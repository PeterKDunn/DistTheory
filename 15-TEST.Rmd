

# Testing 

Some text that I want to add.
Then show some plots, with code in Fig.\ \@ref(fig:plot-example).
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.
Some text and some more text and even more text.




```{r echo=FALSE}
source("R/wrap_Code.R")
source("R/showCode.R")
```

```{r echo=FALSE}
code_text <- '
 plot(cars, main = "Speed vs. Stopping Distance",
      xlab = "Speed (mph)", ylab = "Stopping Distance (ft)",
      col = "blue", pch = 16, cex = 1.2, lwd = 2, las = 1)'

# Count lines and compute required height
line_count <- length(strsplit(code_text, "\n")[[1]])
line_height_in <- 0.31       # inches per line
code_height_in <- max(1.5, 
                      line_count * line_height_in + 0.3) + 0.1
plot_height_in <- 4.5 # This is what would usually appear in the ```{r, fig.height=} code
total_height <- plot_height_in + code_height_in
```

```{r plot-only, echo=FALSE, fig.cap="A scatter plot of cars data.", fig.pos='H', out.width='100%', fig.height=`total_height`, fig.align='center', fig.show='hold'}
layout(matrix(1:2, 
              nrow = 2), 
       heights = c(plot_height_in, 
                   code_height_in))

plot(cars, main = "Speed vs. Stopping Distance",
     xlab = "Speed (mph)", 
     ylab = "Stopping Distance (ft)",
     col = "blue", pch = 16, 
     cex = 1.2, lwd = 2, las = 1)
plot_text_in_figure(code_text, ps=8)

```





```{=html}
<details>
<summary>Show R code</summary>

<pre><code class="language-r">
plot(cars, main = "Speed vs. Stopping Distance",
     xlab = "Speed (mph)", ylab = "Stopping Distance (ft)",
     col = "blue", pch = 16, cex = 1.2,
     lwd = 2, las = 1)
</code></pre>
</details>
```

