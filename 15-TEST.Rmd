
# Testing {#TESTING}

## Test 1: works {#TESTING-WORK}

Some text and some more text and even more text.


```{r echo=FALSE}
code_text <- '
 plot(cars, main = "Speed vs. Stopping Distance",
      xlab = "Speed (mph)", ylab = "Stopping Distance (ft)",
      col = "blue", pch = 16, cex = 1.2, lwd = 2, las = 1)'
```

<!-- LATEX CODE -->
```{r plot-gen, echo=FALSE, fig.show='hide'}
# This R code generates the plot image file.
# fig.show='hide' prevents knitr from automatically inserting the image.
plot(cars, main = "Speed vs. Stopping Distance",
     xlab = "Speed (mph)", ylab = "Stopping Distance (ft)",
     col = "blue", pch = 16, cex = 1.2, lwd = 2, las = 1)

# This chunk runs BEFORE the raw LaTeX block.
# It gets the actual path to the generated PDF plot and stores it in an R variable.
plot_path <- knitr::fig_chunk('plot-gen', 'pdf')
```


```{=latex}
\begin{figure}[htbp]
\centering
% Dynamically include the plot generated by the 'plot-gen' chunk.
% knitr::fig_chunk() gets the correct path to the PDF image.
\includegraphics[width=0.9\linewidth]{`r plot_path`}
\vspace{0.5em} % Small vertical space between plot and code

\begin{minipage}{0.9\linewidth}
\begin{lstlisting}[language=R]
plot(cars, main = "Speed vs. Stopping Distance",
  xlab = "Speed (mph)", ylab = "Stopping Distance (ft)",
  col = "blue", pch = 16, cex = 1.2, lwd = 2, las = 1)
\end{lstlisting}
\end{minipage}

\caption{Speed vs. Stopping Distance: Plot and Corresponding R Code}
\label{fig:cars-plot-code} % Give your figure a unique label
\end{figure}
```


<!-- HTML CODE -->
```{r plot-onlyHTML, echo=FALSE, fig.cap="A scatter plot of cars data.", fig.pos='H', out.width='100%', eval=knitr::is_html_output(), include=knitr::is_html_output()} 
plot(cars, main = "Speed vs. Stopping Distance",
     xlab = "Speed (mph)", 
     ylab = "Stopping Distance (ft)",
     col = "blue", pch = 16, 
     cex = 1.2, lwd = 2, las = 1)
```
```{=html}
<details>
<summary>Show R code</summary>

<pre><code class="language-r">
plot(cars, main = "Speed vs. Stopping Distance",
     xlab = "Speed (mph)", ylab = "Stopping Distance (ft)",
     col = "blue", pch = 16, cex = 1.2,
     lwd = 2, las = 1)
</code></pre>
</details>
```





## Test 2 {#TESTING-ONE-CODE}

Some text and some more text and even more text.


```{r echo=FALSE}
my_plot_code_expr <- quote(
  plot(cars, main = "Speed vs. Stopping Distance",
       xlab = "Speed (mph)", ylab = "Stopping Distance (ft)",
       col = "blue", pch = 16, cex = 1.2, lwd = 2, las = 1)
)
```

```{r echo=FALSE}
# 2. Define a helper function to format code for HTML <pre><code> blocks
#    This cleans up the output from deparse()
show_html_code <- function(code_expr) {
  code_lines <- deparse(code_expr)
  # Remove leading indentation added by deparse from each line (still useful)
  code_lines <- sub("^\\s+", "", code_lines)
  code_string <- paste(code_lines, collapse = "\n")

  # RETURN the full HTML string
  return(paste0('<pre><code class="language-r">\n', code_string, '\n</code></pre>\n'))
}
```



```{r plot-genA, echo=FALSE, fig.show='hide'}
# This R code generates the plot image file.
# fig.show='hide' prevents knitr from automatically inserting the image.
eval(my_plot_code_expr)

# This chunk runs BEFORE the raw LaTeX block.
# It gets the actual path to the generated PDF plot and stores it in an R variable.
plot_path <- knitr::fig_chunk('plot-gen', 'pdf')
```


```{=latex}
\begin{figure}[htbp]
\centering
% Dynamically include the plot generated by the 'plot-gen' chunk.
% knitr::fig_chunk() gets the correct path to the PDF image.
\includegraphics[width=0.9\linewidth]{`r plot_path`}
\vspace{0.5em} % Small vertical space between plot and code

\begin{minipage}{0.9\linewidth}
\begin{lstlisting}[language=R]
`r paste(deparse(my_plot_code_expr), collapse = "\n")`
\end{lstlisting}
\end{minipage}

\caption{Speed vs. Stopping Distance: Plot and Corresponding R Code}
\label{fig:cars-plot-code} % Give your figure a unique label
\end{figure}
```


SOME STUFF HERE

```{r html-code-display, echo=FALSE, results='asis', eval=knitr::is_html_output()}
cat('<details>\n<summary>Show R code</summary>\n\n',
show_html_code(my_plot_code_expr),
'</details>\n')
```


```{r plot-onlyHTMLA, echo=FALSE, fig.cap="A scatter plot of cars data.", fig.pos='H', out.width='100%', eval=knitr::is_html_output(), include=knitr::is_html_output()} 
eval(my_plot_code_expr)
```






```{r asis-test, results='asis', echo=FALSE}
cat("<h2>Hello World from ASIS!</h2>")
```


