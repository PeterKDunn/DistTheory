## Answers for Chap. 7

:::{.answer}
**Answer to Exercise \@ref(exr:Ycubed).**

For $0 < x < 2$, the transformation is one-to-one.
The inverse transform is $X = Y^{1/3}$, and so $0 < y < 8$.

1. $F_Y(y) = \Pr(Y\le y)
   = \Pr(X^3 \le y) = \Pr(X\le y^{1/3}) = F_X( y^{1/3})
   = \int_{u = 0}^{y^{1/3}} u/2\,du = u^2/4\Big|_{u = 0}^{u = y^{1/3}} = y^{2/3}/4.$
Differentiate to find the pdf: 
$\frac{d}{dy} y^{2/3}/4 = y^{-1/3}/6$. 
The pdf of $Y$ is

\[
   f_Y(y) = \begin{cases}
               y^{-1/3}/6 & \text{for $0 < y < 8$};\\
               0 & \text{otherwise}.
            \end{cases}
\]

2. Since $w(y) = y^{1/3}$, then $w'(y) = y^{-2/3}$.
Then:  
\begin{align*}
   f_Y(y)
   &= f_X(y) |J|\\
   &= y^{1/3}/2 \times \overbrace{y^{-2/3}/3}^{|J|} \\
   &= y^{-1/3}/6.
\end{align*}
So the pdf of $Y$ is as above.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:JointDiscrete).**

* When $Y_2 = 0$ (i.e., $X_2 = 0$): $Y_1$ takes the values 0 and 1 (with probs 0 and 2/6).
* When $Y_2 = 1$ (i.e., $X_2 = 1$): $Y_1$ takes the values 1 and 2 (with probs 1/6 and 3/6).
 
So the joint pf is shown in Table \@ref(tab:JDTable).
Hence,

\[
   f_{Y_1} = 
   \begin{cases} 
      1/2 & \text{if $y_1 = 1$};\\
      1/2 & \text{if $y_1 = 2$};\\
      0    & \text{otherwise}.
    \end{cases}
\]

```{r JDTable, echo=FALSE}
JDTable <- array( dim = c(2, 4))

colnames(JDTable) <- c("",
                       "$Y_1 = 1$",
                       "$Y_1 = 2$",
                       "$Y_1 = 3$")
JDTable[1, ] <- c("$Y_2 = 0$",
                  "0",
                  "2/6",
                  "0")
JDTable[2, ] <- c("$Y_2 = 1$",
                  "0",
                  "1/6",
                  "3/6")
if (knitr::is_latex_output()) {
  kable(JDTable,
    format = "latex",
    escape = FALSE,
    caption = "The joint distribution of $Y_1$ and $Y_2$",
    booktabs = TRUE) %>%
  kable_styling(font_size = 10) %>%
  row_spec(0, bold = TRUE) 
}
if (knitr::is_html_output()){
  kable(JDTable,
    caption = "The joint distribution of $Y_1$ and $Y_2$",
    format = "html",
    booktabs = TRUE) %>%
  kable_styling(font_size = 10) %>%
  row_spec(0, bold = TRUE) 
}
```
:::

:::{.answer}
**Answer to Exercise \@ref(exr:GammaSum).**

$Y \sim\text{Gam}(\sum\alpha, \beta)$.
:::
  



:::{.answer}
**Answer to Exercise \@ref(exr:CauchySquared).**
  
Transformation is not 1-1. 
$f_Y(y)=\displaystyle {\frac{1}{\pi \sqrt{y}(1 + y)}}$ for $0 < y < \infty$.
:::

:::{.answer}
**Answer to Exercise \@ref(exr:ContTransform).**

1. Differentiating:  
   \[
     f_X(x) = 
     \begin{cases}
       1 & \text{for $-1/2 < x < /1/2$};\\
       0 & \text{elsewhere}.
     \end{cases}
   \]
2. First: this transformation is not 1:1 (Fig. \@ref(fig:TransformSquared)).
   See that $X = \pm\sqrt{4 - Y}$, and that $3.75 < Y < 4$.
   So,   
   \begin{align*}
     F_Y(y) 
     &= \Pr(Y < y) \\
     &= 1 - \Pr( -\sqrt{4 - y} < X < \sqrt{4 - y} )\\
     &= 1 - \int_{-\sqrt{4 - y}}^{\sqrt{4 - y}} 1\, dx\\
     &= 1 - 2\sqrt{4 - y},
   \end{align*}
   and so, differentiating:
   \[
     f_Y(y) = \frac{1}{\sqrt{4 - y}} \quad\text{for $3.75 < Y < 4$}
   \]
:::

```{r TransformSquared, out.width='100%', fig.width=9, fig.height=3,fig.cap="The transformation", fig.align="center"}
par( mfrow = c(1, 3))

xwide <- seq(-0.75, 0.75,
             length = 100)
x <- seq( -0.5, 0.5,
          length = 100)
y <- dunif(xwide, 
           min = -0.5,
           max = 0.5)
plot( y ~ xwide,
      lwd = 2,
      las = 1,
      type = "l",
      main = expression(The~PDF~"of"~italic(X)),
      xlab = expression(italic(X)),
      ylab = expression(PDF~"of"~italic(X)) )


###

Y <- (4 - x^2)
Ywide <- (4 - xwide^2)

plot(Ywide ~ xwide,
     main = "The transformation",
     las = 1,
     lwd = 2,
     type = "l",
     col = "grey",
     xlab = expression(italic(X)),
     ylab = expression(italic(Y)))
lines(Y ~ x,
      lwd = 4 ,
      col = "black")

abline(v = 0)

yht <- 3.85
x1 <- -sqrt(4 - yht)
x2 <- sqrt(4 - yht)
abline( h = yht,
        col = "grey",
        lty = 2)
abline( v = x1,
        col = "grey",
        lty = 2)
abline( v = x2,
        col = "grey",
        lty = 2)

text(x = x1,
     y = yht,
     pos = 1,
     labels = expression(italic(x)[1]) )
text(x = x2,
     pos = 1,
     y = yht,
     labels = expression(italic(x)[2]) )
mtext(expression(italic(y)),
      at = yht,
      line = 1,
      side = 2,
      las = 1)
##
y <- seq(3.75, 4,
         length = 100)
PDFy <- 1 / sqrt(4 - y)

plot( PDFy ~ y,
      lwd = 2,
      las = 1,
      type = "l",
      ylim = c(0, 10),
      xlim = c(3.65, 4.15),
      main = expression(The~PDF~"of"~italic(Y)),
      xlab = expression(italic(Y)),
      ylab = expression(PDF~"of"~italic(Y)) )
lines( x = c(3.5, 3.75),
       y = c(0, 0),
       lwd = 2)
lines( x = c(4, 4.15),
       y = c(0, 0),
       lwd = 2)
abline( v = c(3.75, 4),
        lty = 2,
        col = "grey")
```


:::{.answer}
**Answer to Exercise \@ref(exr:Projectile).**

Given that $f(\theta) = 4/\pi$ for $0 < \theta< \pi/4$, and hence $0 < D < (v^2/g)$.
Then:  
\begin{align*}
  F_D(d) = \Pr(D < d) 
  &= \Pr( v^2/g\sin2\theta < d) \\
  &= \Pr(\theta < \frac{1}{2} \sin^{-1}(d g/v^2 ) \\
  &= \int_0^{\sin^{-1}(d g/v^2 )/2} \frac{4}{\pi}\, d\theta \\
  &= \frac{2}{\pi} \sin^{-1} \left( \frac{dg}{v^2} \right).
\end{align*}
So   
\[
  f_D(d) = \frac{2g}{\pi}\frac{1}{\sqrt{v^4 - d^2 g^2}}\quad\text{for $0 < D < v^2 /g$}.
\]

Alternatively: see that $D = v^2\sin 2\theta/g \Rightarrow sin 2\theta = Dg/v^2$, and so  
\[
  \frac{dd}{d\theta} = \frac{2v^2}{g}\cos 2\theta.
\]
Then,  
\begin{align*}
  f_D(d) 
  &= \frac{4}{\pi} \left| \frac{g}{2 v^2\cos 2\theta} \right|\\
  &= \frac{2g}{\pi v^2 \cos2\theta}\\
  &= \frac{2g}{\pi \sqrt{v^4 - d^2 g^2}}
\end{align*}
after (e.g.) drawing the right-angled triangle to re-write $\sin 2\theta = Dg/v^2$. 
See Fig. \ref(fig:Projectile).
:::

```{r Projectile, fig.align="center", fig.cap="The distance travelled by a projectile"}
g <- 9.8
v <- 12
dvec <- seq(0, v^2/g,
            length = 100)
pdf <- ( 2 * g / pi ) / sqrt(v^4 - dvec^2 * g^2)

plot(pdf ~ dvec,
     type = "l",
     las = 1,
     lwd = 2,
     xlab = expression(Distance~italic(d)),
     ylab = "Prob. fn.")
abline(v = v^2/g,
       col = "grey",
       lty = 2)
```


:::{.answer}
**Answer to Exercise \@ref(exr:BinomXform).**
See that $Y\in\{0, 1, \sqrt{2}, \sqrt{3}, 2\}$ and so. 
\[ 
   \Pr(Y = y) = \binom{4}{y^2} (0.2)^{y^2} (0.8)^{4 - y^2} \quad \text{for $y = 0, 1, \sqrt{2}, \sqrt{3}, 2$}.
\]
:::


:::{.answer}
**Answer to Exercise \@ref(exr:LogNormal)**.

1. First see that $Y = \log X$.
   Then:  
   \begin{align*}
     F_Y(y)
     &= \Pr(y < Y) \\
     &= \Pr( \exp x < Y)\\
     &= \Pr( x < \log Y)\\
     &= \Phi\big((\log Y - \mu)/sigma\big) 
   \end{align*}
   by the definition of $\Phi(\cdot)$.
2. Proceed:
   \begin{align*}
     f_Y(y) 
     &= \frac{d}{dy}  \Phi\big((\log Y - \mu)/sigma\big) \\
     &= \frac{1}{y} \Phi\big((\log Y - \mu)/sigma\big) \\
     &= \frac{1}{y\sqrt{2\pi\sigma^2}}
        \exp\left[\left(
           -\frac{ (\log y - \mu)^2}{\sigma}\right)^2\right]
   \end{align*}
   since the derivative of $\Phi(\cdot)$ (the df of a standard normal distribution) is $\phi(\cdot)$ (the pdf of a standard normal distribution).
3. See Fig. \@ref(fig:LogNormalPlots).
4. See below: About 0.883.
:::


```{r LogNormalPlots, fig.align="center", fig.cap = 
Log-normal distributions", out.width='100%', fig.width=9.5, fig.height = 7}
par( mfrow = c(2, 2))

x <- seq(0, 8,
         length = 500)

plot( dlnorm(x, meanlog = log(1), sdlog = 1) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      type = "l",
      main = expression(Log~normal*":"~mu==1~and~sigma==1),
      lwd = 2,
      las = 1)
plot( dlnorm(x, meanlog = log(3), sdlog = 1) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      type = "l",
      main = expression(Log~normal*":"~mu==3~and~sigma==1),
      lwd = 2,
      las = 1)
plot( dlnorm(x, meanlog = log(1), sdlog = 2) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      main = expression(Log~normal*":"~mu==1~and~sigma==2),
      type = "l",
      lwd = 2,
      las = 1)
plot( dlnorm(x, meanlog = log(3), sdlog = 2) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      main = expression(Log~normal*":"~mu==3~and~sigma==2),
      type = "l",
      lwd = 2,
      las = 1)
```

```{r}
(1 - plnorm(2, meanlog=2, sdlog=2)) / 
  (1 - plnorm(1, meanlog=2, sdlog=2))
```




:::{.answer}
**Answer to Exercise \@ref(exr:Xminus3).**

1. First, see the relationships:  
\begin{align*}
  X = 1 &\to Y = (X - 3)^2 = 4;\\
  X = 2 &\to Y = (X - 3)^2 = 1;\\
  X = 3 &\to Y = (X - 3)^2 = 0;\\
  X = 4 &\to Y = (X - 3)^2 = 1.
\end{align*}
  So adding probabilities as appropriate:  
\[
  p_Y(y) = 
  \begin{cases}
     9/30  & \text{for $y = 0$}\\
     20/30 & \text{for $y = 1$}\\
     1/30  & \text{for $y = 4$}\\
     0     & \text{elsewhere}.
\end{cases}
\]
:::


