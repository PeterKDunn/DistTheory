## Answers for Chap. 7

:::{.answer}
**Answer to Exercise \@ref(exr:Ycubed).**

For $0 < x < 2$, the transformation is one-to-one.
The inverse transform is $X = Y^{1/3}$, and so $0 < y < 8$.

1. $F_Y(y) = \Pr{Y\le y}
   = \Pr(X^3 \le y) = \Pr(X\le y^{1/3}) = F_X( y^{1/3})
   = \int_{u = 0}^{y^{1/3}} u/2\,du = u^2/4\Big|_{u = 0}^{u = y^{1/3}} = y^{2/3}/4.$
Differentiate to find the pdf: 
$\frac{d}{dy} y^{2/3}/4 = y^{-1/3}/6$. 
The pdf of $Y$ is

\[
   f_Y(y) = \begin{cases}
               y^{-1/3}/6 & \text{for $0 < y < 8$};\\
               0 & \text{otherwise}.
            \end{cases}
\]

2. Since $w(y) = y^{1/3}$, then $w'(y) = y^{-2/3}$.
Then:

\begin{align*}
   f_Y(y)
   &= f_X(y) |J|\\
   &= y^{1/3}/2 \times \overbrace{y^{-2/3}/3}^{|J|} \\
   &= y^{-1/3}/6.
\end{align*}
So the pdf of $Y$ is as above.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:JointDiscrete).**

Note $Y_1$ takes the values $1$ and $2$ for $Y_2 = 0$;
$Y_1$ takes the values $2$ and $3$ for $Y_2 = 1$.

The joint pf is shown in Table \@ref(tab:JDTable).
Hence,

\[
   f_{Y_1} = 
   \begin{cases} 
      2/14 & \text{if $y_1 = 1$};\\
      7/14 & \text{if $y_1 = 2$};\\
      5/14 & \text{if $y_1 = 3$};\\
      0    & \text{otherwise}.
    \end{cases}
\]

```{r JDTable, echo=FALSE}
JDTable <- array( dim = c(2, 4))

colnames(JDTable) <- c("",
                       "$Y_1 = 1$",
                       "$Y_1 = 2$",
                       "$Y_1 = 3$")
JDTable[1, ] <- c("$Y_2 = 0$",
                  "2/14",
                  "4/14",
                  "0")
JDTable[2, ] <- c("$Y_2 = 1$",
                  "0",
                  "3/14",
                  "5/14")
if (knitr::is_latex_output()) {
  kable(JDTable,
    format = "latex")
}
if (knitr::is_html_output()){
  kable(JDTable,
    format = "html")
}
```
:::

:::{.answer}
**Answer to Exercise \@ref(exr:GammaSum).**

$Y \sim\text{Gam}(\sum\alpha, \beta)$.
:::
  
  
:::{.answer}
**Answer to Exercise \@ref(exr:CauchySquared).**
  
Transformation is not 1-1. 
$f_Y(y)=\displaystyle {\frac{1}{\pi \sqrt{y}(1 + y)}}$ for $0 < y < \infty$.
:::

:::{.answer}
**Answer to Exercise \@ref(exr:ContTransform).**

1. $f_x(x) = x$ for $-0.5 < x < 0.5$.  
1. $F_Y(y) =\Pr(Y \le y) = 1 - 2\sqrt{4 - y}$ for $3.75 < y < 4$.
1. $f_Y(y) = (4 - y)^{-1/2}$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:LogNormal)**.

1. First see that $Y = \log X$.
   Then:  
   \begin{align*}
     F_Y(y)
     &= \Pr(y < Y) \\
     &= \Pr( \exp x < Y)\\
     &= \Pr( x < \log Y)\\
     &= \Phi\big((\log Y - \mu)/sigma\big) 
   \end{align*}
   by the definition of $\Phi(\cdot)$.
1. Proceed:
   \begin{align*}
     f_Y(y) 
     &= \frac{d}{dy}  \Phi\big((\log Y - \mu)/sigma\big) \\
     &= \frac{1}{y} \Phi\big((\log Y - \mu)/sigma\big) \\
     &= \frac{1}{y\sqrt{2\pi\sigma^2}}
        \exp\left[\left(
           -\frac{ (\log\y - \mu)^2}{\sigma}\right)^2\right]
   \end{align*}
   since the derivative of $\Phi(\cdot)$ (the df of a standard normal distribution) is $\phi(\cdot)$ (the pdf of a standard normal distribution).
3. See Fig. \@ref(fig:LogNormalPlots).
4. See below: About 0.883.


1. Plot the log-normal distribution for various parameter values.
1. Determine $\Pr(Y > 1 | Y < 2)$ when $\mu = 2$ and $\sigma^2 = 2$.

(**Hint**: Use the `dlnorm()` and `plnorm()` functions in **R**.)
:::

```{r LogNormalPlots, fig.align="center", fig.cap = 
Log-normal distributions", out.width='100%', fig.width=9.5, fig.height = 7}
par( mfrow = c(2, 2))

x <- seq(0, 8,
         length = 500)

plot( dlnorm(x, meanlog = log(1), sdlog = 1) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      type = "l",
      main = expression(Log~normal*":"~mu==1~and~sigma==1),
      lwd = 2,
      las = 1)
plot( dlnorm(x, meanlog = log(3), sdlog = 1) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      type = "l",
      main = expression(Log~normal*":"~mu==3~and~sigma==1),
      lwd = 2,
      las = 1)
plot( dlnorm(x, meanlog = log(1), sdlog = 2) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      main = expression(Log~normal*":"~mu==1~and~sigma==2),
      type = "l",
      lwd = 2,
      las = 1)
plot( dlnorm(x, meanlog = log(3), sdlog = 2) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      main = expression(Log~normal*":"~mu==3~and~sigma==2),
      type = "l",
      lwd = 2,
      las = 1)
```

```{r}
(1 - plnorm(2, meanlog=2, sdlog=2)) / 
  (1 - plnorm(1, meanlog=2, sdlog=2))
```
:::

