# Selected solutions

This Appendix contains some answers to end-of-chapter questions.


```{r evenAnswers, message=FALSE, warning=FALSE, include=FALSE}
includeFullAnswers <- knitr::is_latex_output()
includeBriefAnswers <- !includeFullAnswers
   # THIS MEANS: If latex, show the full answers; for HTML, show brief answers

    # So, for Task 1:
    #     place short answers in  includeFullAnswers; 
    #     place complete answers in   includeBriefAnswers
    # So, for Task 2: 
    #     place complete answers in  includeBriefAnswers
includeGraphsTables <- FALSE
```


<!-- Since font size reduces, make caption font size smaller -->
`r if( knitr::is_latex_output() ) "\\captionsetup{font=footnotesize}"`


## Answers for Chap. 1 {#AnswersChap1}

`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:BasicProbs).**

1. Probably the Venn diagram is best.
1. $\Pr(A\cup B) = \Pr(A) + \Pr(B) - \Pr(A\cap B) = 0.66$.
1. $0.13$.
1. $0.89$.
1. $0.11/0.24 \approx 0.4583...$
1. $\Pr(A) \times \Pr(B) = 0.53\times 0.24 = 0.1272 \ne \Pr(A\cap B) = 0.11$; not independent... but close.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:BasicProbs).**

1. Venn diagram?
1. $0.66$.
1. $0.13$.
1. $0.89$.
1. $0.4583...$
1. Not independent... but close.
:::
`r if( includeFullAnswers) "-->"`






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DrawNumbers).**

1. $(50/100)\times (49/99)\times (48/98)\times (47/97) = ^{50}C_4 / ^{100}C_4\approx 0.0587$.
1. $^{50}C_2\times ^{50}C_2 / ^{100}C_4  = 1225/3201 \approx 0.3826$.
1. $\Pr(\text{at least 2 odd before 1st even}) = \Pr(\text{odd, odd, even, either}) + \Pr(\text{odd, odd, odd, even)} = (50/100)\times(49/99)\times(50/98) + (50/100)\times (49/99)\times(48/98)\times(50/97) \approx 0.1887$.
1. $\Pr(\text{sum odd}) = \Pr(\text{exactly 1 odd number drawn, OR exactly 3 odd numbers drawn}) = 1600/3201 \approx 0.49984$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DrawNumbers).**

1. $0.0587...$.
1. $0.3826...$.
1. $0.1887...$.
1. $0.49984...$.
:::
`r if( includeFullAnswers) "-->"`





`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Quadratic).**

1. $S = \{ (a,b,c) \mid a\in(-\infty, 0)\cap (0, \infty), -\infty < b < \infty, -\infty < c < \infty\}$, which can be written $X \in \{(a, b, c) | (a, b, c) \in \mathbb{R}, a \ne 0\}$ where $\mathbb{R}$ represents the real numbers.
1. The solutions to a quadratic equation are given by
$$
   x = \frac{-b \pm \sqrt{b^2 - 4ac} }{2a}.
$$
For two equal roots, $b^2 - 4ac = 0$, so event $R$ is defined as $R = \{ (a,b,c) \mid (a, b, c)\in \mathbb{R}, a\ne 0, b^2 - 4ac = 0\}$.
1. For no real roots, $b^2 - 4ac < 0$, so event $Z$ is defined as $Z = \{ (a,b,c) \mid (a, b, c)\in \mathbb{R}, a\ne 0, b^2 - 4ac < 0\}$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Quadratic).**

1. $X \in \{(a, b, c) | (a, b, c) \in \mathbb{R}, a \ne 0\}$ where $\mathbb{R}$ represents the real numbers.
1. $R = \{ (a,b,c) \mid (a, b, c)\in \mathbb{R}, a\ne 0, b^2 - 4ac = 0\}$.
1. $Z = \{ (a,b,c) \mid (a, b, c)\in \mathbb{R}, a\ne 0, b^2 - 4ac < 0\}$.
:::
`r if( includeFullAnswers) "-->"`




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:GreenLights).**

1. The length of time (in seconds) between green lights at the intersection, say $G$.
2. $S = \{G \mid 15 \le G \le 150\}$.
3. No---no equally likely events are defined.
4. The probability can be *approximated*---observe the lights many times, and count how often there is less than 90 seconds between green
lights.
:::
`r if( includeBriefAnswers) "-->"`



`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Cricket).**

1. $C^7_5 \times C^5_4 \times C^2_1 \times C^1_1 = 210$.
2. $11^2 + (2\times 22) = 165$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Cricket).**

1. $210$.
2. $165$.
:::
`r if( includeFullAnswers) "-->"`




:::{.answer}
**Answer to Exercise\ \@ref(exr:HatData).**

Tree diagram: Fig, \@ref(fig:HatTree); table: Table \@ref(tab:HatTable); Venn diagram: Fig. \@ref(fig:HatVenn).
:::


```{r HatTree, echo=FALSE, fig.align="center", fig.cap="Tree diagram for the hat-wearing example", fig.width=6.5, fig.height=4, out.width='70%'}

plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      main = "Tree diagram for the hat data",
      xlab = "",
      ylab = "",
      axes = FALSE)
#STEP 1
lines( x = c(0.2, 0.40),
       y = c(0.5, 0.75),
       lwd = 2)
lines( x = c(0.2, 0.40),
       y = c(0.5, 0.25),
       lwd = 2)
# STEP 2
lines( x = c(0.60, 0.80),
       y = c(0.75, 0.90),
       lwd = 2)
lines( x = c(0.60, 0.80),
       y = c(0.75, 0.60),
       lwd = 2)

lines( x = c(0.60, 0.80),
       y = c(0.25, 0.40),
       lwd = 2)
lines( x = c(0.60, 0.80),
       y = c(0.25, 0.10),
       lwd = 2)

# TEXT
text(x = 0.50,
     y = 0.75,
     labels = "Males")
text(x = 0.50,
     y = 0.25,
     labels = "Females")

text(x = 0.90,
     y = 0.90,
     labels = "Hat")
text(x = 0.90,
     y = 0.60,
     labels = "No hat")

text(x = 0.90,
     y = 0.40,
     labels = "Hat")
text(x = 0.90,
     y = 0.10,
     labels = "No hat")

# ADD PROBS
text(x = 0.38,
     y = 0.63,
     cex = 0.9,
     labels = "0.513")
text(x = 0.38,
     y = 0.37,
     cex = 0.9,
     labels = "0.487")

text(x = 0.65,
     y = 0.85,
     cex = 0.9,
     labels = "0.205")
text(x = 0.65,
     y = 0.65,
     cex = 0.9,
     labels = "0.795")

text(x = 0.65,
     y = 0.345,
     cex = 0.9,
     labels = "0.060")
text(x = 0.65,
     y = 0.15,
     cex = 0.9,
     labels = "0.940")

## STEPS
text(x = 0.50,
     y = 0.01,
     label = expression(bold("Step 1"))
     )
text(x = 0.90,
     y = 0.01,
     label = expression(bold("Step 2"))
     )
```


```{r HatTable, echo=FALSE}
BRIS <- read.csv("Data/sunglasses.csv")
BRIS$Gender <- factor(BRIS$Gender,
                      levels = c(1, 2),
                      labels = c("Males",
                                 "Females"))
BRIS$Hat <- factor(BRIS$Hat,
                   levels = c(0, 1),
                   labels = c("No Hat",
                              "Hat"))

HatTable <- xtabs( Count ~ Gender + Hat,
                   data = BRIS)
HatTable <- cbind( HatTable,
                   "Total" = rowSums(HatTable) )

if( knitr::is_latex_output() ) {
  knitr::kable(HatTable,
               format = "latex",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,
               escape = FALSE,
               caption = "The numbers of males and females wearing a hat in the middle of the day in Brisbane") %>%
    kable_styling(font_size = 10) %>%
    row_spec(0, bold = TRUE)
}
if( knitr::is_html_output() ) {
  knitr::kable(HatTable,
               escape = TRUE,
               format = "html",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,
               caption = "The numbers of males and females wearing a hat in the middle of the day in Brisbane") %>%
    row_spec(1, bold = TRUE)
}
```



```{r HatVenn, echo=FALSE, fig.width=7, fig.height=7, out.width='70%', fig.align="center", fig.cap="The hat-wearing data as a Venn diagram"}
par( mfrow = c(2, 2))
colourMale <- rgb(0, 0, 255,
                  max = 255,
                  alpha = 125)
colourHat  <- rgb(0, 255, 0,
                  max = 255,
                  alpha = 125)

plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      ylab = "",
      xlab = "",
      main = expression(paste("Events ", italic(M), " and ", bar(italic(M)))),
      axes = FALSE)

polygon( x = c(0, 0, 1, 1),
         y = c(0, 1, 1, 0))
plotrix::draw.circle(x = 0.4,
                     y = 0.5,
                     radius = 0.2,
                     col = colourMale)
text(x = 0.4,
     y = 0.5,
     labels = expression(paste(italic(M), ": 307")))
text(x = 0.8,
     y = 0.5,
     labels = expression(paste(bar(italic(M)), ": 366")))
mtext(text = expression(italic(S)),
      side = 1,
      adj = 0.25)


###############


plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      ylab = "",
      xlab = "",
      main = expression(paste("Events ", italic(H), " and ", bar(italic(H)))) ,
      axes = FALSE)


polygon( x = c(0, 0, 1, 1),
         y = c(0, 1, 1, 0))

plotrix::draw.circle(x = 0.6,
                     y = 0.5,
                     radius = 0.2,
                     col = colourHat)

text(x = 0.6,
     y = 0.5,
     labels = expression(paste(italic(H), ": 101")))
text(x = 0.2,
     y = 0.5,
     labels = expression(paste( bar(italic(H)), ": 651")))

mtext(text = expression(italic(S)),
      side = 1,
      adj = 0.25)


####################


plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      ylab = "",
      xlab = "",
      main = expression(paste("Events ", italic(M), " and ", italic(H))) ,
      axes = FALSE)


polygon( x = c(0, 0, 1, 1),
         y = c(0, 1, 1, 0))
plotrix::draw.circle(x = 0.4,
                     y = 0.5,
                     radius = 0.2,
                     col = colourMale)
plotrix::draw.circle(x = 0.6,
                     y = 0.5,
                     radius = 0.2,
                     col = colourHat)
text(x = 0.3,
     y = 0.5,
     labels = expression(italic(M)))
text(x = 0.7,
     y = 0.5,
     labels = expression(italic(H)))
mtext(text = expression(italic(S)),
      side = 1,
      adj = 0.25)


#################



plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      ylab = "",
      xlab = "",
      main = "The numbers in each section",
      axes = FALSE)


polygon( x = c(0, 0, 1, 1),
         y = c(0, 1, 1, 0))
plotrix::draw.circle(x = 0.4,
                     y = 0.5,
                     radius = 0.2,
                     col = colourMale)
plotrix::draw.circle(x = 0.6,
                     y = 0.5,
                     radius = 0.2,
                     col = colourHat)
text(x = 0.3,
     y = 0.5,
     labels = "307")
text(x = 0.7,
     y = 0.5,
     labels = "22")
text(x = 0.7,
     y = 0.85,
     labels = expression(bar(italic(M)) ~ intersect() ~ bar(italic(H)) ~ ": 344") )
mtext(text = expression(italic(S)),
      side = 1,
      adj = 0.25)

# Intersection
text(x = 0.5,
     y = 0.5,
     label = "79")

```


:::{.answer}
**Answer to Exercise\ \@ref(exr:CarPassengers).**

1. Choose one driver, and the other seven passengers can sit anywhere:
   $2!\times 7! = 10080$.
1. Choose one driver, and the other seven passengers can sit anywhere:
   $3!\times 7! = 30240$.
1. Choose one driver, choose who sits in what car sets, and the other five passengers can sit anywhere:
   $2!\times 2! \times 5! = 480$.
:::


:::{.answer}
**Answer to Exercise\ \@ref(exr:Monopoly).**
$8\times 7\times 6\times 5 = 1680$ ways.
:::


:::{.answer}
**Answer to Exercise\ \@ref(exr:PassWords).**
The order is important; use permutations.

1. Eight: $^{26}P_8 = 62\ 990\ 928\ 000$;
   nine:  $^{26}P_9 = 1.133837\times 10^{12}$;
   ten: $^{26}P_8 = 1.927522\times 10^{13}$.
   *Total*: $2.047205\times 10^{13}$.
2. $^{52}P_8 = 3.034234\times 10^{13}$.
3. $^{62}P_8 = 1.363259\times 10^{14}$.
4. No answer (yet).
:::




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:MatchingBrackets).**

1. `()()` and `(())`.
   There are two ways.
1. `()()()` and `(())()` and `()(())` and `((()))` and `(()())`.
   There are five ways.
1. $\displaystyle \frac{1}{n + 1} \binom{2n}{n} = \frac{1}{n + 1}\frac{(2n)!}{n!n!}  = \frac{1}{(n + 1)!} \frac{(2n)!}{n!}$ as to be shown.
1. Write as $\displaystyle \frac{(2n)!}{n!\, n!} - \frac{(2n)!}{(n + 1)! (2n - n - 1)!}$.
   Simplifying:
\begin{align*}
     \frac{(2n)!}{n!\, n!} - \frac{(2n)!}{(n + 1)! (n - 1)!}
   &= \frac{(2n)!}{n!\, n!} - \left( \frac{n}{n + 1}\right) \frac{(2n)!}{n!\,n!}\\
   &= \binom{2n}{n}\left(1 - \frac{n}{n + 1}\right) \\
   &= \frac{1}{n + 1} \binom{2n}{n}
\end{align*}
1. The first nine Catalan numbers, for $n = 0, \dots 8$, are $1, 1, 2, 5, 14, 42, 132, 429, 1430$
:::
`r if( includeBriefAnswers) "-->"`






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Stirling).**
See Fig.\ \@ref(fig:Stirling).

```{r Stirling, fig.cap="Relative error of Stirling's approximation", fig.align="center", out.width="70%"}
# Define a function to compute Stirling numbers:
stirling <- function(n){ 
  sqrt(2 * pi *n) * (n/exp(1))^n
}

n <- 1:10
Actual <- factorial(n) 
Approx <- stirling(n)
RelError <- (Actual - Approx)/Actual * 100

cbind(Actual, Approx, RelError)

plot(RelError ~ n,
     ylim = c(0, 8),
     las = 1, 
     type = "b",
     pch = 19,
     lwd = 2,
     xlab = expression(italic(n)),
     ylab = "Relative error (%)",
     main = "Relative error of\nStirling's approximation")
```
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Stirling).**
Figure not shown.
:::
`r if( includeFullAnswers) "-->"`




:::{.answer}
**Answer to Exercise\ \@ref(exr:DiceGame).**

1. $\Pr(\text{Player throwing first wins})$ means $\Pr(\text{First six on throw 1 or 3 or 5 or ...})$.
   So: $\Pr(\text{First six on throw 1}) + \Pr(\text{First six on throw 3}) + \cdots$.
   This produces a geometric progression that can be summed obtained (see App.\ \@ref(UsefulSeries)).
2. Use Theorem\ \@ref(thm:TotalProb).
   Define the events $A = \text{Player 1 wins}$, $B_1 = \text{Player 1 throws first}$, and $B_2 = \text{Player 1 throws second}$.
:::




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:RandomisedResponse).**

Write $y = \Pr(\text{answers `yes'})$.

1. Then, from a tree diagram (Step 1: Used drugs/did not use drugs; Step 2: Card says "Used drugs"/Card says "Did not use drugs"):

\begin{align*}
   y
   &= \Pr(\text{Never takes drugs and say so}) + \Pr(\text{Takes drugs and says so})\\
   &= (1 - p) \times\left(\frac{N - m}{N}\right) + p\times\frac{m}{N}.
\end{align*}
Solving for the unknown $p$:
$$
  p = \frac{yN - N + m}{2m - N}.
$$
2. When $m = 0$, $\Pr(Y) = p$: This mean every card says 'I *have* used an illegal drug in the past twelve months', so the proportion that have used an illegal drug is just the same as the proportion responding with 'Yes' (and there is no anonymity).
   When $m = 0$, $\Pr(Y) = 1 - p$: This mean every card says 'I *have not* used an illegal drug in the past twelve months', so the proportion that have used an illegal drug is just the same as the proportion responding with 'No' (and there is no anonymity).
   When $m = N/2$, $\Pr(Y) = 0.5$; we have learnt nothing: The probability is 50--50.
3. $\displaystyle d = \frac{yN - N + m}{2m - N}$, so plugging in $N = 100$, $m = 25$ and $\Pr(Y) = 175/400 = 0.4375$ gives $d = 0.625$.
:::
`r if( includeBriefAnswers) "-->"`






:::{.answer}
**Answer to Exercise\ \@ref(exr:MCExam).**

Use Theorem \@ref(thm:TotalProb) to find $\Pr(C)$ where $C = \text{select correct answer}$, $K = \text{student knows answer}$. 
Then, $\Pr(C)  =\displaystyle {\frac{mp + q}{m}}$
:::



:::{.answer}
**Answer to Exercise\ \@ref(exr:EPL).**

1. $\Pr(W)$ means 'the probability of a win'.
   $\Pr(W \mid \overline{D})$ means 'the probability of a win, given that the game was *not* a draw*'.
2. $\Pr(W) = 91/208 = 0.4375$.
   $\Pr(W\mid\overline{D}) = 91/(208 - 50) = 0.5759494$.
:::


`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:TwoPointsInSquare).**
Write $d$ as the distance; then $S = \{d: 0 \le d \le \sqrt{2}\}$.
For the grid, let's use **R** to find what values are possible:

```{r}
x <- y <- seq(0, 1, by = 0.25)

distances <- outer(x, y, function(x, y){sqrt(x^2 + y^2)})

unique(sort(distances))
```

It seems there are 15 possible values for the distance:

* $0$, $0.25$, $0.50$, $0.75$ and $1$ along grid lines;
* $\sqrt{2}/4$, $\sqrt{5}/4$, $\sqrt{10}/4$ and $\sqrt{17}/4$ when the line is moved one grid-square right;
* $\sqrt{13}/4$ and $\sqrt{20}/4$ when the line is moved two grid-squares right;
* $\sqrt{25}/4$ when the line is moved three grid-squares right;

and so on.
:::
`r if( includeBriefAnswers) "-->"`




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:LocalNewsletter).**

1. Anywhere between $0$% and $8$%.
1. $0.06/0.30 = 0.20$.
1. $0.06/0.08 = 0.75$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:LocalNewsletter).**

1. Between $0$% and $8$%.
1. $0.20$.
1. $0.75$.
:::
`r if( includeFullAnswers) "-->"`



`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SchoolKids).**
The total number of children: $69\ 279$.
Define $N$ as 'a first-nations student', $F$ as 'a female student', and $G$ as 'attends a government school'.

1. $(2540 + 2734 + 391 + 362) / 69,279 \approx 0.0870$.
1. $49,067/69,279 \approx 0.708$.
1. Many ways to approach this. 
   For **government schools** only: 
   $\Pr(F\mid N) = 2540/(2540 + 2734) \approx 0.4816$.
   $\Pr(\bar{F} \mid N)  = 2734/(2540 + 2734) \approx 0.5184$.
   These are---*very* roughly---about the same, so *approximately* independent.
1. Many ways to approach this. 
   For **non-government schools** only: 
   $\Pr(F\mid N) = 391/(391 + 9496)  \approx 0.0395$.
   $\Pr(\bar{F} \mid N)  = 362/(391 + 9496) \approx 0.0366$.
   These are---*very* roughly---about the same, so *approximately* independent.
1. Many ways to approach this.
   $\Pr(N) =  6027/69,279 \approx 0.0870$.
   $\Pr(N | G) = 5274/49,067 \approx 0.1075$,
   These are not very close, so not really independent.
1. For *female* students:
   $\Pr(N) =  (2540 + 391)/33,646 \approx 0.0871$.
   $\Pr(N | G) = 2540/23,759 \approx 0.1069$.
   These are not very close, so not really independent.
1. For *male* students:
   $\Pr(N) =  (2734 + 362)/35,633 \approx 0.0767$.
   $\Pr(N | G) = 2734/25,308 \approx 0.1080$.
   These are not very close, so not really independent.
1. Based on the above, what can you conclude from the data?
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SchoolKids).**
The total number of children: $69\ 279$.
Define $N$ as 'a first-nations student', $F$ as 'a female student', and $G$ as 'attends a government school'.

1. $\approx 0.0870$.
1. $0.708$.
1. *Approximately* independent.
1. *Approximately* independent.
1. Not really independent.
1. Not really independent.
1. Not really independent.
:::
`r if( includeFullAnswers) "-->"`





:::{.answer}
**Answer to Exercise\ \@ref(exr:CardsAces).**

1. The probability depends on what happens with the first card:
   \begin{align*}
     \Pr(\text{Ace second}) 
     &= \Pr(\text{Ace, then Ace}) + |Pr(\text{Non-Ace, then Ace})\\
     &= \left(\frac{4}{52}\times \frac{3}{51}\right) + \left(\frac{48}{52}\times \frac{4}{51}\right) \\
     &= \frac{204}{52\times 51} \approx 0.07843.
   \end{align*}
   You can use a tree diagram, for example.
2. Be careful:

\begin{align*}
  &\Pr(\text{1st card lower rank than second card})\\
  &= \Pr(\text{2nd card a K}) \times \Pr(\text{1st card from Q to Ace}) + {}\\
  &\qquad   \Pr(\text{2nd card a Q}) \times \Pr(\text{1st card from J to Ace}) +{}\\
  &\qquad   \Pr(\text{2nd card a J}) \times \Pr(\text{1st card from 10 to Ace}) + \dots + {}\\
  &\qquad   \Pr(\text{2nd card a 2}) \times \Pr(\text{1st card an Ace}) \\
  &= \frac{4}{51} \times \frac{12\times 4}{52} + {}\\
  &\qquad   \frac{4}{51} \times \frac{11\times 4}{52} +\\
  &\qquad   \frac{4}{51} \times \frac{10\times 4}{52} + \dots +\\
  &\qquad   \frac{4}{51} \times \frac{1\times 4}{52} \\
  &= \frac{4}{51}\frac{4}{52}\left[ 12 + 11 + 10 + \cdots + 1\right]\\
  &= \frac{4}{51}\frac{4}{52} \frac{13\times 12}{2} \approx 0.4705882.
\end{align*}
3. We can select any of the 52 cards to begin.
   Then, there are four cards higher and four lower, so a total of 16 options for the second card, a total of $52\times 16 = 832$ ways it can happen.
   The number of ways of getting two cards is $52\times 51 = 2652$, so the probability is $832/2652 \approx 0.3137$.
:::




:::{.answer}
**Answer to Exercise\ \@ref(exr:Octaves).**
No answer (yet).

:::




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SomeProb).**
$x = 0.05$.
:::
`r if( includeBriefAnswers) "-->"`





`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SolvePermk).**

\begin{align*}
   12\times {}^7P_k &= 7\times {}^6P_{k + 1} \\
   12\times \frac{7!}{(7 - k)!} &= 7\times\frac{6!}{(5 - k)!}\\
   \frac{12}{(7 - k)!} &= \frac{1}{(5 - k)!}\\
   \frac{12}{(7 - k)\times (6 - k)\times (5 - k)!} &= \frac{1}{(5 - k)!}\\
   12 &= (7 - k)(6 - k)\\
   k^2 - 13k + 30 &= 0\\
   (k - 10)(k - 3) &= 0
\end{align*}
and so $k = 10$ or $k = 3$.
But if $k = 10$, we get silly things like ${}^7P_{10}$.
So the solution must be $k = 3$.


```{r}
for (k in (1:5)){ # Answer must e less than 6
  cat("FOR k = ",k, ":")
  cat("LHS =", 12 * factorial(7) / factorial(7 - k), "; ")
  cat("RHS =", 7 * factorial(6) / factorial(5 - k), "\n")
}
```
:::
`r if( includeBriefAnswers) "-->"`



`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SolvePermk2).**

\begin{align*}
   \frac{ {}^7 P_{r + 1}}{ {}^{7}C_r}
   &= \frac{7!}{(7 - (r + 1))!} \times \frac{(7 - r)!\, r!}{7!}\\
   &= \frac{7!}{(6 - r)!} \times \frac{(7 - r)!\, r!}{7!}\\
   &= \frac{(7 - r)!\, r!}{(6 - r)!}\\
   &= \frac{(7 - r)\times (6 - r)!\, r!}{(6 - r)!}\\
   &= (7 - r) r!\\
   &= 10.
\end{align*}
Rewrite: $r! = 10/(7 - r)$.
Since $r!$ is a positive integer, $r$ must be either $r = 2$ or $r = 5$.
Trying both, clearly $r = 2$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SolvePermk2).**
$r = 2$.
:::
`r if( includeFullAnswers) "-->"`





:::{.answer}
**Answer to Exercise\ \@ref(exr:BirthdayProblem).**

1. Proceed:  
\begin{align*}
  \Pr(\text{at least two same birthday}) 
  &= 1 - \Pr(\text{no two birthdays same}) \\
  &= 1 - \Pr(\text{every birthday different}) \\
  &= 1 - \left(\frac{365}{365}\right) \times \left(\frac{364}{365}\right) \times \left(\frac{363}{365}\right) \times \cdots \times \left(\frac{365 - n + 1}{365}\right)\\
  &= 1 - \left(\frac{1}{365}\right)^{n} \times (365\times 364 \times\cdots (365 - n + 1) )
\end{align*}

2. Graph the relationship for various values of $N$ (from $2$ to $60$), using the above form to compute the probability.
3. No answer (yet).
4. Birthdays are independent and randomly occur through the year (i.e., each day is equally likely).

```{r Birthdays, fig.width = 5, fig.height=3.5, fig.align="center", fig.cap="Question 1", out.width='50%'}
N <- 2:80
probs <- array( dim = length(N) )

for (i in 1:length(N)){
  
  probs[i] <- 1 - prod( (365 - (1:N[i]) + 1)/365 )

}
plot( probs  ~ N,
      type = "l",
      lwd = 2,
      ylab = "Prob. at least two share birthday",
      xlab = expression(Group~size~italic(N)),
      las = 1)
```
:::




:::{.answer}
**Answer to Exercise\ \@ref(exr:SixNumbersConsecutive).**

```{r}
set.seed(981686)
numberSimulations <- 5000
anyConsecutive <- 0

for (i in (1:numberSimulations)){
  # Find the six numbers
  theNumbers <- sample(1:45,
                       size = 6,
                       replace = FALSE)
  theNumbers <- sort(theNumbers)
  
  if (any( diff(theNumbers) == 1 )){
    anyConsecutive <- anyConsecutive + 1
  }
  
}
cat("Number with consecutive values", 
    anyConsecutive,"\n")
cat("Proportion with consecutive values", 
    round(anyConsecutive/numberSimulations, 3), "\n")
cat("Proportion WITHOUT consecutive values", 
    round(1 - anyConsecutive/numberSimulations, 3), "\n")
```
:::



:::{.answer}
**Answer to Exercise\ \@ref(exr:TwoEventsOverline).**
$\Pr( \overline{A} \cap \overline{B}) = 0.5$ (using, for exmaple, a two-way table).
$A$ and $B$ are not independent.
:::


:::{.answer}
**Answer to Exercise\ \@ref(exr:TwoEventsAbsorption).**
Use two-way table, or Venn diagrams.
:::



:::{.answer}
**Answer to Exercise\ \@ref(exr:NewCars).**
$7\times 3\times 2 = 42$.
:::




:::{.answer}
**Answer to Exercise\ \@ref(exr:NumberPlates).**
$10\times 10\times 10\times 26\times 26\times 10 = 6\ 760\ 000$.
:::



`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:PairsPoker).**
Order is not important, so combinations are relevant.

There are $\binom{52}{5} = 2\,598\,960$ ways to get five cards from $52$ (without replacement).

1. Pick the denomination: $13$\ to select from.
   We need two of those $4$\ cards: $13\times \binom{4}{2}$.
   Now the other three cards are drawn from the other $12$\ denominations: $\binom{12}{3}$.
   There are also $4$\ ways to choose the suit of *each* of those $3$\ cards.
   All up then: the number of ways is $13\times\binom{4}{2}\times\binom{12}{3}\times 4^3 = 1\,098\,240$.
   The probability is therefore $1\,098\,240/2\,598\,960 = 0.422569$.
   TAKE THE THREE OF A KIND AND FOUR OF A KIND!!
1. There are $4$ suits each with $4$ picture cards, so $16$ picture cards in total.
   We want to select five picture cards from $52$ cards, without replacement:
   $^{16}C_5 = 4\,368$ ways to do this.
   So the probability is $4\,368\ 160/^{52}C_5 = 0.0017$.
:::
`r if( includeBriefAnswers) "-->"`




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:NoTechP).**
$\binom{25}{8}/\binom{26}{6} = (25!\, 6!\, 19!)/(8!\,17!\,25!) = 171/28 \approx 6.107$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:NoTechP).**
$\approx 6.107$.
:::`r if( includeFullAnswers) "-->"`



  
:::{.answer}
**Answer to Exercise\ \@ref(exr:Cards).**

$P = \{ (s, d) | s \in \{\text{`r if (knitr::is_latex_output()) {
   '\\Largedice{2}'
} else {
   '<span class="larger-die">&#9857;</span>'
}`,
`r if (knitr::is_latex_output()) {
   '\\Largedice{4}'
} else {
   '<span class="larger-die">&#9859;</span>'
}`,
`r if (knitr::is_latex_output()) {
   '\\Largedice{6}'
} else {
   '<span class="larger-die">&#9861;</span>'
}`}\} \text{\ and\ } D \in \{ 2, 3, \dots, 10, \text{Jack}, \text{Queen}, \text{King}, \text{Ace}\} \}$.
:::



:::{.answer}
**Answer to Exercise\ \@ref(exr:ComplexNumbers).**
$\mathbb{R} \in \mathbb{C}$ but $\mathbb{C} \notin \mathbb{R}$ 
:::


:::{.answer}
**Answer to Exercise\ \@ref(exr:ProbHarder).**
No answer (yet).
:::




<!-- **************************************************************************** -->
## Answers for Chap. 2 {#AnswersChap2}


:::{.answer}
**Answer to Exercise\ \@ref(exr:SSpaceRV).**

1. $R_X = \{X \mid x \in (0, 1, 2) \}$; discrete.
2. $R_X = \{X \mid x \in (1, 2, 3\dots) \}$; discrete.
3. $R_X = \{X \mid x \in (0, \infty) \}$; continuous.
4. $R_X = \{X \mid x \in (0, \infty) \}$; continuous.
5. $R_X = \{X \mid x \in (0, 1, 2, \dots) \}$; discrete.
6. $R_X = \{X \mid x \in (0, 1, 2, \dots) \}$; discrete.
7. $R_X = \{X \mid x \in (0, \infty) \}$; continuous.
:::


:::{.answer}
**Answer to Exercise\ \@ref(exr:DFdiscrete).**

1. $\displaystyle F_X(x) = 
   \begin{cases}
      0   & \text{for $x < 10$};\\
      0.3 & \text{for $10 \le x < 15$};\\
      0.5 & \text{for $15 \le x < 20$};\\
      1   & \text{for $x \ge 20$}.
    \end{cases}$
1. $\Pr(X > 13) = 1 - F_X(13) = 0.7$.
1. $\Pr(X \le 10 \mid X\le 15) = \Pr(X \le 10) / \Pr(X \le 15) = F_X(10)/F_X(15) = 0.3/0.5 = 0.6$.
:::




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DFcontinuous).**

1. $\alpha = 2/15$.
1. $\displaystyle F_Z(z) = 
    \begin{cases}
        0                     &  \text{for $z \le -1$};\\
        6z/15 - z^2/15 + 7/15 & \text{for $-1 < z < 2$};\\
        1                     & \text{for $z \ge 2$}.
    \end{cases}$
1. $\Pr(Z < 0) = F_Z(0) = 7/15 \approx 0.4666$.
:::

```{r DFZcontinuous, fig.align="center", fig.cap="The DF for $f(z)$"}
F1 <- function(x){
  F <- array( dim = length(x))
  F[ x < -1] <- 0
  F[ x > 2] <- 1
  Interesting <- (x > -1) & (x < 2)
  F[ Interesting ] <- 6*z[Interesting]/15 - (z[Interesting]^2)/15 + 7/15
  F
}

z <- seq(-2, 3, 
         length = 200)
plot( F1(z) ~ z,
      las = 1,
      type = "l",
      xlab = expression(italic(x)),
      ylab = "Dist. fn.",
      lwd = 2)
```
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DFcontinuous).**

1. $2/15$.
1. $\displaystyle F_Z(z) = 
    \begin{cases}
        0                     &  \text{for $z \le -1$};\\
        6z/15 - z^2/15 + 7/15 & \text{for $-1 < z < 2$};\\
        1                     & \text{for $z \ge 2$}.
    \end{cases}$
1. $\approx 0.4666$.
:::
`r if( includeFullAnswers) "-->"`







`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DFdiscreteBackwards).**

1. $\displaystyle
   p_W(w) = \begin{cases}
               0.3 & \text{for $w = 10$};\\
               0.4 & \text{for $w = 20$};\\
               0.2 & \text{for $w = 30$};\\
               0.1 & \text{for $w = 40$};\\
               0   & \text{elsewhere}.
            \end{cases}$
1. $\Pr(W < 25) = 0.7$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DFdiscreteBackwards).**

1. $\displaystyle
   p_W(w) = \begin{cases}
               0.3 & \text{for $w = 10$};\\
               0.4 & \text{for $w = 20$};\\
               0.2 & \text{for $w = 30$};\\
               0.1 & \text{for $w = 40$};\\
               0   & \text{elsewhere}.
            \end{cases}$
1. $0.7$.
:::
`r if( includeFullAnswers) "-->"`







`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DFcontinuousBackwards).**

1. $\displaystyle
   f_Y(y) = \begin{cases}
               (4/3) - y^2 & \text{for $0 < y < 1$};\\
               0 & \text{elsewhere}.
            \end{cases}$
1. $\Pr(Y < 0.5) = 0.625$.
:::

```{r, fig.align="center", fig.cap="A pdf"}
fy <- function(y){
  pdfy <- array(0, dim = length(y))
  pdfy <- ifelse( (y > 0) & (y < 1),
                  (4/3) - y^2,
                  0)
  pdfy
}
y <- seq(-1, 2,
         length = 500)
plot(fy(y) ~ y,
     lwd = 2,
     type = "l",
     xlab = expression(italic(y)),
     ylab = "PDF",
     las = 1)
```
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DFcontinuousBackwards).**

1. $\displaystyle
   f_Y(y) = \begin{cases}
               (4/3) - y^2 & \text{for $0 < y < 1$};\\
               0 & \text{elsewhere}.
            \end{cases}$
1. $0.625$.
:::
`r if( includeFullAnswers) "-->"`



`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Chlorine).**

1. Easiest to draw, and see that this represents a *triangular distribution*, and find the area of the said triangle.
   Integration can be used though.
2. PDF:
\begin{align*}
   f_X(x)
   &=
   \begin{cases}
      \frac{2}{8.8\times 4.4} (x - 0.6) & \text{for $0.6 < x < 5$};\\
      \frac{2}{8.8\times 4.4} (9.4 - x) & \text{for $5 < x < 9.4$}
   \end{cases}\\
   &=
   \begin{cases}
      \frac{2}{38.72} (x - 0.6) & \text{for $0.6 < x < 5$};\\
      \frac{2}{38.72} (9.4 - x) & \text{for $5 < x < 9.4$}.
   \end{cases}
\end{align*}
3. Proceed:
\begin{align*}
   F_X(x)
   &=
   \begin{cases}
      0                                   & \text{for $x < 0.6$}\\
      \int_{0.6}^x \frac{2}{38.72} (t - 0.6) \, dt               & \text{for $0.6 \le x < 5$};\\
      \int_5^x     \frac{2}{38.72} (9.4 - t)\, dt + 0.5       & \text{for $5 \le x < 9.4$}.\\
      1                                   & \text{for $x \ge 9.4$}
   \end{cases}\\
   &=
   \begin{cases}
      0                                   & \text{for $x < 0.6$}\\
      [(0.6 - x)^2 ]/ 38.72               & \text{for $0.6 \le x < 5$};\\
      1 - [(x - 9.4)^2] / 38.72           & \text{for $5 \le x < 9.4$}.\\
      1                                   & \text{for $x \ge 9.4$}
   \end{cases}
\end{align*}
4. See below.
5. $\Pr(X > 3) = 1 - \Pr(X < 3) =  1 - 0.1487603 =  0.8512397$ (or use areas of  triangles)
6. $\Pr(X > 3 \mid X > 1) = \Pr(X > 3) / \Pr(X > 1) = 0.8512397 / 0.9958678 = 0.8547718$.
7. One is just if $X$ exceeds 3; the other if $X$ exceeds 3 if we already know $X$ has exceeded 1.
:::

```{r, Triangular, out.width='90%', fig.align="center", fig.cap="A pdf and cdf"}
f <- function(x){
  f <- array( dim = length(x))
  f[x < 0.6] <- 0
  f[x > 9.4] <- 0
  xSmall <- (x >= 0.6) & ( x <= 5)
  xLarge <- (x > 5) & (x <= 9.4)
  f[xSmall] <- 2 / (8.8 * 4.4) * (x[xSmall] - 0.6)
  f[xLarge] <- 2 / (8.8 * 4.4) * (9.4 - x[xLarge] )
  f
}

F <- function(x){
  FF <- array( dim = length(x))

  for (i in (1:length(x))){
    FF[i] <- integrate(f, lower = 0.6, upper = x[i])$value
  }
  FF
}


par(mfrow = c(1, 2))
x <- seq(0, 10,
         length = 200)
plot( f(x) ~ x,
      type = "l",
      lwd = 2,
      las = 1,
      main = "PROB fn",
      xlab = expression(italic(x)),
      ylab = "Prob. fn.")



x <- seq(0, 10,
         length = 200)
plot( F(x) ~ x,
      type = "l",
      lwd = 2,
      las = 1,
      main = "DIST fn",
      xlab = expression(italic(x)),
      ylab = "Dist fn.")
```


```{r}
1 - F(3)
(1 - F(3)) / (1 - F(1))
```
`r if( includeBriefAnswers) "-->"`



:::{.answer}
**Answer to Exercise\ \@ref(exr:TriangularHospital).**

Using the area of triangles, the 'height' is $2/27 \approx 0.07407407$ as shown below.
Then, after some algebra:
$$
  f_S(s) = 
   \begin{cases}
      \frac{4}{81}s - \frac{14}{81} & \text{for $3.5 < s < 5$};\\
      -\frac{4}{1377}s + \frac{122}{1377} & \text{for $5 < s < 30.5$}.
   \end{cases}
$$
Also,
$$
   F_S(s) = 
   \begin{cases}
      0                                    & \text{for $s < 3.5$};\\
      \frac{(7 - 2s)^2}{162}               & \text{for $3.5 < s < 5$};\\
      \frac{2}{1377} (s^2 - 61s + 280)     & \text{for $5 < s < 30.5$};\\
      1                                    & \text{for $s > 30.5$}.
   \end{cases}
$$
Then, 
$\Pr(S > 20 \mid S > 10) = \Pr( (S > 20) \cap (S > 10) )/\Pr(S > 10) = \Pr(S > 20)/\Pr(S > 10) = 0.1601311 / 0.6103854$.
This is about 0.2623.
:::


```{r, TriangularHospital, echo=FALSE, out.width='90%', fig.align="center", fig.cap="A pdf and cdf"}
par( mfrow = c(1, 2))

f <- function(x){
  f <- array( dim = length(x))
  f[x < 3.5] <- 0
  f[x > 30.5] <- 0
  xLO <- (x >= 3.5) & (x <= 5)
  xHI <- (x > 5) & (x <= 30.5)
  f[xLO] <- 4 * x[xLO] / 81 - (14 / 81)
  f[xHI] <- -4 * x[xHI]/1377 + 122/1377
  f
}

x <- seq(0, 35, 
         length = 500)

plot( f(x) ~ x,
      type = "l",
      lwd = 2,
      las = 1,
      main = "PROBABILITY function",
      xlab = expression(italic(s)),
      ylab = "Prob. fn.")
points(x = 5, 
       y = f(5), 
       pch = 19)
lines( x = c(0, 5),
       y = c(f(5), f(5)),
       lty = 2,
       lwd = 2)
axis(side = 2,
     at = f(5),
     labels = "2/27")




Fx <- function(x){
  F <- array( dim = length(x))
  
  for (i in (1:length(x))) {
    F[i] <- integrate(f, lower = 3.5, upper = x[i])$value
  }
  F
}

x <- seq(0, 35, 
         length = 500)

plot( Fx(x) ~ x,
      type = "l",
      lwd = 2,
      las = 1,
      ylim = c(0, 1),
      main = "DISTRIBUTION function",
      xlab = expression(italic(s)),
      ylab = "Dist. fn.")
```

```{r}
(1 - Fx(20) ) / ( 1 - Fx(10))
```






:::{.answer}
**Answer to Exercise\ \@ref(exr:Exceedance).**

1. Producers usually need that they will receive *at least* a certain amount of rainfall.
2. A *very poor* graph below; I really have to fix that.
3. Six months have recorded over 60mm; so 6/81. 
   But taking half of the previous '40 to under 60' category, we'd get 12/81.
   So somewhere around there.
4. In June, there are 81 observations, so the median is the 41st: The median rainfall is between 0 to under 20mm.  
   In December, there are 80 observations, so the median is the 40.5th: The median rainfall is between 40 to under 60mm.
5. Median; *very* skewed to the right.
6. ...
:::

```{r ExceedanceCharts, echo=FALSE, fig.align="center", fig.cap="Exceedance charts"}
Rain12 <- read.csv("Data/IDCJAC0001_044021/IDCJAC0001_044021_Data12.csv", 
                   na.strings = "null")
RainDec <- Rain12$Dec
RainJun <- Rain12$Jun

breaks <- c( 0, 0.01, 20,
             seq(40, 220, by = 20) )
outDec <- hist(RainDec,
               breaks = breaks,
               plot = FALSE)
outJun <- hist(RainJun, 
               breaks = breaks,
               plot = FALSE)

Buckets <- c("Zero", 
           "0 < R < 20",
           "20 <= R < 40",
           "40 <= R < 60",
           "60 <= R < 80",
           "80 <= R < 100",
           "100 <= R < 120",
           "120 <= R < 140",
           "140 <= R < 160",
           "160 <= R < 180",
           "180 <= R < 200",
           "200 <= R < 220")

cbind("Buckets" = Buckets,
      "Jun" = outJun$counts,
      "Dec" = outDec$counts)

exceedanceJun <-  ( sum(outJun$counts) - cumsum(outJun$counts) ) / sum(outJun$counts)
exceedanceDec <-  ( sum(outDec$counts) - cumsum(outDec$counts) ) / sum(outDec$counts)

plot( exceedanceJun ~ breaks[1:12], 
      type = "b",
      xlab = "Rainfall (in mm)",
      ylab = "Exceedance probability",
      main = "Charleville",
      ylim = c(0, 1.1),
      lwd = 2,
      lty = 1,
      pch = 19,
      las = 1)
lines( exceedanceDec ~ breaks[1:12], 
       type = "b",
      pch = 1,
      lty = 2,
      las = 1)
legend("topright",
       lwd = 2,
       pch = c(19, 1),
       lty = c(1, 2),
       legend = c("June",
                  "December"))
```






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:YouFriendInLine).**

Suppose I stand at Position 1; my friend can be at Positions 2 to 5, with distances 1, 2, 3 4.
Similar if I stand at Position 5.

Suppose I stand at Position 2; my friend can be at Positions 1, 3 to 5, with distances 1, 1, 2, 3.
Similar if I stand at Position 4.

Suppose I stand at Position 3; my friend can be at Positions 1, 2, 4, 5, with distances 1, 2, 2, 1.

So counting, the pdf for the number of people between us, say $Y$, is:
$$
   f_Y(y) =
   \begin{cases}
      4/10 & \text{for $y = 0$};\\
      3/10 & \text{for $y = 1$};\\
      2/10 & \text{for $y = 2$};\\
      1/10 & \text{for $y = 3$};\\
         0 & \text{elsewhere}.
   \end{cases}
$$
or $f_Y(y) = (4 - y)/10$ for $y\in\{0, 1, 2, 3\}$.
:::
`r if( includeBriefAnswers) "-->"`






:::{.answer}
**Answer for Exercise\ \@ref(exr:Continuous1).**

1. $a\int_0^1 (1 - y)^2\,dy = \left. (1 - y)^3/3\right|_0^1 = 1/3$.
1. $\Pr(|Y - 1/2| > 1/4) = \Pr(Y > 3/4) + \Pr(Y < 1/4) = 1 - \Pr(1/4 < Y < 3/4) = 13/32$.
1. See Fig. \@ref(fig:PDFy).

```{r PDFy, fig.cap="The pdf of $y$", fig.align="center"}
y <- seq(0, 1, length = 500)
fy <- ( (1 - y)^2 ) * 3

plot(fy ~ y,
     lwd = 2,
     xlab = "y",
     ylab = "PDF",
     type = "l")
```

:::




:::{.answer}
**Answer for Exercise\ \@ref(exr:ContTwoParts).**
df is:  
$$
  F_Y(y) = 
  \begin{cases}
    0                    & \text{for $y < 0$};\\
    \frac{1}{3}(y - 1)^2 & \text{for $1 < y < 2$};\\
    \frac{1}{3}(2y - 3)  & \text{for $2 < y < 3$};\\
    1                    & \text{for $y \ge 3$.}
  \end{cases}
$$
When $y = 3$, expect $F_Y(y) = 1$; this is true.
When $y = 1$, expect $F_Y(y) = 0$; this is true.
For all $y$, $0 \le F_Y(y) \le 1$.
:::





:::{.answer}
**Answer for Exercise\ \@ref(exr:Quartic).**
$\Pr(60 < Y < 70) = 154\,360\,000k/3\approx 51\,453\,333k$ and $\Pr(Y > 70) = 54\,360\,000k$.
Using this model, the larger probability is dying over 70.
:::



`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:PooledTest).**
1. See that $X = 1$ (i.e., one pooled test, and all are negative; no further testing needed) or $X = n + 1$ (the pooled test is positive, so $n$ individual tests are needed in addition to the pooled test).
   So the sample space is $\{1, n + 1\}$.
2. $X = 1$ only occurs if the test is negative; that is, $\Pr(X = 1) = (1 - p)^n$
So:
$$
  p_X(x) =
  \begin{cases}
     (1 - p)^n     & \text{for $x = 1$ (i.e., the pooled test is negative)};\\
     1 - (1 - p)^n & \text{for $x = n + 1$}
  \end{cases}
$$
and zero elsewhere.
:::
`r if( includeBriefAnswers) "-->"`




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:CardDistance).**
So we have cards like:
$$
  2, 3, 4, \dots, 8, 9, 10, 10 (J), 10 (Q), 10 (K), 10 (A).
$$
That is, there are\ $20$ cards with a points value of ten (four suits of five cards each).
For a 'distance' say $D$, of\ $8$, we need $\Pr[ (2, 10)\ \text{or}\ (10, 2)]$, with probability.
$$
  \Pr(D = 8) = 2\times \left(\frac{4 \times 20}{52 \times 51}\right).
$$
For a 'distance' of\ $7$, we need
$$
  \Pr[(3, 10)\ \text{or}\ (10, 3)] + 
  \Pr[(2,  9)\ \text{or}\ (9,  2)],
$$
with probability
$$
  \Pr(D = 7) 
  = 2\times\left(\frac{  \times 20}{52 \times 51}\right) + 
    2\times\left(\frac{4 \times 4}{52\times 51}\right).
$$
For a 'distance' of\ $6$, we need 
$$
   \Pr[(4, 10)\ \text{or}\ (10, 4)] + 
   \Pr[(3,  9)\ \text{or}\ (9,  3)] + 
   \Pr[(2,  8)\ \text{or}\ (8,  2)]
$$
with probability
$$
  \Pr(D = 6) 
  = 2\times\left(\frac{4 \times 20}{52 \times 51}\right) + 
    2\times\left(\frac{4 \times 4}{52\times 51}\right) +
    2\times\left(\frac{4 \times 4}{52\times 51}\right).
$$
So in general, for $D = 1, 2, \dots 8$:
$$
  \Pr(D = d) =
  2\times\left(\frac{4 \times 20}{52 \times 51}\right) + 
  (8 - d)\times 2\times\left(\frac{4 \times  4}{52 \times 51}\right)
$$

The case $D = 0$ is different.
We can compute the probability as\ $1$ minus the probablities from $D = 1$ to $D = 8$, or directly.
By subtraction :

```{r}
d <- 1:8
pd <- (2 * 4 * 20)/(52 * 51) + (8 - d) * (2 * 4 * 4)/(52 * 51)
rbind(d, pd)
1 - sum(pd)
```
To proceed directly, see that a 'distance' of zero can occur if we get a 'ten' and another 'ten', **or** a non-ten card plus the *same* non-ten card:
$$
  \Pr(D = 0) = \frac{20 \times 19}{52 \times 51} + \frac{32\times 3}{52\times 51}.
$$
The answer is the same:

```{r}
(20 * 19)/(52 * 51) + (32 * 3)/(52 * 51)
```

See the pmf in Fig.\ \@ref(fig:CardDistance).
:::


```{r CardDistance, fig.cap="The pdf for the 'distance' between cards", fig.align="center"}
pd0 <- c( 1 - sum(pd), pd)
d0 <- 0:8


plot(pd0 ~ d0,
     type = "p",
     las = 1,
     pch = 19,
     xlab = expression(italic(d)),
     ylab = "pmf")
```
`r if( includeBriefAnswers) "-->"`








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:BenfordsLaw).**

1. Write as $p(x) = \log_{10}(1 + x) - \log_{10}x$; then the sum is  
\begin{align*}
    (\log_{10}(2) - \log_{10} 1) 
    + (\log_{10} 3 - \log_{10} 2)
    + (\log_{10} 4 - \log_{10} 3) 
    + \dots\\
    + (\log_{10} 9 - \log_{10} 8)
    + (\log_{10} 10 - \log_{10} 9)
\end{align*}
and things cancel, leaving $\log_{10}10 = 1$.
1. The df is
\begin{align*}
   F_D(d) 
   &= \sum_{i = 1}^d \log[ (1 + d)/ \log(d) ] \\
   &= \sum_{i = 1}^d \log(1 + d) - \log d\\
   &= (\log 2 - \log 1) + (\log 3 - \log 2) + \log 4 - \log 3) + \cdots\\
   &  \quad {} + (\log d - \log(d - 1) ) + (\log (1 + d) - \log d)\\
   &= \log (1 + d).
\end{align*}
:::

```{r, BenfordPlots, fig.align="center", fig.cap="A pdf and cdf"}
fd <- function(x){
  log10( 1 + 1/d)
}

Fd <- function(x){
  log10(1 + d)
}

d <- 1:9

par(mfrow = c(1, 2))

plot( fd(d) ~ d,
      type = "p",
      pch = 19,
      las = 1,
      main = "Prob. fn",
      xlab = expression(italic(d)),
      ylab = "Prob. fn.")
points( fd(d) ~ d,
        type = "h",
        lty = 2,
        col = "grey",
        lwd = 2)

plot( Fd(d) ~ d,
      type = "p",
      pch = 19,
      las = 1,
      main = "Distribution fn",
      ylim = c(0, 1),
      xlab = expression(italic(d)),
      ylab = "Prob. fn.")
points( Fd(d) ~ d,
        type = "h",
        lty = 2,
        col = "grey",
        lwd = 2)
```
`r if( includeBriefAnswers) "-->"`

`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:BenfordsLaw).**
$F_D(d) = \log (1 + d)$.
:::
`r if( includeFullAnswers) "-->"`







`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:Arcsine).**

$k = 1/\pi$.
$F(y) = \int_0^x \frac{1}{\pi\sqrt{t(1 - t)}}\, dt = \frac{1}{\pi}\arcsin(2x - 1) + \frac{1}{2}$ for $0 < x < 1$.
$\Pr(X > 0.25) = 2/3$.
:::

```{r, ArcsinePlots, fig.align="center", fig.cap="A pdf and cdf"}
y <- seq(-0.5, 1.5,
         length = 100)
fy <- ifelse( (y > 0) & (y < 1),
              1/( pi * sqrt( y * (1 - y))),
              0)

Fy <- array( 0,
             dim = length(y))
Fy[ y < 0 ] <- 0
Fy[ y > 1 ] <- 1
Fy[ (y > 0) & (y < 1) ] <- 1/pi * asin(2*y[(y > 0) & (y < 1)] - 1) + 0.5

par(mfrow = c(1, 2))

plot( fy ~ y,
      type = "l",
      lwd = 2,
      xlab = expression(italic(x)),
      ylab = "Prob. fn",
      las = 1)
plot( Fy ~ y,
      type = "l",
      lwd = 2,
      ylim = c(0, 1),
      xlab = expression(italic(x)),
      ylab = "Dist. fn",
      las = 1)
```
`r if( includeBriefAnswers) "-->"`







:::{.answer}
**Answer for Exercise\ \@ref(exr:DFExpInverse).**

The pdf is
$$
   f_X(x) 
   = \frac{d}{dx} \exp(-1/x) 
   = \frac{\exp(-1/x)}{x^2}
$$
for $x > 0$.
See Fig. \@ref(fig:PlotDFExpInverse).
:::

```{r PlotDFExpInverse, echo=FALSE, fig.cap="A pdf", fig.align="center", out.width='80%'}
par( mfrow = c(1, 2))

f1 <- function(x){
  fy <- array(0, dim = length(x))
  fy <- ifelse(x > 0,
               exp(-1/x) / x^2,
               0)
  fy
}

x <- seq(-0.5, 5, length = 100)

plot( f1(x) ~ x,
      type = "l",
      lwd = 2,
      xlab = expression(italic(x)),
      ylab = expression(italic(f)(italic(x))),
      las = 1)



F1 <- function(x){
  fy <- array(0, dim = length(x))
  fy <- ifelse(x > 0,
               exp(-1/x),
               0)
  fy
}

x <- seq(-0.5, 8, length = 100)

plot( F1(x) ~ x,
      type = "l",
      lwd = 2,
      ylim = c(0, 1),
      xlab = expression(italic(x)),
      ylab = expression(italic(F)(italic(x))),
      las = 1)


```






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:Cards4).**

* 1 suit: Select 4 cards from the 13 of that suit, and there are four suits to select.
* 2 suits: There are two scenarios here: 
  - Three from one suit, and one from another: 
    Choose a suit, and select three cards from it: $\binom{4}{3}\binom{13}{3}$.
    Then we need another suit (three choices remain) and one card from (any of the 13).
  - Chose two suits, and two cards from each of two suits:
    $\binom{4}{2}\binom{13}{2}\binom{13}{2}$
* 3 suits: Umm...
* 4 suits: Choose one from each of the four suits.

One way to get 3 suits is to realise that the total probability must add to one...

```{r echo=TRUE}
### 1 SUIT
suits1 <- 4 * choose(13, 4) / choose(52, 4)

### 2 SUITS
suits2 <- choose(4, 3) * choose(13, 3) * choose(3, 1) * choose(13, 1) + 
          choose(4, 2) * choose(13, 2) * choose(13, 2)
suits2 <- suits2 / choose(52, 4)

### 4 SUITS:
suits4 <- choose(13, 1) * choose(13, 1) * choose(13, 1) * choose(13, 1)
suits4 <- suits4  / choose(52, 4)

suits3 <- 1 - suits1 - suits2 - suits4

round( c(suits1, suits2, suits3, suits4), 3)
```
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:Cards4).**

* 1 suit: Select 4 cards from the 13 of that suit, and there are four suits to select.
* 2 suits: There are two scenarios here: 
  - Three from one suit, and one from another: 
    Choose a suit, and select three cards from it: $\binom{4}{3}\binom{13}{3}$.
    Then we need another suit (three choices remain) and one card from (any of the 13).
  - Chose two suits, and two cards from each of two suits:
    $\binom{4}{2}\binom{13}{2}\binom{13}{2}$
* 3 suits: Umm...
* 4 suits: Choose one from each of the four suits.

One way to get 3 suits is to realise that the total probability must add to one...

```{r echo=TRUE}
### 1 SUIT
suits1 <- 4 * choose(13, 4) / choose(52, 4)

### 2 SUITS
suits2 <- choose(4, 3) * choose(13, 3) * choose(3, 1) * choose(13, 1) + 
          choose(4, 2) * choose(13, 2) * choose(13, 2)
suits2 <- suits2 / choose(52, 4)

### 4 SUITS:
suits4 <- choose(13, 1) * choose(13, 1) * choose(13, 1) * choose(13, 1)
suits4 <- suits4  / choose(52, 4)

suits3 <- 1 - suits1 - suits2 - suits4

round( c(suits1, suits2, suits3, suits4), 3)
```
:::
`r if( includeFullAnswers) "-->"`







:::{.answer}
**Answer for Exercise\ \@ref(exr:Mixed).**

1. $a = 1/3$.
3. We find:
$$
  F_Y(y) = 
  \begin{cases}
    0.  & \text{for $t < 0$};\\
    1/3 & \text{for $t = 0$};\\
    (1 - t + 3t^2 - t^3)/3 & \text{for $0 < t < 2$};\\
    1 & \text{for $t \ge 2$}.
  \end{cases}
$$
:::

  
:::{.answer}
**Answer for Exercise\ \@ref(exr:TotalFour).**
I have no idea...

From ChatGPT (i.e., haven't checked):

At least four:

```{r, eval=FALSE}
# Set the number of simulations
num_simulations <- 100000

# Initialize a vector to store the number of rolls required for each simulation
rolls_required <- numeric(num_simulations)

# Function to simulate rolling a die until the total is 4
simulate_rolls <- function() {
  total <- 0
  rolls <- 0
  while (total < 4) {
    roll <- sample(1:6, 1) # Roll the die
    total <- total + roll
    rolls <- rolls + 1
  }
  return(rolls)
}

# Perform simulations
for (i in 1:num_simulations) {
  rolls_required[i] <- simulate_rolls()
}

# Calculate the PMF
pmf <- table(rolls_required) / num_simulations

# Print the PMF
print(pmf)

# Optionally, plot the PMF
barplot(pmf, main="Probability Mass Function of Rolls Needed to Sum to 4",
        xlab="Number of Rolls", ylab="Probability",
        col="lightblue", border="blue")

```

Exactly four:

```{r eval=FALSE}
# Set the number of simulations
num_simulations <- 100000

# Initialize a vector to store the number of rolls required for each simulation
rolls_required <- integer(num_simulations)

# Function to simulate rolling a die until the total is exactly 4
simulate_rolls <- function() {
  total <- 0
  rolls <- 0
  while (total < 4) {
    roll <- sample(1:6, 1) # Roll the die
    total <- total + roll
    rolls <- rolls + 1
    if (total > 4) {
      return(NA) # Return NA if the total exceeds 4
    }
  }
  return(rolls)
}

# Perform simulations
for (i in 1:num_simulations) {
  result <- simulate_rolls()
  if (!is.na(result)) {
    rolls_required[i] <- result
  }
}

# Remove NA values from the results
rolls_required <- na.omit(rolls_required)

# Remove zero values (impossible cases)
rolls_required <- rolls_required[rolls_required > 0]

# Calculate the PMF
pmf <- table(rolls_required) / length(rolls_required)

# Print the PMF
print(pmf)

# Optionally, plot the PMF
barplot(pmf, main="Probability Mass Function of Rolls Needed to Sum to 4",
        xlab="Number of Rolls", ylab="Probability",
        col="lightblue", border="blue")

```

:::


  
  
  
  
  
  
<!-- ************************************************************************************** -->  
## Answers for Chap. 3 {#AnswersChap3}


`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:C3ContA).**

1. $k = -2$.
2. See Fig. \@ref(fig:PDFY).
3. $\text{E}(Y) = 5/3$.
4. $\text{E}(Y^2) = 17/6$, so $\text{var(Y)} = 17/6 - (5/3)^2 = 1/18$.
5. $\Pr(X > 1.5) = \int_{1.5}^2 f_Y(y)\, dy = 3/4$.

```{r, PDFY, echo=FALSE, fig.align="center", fig.cap="The pdf for Y", out.width='70%'}
xx <- seq(0, 3, 
          length = 500)
fy <- function(x){
  y <- 2*x - 2
  y <- ifelse(x < 1, 0, y)
  y <- ifelse( x > 2, 0, y)
  y
}

plot(x = xx,
     y = fy(xx),
     lwd = 2,
     type = "l",
     las = 1,
     main = expression("PDF for"~italic(Y)),
     xlab = expression(italic(Y)),
     ylab = "Prob. fn")
```
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:C3ContA).**

1. $k = -2$.
2. Not shown.
3. $\text{E}(Y) = 5/3$.
4. $\text{var(Y)} = 1/18$.
5. $\Pr(X > 1.5) = 3/4$.
:::
`r if( includeFullAnswers) "-->"`





`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:C3DiscreteA).**

First: $k = 1/4$.

1. $\text{E}(D) = 7/4 = 1.75$; $\text{E}(D^2) = 15/4$ so $\text{var}(D) = 11/16 = 0.6875$.
1. $M_D(t) = \exp(t)/2 + \exp(2t)/4 + \exp(3t)/4$.
1. $\Pr(D < 3) = 3/4$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:C3DiscreteA).**
1. $\text{E}(D) = 7/4$; $\text{var}(D) = 11/16$.
1. $M_D(t) = \exp(t)/2 + \exp(2t)/4 + \exp(3t)/4$.
1. $3/4$.
:::
`r if( includeFullAnswers) "-->"`







`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer for Exercise\ \@ref(exr:YouFriendInLine2).**

Using the pmf from Exercise\ \@ref(exr:YouFriendInLine):
$$
   \text{E}(X) =
   \left(0\times\frac{4}{10}\right) +
   \left(1\times\frac{3}{10}\right) +
   \left(2\times\frac{2}{10}\right) +
   \left(3\times\frac{1}{10}\right) = 1.
$$
In **R**:
```{r echo=TRUE}
set.seed(777023)

dist <- array(NA, dim = 1000)
for (i in (1:1000)){
  positions <- sample(1:5,
                      size = 2,
                      replace = FALSE)
  dist[i] = abs(diff(positions)) - 1
}
mean(dist)
```
:::
`r if( includeBriefAnswers) "-->"`






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:C3DiscreteB).**

1. $M_Z'(t) = 0.6\exp(t)[0.3\exp(t) + 0.7]$ so $\text{E}(Z) = 0.6$.
Also, $M''_Z(t) = 0.18\exp(2t) + 0.6\exp(t)[0.3\exp(t) + 0.7]$ so $\text{E}(Z^2) = 0.78$, so $\text{var}(Z) = 0.42$ (be careful with the derivatives here!)
2. Expand the quadratic and find: $\Pr(Z = 0) = 0.49$, $\Pr(Z = 1) = 0.42$, $\Pr(Z = 2) = 0.09$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:C3DiscreteB).**

1. $\text{E}(Z) = 0.6$.
   $\text{var}(Z) = 0.42$ (be careful with the derivatives here!)
2. $\Pr(Z = 0) = 0.49$, $\Pr(Z = 1) = 0.42$, $\Pr(Z = 2) = 0.09$.
:::
`r if( includeFullAnswers) "-->"`








:::{.answer}
**Answer to Exercise\ \@ref(exr:C3MGFA).**

1. $M'_G(t) = \alpha\beta(1 - \beta t)^{-\alpha - 1}$ so $\text{E}(G) = \alpha\beta$.
   $M''_G(t) = \alpha\beta^2(\alpha + 1)(1 - \beta t)^{-\alpha - 2}$ so $\text{E}(G^2) = \alpha\beta^2(\alpha + 1)$ and $\text{var}(G) = \alpha\beta^2$.
:::





`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:C3Moments).**

1. Proceed:
$$
  \mu'_r = \text{E}(X^r) = \int_{x = 0}^1 x^r 2(1 - x)\, dx = 2\left[ \left(\frac{x^{r + 1}}{r + 1} - \frac{x^{r + 2}}{r + 2}\right)\Big|_{0}^{1}\right] 
         = 2\left[ \frac{1}{r + 1} - \frac{1}{r + 2}\right].
$$
1. Expanding, $\text{E}((X + 3)^2) = \text{E}(X^2) + 6\text{E}(X) + 9$.
   Now, $\text{E}(X) = \mu'_1 = 1/3$ from above, and $\text{E}(X^2) = \mu'_2 = 1/6$ from above.
   Hence $\text{E}((X + 3)^2) = 67/6$.
1. $\text{var}(X) = \text{E}(X^2) - \text{E}(X)^2 = 1/18$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:C3Moments).**

1. $2\left[ \frac{1}{r + 1} - \frac{1}{r + 2}\right]$.
1. $\text{E}((X + 3)^2) = 67/6$.
1. $\text{var}(X) = 1/18$.
:::
`r if( includeFullAnswers) "-->"`






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:C3NoMean).**

1. $\text{E}(Y) = \int_2^\infty y\frac{2}{y^2}\,dy = 2\log y\Big|_2^\infty$, which does not converge.
1. If $\text{E}(Y)$ is not defined, then $\text{var}(Y)$ cannot be defined either.
1. See Fig. \@ref(fig:NoMeanPlots), left panel.
1. $F_Y(y) = \int_2^y 2/t^2\, dt = 1 - (2/y)$; see Fig. \@ref(fig:NoMeanPlots), right panel.
1. $F_Y(y) = 0.5$ gives the median as 4.
1. $F_Y(y) = 1/4$ gives $Q_1 = 8/3$; $F_Y(y) = 3/4$ gives $Q_3 = 8$; so IQR is $8 - 8/3 = 16/3$.
1. $\Pr(Y > 4\mid Y > 3) = \Pr(Y > 4)/\Pr(Y > 3)$.
   Then, $\Pr(Y > 4) = 1 - \Pr(Y < 4) = 1/2$ using the df;
   and   $\Pr(Y > 3) = 1 - \Pr(Y < 3) = 2/3$ using the df;
   so the answer is $3/4$. 
:::

```{r NoMeanPlots, echo=FALSE, fig.align="center", fig.cap="The probability and distribution functions for a distribution with no mean", out.width='80%', fig.width=7, fig.height=3}
y <- seq(0, 5, 
         length = 200)
ypdf <- function(x){
  ifelse(y > 2, 
         2/y^2,
         0)
}
ycdf <- function(x){
  ifelse(y > 2, 
         1 - 2/y,
         0)
}

par( mfrow = c(1, 2))

plot( ypdf(y) ~ y,
      las = 1,
      lwd = 2,
      type = "l",
      xlab = expression(italic(y)), 
      ylab = "Prob. fn.",
      main = "Probability function")

y <- seq(0, 10, 
         length = 200)

plot( ycdf(y) ~ y,
      las = 1,
      lwd = 2,
      ylim = c(0, 1),
      type = "l",
      xlab = expression(italic(y)) ,
      ylab = "Dist. fn.",
      main = "Distribution  function")

```
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:C3NoMean).**

1. $\int_2^\infty y\frac{2}{y^2}\,dy = 2\log y\Big|_2^\infty$ does not converge.
1. If $\text{E}(Y)$ is not defined, then $\text{var}(Y)$ cannot be defined either.
1. Not shown.
1. $F_Y(y) = 1 - (2/y)$.
1. Median is 4.
1. IQR is $8 - 8/3 = 16/3$.
1. $3/4$. 
:::
`r if( includeFullAnswers) "-->"`











:::{.answer}
**Answer to Exercise\ \@ref(exr:C3Cauchy).**

1. See Fig. \@ref(fig:Cauchy) (left panel).
1. Evaluate $F_X(t) = \displaystyle \int_{-\infty}^t \frac{1}{\pi(1 + x^2)}\,dx = \frac{1}{\pi}\arctan(x) + \frac{1}{2}$.
   See Fig. \@ref(fig:Cauchy) (right panel).
1. $\displaystyle \text{E}(X) =  \int_{-\infty}^t \frac{x}{\pi(1 + x^2)}\,dx = ...$, which is not defined.
:::

```{r Cauchy, echo=FALSE, fig.align="center", fig.cap="The Cauchy distribution", fig.height=4, fig.width=7,out.width='70%'}
par( mfrow = c(1, 2))
x <- seq(-5, 5,
         length = 100)
y <- 1 / (pi * (1 + x^2))
plot(y ~ x,
     lwd = 2,
     las = 1,
     type = "l",
     main = "Density function for\nthe Cauchy distribution",
     xlab = expression(italic(X)),
     ylab = "Density function")

Y <- atan(x)/pi + 0.5
plot(Y ~ x,
     lwd = 2,
     las = 1,
     ylim = c(0, 1),
     type = "l",
     main = "Distribution function for\nthe Cauchy distribution",
     xlab = expression(italic(X)),
     ylab = "Distribution function")
```







:::{.answer}
**Answer to Exercise\ \@ref(exr:SkewDiscreteCentralMomentsZero).**

Begin with Definition \@ref(def:MGF) for $M_X(t)$ and use fact that if a distribution is symmetric about 0 then $f_X(x) = f_X(-x)$ using symmetry. 
Transform the resulting integral.
:::







:::{.answer}
**Answer to Exercise\ \@ref(exr:TriangularHospitalExp).**

First, the pdf needs to be defined (see Fig. \@ref(fig:WaitingTimes)), and define $W$ as the waiting time.
Let $H$ be the 'height' of the triangle.
The area of triangle $A_1$ is $3H/4$, and the area of triangle $A_2$ is $51H/4$, so the value of $H$ is $2/27$.

The two lines, $L_1$ and $L_2$ can be found (find the slope; determine the linear equation) so that:
$$
   f_W(w) =
   \begin{cases}
      4w/81 - 14/81       & \text{for $3.5 < w < 5$};\\
      -4w/1377 + 122/1377 & \text{for $5 \le w < 30.5$}.
   \end{cases}
$$

1. $\text{E}(W)$ can be computed as usual across the two parts of the pdf: $\text{E}(W) = \frac{1}{4} + \frac{51}{4} = 13$ minutes.
1. $\text{E}(W^2)$ can be computed in two parts also: $\text{E}(W^2) = \frac{163}{144} + \frac{29\,699}{144} = 16598/8$.
   Hence $\text{var}(Y) = (1659/8) - 13^2 = 307/8\approx 38.375$, so the *standard deviation* is $\sqrt{38.375} = 6.19$  minutes.
:::


```{r WaitingTimes, echo=FALSE, fig.width=9, out.width='100%',fig.align="center", fig.cap="Waiting times"}
flo <- function(x){
  (4/81) * x - (14/81)
}
fhi <- function(x){
  (-4/1377) * x + (122/1377)
}

ff <- function(x){
  y <- array( 0, 
              dim = length(x))
  
  lo <- (x <= 3.5)
  hi <- (x >= 30.5)
  midlo <- (x > 3.5) & (x < 5)
  midhi <- (x >= 5)  & (x < 30.5)
  
  y[midlo] <- flo( x[midlo] )
  y[midhi] <- fhi( x[midhi] )
  y
}

y <- seq(0, 35,
         length = 500)

plot(ff(y) ~ y, 
     type="l",
     las = 1,
     lwd = 2,
     xlab = expression(italic(W)),
     ylab = "Prob. fn.",
     ylim = c(0, 0.095) )


polygon( x = c(3.5, 5, 5, 3.5),
         y = c(0, 2/27, 0, 0),
         col = grey(0.7))
polygon( x = c(5, 5, 30.5, 5),
         y = c(0, 2/27, 0, 0),
         col = grey(0.8))

ylo <- seq(0, 7, 
           length = 100)
lines(flo(ylo) ~ ylo,
      lty = 2,
      col = "grey",
      lwd = 2)

yhi <- seq(3, 30.5, 
           length = 100)
lines(fhi(yhi) ~ yhi,
      lty = 2,
      col = "grey",
      lwd = 2)

lines(ff(y) ~ y, 
     lwd = 2)


abline(v = c(3.5, 5, 30.5),
        lty = 2, 
        col = "grey")
abline(h = 2/27,
       lty = 2,
       col = "grey")
points(x = 5,
       y = 2/27,
       pch = 19)

text( 4.25, 0.007,
      labels = expression(italic(A)[1]))
text( 15, 0.02,
      labels = expression(italic(A)[2]))

text(15, fhi(15),
     pos = 3,
     labels = expression(italic(L)[2]))
text(5.5, fhi(5.5),
     pos = 3,
     labels = expression(italic(L)[1]))
```






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:CharFunction).**
1. Show by substituting.
2. Proceed:
$$
  \varphi(t)
  = \text{E}[\exp(itX)]\\
  = \int_{\mathbb{R}} \exp(itx) f(x)\, dx.
$$
Differentiating wrt $t$:
$$
   \varphi(t)' = \int_{\mathbb{R}} ix \exp(itx) f(x)\, dx.
$$
Setting $t = 0$:
$$
   \varphi(0)' = \int_{\mathbb{R}} xi f(x)\, dx,
$$
and so $-i\varphi(0) = \text{E}[X]$ as to be shown.
:::
`r if( includeBriefAnswers) "-->"`




:::{.answer}
**Answer to Exercise\ \@ref(exr:GeometricGeneratingFn).**

1. $(1 - a)^{-1} = 1 + a + a^2 + a^3 + \dots = \sum_{n=0}^\infty a^n$ for $|a| < 1$.
2. $(1 - tX)^{-1} = 1 + tX + t^2X^2 + t^3X^3 + \dots = \sum_{n=0}^\infty t^n X^n$ for $|tX| < 1$.
   Thus:
\begin{align*}
  \text{E}\left[ (1 - tX)^{-1}\right] 
  &= \text{E}[1] + \text{E}[tX] + \text{E}[t^2X^2] + \text{E}[t^3X^3] + \dots\\
  &= \sum_{n=0}^\infty \text{E}\left[ t^n X^n\right] \quad \text{for $|tX| < 1$}.
\end{align*}
3. Using the definition of an expected value:
\begin{align*}
  R_Y(t) 
  &= \text{E}\left[ (1 - tY)^{-1} \right]\\
  &= \int_0^1 \frac{1}{1 - ty}\, dy 
   = -\frac{\log(1 - t)}{t}.
\end{align*}
4. Using the series expansion of $\log(1 - t)$:
$$
  \log(1 - t) = -t - \frac{t^2}{2} - \frac{t^3}{3} + \dots
$$
and so 
$$
  -\frac{\log(1 - t)}{t} 
  = 1 + \frac{t}{2} + \frac{t^2}{3} + \dots.
$$
5. Equating this expression with that found in Part\ 2:
\begin{align*}
  1 + \frac{t}{2} + \frac{t^2}{3} + \dots.
  &=
  1 + \text{E}[tY] + \text{E}[t^2 Y^2] + \text{E}[t^3 Y^3] + \dots\\
  &=
  1 + t \text{E}[Y] + t^2\text{E}[Y^2] + t^3\text{E}[Y^3] + \dots 
\end{align*}
and so
\begin{align*}
  t   \text{E}[Y]   &= t/2         \Rightarrow \text{E}[Y] = 1/2;\\
  t^2 \text{E}[Y^2] &= t^2/3       \Rightarrow \text{E}[Y^2] = 1/3;\\
  t^n \text{E}[Y^n] &= t^n/(n + 1) \Rightarrow \text{E}[Y^n] = 1/(n + 1).\\
\end{align*}
:::




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:FindkGiveVar).**
First see that the area under the curve must be one, so
$$
   1 = \int_{-c}^c k(3x^2 + 4)\, dx = k(2c^3 + 8c).
$$
Then, note that $\text{E}(W) = 0$ (as the pdf is symmetric about 0), so that $\text{var}(X) = \text{E}(X^2)$, and:
$$
  \text{E}(X^2) = \int_{-c}^c k x^2 (3x^2 + 4)\, dx
  = k c^3\frac{18c^2 + 40}{15} = \frac{28}{15},
$$
and hence, equating the top lines of both fractions:
$$
  k c^3(9c^2 + 20) = 14.
$$
So we have two equations in two unknowns.
Equating we obtain, after some algebra,
$$
  9 c^4 - 8c^2 - 112 = 0.
$$
This is just a quadratic equation in $c^2$; so write
$$
  9 X^2 - 8X - 112 = (9X + 28)(X - 4) = 0
$$
with the two solutions $X = c^2 = -28/9$ (which has no real solutions for $c$), and $X = c^2 = 4$, so that $c = 2$ (as the pdf must be positive), giving $k = 1/32$.
:::
`r if( includeBriefAnswers) "-->"`






:::{.answer}
**Answer to Exercise\ \@ref(exr:BenfordsLawMean).**
$\text{E}[D] = \sum_{d=1}^9 \log_{10}\left(\frac{d + 1}{d}\right) \times d$.
By expanding, and collecting like terms, and simplifying (e.g., $\log_{10} 1 = 0$ and $\log_{10}10 = 1$), find
$$
  \text{E}[D] = -\log_{10}2 - \log_{10}3 - \cdots - \log_{10}8 - \log_{10}9 + 9
  \approx 3.440.
$$
:::



:::{.answer}
**Answer to Exercise\ \@ref(exr:vonMises).**

1. No answer (yet).
2. No answer (yet).

```{r fig.cap="von Mises distribution", fig.align="center"}
vonMises <- function(y, mu, lambda){
  exp( lambda * cos( y - mu))
}
k <- integrate(vonMises, 
               lower = 0,
               upper = pi,
               lambda = 1,
               mu = pi/2)

y <- seq(0, 2 * pi, 
         length = 100)
mu <- pi/2
lambda <- 1
fy <- exp( lambda * cos( y - mu) ) / k$value

plot(fy ~ y,
     type = "l",
     ylim = c(0, 0.5),
     lwd = 2,
     xlab = expression(italic(y)),
     ylab = "Prob. fn",
     main = "von Mises distribution", 
     axes = FALSE)
axis(side = 2, 
     las = 1)
axis(side = 1,
     at = c(0, 0.5, 1, 1.5, 2)* pi,
     label = c("0",
               expression(pi/2),
               expression(pi),
               expression(3*pi/2),
               expression(2*pi)))
box()
grid()
```
:::




:::{.answer}
**Answer to Exercise\ \@ref(exr:inverseGaussian).**

2. No answer (yet).

```{r fig.cap="inverse Gaussian distributions", fig.align="center"}
y <- seq(0, 4,
         length = 200)
phiVec <- c(0.5, 1, 2)

dIG <- function(x, mu, phi){
  front <- 1 / sqrt(2 * pi * y^3 * phi)
  power <- -(y - mu)^2 / (2 * phi * y * mu^2)
  
  front * exp( power)
}

plot( dIG(y, mu = 1, phi = phiVec[1]) ~ y,
      type = "l",
      xlab = expression(italic(y)),
      ylab = "Prob. fn",
      main = "inverse Gaussian distribution",
      lwd = 2,
      lty = 1,
      ylim = c(0, 1.5),
      las = 1)
lines( dIG(y, mu = 1, phi = phiVec[2]) ~ y,
       lty = 2,
       lwd = 2)
lines( dIG(y, mu = 1, phi = phiVec[3]) ~ y,
       lty = 3,
       lwd = 2)
legend("topright",
       lwd = 2,
       lty = 1:3,
       legend = c(expression(phi==0.5),
                  expression(phi==1),
                  expression(phi==2)))
```
:::



:::{.answer}
**Answer to Exercise\ \@ref(exr:W3inverse).**

1. $\int_c^\infty c/w^3\, dy = 1/(2c)$ and so $c = 1/2$.
2. $\text{E}[W] = \int_{1/2}^\infty w/(2w^3) \, dy = 1$.
3. $\text{E}[W^2] = \int_{1/2}^\infty w^2/w^3\, dy$ which does not converge; the variance is undefined.
:::




:::{.answer}
**Answer to Exercise\ \@ref(exr:Pareto).**

1. $k > 0$
2. Differentiating: $f_X(x) = \alpha k^\alpha x^{-\alpha - 1}$.
3. $\text{E}[X] = \alpha k/(\alpha - 1)$.
   Also, $\text{E}[X^2] = \alpha k^2/(\alpha - 2)$, and so $\text{var}[X] = \alpha k^2/[(\alpha - 2)(\alpha - 1)^2]$.
4. No answer (yet).
5. See below.
6. $\Pr(X > 4 \cap X < 5) = \Pr(4 < X < 5) = F(5) - F(4) = (3/4)^3 - (3/5)^3 = 0.205875$.
   Also, $\Pr(X < 5) = 1 - (3/5)^3 = 0.784$.
   So the prob. is $0.205875/0.784 = 0.2625957$.
7. No answer (yet).


```{r fig.align="center", fig.cap="A Pareto distribution"}
dPareto <- function(x, k, alpha){
  pfn <- array( 0, length(x) )
  
  xx <- x[x > k]
  
  pfn[x > k] <- alpha * k^alpha * xx^(-alpha - 1)
  
  pfn
}

y <- seq(0, 7, 
         length = 100)
fy <- dPareto(y,
              alpha = 3,
              k = 3)
plot(fy ~ y,
     type = "l",
     las = 1,
     xlab = expression(italic(x)),
     ylab = "Prob. fn",
     main = "Pareto distribution",
     lwd = 2)
```
:::




:::{.answer}
**Answer to Exercise\ \@ref(exr:SolitonDist).**

1. $\text{E}(X) = \sum_{x = 1}^K x. p_X(x) = (1/6) + \sum_{x = 2}^K 1(x - 1)$.
   $\text{E}(X^2) = \frac{1}{K} + \sum_{x=2}^K \frac{x}{x - 1}$ with no closed form, so the variance is a PITA.
   No closed form!
1. See Fig. \@ref(fig:Soliton).
1. Applying the definition:  
\[  
  M_X(t) = \text{E}(\exp(tX)) = \frac{1}{K} 
     + \left( 
     \frac{\exp(2t)}{2\times 1} +
     \frac{\exp(3t)}{3\times 2} +
     \frac{\exp(4t)}{4\times 3} + \dots +
     \frac{\exp(Kt)}{K\times (K - 1)}\right).
\]

```{r Soliton, echo=FALSE, fig.align="center", fig.cap="The Soliton distribution", fig.width=5, fig.height=3}
pSoliton <- function(K){
  y <- array( dim = K)
  Kseq <- 2:K

  y[1] <- 1/K
  y[2:K] <- 1/(Kseq * (Kseq - 1) )
  y
}


par(mfrow = c(1, 2))

K <- 6
px <- pSoliton(K)

plot(px ~ I(1:K), 
     type = "p",
     pch = 19,
     las = 1,
     xlab = expression(italic(x)),
     ylab = "Prob. fn.")
lines(px ~ I(1:K), 
     type = "h",
     lty = 2,
     col = "grey",
     lwd = 2)

K <- 10
px <- pSoliton(K)

plot(px ~ I(1:K), 
     type = "p",
     pch = 19,
     las = 1,
     xlab = expression(italic(x)),
     ylab = "Prob. fn.")
lines(px ~ I(1:K), 
     type = "h",
     lty = 2,
     col = "grey",
     lwd = 2)
```
:::








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:InvertMGFcontinuous).**

1. Since $M_X(t) = \lambda/(\lambda - t)$, then $M_X(it) = \lambda/(\lambda - it)$.
   Then

\begin{align*}
  f_X(x)
  &= \int_{-\infty}^{\infty} M_X(it) ] \exp(-itx)\, dt \\
  &= \int_{-\infty}^{\infty} \frac{\lambda}{\lambda - it} (\cos(-tx) + \sin(-tx))\, dt\\
  &= \int_{-\infty}^{\infty} \frac{\lambda(\lambda + it)}{\lambda^2 + t^2} (\cos(tx) - \sin(tx))\, dt \\
  &= \int_{-\infty}^\lambda \frac{\lambda}{\lambda^2 + t^2} (\lambda\cos(tx) + t\sin(tx))\, dt.
\end{align*}


```{r Integrand, echo=FALSE, fig.cap="The integrand", fig.align="center"}
t <- seq(-50, 2, # Recall: t only from -infty to lambda (= 2)
         length = 1000)
integrand <- function(t, lambda=2, x=1){
  lambda / (lambda^2 + t^2) *
    (lambda * cos(t * x) + t*sin(t*x))
}

plot(integrand(t) ~ t,
     type = "l",
     xlab = expression(italic(t)),
     ylab = "Integrand",
     lwd = 2,
     las = 1)
abline(h = 0,
       col = "grey")
```
:::
`r if( includeBriefAnswers) "-->"`









`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:PooledTest2).**

1. $\text{E}[X] = (n + 1) - n (1 - p)^n$.
2. $\text{E}[X^2] = (1 - p)^n + 25 - 25(1 - p)^n$, so $\text{var}[X] = 16(1 - p)^n[ 1 - (1 - p)^n]$.
3. As $p \to 0$ (i.e., no-one has the disease), the expected number of tests is one (with no variation).
   As $p \to 1$ (i.e., everyone has the disease), the expected number of tests is five (with no variation).
4. Using $\text{E}[X] > n$, solve to find $p > 1 - (1/n)^{1/n}$.
5. See Fig. \@ref(fig:TestsSaved).
6. With $n = 4$, the expected number of tests saved is $4 - (5 - 4(1-p)^4) \approx 1.6244$.
   So doing this 50 times (i.e., $50 \times 4 = 200$) would save $50\times 1.6244 \times 15 = 1218.3$; about $1220 in cost savings.


```{r TestsSaved, fig.align="center", fig.cap="The expected number of tests saved by pooling"}
n <- 2:10 # n = 1 is silly
p <- 0.1
expectedNumberTests <- 5 - 4*(1 - p)^n
numTestsSaved <- n - expectedNumberTests
plot(numTestsSaved ~ n,
     pch = 19,
     las = 1,
     xlab = "Number of people",
     ylab = "Expected number of tests saved",
     main = expression(Using~italic(p==0.1)) )
grid(nx = NA,
     ny = NULL)
```

$\Pr(\text{Need individual tests})$
${}={}$
$\Pr(\text{Pooled test is positive})$
${}={}$
$1 - \Pr(\text{Pooled test is negative})$
${}={}$
$1 - \Pr(\text{All individuals are negative})$
${}={}$
$1 -(0.9)^ 4 = 0.3439$.
So the pmf of $N$, the number if tests needed, is
$$
  p_N(n) =
  \begin{cases}
     0.6561 & \text{for $n = 1$ (i.e., pooled test only)};\\
     0.3439 & \text{for $n = 5$ (i.e., one pooled test, olus four individual tests)}
  \end{cases}
$$
Then $\text{E}(X) = (0.6561 \times 1) + (0.3439 \times 5) = 2.3756$ and
$\text{E}(X^2) = (0.6561 \times 1^2) + (0.3439 \times 5^2) =  9.2536$ so that $\text{var}(X) = 3.610125$.
So for a pool of four people, rather than four tests we would expected to have to conduct 2.3756 tests, a saving of $4 - 2.3756 = 1.6244$ tests.

If 200 people in total, testing each individual would cost $200\times 15 = \$3000$.
With $n = 4$, a total of 50 pools are created, and each pool saves 1.6244 tests, so the total numbert of tests expected to be saved in $50 \times 1.6244 = 81.22$; at \$15 each, the saving is $\$1218.30$.
:::

```{r PoolTestFig, echo=TRUE, fig.show='hide'}
n <- 2:14

probIndTestsNeeded <- 1 - 0.9^n
probOneTestNeeded <- 0.9^n
expectedTests <- (probOneTestNeeded * 1) + (probIndTestsNeeded * (n + 1) )
TestsSaved <- n - expectedTests

par(mfrow = c(1, 2))

plot( expectedTests ~ n,
      las = 1,
      ylim = c(0, 12),
      type = "b",
      main = "Expected number of tests\nfor pooling first",
      xlab = "Number in pooled test",
      ylab = "Expected number of tests")
plot( TestsSaved ~ n,
      las = 1,
      ylim = c(0, 2.5),
      type = "b",
      main = "The number of tests saved\nby pooling first",
      xlab = "Number in pooled test",
      ylab = "Expected number of tests saved/pool")

```
```{r PoolTestFig2, echo=FALSE, fig.cap="The advantage of initial pooled testing", out.width='90%', fig.width=7}
<<<PoolTestFig>>>
```
`r if( includeBriefAnswers) "-->"`


`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:RunningTotal).**
Consider the case of taking *one* roll, $\Pr(R = 1)$: $\Pr(\text{roll $3$, $4$, $5$, or $6$}) = 4/6$.

Consider the case of taking *two* rolls: 
\begin{align*}
   \Pr(R = 2) 
   &= \Pr(\text{roll $1$ on first roll, then $2$ to $6$ on second roll}) \text{\ or\ } \Pr(\text{roll $2$ on first roll})\\
   &= \left(\frac{1}{6}\times\frac{5}{6}\right) + \frac{1}{6}\\
   &= 11/36.
\end{align*}
   
Consider the case of taking *three* rolls: the only scenario is rolling a\ $1$, then a\ $1$; then, anything else takes the running total past\ $3$.

So:
\[
  p_R(r) = 
  \begin{cases}
    24/36 & \text{if $r = 1$};\\
    11/36 & \text{if $r = 2$};\\
    \phantom{0}1/36  & \text{if $r = 3$}.
  \end{cases}
\]
The mean is $\text{E}[R] = (1\times 24/36) + (2\times 11/36) + (3\times 1/36) = 49/35$, or about $1.36$.
:::
`r if( includeBriefAnswers) "-->"`






<!-- ********************************************************************************************* -->
## Answers for Chap. 4 {#AnswersChap4}


`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:BinChange).**
From what is given: $p_X(x; n, 1 - p) = \binom{n}{x} (1 - p)^x p^{n - x}$.
Then, define $Y = n - X$ and hence 
$f_Y(y) = \binom{n}{y} p^y (1 - p)^{n - y}$, which is $f_Y(y) = \binom{n}{n - x} p^{n - x} (1 - p)^{n}$.
It is easy to show $\binom{n}{x} = \binom{n}{n - x}$ and hence $f_X(x)$ and $f_Y(y)$ are equivalent.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:BinChange).**
Show  $\binom{n}{x} = \binom{n}{n - x}$ and hence $f_X(x)$ and $f_Y(y)$ are equivalent.
:::
`r if( includeFullAnswers) "-->"`








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SaltIntake).**

Care: The geometric is parameterised so that $x$ is the number of *failures* before a success (not the number of *trails*).
Similarly for the negative binomial.


```{r echo=TRUE}
sum( dbinom(10:25, # Part 1
            size = 25,
            prob = 0.30) )
sum( dbinom(0:9,  # Part 2
            size = 25,
            prob = 0.30) )
sum( dbinom(5:10,  # Part 3
            size = 25,
            prob = 0.30) )
dgeom(x  = 5,  # Part 4: 5 fails before 1st success
      prob = 0.30)

sum( dgeom(x  = 7:50,  # Part 5: Num. fails! 
           prob = 0.30) )

# Part 6; This means 5 fails, before 3rd success
dnbinom(x = 5,
        prob = 0.30,
        size = 3)
```

Assumes independence of people, and a *constant* probability.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SaltIntake).**

Care: The geometric is parameterised so that $x$ is the number of *failures* before a success (not the number of *trails*).
Similarly for the negative binomial.



```{r echo=TRUE}
sum( dbinom(10:25, # Part 1
            size = 25,
            prob = 0.30) )
sum( dbinom(0:9,  # Part 2
            size = 25,
            prob = 0.30) )
sum( dbinom(5:10,  # Part 3
            size = 25,
            prob = 0.30) )
dgeom(x  = 5,  # Part 4: 5 fails before 1st success
      prob = 0.30)

sum( dgeom(x  = 7:50,  # Part 5: Num. fails! 
           prob = 0.30) )

# Part 6; This means 5 fails, before 3rd success
dnbinom(x = 5,
        prob = 0.30,
        size = 3)
```
:::
`r if( includeFullAnswers) "<!--"`










`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Placebos).**

Care: The geometric is parameterised so that $x$ is the number of *failures* before a success (not the number of *trails*).
Similarly for the negative binomial.

```{r echo=TRUE}
sum( dbinom( 16:81,  # Part 1
             size = 81,
             prob = 0.20) ) # 0.5663638
sum( dbinom( 12:81,  # Part 2
             size = 81,
             prob = 0.20) ) # 0.9082294
  # Part 3
dgeom(x = 2, #i.e., two failures before first success
      prob = 0.20) # 0.128

  # Part 4
dnbinom(x = 5, # is 5 fails before 5th success
        prob = 0.20,
        size = 5) # 0.01321206
sum( dbinom(50:81,
            size = 81,
            prob = 0.2) )
```
:::
`r if( includeBriefAnswers) "-->"`









`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:NoisyMiners).**

```{r echo=TRUE}
dpois( 0,  # Part 1
       lambda = 3)
sum( dpois( 6:50,  # Part 2
            lambda = 3) )
dpois( 2,   # Part 3
       lambda = 6)
```
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:NoisyMiners).**

1. $0.0498$.
2. $0.0839$.
3. $0.446$.
:::
`r if( includeFullAnswers) "-->"`









`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DisaggregationPoisson).**

See Fig. \@ref(fig:RainEventsPlotA).

```{r RainEventsPlot, fig.show="hide"}
x <- 0:10
pSummer <- dpois(x,
                 lambda = 2.5)
pWinter <- dpois(x,
                 lambda = 1.9)

plot( pWinter ~ x,
      las = 1,
      pch = 19,
      ylab = "Probability",
      xlab = "Number of rainfall events")
points( pSummer ~ x,
        pch = 0)
lines( ifelse(pWinter > pSummer, pWinter, pSummer) ~ x,
       type = "h", # Add vertical lines
       lty = 2,
       col = "grey")
 
legend("topright",
       pch = c(19, 0),
       legend = c("Winter", "Summer"))

sum( dpois(4:20,  # Part 2
     lambda = 1.9) )
sum( dpois(4:20,  # Part 3
     lambda = 2.5) )

# Part 4
sum( dpois(4:20, lambda = 2.5) ) /
   sum( dpois(2:20, lambda = 2.5) )

# Part 5
sum( dpois(3:10, lambda = 1.9) ) /
   sum( dpois(2:10, lambda = 1.9) )
```
:::

```{r, RainEventsPlotA, fig.width=5, echo=FALSE, results='hide', fig.cap="The number of rainfall events in summer and winter", fig.align="center"}
<<RainEventsPlot>>
```
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DisaggregationPoisson).**

4. $0.3401$.
5. $0.5232$.
:::
`r if( includeFullAnswers) "-->"`















`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:UnknownSize).**

1. Yep.
1. $\log n_x = \log N + \log p + x\log (1 - p)$, which is a linear regression model of $\log n_x$ regressed on $x$, with intercept $\beta_0 = \log N + \log p$ and slope $\beta_1 = \log (1 - p)$.
1. So from the fitted slope, we can estimate $p$; then, using the estimated intercept, we can estimate $N$.
More specifically, the estimate of $p$ is $1 - \exp( \hat{\beta}_1)$, and the estimate of $N$ is then $\exp(\beta_0 - \log p)$.
The population size is estimate as about 894:
$p = 0.6765636$.
$N = 894.2445$.
:::

```{r echo=TRUE}
x <- 1:6
nx <- c(247, 63, 20, 4, 2, 1)

m1 <- lm( log(nx) ~ x); coef(m1)
beta0 <- coef(m1)[1]
beta1 <- coef(m1)[2]

p <- 1 - exp(beta1); p
N <- exp(beta0 - log(p) ); N
```

`r if( includeBriefAnswers) "<!--"`










:::{.answer}
**Answer to Exercise\ \@ref(exr:NigerianWater)**
Defining $X$ as the 'number of failures until 4kWh/m^2^ was observed', since the parameterisation used in the textbook is for *the number of failures until the first success*.

Then, $X\sim \text{Geom}(p)$.

1. $\text{E}(X) = (1 - p)/p = 1$ failures till first success, followed by the day of success: So 2.
1. $\text{E}(X) = (1 - p)/p = 3$ failures, so $3 + 1 = 4$.
1. $\text{var}(X) = (1 - p)/p^2 = 12$.

```{r}
# Part 4
sum( dgeom(0:2,  # 0 to 2 failures before the success
           prob = 0.25))

```
:::








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:LayDate).**

1. See Fig. \@ref(fig:LayData).
   They are not hugely different.
1. Similar probabilities: 0.85 (in 1999) and 0.91 (in 2000).
1. Similar: 16 days (in 1999) and 12 (in 2000).
1. Writing $X$ for the clutch size (where $n = 237$):

   * $\text{E}(X) = (1\times \frac{9}{237}) + (2\times \frac{29}{237}) + (3\times \frac{199}{237}) =   2.801688$, or about 2.8.
   * $\text{E}(X^2) = (1^2\times \frac{9}{237}) + (2^2\times \frac{29}{237}) + (3^2\times \frac{199}{237}) = 8.084388$.
   * So, $\text{var}(X) = 8.084388 - (2.801688)^2 = 0.2349324$, so the standard deviation is 0.4846982, or about 0.485.
:::

```{r}
  ## Part 2
1 -  pnbinom(30, mu = 23.0, size = 20.6) # 0.1416996
1 - pnbinom(30, mu = 19.5, size = 8.9) # 0.09175251
  ## Part 3
qnbinom(0.15, mu = 23.0, size = 20.6) # 16
qnbinom(0.15, mu = 19.5, size = 8.9)  # 12

```

```{r LayData, out.width='80%', fig.width=8, fig.height = 3.5, fig.cap="The lay date model for glaucous-winged gulls, in 1999 and 2000", fig.align="center"}
x <- 0:50
y1999 <- dnbinom(x, mu = 23.0, size = 20.6)
y2000 <- dnbinom(x, mu = 19.5, size = 8.9)

plot( y1999 ~ x,
      pch = 19,
      las = 1,
      main = "Lay date for glaucous-winged gulls",
      xlab = "Lay date",
      ylab = "Prob. function")
points( y2000 ~ x,
        pch = 1)
legend("topleft",
       pch = c(19, 1),
       legend = c("1999",
                  "2000"))

```
`r if( includeBriefAnswers) "-->"`








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:NegativeBinomialALT).**

In Eq. \@ref(eq:NegativeBinomialPMF), the rv $X$ refers to the number of *failures* before the $r$th success is observed, so that $X = 0, 1, 2, \dots$.
So define $Y$ as the number of trials till the $r$th success, and hence $Y = X + r$.

1. The range space is $Y\in\{r, r + 1, r + 2, \dots\}$
1. $p_Y(y; p, r) = \binom{y - 1}{r - 1}(1 - p)^{y - r} p^{r - 1}$, for $y = r, r + 1, r + 2, \dots$.
1. $\text{E}(Y) = \text{E}(X + r) = \text{E}(X) + r = r/p$.  
   $\text{var}(Y) = \text{var}(X + r) = \text{var}(X) = r(1 - p)/p^2$.  
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:NegativeBinomialALT).**

Define $Y$ as the number of trials till the $r$th success, and hence $Y = X + r$.

1. $Y\in\{r, r + 1, r + 2, \dots\}$
1. $p_Y(y; p, r) = \binom{y - 1}{r - 1}(1 - p)^{y - r} p^{r - 1}$ for $y = r, r + 1, r + 2, \dots$.
1. $\text{E}(Y) = r/p$.  
   $\text{var}(Y) = r(1 - p)/p^2$.  
:::
`r if( includeFullAnswers) "-->"`








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:PoissonTypos).**

Let $X$ be the number of typos per minute; then $X\sim\text{Pois}(\lambda = 2.5\times 5 = 12.5)$ for a five-minute test.

```{r}
dpois(10, lambda = 12.5) # 0.09564364
dpois(6, lambda = 2.5 * 3) * dpois(4, lambda = 2.5 * 2) #  0.02398959
```

For part 3: The number of errors occurring in the 'overlap minute' could be 0, 1, 2, \dots 6.
So proceed:

* 6 errors in overlap minute:
 $\Pr(\text{0 errors first 2 mins})\times{}$
 $\Pr(\text{6 errors overlap min})\times{}$
 $\Pr(\text{0 errors final 2 mins})$
* 5 errors in overlap minute:
 $\Pr(\text{1 error first 2 mins})\times{}$
 $\Pr(\text{5 errors overlap min})\times{}$
 $\Pr(\text{1 error final 2 mins})$

And so on.

```{r}
prob <- function(ErrorsInOverlap){
  dpois( (6 - ErrorsInOverlap), lambda = 2 * 2.5) *
  dpois(ErrorsInOverlap, lambda = 1 * 2.5) *
  dpois((6 - ErrorsInOverlap), lambda = 2 * 2.5)
}
sum( prob( 0:6 ) ) # 0.02120811
```
:::
`r if( includeBriefAnswers) "-->"`









:::{.answer}
**Answer to Exercise\ \@ref(exr:RiverDepth).**

1. $0.25$.
2. `dbinom(x = 2, size = 4, prob = 0.25)` ${}=  0.2109375$.
:::










`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:QueuingPois).**

The code below is for one simulation for each part only.

```{r, fig.align="center", fig.cap="A simulation"}
### Part 1
set.seed(2268) # For reproducibility

queueLength <- array(dim = 60)

queueLength[1] <- rpois(1, lambda = 0.5)

for (i in 2:60){
   queueLength[i] <- queueLength[i - 1] + rpois(1, lambda = 0.5)
   # Print every 10 minutes
   if ( floor(i/10) == i/10 ) {
     cat("After ", i, " minutes past 8AM, queue length: ", queueLength[i], "\n")
   }
}
plot( queueLength, type = "l", las = 1)



### Part 2
queuelength <- array(dim = 60)

queueLength[1] <- rpois(1, lambda = 0.5)

for (i in 2:60){
   NumberIn <- rpois(1, lambda = 0.5)

   # Number being served
   if ( i < 30 ) {
     NumberServed <- 0
   } else {
     if (i >= 30) {
        lambda <- 0.75
     }
     NumberServed <- rpois(1, lambda = lambda)
     queueLength[i] <- queueLength[i - 1] + NumberIn - NumberServed
   }

   if ( queueLength[i] < 0 ) queueLength[i] <- 0
}

plot( queueLength, type = "l", las = 1)
abline(v = 30,
       lwd = 2,
       col = "grey")
text(30, 5,
     pos = 3, # To the right,
     labels = "Server starts")




### Part 3.
queuelength <- array(dim = 60)

queueLength[1] <- rpois(1, lambda = 0.5)

for (i in 2:60){
   NumberIn <- rpois(1, lambda = 0.5)

   # Number being served
   if ( i < 30 ) {
     NumberServed <- 0
   } else {
     if ( (i > 30) & (i < 45) ) {
        lambda <- 0.7
     }
     if ( i > 45 ) {
        lambda <- 1.3
     }
     NumberServed <- rpois(1, lambda = lambda)
   }

   queueLength[i] <- queueLength[i - 1] + NumberIn - NumberServed

   if ( queueLength[i] < 0 ) queueLength[i] <- 0
}

plot( queueLength, type = "l", las = 1)
abline(v = 30,
       lwd = 2,
       col = "grey")
text(30, 5,
     pos = 3, # To the right,
     labels = "Server 1 starts")
abline(v = 45,
       lwd = 2,
       col = "grey")
text(45, 5,
     pos = 3, # To the right,
     labels = "Server 2 starts")
```

:::
`r if( includeBriefAnswers) "-->"`








:::{.answer}
**Answer to Exercise\ \@ref(exr:PoissonEqualValues).**
Suppose $X\sim\text{Pois}(\lambda)$; then $\Pr(X) = \Pr(X + 1)$ implies
\begin{align*}
   \frac{\exp(-\lambda)\lambda^x}{x!} 
   &= \frac{\exp(-\lambda)\lambda^{x + 1}}{(x + 1)!} \\
   \frac{\lambda^x}{x!} 
   &= \frac{\lambda^{x} \lambda}{(x + 1) \times x!}
\end{align*}
so that $\lambda = x + 1$ (i.e., $\lambda$ must be a while number).
For example, if $x = 4$ we would have $\lambda = 5$.
And we can check:

```{r}
dpois(x = 4,     lambda = 5)
dpois(x = 4 + 1, lambda = 5)
```
:::






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:HypergeometricFPC).**

1. $\text{E}(X) = kp$ which is the same as the binomial (here, $k$ is the sample size).
1. $\text{var}(X) = k p (1 - p) \times \left(\frac{N - k}{N - 1}\right)$; the first bit is the variance for the binomial distribution (recall $k$ is the sample size).
   The other term is $(N - k)/(N - 1)$, which is the FPC factor as defined.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:HypergeometricFPC).**

1. $\text{E}(X) = kp$.
1. $\text{var}(X) = k p (1 - p) \times \left(\frac{N - k}{N - 1}\right)$.
:::
`r if( includeFullAnswers) "-->"`









:::{.answer}
**Answer to Exercise\ \@ref(exr:DiscreteUniformVar).**

Since $\text{var}(Y) = \text{E}(Y^2) - \text{E}(Y)^2$, find $\text{E}(Y^2)$ using \@ref(eq:SumSquaredNaturalNumbers):

\begin{align*}
  \text{E}(Y^2)
  &= \sum_{i = 0}^{b - a} i^2\frac{1}{b - a + 1}\\
  &= \frac{1}{b - a + 1}(0^2 + 1^2 + 2^2 + \dots  +(b - a)^2)\\
  &= \frac{1}{b - a + 1}\frac{(b - a)(b - a + 1)(2(b - a) + 1)}{6}\\
  &= \frac{(b - a)(2(b - a) + 1)}{6}.
\end{align*}
Therefore
\begin{align*}
   \text{var}(X)
    = \text{var}(Y)
   &= \frac{(b - a)(2(b - a) + 1)}{6} - \left(\frac{b - a}2\right)^2\\
   &= \frac{(b - a)(b - a + 2)}{12}.
\end{align*}
:::
 
 
 
 
 
 
 
 

<!-- ******************************************************************************************* --> 
## Answers for Chap. 5  {#AnswersChap5}



:::{.answer}
**Answer to Exercise\ \@ref(exr:BetaRepara).**

For example:
From $\mu = m/(m + n)$, we get $n = m(1 - \mu)/\mu$ and $m + n = m/\mu$.
Also, from the expression for the variance, substitiute $m + n = m/\mu$ and simplify to get

\[
   n = \frac{\sigma^2 m (m + \mu)}{\mu^3}
\]
Equate this expression for $n$ with $n = m(1 - \mu)/\mu$ from earlier, and solve for $m$.
We get that $m = \frac{\mu}{\sigma^2}\left( \mu(1 - \mu) - \sigma^2\right)$;
$n = \frac{1 - \mu}{\sigma^2}\left( \mu(1 - \mu) - \sigma^2\right)$.
:::






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SpeedSimUnif).**

1. $\text{E}(X) = (72 + 30)/2 = 51$km.h^$-1$^.
$\text{var}(X) = (72 - 30)^2 / 12 = 147$(km.h^$-1$^)^$2$^ (more easily understood, as $\sqrt{\text{Var}(X)} = 12.12$km.h^$-1$^).
1. See Fig. \@ref(fig:VehicleSpeeds).
1. See below; $2/7 \approx 0.2857$.
1. See below; $7/12 \approx 0.5833$.


```{r}
1 - punif(60, 30, 72)
(1 - punif(65, 30, 72) ) /
  (1 - punif(60, 30, 72) )

```
:::

```{r, VehicleSpeeds, echo=TRUE, fig.align="center", fig.cap="Vehicle speeds", out.width='70%'}
par(mfrow = c(1, 2))

x <- seq(10, 100,
         length = 1000)
plot( x = x,
      y = dunif(x, 
                min = 30,
                max = 72),
      type = "l",
      las = 1,
      xlab = "Vehicle speeds (in km/h)",
      ylab = "Probability density",
      main = "PDF for vehicle speeds")

x <- seq(10, 100,
         length = 1000)
plot( x = x,
      y = punif(x, 
                min = 30,
                max = 72),
      type = "l",
      las = 1,
      ylim = c(0, 1),
      xlab = "Vehicle speeds (in km/h)",
      ylab = "Probability density",
      main = "DF for vehicle speeds")
```
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:SpeedSimUnif).**

1. $\text{E}(X) 51$km.h^$-1$^.
$\text{var}(X) = 147$(km.h^$-1$^)^2^.
1. Not shown.
1. $2/7$.
1. $7/12$.
:::
`r if( includeFullAnswers) "-->"`



:::{.answer}
**Answer to Exercise\ \@ref(exr:SpeedSimNorm).**

1. About $2.4$% of vehicles are excluded.
1. $Y$ has the distribution of $X \mid (X > 30 \cap X < 72)$ if $X \sim N(48, 8.8^2)$.
The pdf is
$$
  f_Y(y) = 
  \begin{cases}
     0 & \text{for $y < 30$};\\
        \displaystyle \frac{1}{8.8k \sqrt{2\pi}}
                 \exp\left\{ -\frac{1}{2}\left( \frac{y - 48}{8.8}\right)^2 \right\} & \text{for $30\le y \le 72$};\\
     0 & \text{for $y > 72$}.
  \end{cases}
$$
where $k \approx \Phi(-2.045455) + (1 - \Phi(2.727273)) = 0.02359804$.


```{r}
# Proportion excluded:
pnorm(30, 48, 8.8) + # Slower than 30
   (1- pnorm(72, 48, 8.8)) # Faster than 72
```
:::







`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:ConcreteDiffusion).**

1. See Fig. \@ref(fig:ConcreteDiffusion).
1. $\text{E}(X) = \alpha \beta \approx 38.4$ and $\text{var}(X) = \alpha \beta^2 \approx 54.54$, so standard deviation is about $7.38$.
1. $\Pr(C > 30 \mid C < 50) = \Pr(30 < C < 50) / \Pr(C < 50)\approx 0.870$.
:::

```{r ConcreteDiffusion, fig.cap="The gamma distribution for the concrete diffusion model", out.width='70%', fig.align="center"}
alpha <- 27.05
beta <- 1.42

x <- seq(0, 80, length = 200)

par(mfrow = c(1, 2))

plot( y = dgamma(x, shape = alpha, scale = beta),
      x = x,
      las = 1,
      xlab = expression(italic(x)),
      ylab = "Prob. fn",
      type = "l",
      lwd = 2)
plot( y = pgamma(x, shape = alpha, scale = beta),
      x = x,
      xlab = expression(italic(x)),
      ylab = "Dist. fn",
      type = "l",
      las = 1,
      lwd = 2)

( pgamma(50, shape = alpha, scale = beta) - 
  pgamma(30, shape = alpha, scale = beta) ) /
pgamma(50, shape = alpha, scale = beta)
```
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:ConcreteDiffusion).**

1. Not shown.
1. $\text{E}(X) \approx 38.4$ and $\text{var}(X) \approx 54.54$.
1. $\approx 0.870$.
:::
`r if( includeFullAnswers) "-->"`








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:ConcreteSurfaceCholride).**

1. See Fig.\ \@ref(fig:SurfaceChloride).
2. About $0.0228$.
3. About $2.17$ kg/m^$3$^.
4. About $2.21$ kg/m^$3$^.
:::


```{r SurfaceChloride, fig.cap="The gamma distribution for the surface chloride concentrations model", out.width='70%', fig.align="center"}
mn <- 2
sd <- 0.2

x <- seq(1.2, 2.8, length = 200)

par(mfrow = c(1, 2))

plot( y = dnorm(x, mean = mn, sd = sd),
      x = x,
      xlab = expression(italic(x)),
      ylab = "Prob. fn",
      type = "l",
      lwd = 2)
plot( y = pnorm(x, mean = mn, sd = sd ),
      x = x,
      xlab = expression(italic(x)),
      ylab = "Dist. fn",
      type = "l",
      lwd = 2)

1 - pnorm(2.4, mean = mn, sd = sd)
qnorm(0.8, mean = mn, sd = sd)
qnorm(0.85, mean = mn, sd = sd)

```
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:ConcreteSurfaceCholride).**

1. Not shown.
2. About $0.0228$.
3. About $2.17$ kg/m^$3$^.
4. About $2.21$ kg/m^$3$^.
:::
`r if( includeFullAnswers) "-->"`









`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Kumaraswamy).**

1. See Fig.\ \@ref(fig:KumaraswamyPlots).
1. $F_X(x) = \int_0^x ab t^{a - 1} (1 - t^a)^{b - 1} \, dt = 1 - (1 - x^2)^b$.
1. With $b = 1$, the pdf is $p_X(x) = a x^{a - 1}$.
   Also,
   \begin{align*}
     \text{Beta}(a, 1)
     &= \frac{x^{a - 1} (1 - x)^1 - 1}{B(a, 1)}\\
     &= \frac{x^{a - 1} \Gamma(a + 1)}{\Gamma(a) \, \Gamma(a)} = a x^{a - 1},
  \end{align*}
  which is the same as above.
1. With $a = b = 1$, the pdf is $p_X(x) = 1$, which is the continuous uniform distribution.
1. Write $Y = 1 - X$; then $p_X(x) = ab(1 - y)^{a - 1} (y^a) ^{b - 1}$.
:::


```{r KumaraswamyPlots, fig.cap="Some Kumaraswamy distributions", out.width='70%', fig.align="center"}
dKumaraswamy <- function(x, a, b){
  a * b * x^(a - 1) * (1 - x^2) ^ (b - 1)
}
pKumaraswamy <- function(x, a, b){
  1 - (1 - x^a)^b
}


x <- seq(0, 1, length = 200)

par(mfrow = c(1, 2))

plot( y = dKumaraswamy(x, a = 0.5, b = 0.5),
      x = x,
      xlab = expression(italic(x)),
      ylab = "Prob. fn",
      las = 1,
      type = "l",
      ylim = c(0, 4),
      lwd = 2)
lines(y = dKumaraswamy(x, a = 4, b = 1),
      x = x,
      lwd = 2,
      lty = 2)
lines(y = dKumaraswamy(x, a = 1, b = 4),
      x = x,
      lwd = 2,
      lty = 3)
lines(y = dKumaraswamy(x, a = 1, b = 3),
      x = x,
      lwd = 2,
      lty = 4)




plot( y = pKumaraswamy(x, a = 0.5, b = 0.5),
      x = x,
      las = 1,
      xlab = expression(italic(x)),
      ylab = "Dist. fn",
      type = "l",
      lwd = 2)
lines(y = pKumaraswamy(x, a = 4, b = 1),
      x = x,
      lwd = 2,
      lty = 2)
lines(y = pKumaraswamy(x, a = 1, b = 4),
      x = x,
      lwd = 2,
      lty = 3)
lines(y = pKumaraswamy(x, a = 1, b = 3),
      x = x,
      lwd = 2,
      lty = 4)


```
`r if( includeBriefAnswers) "-->"`









:::{.answer}
**Answer to Exercise\ \@ref(exr:GammaCV).**

$\text{CV} = \frac{\sqrt{a\beta^2}}{\alpha\beta} = 1/\sqrt{\alpha}$, which is constant.
:::






:::{.answer}
**Answer to Exercise\ \@ref(exr:BetaHospital).**

For the given beta distribution, $\text{E}(V) = 0.287/(0.287 + 0.926) = 0.2366...$ and $\text{Var}(V) = 0.08161874$.

1. $\text{E}(S) = \text{E}(4.5 + 11V) = 4.5 + 11\text{E}(V) = 7.10$ minutes.
   $\text{var}(S) = 11^2\times\text{Var}(V) = 9.875$ minutes^2^.
1. See Fig.\ \@ref(fig:ServiceTimesBeta).
:::


```{r ServiceTimesBeta, fig.cap="Service times", fig.align="center"}
v <- seq(0, 1, length = 500)

PDFv <- dbeta(v, shape1 = 0.287, shape2 = 0.926)

plot( PDFv ~ v,
      type = "l",
      las = 1,
      xlim = c(0, 1),
      ylim = c(0, 5),
      xlab = expression(italic(V)),
      ylab = "PDF",
      main = "Distribution of V",
      lwd = 2)
```






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:ExpHospital).**

1. $\text{E}[T] = \text{E}[0.5 + W] = 0.5 + \text{E}[W] = 0.5 + 16.5 = 17.0$.
2. $\text{var}[T] = \text{var}[0.5 + W] = \text{var}[W] = 16.5^2$, so the std dev is $16.5$.
:::

```{r, ExpHos, fig.align="center", fig.cap="Exponential distribution for hospitals"}
beta <- 16.5
x <- seq(0, 80, length = 1000)

yB <- dexp(x,
           rate = 1/beta)

plot( yB ~  x,
      las = 1,
      type = "l",
      ylim = c(0, 0.06),
      lwd = 2,
      main = expression(PDF~"for"~italic(W)),
      xlab = expression(italic(w)),
      ylab = "Prob. fn.")
```
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:ExpHospital).**

1. $\text{E}[T] = 17.0$.
2. $\text{var}[T] = 16.5^2$.
:::
`r if( includeFullAnswers) "-->"`








:::{.answer}
**Answer to Exercise\ \@ref(exr:DisaggregationDuration).**

4. In summer: If the event lasts more than 1 hour, what is the probability that it eventually lasts more than three hours?
5. In winter: If the event lasts more than 1 hour, what is the probability that it lasts less  than two hours?

```{r, WinterSummer, fig.align="center", fig.cap="Winter and summer"}
alpha <- 2; betaS <- 0.04; betaW <- 0.03
x <- seq(0, 1, length = 1000)

yS <- dgamma( x, shape = alpha, scale = betaS)
yW <- dgamma( x, shape = alpha, scale = betaW)

plot( range(c(yS, yW)) ~  range(x),
      type = "n", # No plot, just canvas
      las = 1,
      xlab = "Event duration (in ??)",
      ylab = "Prob. fn.")
lines(yS ~ x, 
      lty = 1,
      lwd = 2)
lines(yW ~ x, 
      lty = 2,
      lwd = 2)
legend( "topright",
        lwd = 2,
        lty = 1:2,
        legend = c("Summer", "Winter"))

1 - pgamma(6/24, shape = alpha, scale = betaW)
1 - pgamma(6/24, shape = alpha, scale = betaS)

```
::: 







`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Diarrhoea).**

1. $\text{E}(X) = \alpha\beta = 3.76$ days.
   $\text{var}(X) = \alpha\beta^2 = 12.75$ days^2^, so std dev is $3.571$ days.
1. The main difference is at the lower end of the distribution.
1. About 35% (gamma) and 31% (exponential).
1. Both just over 10 days.


```{r, fig.align="center", fig.cap="Gamma and exponential"}
alpha <- 1.11; beta <- 3.39

x <- seq(0, 15, length = 500)
yGamma <- dgamma(x, shape = alpha, scale = beta)
yExp <- dexp(x, rate = 1/beta)

plot( range (c(yGamma, yExp)) ~ range(x),
      type = "n", # No plot, just canvas
      las = 1,
      xlab = "Duration of symptoms (in days)",
      ylab = "Prob. fn.")
lines( yGamma ~ x,
       lwd = 2,
       lty = 1)
lines( yExp ~ x,
       lwd = 2,
       lty = 2)
legend( "topright",
        lwd = 2,
        lty = 1:2,
        legend = c("Gamma", "Exponential"))

## Part 3
1 - pgamma(4, shape = alpha, scale = beta) # 0.3505492
1 - pexp(4, rate = 1/beta) # 0.3072969

## Part 4
qgamma(0.95, shape = alpha, scale = beta) # 10.86655
qexp(0.95, rate = 1/beta) # 10.15553
```
:::
`r if( includeBriefAnswers) "-->"`












`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:NormalLeaveTime).**

1. About $25.2$%.
2. $\Pr(T > 7 \mid T > 5) = \Pr(T > 7)/\Pr(T > 5)$ or about 33.8%.
3. About 7:30pm.

```{r}
pnorm(5, mean = 6, sd = 1.5)

(1 - pnorm(7, mean = 6, sd = 1.5) ) /
  (1 - pnorm(5, mean = 6, sd = 1.5) )

qnorm(0.85, mean = 6, sd = 1.5)
```

:::
`r if( includeBriefAnswers) "-->"`






`r if( includeBriefAnswers) "<!--"`
**Answer to Exercise\ \@ref(exr:BetaClay).**
Write $X$ for the percentage of clay content in soil.

2. County A:
   * $\text{E}(X) = m / (m + n) = 0.708$ or about $70.8$%.
   * $\text{var}(X) = 0.01196957$ so the standard deviation is about $10.9$%.
   County B:
   * $\text{E}(X) = m / (m + n) = 0.513$ or about $51.3$%.
   * $\text{var}(X) = 0.02939085$ so the standard deviation is about $17.0$%.
3. About $71.7$% for County A; about $51.5$% for County B.
   These look reasonable from the plots.

```{r, fig.align="center", fig.cap="Clay content"}
x <- seq(0, 1, length = 1000)
yA <- dbeta(x, shape1 = 11.52, shape2 = 4.75)
yB <- dbeta(x, shape1 = 3.85, shape2 = 3.65)

plot( range( c(yA, yB)) ~ range(100 * x),
      type = "n", #No plot, just canvas
      las = 1,
      xlab = "Percentage clay",
      ylab = "Prob. fn.")
lines( yA ~ I(100 * x),
       lwd = 2,
       lty = 1)
lines( yB ~ I(100 * x),
       lwd = 2,
       lty = 2)
legend("top",
       lty = 1:2,
       lwd = 2,
       legend = c("Location A", "Location B"))

## Part 3
1 - pbeta( 0.5, shape1 = 11.52, shape2 = 4.75) #  0.9601194
1 - pbeta( 0.5, shape1 = 3.85, shape2 = 3.65) # 0.5307863
```
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise \@ref(exr:BetaClay).**
1. Not shown.
2. County A: mean $70.8$%; standard deviation $10.9$%.
   County B: mean $51.3$%; standrad deviation $17.0$%.
3. $71.7$% (County A); $51.5$% (County B).
:::
`r if( includeFullAnswers) "-->"`






`r if( includeBriefAnswers) "<!--"`

:::{.answer}
**Answer to Exercise\ \@ref(exr:Headway).**

Note that if $Y = X - \Delta$, then $Y$ has a gamma distribution, with $\alpha = 2.5$ and $\beta = 0.8$, with $\text{E}(Y) = \alpha\beta = 2$ and $\text{var}(Y) = \alpha\beta^2 = 1.6$.

1. $\text{E}(X) = \text{E}(Y + \Delta) = 3.2$ seconds.
   $\text{var}(X) = \text{var}(Y) = 1.6$ seconds^2^.


```{r, fig.align="center", fig.cap="Headways"}
numSims <- 1000
yHeadway <- rgamma( n = numSims,
                    shape = 2.5,
                    rate = 0.8)
xHeadway <- yHeadway + 1.2
hist(xHeadway,
     las = 1,
     lwd = 2,
     xlim = c(0, max(xHeadway)),
     main = "Histogram of headway",
     ylab = "Prob. fn.",
     xlab = "Headway (in sec)")

xMean <- 3.2; xVar <- 1.6
xLo <- 3.2 - 2 * sqrt(xVar)
xHi <- 3.2 + 2 * sqrt(xVar)
cat("Limits", xLo, "and", xHi, "\n")

# Part 3
Num <- sum( (xHeadway < xHi ) & (xHeadway > xLo) )
EmpiricalProp <- Num / numSims
EmpiricalProp

# Part 4: Tchebyshev: AT LEAST this proportion
k <- 2
1 - 1/k^2
```
:::
`r if( includeBriefAnswers) "-->"`










:::{.answer}
**Answer to Exercise\ \@ref(exr:SimulationGirlHeights).**

```{r, GirslHeights, fig.align="center", fig.cap="Heights of children at day-care facilities" }
htMean <- function(x) {
  7.5 * x + 70
}
htSD <- function(x) {
  0.4575 * x + 1.515
}

NumSims <- 10000

Ages <- c(
  rep(2, NumSims * 0.32),
  rep(3, NumSims * 0.33),
  rep(4, NumSims * 0.25),
  rep(5, NumSims * 0.10)
)

Hts <- rnorm(NumSims,
             mean = htMean(Ages),
             sd = htSD(Ages))
hist(Hts,
     las = 1,
     xlab = "Heights (in cm)")

# Taller than 100:
cat("Taller than 100cm:", sum( Hts > 100) / NumSims * 100, "%\n")
# Mean and variance:
cat("Mean:", mean( Hts ), "cm; ",
    "Std dev: ", sd(Hts), "cm\n")

# Sort the heights to find where the tallest 20% are:
cat("Tallest 15% are taller than", 
    sort(Hts)[ NumSims * 0.85], "cm\n")
```

:::






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:TweedieVarFn).**
Normal: $\text{var}(X) = \sigma^2 \mu^0$, so $\phi = sigma^2$ and $p = 0$.

Poisson: $\text{var}(X) = \mu$, so $\phi = 1$ and $p = 1$.

Gamma: $\text{var}(X) = \phi \mu^2$, so $\phi = ???$ and $p = 2$.
:::
`r if( includeBriefAnswers) "-->"`









<!-- *********************************************************************************** -->
  
## Answers for Chap. 6 {#AnswersChap6}

`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DiscreteXY).**

1. This corresponds to the cell $X = 1, Y = 2$:  $5/24\approx 0.208333$. 
2. $\Pr(X + Y \le 1) = \Pr(X = 0, Y = 0) + \Pr(X = 0, Y = 1) + \Pr(X = 1, Y = 0) = 1/2$.
3. $\Pr(X > Y) = \Pr(X = 1, Y = 0) = 1/4$.
4. Write:  
\[
   p_X(x) = \begin{cases}
            7/24 & \text{if $x = 0$};\\
            17/24 & \text{if $x = 1$};\\
            0 & \text{otherwise}.
            \end{cases}
\]
5. Only consider the column corresponding to $X = 1$:  
\[
   p_{Y\mid X = 1}(y\mid x = 1) = 
   \begin{cases}
            (1/4)/(17/24) = 6/17 & \text{if $y = 0$};\\
            (1/4)/(17/24) = 6/17 & \text{if $y = 1$};\\
            (5/24)/(17/24) = 5/17 & \text{if $y = 2$};\\
            0 & \text{otherwise}.
   \end{cases}
\]
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DiscreteXY).**

1. $5/24$. 
2. $1/2$.
3. $1/4$.
4. Write:
$$
   p_X(x) = \begin{cases}
            7/24 & \text{if $x = 0$};\\
            17/24 & \text{if $x = 1$};\\
            0 & \text{otherwise}.
            \end{cases}
$$
5. Only consider the column corresponding to $X = 1$:
$$
   p_{Y\mid X = 1}(y\mid x = 1) = 
   \begin{cases}
            (1/4)/(17/24) = 6/17 & \text{if $y = 0$};\\
            (1/4)/(17/24) = 6/17 & \text{if $y = 1$};\\
            (5/24)/(17/24) = 5/17 & \text{if $y = 2$};\\
            0 & \text{otherwise}.
   \end{cases}
$$
:::`r if( includeFullAnswers) "-->"`










`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:AandBsimple).**

1. $13 + 4 = 17$.
2. $5 + 2 = 7$.
3. $(2\times 13) - (3\times 4) = 14$.
4. $(2^2\times 5) + (-3)^2\times 2) = 38$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:AandBsimple).**

1. $17$.
2. $7$.
3. $14$.
4. $38$.
:::
`r if( includeFullAnswers) "-->"`






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:AandBsimple2).**

1. $17$.
2. $5 + 2 + 0.2 = 7.2$.
3. $14$.
4. $(2^2\times 5) + ((-3)^2\times 2) + (2\times -3\times 0.2) = 36.8$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:AandBsimple2).**

1. $17$.
2. $7.2$.
3. $14$.
4. $36.8$.
:::
`r if( includeFullAnswers) "-->"`








:::{.answer}
**Answer to Exercise\ \@ref(exr:SampleMean).**
1. $\text{E}(\overline{X}) = \text{E}([X_1 + X_2 + \cdots + X_n]/n) = [\text{E}(X_1) + \text{E}(X_2) + \cdots + \text{E}(+ X_n)]/n = [n \mu]/n = \mu$.
2. $\text{var}(\overline{X}) = \text{var}([X_1 + X_2 + \cdots + X_n]/n) = [\text{var}(X_1) + \text{var}(X_2) + \cdots + \text{var}(X_n)]/n^2 = [n \sigma^2]/n^2 = \sigma^2/n$.
:::




:::{.answer}
**Answer to Exercise\ \@ref(exr:PoissonGammaRainfall).**

For one month:

```{r}
set.seed(932649)

NumRainEvents <- rpois(1,
                       lambda = 0.78)
MonthlyRain <- 0

if ( NumRainEvents > 0) {
     EventAmounts <- rgamma(NumRainEvents,
                           shape = 0.5,
                           scale = 6 )
     MonthlyRain <- sum( EventAmounts )
}
```

For 1000 simulations:

```{r}
set.seed(932649)

MonthlyRain <- array(0,  
                     dim = 1000)

for (i in 1:1000){
 NumRainEvents <- rpois(1,
                       lambda = 0.78)
 MonthlyRain[i] <- 0

  if ( NumRainEvents > 0) {
       EventAmounts <- rgamma(NumRainEvents,
                             shape = 0.5,
                             scale = 6 )
       MonthlyRain[i] <- sum( EventAmounts )
  }
}

# Exact zeros:
sum(MonthlyRain == 0) / 1000
mean(MonthlyRain)
mean(MonthlyRain[MonthlyRain > 0])
```
:::







:::{.answer}
**Answer to Exercise\ \@ref(exr:JointPDF).**

1. Need integral to be one: $\displaystyle \int_0^1\!\!\!\int_0^1 kxy\, dx\, dy = 1$, so $k = 4$.
1. Here:  
\[
   4 \int_0^{3/8}\!\!\!\int_0^{5/8} kxy\, dx\, dy = 225/4096\approx 0.05493.
\]
:::









:::{.answer}
**Answer to Exercise\ \@ref(exr:LinearCombinCovariance).**

1. $\text{E}[U] = \mu_x - \mu_Z$;  $\text{E}[V] = \mu_x - 2\mu_Y + \mu_Z$.
1. $\text{var}[U] = \sigma^2_x + \sigma^2_Z$;  $\text{E}[V] = \sigma^2_x + 4\sigma^2_Y + \sigma^2_Z$.
1. Care is needed!  
\begin{align*}
    \text{Cov}[U, V]
  &= \text{E}[UV] - \text{E}[U]\text{E}[V]\\
  &= \text{E}[X^2 - 2XY + XZ - XZ + 2YZ - Z^2] - \\
  &\qquad (\mu_X^2 + 2\mu_X\mu_Y + \mu_X\mu_Z - \mu_X\mu_Z - 2\mu_Y\mu_Z - \mu^2_z)\\
  &= (\text{E}[X^2] - \mu_X^2) - 2(\text{E}[XY] - \text{E}[X]\text{E}[Y]) + 2(\text{E}[YZ] - \mu_Y\mu_Z)  -\\
  &\qquad (\text{E}[Z^2] - \mu_Z^2)\\
  &= \sigma^2_X - \sigma^2_Z,
\end{align*}
since the two middle terms become $-2\text{Cov}[X, Y] + 2\text{Cov}[Y, Z]$, are both are zero (as given).
1. The covariance is zero if $\sigma^2_X = \sigma^2_Z$.
:::







`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:JointDiscrete11).**

1. First, $\Pr(X \mid Y = 2) = |x - 2|/11$.
   Then, the marginal distribution is
$$
      p(X\mid Y = 2) =
      \begin{cases}
        2/3 & \text{for $x = 0$};\\
        1/3 & \text{for $x = 1$.}
      \end{cases}
$$
   So $\text{E}(X | Y = 2) = 1/3$.
2. First, $p_X(x) = \frac{1}{11}( |x - 1| + |x - 2| + |x - 3|)$ for $x = 0, 1, 2$; so $\Pr(X\ge 1) = 5/11$.
   The probability function is non-zero for $y = 1, 2, 3$.
   Then
$$
   p(Y\mid x\ge 1) = 
     \begin{cases}
        1/5 & \text{for $y = 1$};\\
        1/5 & \text{for $y = 2$};\\
        3/5 & \text{for $y = 3$}.
     \end{cases}
$$
Then, $\text{E}(Y \mid X\ge 1) = 12/5$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:JointDiscrete11).**

1. First find marginal distribution.
   Then $\text{E}(X | Y = 2) = 1/3$.
2. $\text{E}(Y \mid X\ge 1) = 12/5$.
:::
`r if( includeFullAnswers) "-->"`








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:CorrContDist).**

1. We find $f_X(x) = 1$ for $0 < x < 1$ and $f_Y(y) = 1$ for $0 < y < 1$.
2. Independence if $f_X(x) \times f_Y(y) = f_{XY}(x, y)$, which occurs only when $\alpha = 0$.
3. We need some intermediate values:

   * $\text{E}(X) = \text{E}(Y) = 1/2$;
   * $\text{var}(X) = \text{var}(Y) = 1/12$;
   * $\text{E}(XY) = (9 - \alpha)/36$.

   Then $\text{Cov}(X, Y) = -\alpha/36$ and so $\text{Cor}(X, Y) = -\alpha/3$.
4. $\Pr(X < Y) = \int_0^1\!\!\int_y^1 1 - \alpha(1 - 2x)(1 - 2y)\, dx\, dy = 1/2$.
:::
`r if( includeBriefAnswers) "-->"`







:::{.answer}
**Answer to Exercise\ \@ref(exr:FairCoinTossedTwice).**

1. Construct table (below) from listing all four outcomes.
1. We get
$$
  p_X(x) = 
  \begin{cases}
     1/4 & \text{for $x = 0$};\\
     1/2 & \text{for $x = 1$};\\
     1/4 & \text{for $x = 2$}.
  \end{cases}
$$
1. When given $Y = 1$, then the probability function is non-zero for $x = 1, 2$:
$$
  p_{X|Y = 1}(x \mid Y = 1) = 
  \begin{cases}
     1/2 & \text{for $x = 1$};\\
     1/2 & \text{for $x = 2$};
  \end{cases}
$$ 
1. Not independent; for instance, when $Y = 0$, $\Pr(X) > 0$ for $x =   0, 1$, in constrast to when $Y = 1$.
:::

   .    | $X = 0$ | $X = 1$ | $X = 2$ |
--------| --------|---------|---------|
$Y = 0$ | $1/4$   | $1/4$   | $0$     |
$Y = 1$ | $0$     | $1/4$   | $1/4$   |









`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:DiceMinMax).**
The joint probability function is shown in Table \@ref(tab:DiceMinMaxTab).
For example:

* A minimum of 2 and a maximum of 1 is impossible; this makes no sense (hence probability is zero).
* A minimum of 3 and a maximum of 4 can happen in two ways: A 4 on the first die and a 3 on the other, or a 3 on the first die and a 4 on the other.
* A minimum *and* a maximum of 2 can only happen one way: both dice show a 2.

Then, the marginal distribution for $B$ (the minimum) is
$$
   f_B(b) =
   \begin{cases}
       11/36 & \text{for $b = 1$};\\
       9/36 & \text{for $b = 2$};\\
       7/36 & \text{for $b = 3$};\\
       5/36 & \text{for $b = 4$};\\
       3/36 & \text{for $b = 5$};\\
       1/36 & \text{for $b = 6$}
   \end{cases}
$$
which is easily confirmed as a valid pmf.


```{r DiceMinMaxTab, echo=FALSE}
DiceMinMax <- array( 0, 
                     dim = c(6, 6))

colnames(DiceMinMax) <- c("$\\text{min} = 1$",
                          "$\\text{min} = 2$",
                          "$\\text{min} = 3$",
                          "$\\text{min} = 4$",
                          "$\\text{min} = 5$",
                          "$\\text{min} = 6$")
rownames(DiceMinMax) <- c("$\\text{max} = 1$",
                          "$\\text{max} = 2$",
                          "$\\text{max} = 3$",
                          "$\\text{max} = 4$",
                          "$\\text{max} = 5$",
                          "$\\text{max} = 6$")
DiceMinMax[1, ] <- paste0( c(1, 0, 0, 0, 0, 0), "/36")
DiceMinMax[2, ] <- paste0( c(2, 1, 0, 0, 0, 0), "/36")
DiceMinMax[3, ] <- paste0( c(2, 2, 1, 0, 0, 0), "/36")
DiceMinMax[4, ] <- paste0( c(2, 2, 2, 1, 0, 0), "/36")
DiceMinMax[5, ] <- paste0( c(2, 2, 2, 2, 1, 0), "/36")
DiceMinMax[6, ] <- paste0( c(2, 2, 2, 2, 2, 1), "/36")


DiceMinMax.caption <- "The minimum and maximum from two rolls of a die"
if( knitr::is_latex_output() ) {
  knitr::kable(DiceMinMax,
               format = "latex",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               escape = FALSE,
               linesep = c("", "", "\\addlinespace"),
               caption = DiceMinMax.caption) %>%
    kable_styling(font_size = 10) %>%
    row_spec(0, bold = TRUE) %>%
    column_spec(1, bold = TRUE)
}
if( knitr::is_html_output() ) {
  knitr::kable(DiceMinMax,
               format = "html",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               caption = DiceMinMax.caption) %>%
    row_spec(0, bold = TRUE) 
}


```
:::
`r if( includeBriefAnswers) "-->"`









`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:GammaExp).**

For an exponential distribution, the mgf is $M_X(t) = (1 - \beta t)^{-1}$.
Now, the mgf is a sum is the product opf the mgfs (see Theorem \@ref(thm:MGFIndependent)), so the mgf of $W = Z_1 + Z_2 + \cdots + Z_n$ is  
\[
   M_W(t) = \prod_{i = 1}^n (1 - \beta t)^{-1} =  (1 - \beta t)^{-n},
\]
which is the mgf of a gamma distribution with parameters $n$ and $\beta$, as to be shown. 
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:GammaExp).**
Gamma distribution with parameters $n$ and $\beta$.
:::
`r if( includeFullAnswers) "-->"`



:::{.answer}
**Answer to Exercise\ \@ref(exr:DiscreteJointTable).**

1. Adding:
$$
  p_X(x) = 
  \begin{cases}
    0.40 & \text{for $x = 0$};\\
    0.45 & \text{for $x = 1$};\\
    0.15 & \text{for $x = 3$}.
  \end{cases}
$$
2. $\Pr(X \ne Y) = 1 - \Pr(X = Y) = 1 - (0.20) = 0.80$.
3. $X < Y$ only includes these five $(x, y)$ elements of the sample space: 
   $\{ (0, 1), (0, 2), (0, 3); (1, 2), (1, 3)\}$.
   The sum of these probabilities is 0.65.  
   
   Then, **given** these five, only two of them sum to three (i.e., $(0, 3)$ and $(1, 2)$).
   So the probability of the **intersection** is $\Pr( \{0, 3\} ) + \Pr( \{1, 2\}) = 0.30$.  
   
   So the conditional probability is $0.30/0.65 = 0.4615385$, or about 46%.
4. No: For $X = 0$, the values of $Y$ with non-zero probability are $Y = 1, 2, 3$.
   However, for $X = 1$ (for example), the values of $Y$ with non-zero probability are $Y = 1, 2$.
:::








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:IIDcubic).**
1. $f(x_1, x_2, \dots, x_n) = 4^n \prod_{i = 1}^n x_i^3$.
2. $\P(X_1 > 1/2) = \int_0^{1/2} 4 x^3 \, dx =  1/16 = 0.0625$.
3. The prob is $16^{-n}$.
4. Same as 3.
:::
`r if( includeBriefAnswers) "-->"`






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:TwoFairDie).**

A table can be used to show the sample space (below).
Looking for $X = 4$ we deduce that
$$
  p_Y(y|X = 4) =
  \begin{cases}
        2/7 = 0.2857 & \text{for $y = 1$};\\
        2/7 & \text{for $y = 2$};\\
        2/7 & \text{for $y = 3$};\\
        2/7 & \text{for $y = 4$};\\
        0 & \text{elsewhere}.\\
  \end{cases}
$$
Hence we deduce that $\text{E}[Y | X = 4] = 16/7\approx 2.2857$.
:::

The table shows the values of $(x, y)$.

   .     | Die 1: 1  | 2       | 3         | 4        | 5        | 6        |
--------:|-----------|---------|-----------|----------|---------|-----------|
Die 2: 1 |  $(1, 1)$ | $(2, 1)$ | $(3, 1)$ | $(4, 1)$ | $(5, 1)$ | $(6, 1)$ |
       2 |  $(2, 1)$ | $(2, 2)$ | $(3, 2)$ | $(4, 2)$ | $(5, 2)$ | $(6, 2)$ |
       3 |  $(3, 1)$ | $(3, 2)$ | $(3, 3)$ | $(4, 3)$ | $(5, 3)$ | $(6, 3)$ |
       4 |  $(4, 1)$ | $(4, 2)$ | $(4, 3)$ | $(4, 4)$ | $(5, 4)$ | $(6, 4)$ |
       5 |  $(5, 1)$ | $(5, 2)$ | $(5, 3)$ | $(5, 4)$ | $(5, 5)$ | $(6, 5)$ |
       6 |  $(6, 1)$ | $(6, 2)$ | $(6, 3)$ | $(6, 4)$ | $(6, 5)$ | $(6, 6)$ |



```{r echo=FALSE}

set.seed(108125)

numSims <- 10000
yCount <- 0
yVector <- array(dim = numSims)

for (i in 1:numSims){
  # Roll the dice
  Die1 <- sample(1:6, 1)
  Die2 <- sample(1:6, 1)
  
  x <- max( c(Die1, Die2) )
  y <- min( c(Die1, Die2) )
  
  if (x == 4){
    yCount <- yCount + 1
    yVector[yCount] <- y
  }
  
}

expY <- mean(yVector, na.rm=TRUE)

expY # Similar to what is expected
```
`r if( includeBriefAnswers) "-->"`










:::{.answer}
**Answer to Exercise\ \@ref(exr:DailyRainfallSim).**

```{r echo=FALSE}
set.seed(8584444)
```
```{r echo=TRUE}
annualRainfallList <- array( NA, dim = 1000)
for (i in 1:1000){
   rainAmounts <- array( 0, dim = 365) # Reset for each simulation

    wetDays <- rbinom(365, size = 1, prob = 0.32) # 1: Wet day
   locateWetDays <- which( wetDays == 1 )


   rainAmounts[locateWetDays] <- rgamma( n = length(locateWetDays),
                                         shape = 2,
                                         scale = 20)
   annualRainfallList[i] <- sum(rainAmounts)
}
# hist( annualRainfallList)
```

```{r echo=FALSE}
set.seed(8584444)
```
```{r echo=TRUE}
Days <- 1 : 365
prob <- (1 + cos( 2 * pi * Days/365) ) / 2.2

annualRainfallList2 <- array( NA, dim = 1000)
for (i in 1:1000){

  wetDays <- rbinom(365, size = 1, prob = prob) # 1: Wet day
  
  locateWetDays <- which( wetDays == 1 )
  
  rainAmounts2 <- array( 0, dim = 365)
  
  rainAmounts2[locateWetDays] <- rgamma( n = length(locateWetDays),
                                         shape = 2,
                                         scale = 20)
   annualRainfallList2[i] <- sum(rainAmounts2)
}
#hist( annualRainfallList2)
```

```{r echo=FALSE}
set.seed(8584444)
```
```{r echo=TRUE}
Days <- 1 : 365

probList <- array( dim = 365)
probList[1] <- 0.32

annualRainfallList3 <- array( NA, dim = 1000)

for (i in 1:1000){
  
  rainAmounts <- array( dim = 365 )

  for (day in 1:365) {
    if ( day == 1 ) {
      probList[1] <- 0.32
      wetDay <- rbinom(1, 
                       size = 1, 
                       prob = probList[1]) # 1: Wet day
      rainAmounts[1] <- rgamma( n = 1,
                                shape = 2,
                                scale = 20)

    } else {
    
      probList[i] <- ifelse( rainAmounts[day - 1] == 0,
                             0.15,
                             0.55)
      wetDay <- rbinom(1, 
                       size = 1, 
                       prob = probList[i]) # 1: Wet day

      if (wetDay) {
        rainAmounts[day] <- rgamma( n = 1,
                                    shape = 2,
                                    scale = 20)
      } else {
        rainAmounts[day] <- 0
      }
    }
  }
  annualRainfallList3[i] <- sum(rainAmounts)
    
}

#hist( annualRainfallList3)
```
:::









`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:JointTriangular).**

1. See Fig. \@ref(fig:TriRegion).
1. Integrate correctly! $\displaystyle \int_0^2 \!\!\!\int_0^{2 - x} x(y + 1)\,dy \, dx = 2$, so $c = 1/2$.
1. $P(Y < 1 \mid X > 1) = P(Y < 1 \cap X > 1)/\Pr(X > 1)$.
   First, $f_X(x) = (1/2) \int_0^{2 - x} x(y + 1)\,dy =  (1/4)(x^3 - 6x^2 + 8x)$ for $0 < x < 2$.
   So $\Pr(X > 1) = 7/16 = 0.4375$.
   Also,
$$
      P(Y < 1 \cap X > 1)
      =  (1/2) \int_1^2 \!\!\!\int_0^{2 - x} x(y + 1)\,dy \, dx
      = 7/16.
$$
   Then, $P(Y < 1 \mid X > 1) = 1$, which makes sense from the diagram (if $X > 1$, $Y$ *must* be less than 1).
1. $P(Y < 1 \mid X > 0.25) = P(Y < 1 \cap X > 0.25)/\Pr(X > 0.25)$.
   Using results from above, $\Pr(X > 0.25) = 3871/4096 = 0.945068$ and $P(Y < 1 \cap X > 0.25) = 0.945$.
   So $P(Y < 1 \mid X > 0.25) = P(Y < 1 \cap X > 0.25)/\Pr(X > 0.25)$.
1. First, $f_Y(y) = \frac{1}{2} \int_0^{2 - y} x(y + 1)\, dx = \frac{1}{4}(y + 1)(y - 2)^2$.
   Then,
$$
     \Pr(Y < 1) = \int_0^1 \frac{1}{4}(y + 1)(y - 2)^2\, dy = \frac{13}{16}\approx 0.8125.
$$
:::

```{r TriRegion, echo=FALSE, fig.align="center", fig.cap="The region where $X$ and $Y$ have positive probability"}
plot( x = c(-0.5, 3),
      y = c(-0.5, 3),
      type = "n",
      las = 1,
      xlab = expression(italic(x)),
      ylab = expression(italic(y)))

polygon( x = c(0, 0, 2, 0),
         y = c(0, 2, 0, 0),
         col = "grey")
lines( x = c(0, 2),
       y = c(2, 0),
       lwd = 2)
abline(v = 0, 
       lwd = 2)
abline(h = 0,
       lwd = 2)
text(1.75, 1.75,
     pos = 3,
     expression( italic(y) == 2 - italic(x) ))
arrows( x0 = 1.75,
        y0 = 1.75,
        x1 = 1,
        y1 = 1,
        angle = 15,
        length = 0.15)
```
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`

:::{.answer}
**Answer to Exercise\ \@ref(exr:JointTriangular).**

1. Not shown.
1. Integrate correctly! $c = 1/2$.
1. $\Pr(X > 1) = 7/16 = 0.4375$.
   $P(Y < 1 \cap X > 1) = 7/16$.
   Then, $P(Y < 1 \mid X > 1) = 1$, which makes sense from the diagram (if $X > 1$, $Y$ *must* be less than 1).
1. $P(Y < 1 \mid X > 0.25) = P(Y < 1 \cap X > 0.25)/\Pr(X > 0.25)$.
1. $\frac{13}{16}\approx 0.8125$.
:::
`r if( includeFullAnswers) "-->"`











`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:JointQuad).**

1. Proceed:
\begin{align*}
   1
   &= k\int_0^1\!\!\!\int_0^{\sqrt{y}} (1 - x)y\, dx\, dy\\
   &= k\int_0^1\!\!\!\int_{x^2}^{1} (1 - x)y\, dy\, dx\\
   &= \frac{k}{2}\int_0^1 (1 - x) (1 - x^4) \, dx\\
   &= \frac{7k}{30},
\end{align*}
so that $k = 30/7\approx 4.285714$.
2. Being careful with the integration limits again (draw a diagram!):
\begin{align*}
   \Pr(X > Y)
   &= \int_0^1 \!\int_y^{\sqrt{y}} f(x, y)\, dx\, dy\\
   &= \int_0^1 \!\int_x^{x^2} f(x, y)\, dy\, dx\\
   &= \frac{15}{7} \int_0^1 (x - 1) x^2 (x^2 - 1)\, dx\\
   &= 3/28\approx 0.1071429.
\end{align*}
3. First find the marginal distribution of $X$:
$$
  f_X(x) = \int_{x^2}^1 f(x, y)\, dy = \frac{15}{7} (x - 1)(x^4 - 1),
$$
and so
$$
   \Pr(X > 0.5) =  \frac{15}{7} \int_{1/2}^1 (x - 1)(x^4 - 1)\, dx = \frac{183}{896}\approx 0.2042411.
$$
:::
`r if( includeBriefAnswers) "-->"`









:::{.answer}
**Answer to Exercise\ \@ref(exr:Mixture).**

1. Since $X + Y + Z = 500$, once the values of $X$ and $Y$ are known, the value of $Z$ has one specific value (i.e., all three values are not free to vary).
2. See Fig. \@ref(fig:Mixture) (left panel).
3. See Fig. \@ref(fig:Mixture) (right panel).
4. Proceed:
   \begin{align*}
     1 
     &= \int_{200}^{300} \!\! \int_{100}^{400 - y} k\,dx\,dy + 
        \int_{100}^{200} \!\! \int_{300 - y}^{400 - y}     k\,dx\,dy \\
     &= 30\ 000,
  \end{align*}
  so that $k = 1/30\ 000$.
:::


```{r Mixture, echo=FALSE, out.width = '100%', fig.width=9, fig.align="center", fig.cap="The sample space for the mixture of nuts and dried fruit"}

par( mfrow = c(1, 2) )

plot( x = c(0, 430),
      y = c(0, 450),
      type = "n",
      asp = 1,
      main = "The weight of nuts plus dried fruit\nis between 300g and 400g",
      xlab = expression(italic(X)),
      ylab = expression(italic(Y)),
      las = 1)
abline(v = 0, 
       lty = 1)
abline(h = 0,
       lty = 1)

polygon( x = c(0, 0, 400, 300),
         y = c(300, 400, 0, 0),
         lwd = 3,
         col = "grey")
arrows(x0 = 200,
       y0 = 400,
       x1 = 100,
       y1 = 300,
       angle = 15,
       length = 0.25)
text(200, 400,
     pos = 3,
     labels = expression(italic(X)+italic(Y)==400))


arrows(x0 = 300,
       y0 = 200,
       x1 = 200,
       y1 = 100,
       angle = 15,
       length = 0.25)
text(300, 200,
     pos = 3,
     labels = expression(italic(X)+italic(Y)==300))

########################

plot( x = c(0, 430),
      y = c(0, 450),
      asp = 1,
      type = "n",
      axes = FALSE,
      main = "A minimum of 100g of nuts\nand a minimum of 100g of dried fruit",
      xlab = expression(italic(X)),
      ylab = expression(italic(Y)),
      las = 1)
axis(side = 1,
     at = c(100, 300, 400, 500),
     labels = c(expression(plain(min)(italic(X))==100), 300, 400, 500))
axis(side = 2,
     las = 1,
     at = seq(0, 500, by = 100),
     labels = c(0, expression(plain(min)*(italic(Y))==100), 200, 300, 400, 500))
box()


abline(v = 0, 
       lty = 1)
abline(h = 0,
       lty = 1)

polygon( x = c(0, 0, 400, 300),
         y = c(300, 400, 0, 0),
         lwd = 1,
         lty = 2,
         col = "white")


lines( x = c(100, 100),
       y = c(0, 200),
       lty = 2)
lines( x = c(0, 200),
       y = c(100, 100),
       lty = 2)


polygon( x = c(100, 100, 300, 200),
         y = c(200, 300, 100, 100),
         lwd = 3,
         col = "grey")

```









<!-- ************************************************************************************* -->

## Answers for Chap. 7 {#AnswersChap7}



`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:X2).**

For $0 < x < 2$, the transformation is one-to-one.
The inverse transform is $X = Y^{1/3}$, and so $0 < y < 8$.

1. $F_Y(y) = \Pr(Y\le y)
   = \Pr(X^3 \le y) = \Pr(X\le y^{1/3}) = F_X( y^{1/3})
   = \int_{u = 0}^{y^{1/3}} u/2\,du = u^2/4\Big|_{u = 0}^{u = y^{1/3}} = y^{2/3}/4.$
Differentiate to find the pdf:
$\frac{d}{dy} y^{2/3}/4 = y^{-1/3}/6$.
The pdf of $Y$ is
$$
   f_Y(y) = \begin{cases}
               y^{-1/3}/6 & \text{for $0 < y < 8$};\\
               0 & \text{otherwise}.
            \end{cases}
$$

2. Since $w(y) = y^{1/3}$, then $w'(y) = y^{-2/3}$.
Then:
\begin{align*}
   f_Y(y)
   &= f_X(y) |J|\\
   &= y^{1/3}/2 \times \overbrace{y^{-2/3}/3}^{|J|} \\
   &= y^{-1/3}/6.
\end{align*}
So the pdf of $Y$ is as above.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:X2).**

For $0 < x < 2$, the transformation is one-to-one.
The inverse transform is $X = Y^{1/3}$, and so $0 < y < 8$.

Pdf of $Y$ is
$$
   f_Y(y) = \begin{cases}
               y^{-1/3}/6 & \text{for $0 < y < 8$};\\
               0 & \text{otherwise}.
            \end{cases}
$$
:::`r if( includeFullAnswers) "-->"`





`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:JointDiscrete).**

First:

* For $X_1 = 0$, $X_2= 0$ (with prob: $0$):   $Y_1 = 0$; $Y_2 = 0$;
* For $X_1 = 0$, $X_2= 1$ (with prob. $1/6$): $Y_1 = 1$; $Y_2 = 1$;
* For $X_1 = 1$, $X_2= 0$ (with prob. $2/6$): $Y_1 = 1$; $Y_2 = 0$;
* For $X_1 = 1$, $X_2= 1$ (with prob. $3/6$): $Y_1 = 2$; $Y_2 = 1$.

Effectively, the first line can be ignored (since the probability is zero), so $Y_1 \in \{1, 2\}$ and $Y_2\in\{0, 1\}$.

1. From the above, the joint pf is shown in Table \@ref(tab:JDTable).
1. Hence, from the table:
$$
   f_{Y_1}(y_1) =
   \begin{cases}
      1/2 & \text{if $y_1 = 1$};\\
      1/2 & \text{if $y_1 = 2$};\\
      0    & \text{otherwise}.
    \end{cases}
$$

```{r JDTable, echo=FALSE}
JDTable <- array( dim = c(2, 3))

colnames(JDTable) <- c("",
                       "$Y_1 = 1$",
                       "$Y_1 = 2$")
JDTable[1, ] <- c("$Y_2 = 0$",
                  "$2/6$",
                  "$0$")
JDTable[2, ] <- c("$Y_2 = 1$",
                  "$1/6$",
                  "$3/6$")
if (knitr::is_latex_output()) {
  kable(JDTable,
    format = "latex",
    escape = FALSE,
    caption = "The joint distribution of $Y_1$ and $Y_2$",
    booktabs = TRUE) %>%
  kable_styling(font_size = 10) %>%
  row_spec(0, bold = TRUE)
}
if (knitr::is_html_output()){
  kable(JDTable,
    caption = "The joint distribution of $Y_1$ and $Y_2$",
    format = "html",
    booktabs = TRUE) %>%
  kable_styling(font_size = 10) %>%
  row_spec(0, bold = TRUE)
}
```
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:JointDiscrete).**

1. Table not shown.
1. Find:
$$
   f_{Y_1}(y_1) =
   \begin{cases}
      1/2 & \text{if $y_1 = 1$};\\
      1/2 & \text{if $y_1 = 2$};\\
      0    & \text{otherwise}.
    \end{cases}
$$
:::
`r if( includeFullAnswers) "-->"`


















`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:GammaSum).**

$Y \sim\text{Gam}(\sum\alpha, \beta)$.
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`

:::{.answer}
**Answer to Exercise\ \@ref(exr:GammaSum).**

$Y \sim\text{Gam}(\sum\alpha, \beta)$.
:::
`r if( includeFullAnswers) "-->"`





`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:CauchySquared).**

Transformation is not 1-1; and $Y > 0$.

Then:
\begin{align*}
   F_Y(y)
   &= \Pr(Y < y)\\
   &= \Pr( X^1 < y)\\
   &= \Pr( -\sqrt{y} < X < \sqrt{y} ) \quad\text{(draw a diagram!)}\\
   &= \int_{-\sqrt{y}}^{\sqrt{y}} \frac{1}{\pi(1 + x^2)}\, dx\\
   &= \frac{2}{\pi} \tan^{-1}(\sqrt{y}).
\end{align*}
and so
\begin{align*}
   f_Y(y)
   &= \frac{d}{dy} \frac{2}{\pi} \tan^{-1}(\sqrt{y})\\
   &= \frac{1}{\pi(y + 1)\sqrt{y}}\quad\text{for $y > 0$}.
\end{align*}

:::
`r if( includeBriefAnswers) "<!--"`






:::{.answer}
**Answer to Exercise\ \@ref(exr:ContTransform).**

1. Differentiating:  
   \[
     f_X(x) = 
     \begin{cases}
       1 & \text{for $-1/2 < x < /1/2$};\\
       0 & \text{elsewhere}.
     \end{cases}
   \]
2. First: this transformation is not 1:1 (Fig. \@ref(fig:TransformSquared)).
   See that $X = \pm\sqrt{4 - Y}$, and that $3.75 < Y < 4$.
   So,   
   \begin{align*}
     F_Y(y) 
     &= \Pr(Y < y) \\
     &= 1 - \Pr( -\sqrt{4 - y} < X < \sqrt{4 - y} )\\
     &= 1 - \int_{-\sqrt{4 - y}}^{\sqrt{4 - y}} 1\, dx\\
     &= 1 - 2\sqrt{4 - y},
   \end{align*}
   and so, differentiating:
   \[
     f_Y(y) = \frac{1}{\sqrt{4 - y}} \quad\text{for $3.75 < Y < 4$}
   \]
:::

```{r TransformSquared, out.width='100%', fig.width=9, fig.height=3,fig.cap="The transformation", fig.align="center"}
par( mfrow = c(1, 3))

xwide <- seq(-0.75, 0.75,
             length = 100)
x <- seq( -0.5, 0.5,
          length = 100)
y <- dunif(xwide, 
           min = -0.5,
           max = 0.5)
plot( y ~ xwide,
      lwd = 2,
      las = 1,
      type = "l",
      main = expression(The~PDF~"of"~italic(X)),
      xlab = expression(italic(X)),
      ylab = expression(PDF~"of"~italic(X)) )


###

Y <- (4 - x^2)
Ywide <- (4 - xwide^2)

plot(Ywide ~ xwide,
     main = "The transformation",
     las = 1,
     lwd = 2,
     type = "l",
     col = "grey",
     xlab = expression(italic(X)),
     ylab = expression(italic(Y)))
lines(Y ~ x,
      lwd = 4 ,
      col = "black")

abline(v = 0)

yht <- 3.85
x1 <- -sqrt(4 - yht)
x2 <- sqrt(4 - yht)
abline( h = yht,
        col = "grey",
        lty = 2)
abline( v = x1,
        col = "grey",
        lty = 2)
abline( v = x2,
        col = "grey",
        lty = 2)

text(x = x1,
     y = yht,
     pos = 1,
     labels = expression(italic(x)[1]) )
text(x = x2,
     pos = 1,
     y = yht,
     labels = expression(italic(x)[2]) )
mtext(expression(italic(y)),
      at = yht,
      line = 1,
      side = 2,
      las = 1)
##
y <- seq(3.75, 4,
         length = 100)
PDFy <- 1 / sqrt(4 - y)

plot( PDFy ~ y,
      lwd = 2,
      las = 1,
      type = "l",
      ylim = c(0, 10),
      xlim = c(3.65, 4.15),
      main = expression(The~PDF~"of"~italic(Y)),
      xlab = expression(italic(Y)),
      ylab = expression(PDF~"of"~italic(Y)) )
lines( x = c(3.5, 3.75),
       y = c(0, 0),
       lwd = 2)
lines( x = c(4, 4.15),
       y = c(0, 0),
       lwd = 2)
abline( v = c(3.75, 4),
        lty = 2,
        col = "grey")
```










`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Projectile).**

Given that $f(\theta) = 4/\pi$ for $0 < \theta< \pi/4$, and hence $0 < D < (v^2/g)$.
Then:
\begin{align*}
  F_D(d) = \Pr(D < d)
  &= \Pr( v^2/g\sin2\theta < d) \\
  &= \Pr(\theta < \frac{1}{2} \sin^{-1}(d g/v^2 ) \\
  &= \int_0^{\sin^{-1}(d g/v^2 )/2} \frac{4}{\pi}\, d\theta \\
  &= \frac{2}{\pi} \sin^{-1} \left( \frac{dg}{v^2} \right).
\end{align*}
So
\[
  f_D(d) = \frac{2g}{\pi}\frac{1}{\sqrt{v^4 - d^2 g^2}}\quad\text{for $0 < D < v^2 /g$}.
\]

Alternatively: see that $D = v^2\sin 2\theta/g \Rightarrow sin 2\theta = Dg/v^2$, and so
\[
  \frac{dd}{d\theta} = \frac{2v^2}{g}\cos 2\theta.
\]
Then,
\begin{align*}
  f_D(d)
  &= \frac{4}{\pi} \left| \frac{g}{2 v^2\cos 2\theta} \right|\\
  &= \frac{2g}{\pi v^2 \cos2\theta}\\
  &= \frac{2g}{\pi \sqrt{v^4 - d^2 g^2}}
\end{align*}
after (e.g.) drawing the right-angled triangle to re-write $\sin 2\theta = Dg/v^2$.
See Fig. \@ref(fig:Projectile).
:::

```{r Projectile, fig.align="center", fig.cap="The distance travelled by a projectile"}
g <- 9.8
v <- 12
dvec <- seq(0, v^2/g,
            length = 100)
pdf <- ( 2 * g / pi ) / sqrt(v^4 - dvec^2 * g^2)

plot(pdf ~ dvec,
     type = "l",
     las = 1,
     lwd = 2,
     xlab = expression(Distance~italic(d)),
     ylab = "Prob. fn.")
abline(v = v^2/g,
       col = "grey",
       lty = 2)
```
`r if( includeBriefAnswers) "-->"`








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:RandomExp).**
Proceed:
\begin{align*}
  F_Y(y)
  &= \Pr(Y \le y)\\
  &= \Pr(X \ge \exp(-y/\alpha)) \qquad\text{note the change of direction!}\\
  &= \int_{\exp(-y/\alpha)}^1 1\, dx
\end{align*}
so that $f_Y(y) = \frac{1}{\alpha} \exp(-y/\alpha)$ for $y > 0$, which is the exponential distribution.
:::
`r if( includeBriefAnswers) "-->"`








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:RandomW).**

2. $\text{E}[W] = -1/3$; $\text{var}[W] = 17/9\approx 1.8889\dots$.
3. $\Pr(V = 0) = 1/2$; $\Pr(V = 4) = 1/2$.
4. Find:
$$
  F_W(w) =
  \begin{cases}
    0 & \text{for $w < -2$};\\
    1/3 & \text{for $-2 \le w < 0$};\\
    5/6 & \text{for $0 \le w < 2$};\\
    1 & \text{for $w \ge 2$}.
  \end{cases}
$$
:::
`r if( includeBriefAnswers) "-->"`








:::{.answer}
**Answer to Exercise\ \@ref(exr:LogNormal)**.

1. First see that $Y = \log X$.
   Then:  
   \begin{align*}
     F_Y(y)
     &= \Pr(Y < y) \\
     &= \Pr( \exp X < y)\\
     &= \Pr( X < \log y)\\
     &= \Phi\big((\log y - \mu)/\sigma\big) 
   \end{align*}
   by the definition of $\Phi(\cdot)$.
2. Proceed:
   \begin{align*}
     f_Y(y) 
     &= \frac{d}{dy}  \Phi\big((\log y - \mu)/\sigma\big) \\
     &= \frac{1}{y} \Phi\big((\log y - \mu)/\sigma\big) \\
     &= \frac{1}{y\sqrt{2\pi\sigma^2}}
        \exp\left[\left(
           -\frac{ (\log y - \mu)^2}{\sigma}\right)^2\right]
   \end{align*}
   since the derivative of $\Phi(\cdot)$ (the df of a standard normal distribution) is $\phi(\cdot)$ (the pdf of a standard normal distribution).
3. See Fig. \@ref(fig:LogNormalPlots).
4. See below: About 0.883.
:::


```{r LogNormalPlots, fig.align="center", fig.cap="Log-normal distributions", out.width='100%', fig.width=9.5, fig.height = 7}
par( mfrow = c(2, 2))

x <- seq(0, 8,
         length = 500)

plot( dlnorm(x, meanlog = log(1), sdlog = 1) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      type = "l",
      main = expression(Log~normal*":"~mu==1~and~sigma==1),
      lwd = 2,
      las = 1)
plot( dlnorm(x, meanlog = log(3), sdlog = 1) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      type = "l",
      main = expression(Log~normal*":"~mu==3~and~sigma==1),
      lwd = 2,
      las = 1)
plot( dlnorm(x, meanlog = log(1), sdlog = 2) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      main = expression(Log~normal*":"~mu==1~and~sigma==2),
      type = "l",
      lwd = 2,
      las = 1)
plot( dlnorm(x, meanlog = log(3), sdlog = 2) ~ x,
      xlab = expression(italic(y)),
      ylab = "PDF",
      main = expression(Log~normal*":"~mu==3~and~sigma==2),
      type = "l",
      lwd = 2,
      las = 1)
```

```{r}
(1 - plnorm(2, meanlog=2, sdlog=2)) / 
  (1 - plnorm(1, meanlog=2, sdlog=2))
```








`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:BinomXform).**
See that $Y\in\{0, 1, \sqrt{2}, \sqrt{3}, 2\}$ and so
$$
   \Pr(Y = y) = \binom{4}{y^2} (0.2)^{y^2} (0.8)^{4 - y^2} \quad \text{for $y = 0, 1, \sqrt{2}, \sqrt{3}, 2$}.
$$
:::
`r if( includeBriefAnswers) "-->"`
`r if( includeFullAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:BinomXform).**
$\Pr(Y = y) = \binom{4}{y^2} (0.2)^{y^2} (0.8)^{4 - y^2}$
for $y = 0, 1, \sqrt{2}, \sqrt{3}, 2$.
:::
`r if( includeFullAnswers) "-->"`






`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:Xminus3).**

1. First, see the relationships:
\begin{align*}
  X = 1 &\to Y = (X - 3)^2 = 4;\\
  X = 2 &\to Y = (X - 3)^2 = 1;\\
  X = 3 &\to Y = (X - 3)^2 = 0;\\
  X = 4 &\to Y = (X - 3)^2 = 1.
\end{align*}
  So adding probabilities as appropriate:
$$
  p_Y(y) =
  \begin{cases}
     9/30  & \text{for $y = 0$}\\
     20/30 & \text{for $y = 1$}\\
     1/30  & \text{for $y = 4$}\\
     0     & \text{elsewhere}.
\end{cases}
$$
:::
`r if( includeBriefAnswers) "-->"`




:::{.answer}
**Answer to Exercise\ \@ref(exr:BetaHospital2).**

For the given beta distribution, $\text{E}(V) = 0.287/(0.287 + 0.926) = 0.2366...$ and $\text{Var}(V) = 0.08161874$.

1. $\text{E}(S) = \text{E}(4.5 + 11V) = 4.5 + 11\text{E}(V) = 7.10$ minutes.
   $\text{var}(S) = 11^2\times\text{Var}(V) = 9.875$ minutes^2^.
1. $V\in (4.5, 15.5)$.
   See Fig. \@ref(fig:ServiceTimesBeta2).
1. This corresponds to $V = 10.5/11 = 0.9545455$, so $\Pr(S > 15) = \Pr(V > 0.9545455) = 0.01745087$.
1. With $V$, the largest 20% correspond to $V = 0.004080076$, so that $S = 4.544881$; the *quickest* 20% are within 4.54 minutes.
:::


```{r ServiceTimesBeta2, fig.cap="Service times", fig.align="center"}
v <- seq(0, 1, length = 500)
stime <- 4.5 + 11 * v
  
PDFv <- dbeta(v, shape1 = 0.287, shape2 = 0.926)

plot( PDFv ~ stime,
      type = "l",
      las = 1,
      xlim = c(0, 15.5),
      ylim = c(0, 5),
      xlab = expression(italic(S)),
      ylab = "PDF",
      main = "Distribution of S",
      lwd = 2)
abline(v = 4.5,
       lty = 2,
       col = "grey",
       lwd = 2)
## Part 3
1 - pbeta( 0.9545455, shape1 = 0.287, shape2 = 0.926)

## Part 4
qbeta(0.2, shape1 = 0.287, shape2 = 0.926) + 4.5
```




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise \@ref(exr:Not1to1).**

Care is needed with the interval: it is not 1:1.

```{r Xform, echo=FALSE, fig.width = 8.5, fig.height=3.25, fig.align="center", fig.cap="Question 1", out.width='80%'}
par(mfrow = c(1, 2))

x <- seq(-1, 2, length = 100)
y <- x^2

plot( y ~ x,
      type = "l",
      lwd = 2,
      las = 1,
      ylim = c(0, 4.5),
      axes = FALSE,
      main = expression(Question~1:~italic(Y)==italic(Z)^2),
      xlab = expression(italic(Z)),
      ylab = expression(italic(Y)) )
axis(side = 1)
axis(side = 2,
     at = c(0, 1, 4),
     labels = c(expression(italic(y)==0),
                expression(italic(y)==1),
                expression(italic(y)==4) ),
     las = 1 )
box()

abline(v = 0, 
       lty = 2,
       col = "grey")
abline(h = 1, 
       lty = 2,
       col = "grey")
abline(h = 4, 
       lty = 2,
       col = "grey")
abline(h = 0, 
       lty = 2,
       col = "grey")
points(x = c(-1, 1, 2),
       y = c(1, 1, 4),
       pch = 19)




###

yLO <- seq(0, 1, length = 100)
yHI <- seq(1, 4, length = 100)
fyLO <- 1 / (3 * sqrt(yLO) )
fyHI <- 1 / (6 * sqrt(yHI) )

plot( c(fyLO, fyHI) ~ c(yLO, yHI),
      type = "n",
      las = 1,
      ylim = c(0, 2),
      main = expression(Question~1:~Density~of~italic(Y)),
      xlab = expression(italic(Y)),
      ylab = "Prob. density" )
lines( fyLO ~ yLO,
       lwd = 2)
lines( fyHI ~ yHI,
       lwd = 2)
abline( v = 1, 
        lty = 1,
        col = "grey")
abline( h = 0, 
        lty = 1,
        col = "grey") 

```

1. Note that $Y$ is defined over $0 < Y < 4$, and the transformation is **not** a 1:1 transformation (Fig.\ 1, left panel) over these values.
   To use **the distribution function method**, see that $0 < y < 1$ corresponds to $-\sqrt{Y} < z < \sqrt{Y}$, but $1 \le y \le 4$ corresponds to $-1 < z <\sqrt{Y}$.
   For $y < 1$:  
$$
  F_Y(y) = \Pr(Y \le y) = \Pr(-\sqrt{y} < z < \sqrt{y}\,) = \int_{-\sqrt{y}}^{\sqrt{y}} \frac{1}{3}\, dz = \frac{2\sqrt{y}}{3}\quad \text{for $0 < y < 1$}.
$$
  For $1 < y < 4$, start by writing $F_Y(y) = \Pr(Y \le y)$, but then take care to include $\Pr(Y < 1)$!  
$$
  F_Y(y) 
  =  \Pr(Y \le 1) + \Pr(1 < Y < y) 
  = \frac{2}{3} + \Pr(1 < z < \sqrt{y}\,)
  =  \frac{2}{3} + \int_{1}^{\sqrt{y}} \frac{1}{3}\, dz = \frac{1 + \sqrt{y}}{3}.
$$
   Hence (noting carefully where $y = 1$ in the pdf),  
$$
  F_Y(y) = 
  \begin{cases}
    0 & \text{for $y \le 0$};\\
    \frac{2\sqrt{y}}{3} & \text{for $0 \le y < 1$};\\
    \frac{1 + \sqrt{y}}{3} & \text{for $1 \le y < 4$};\\
    1 & \text{for $y \ge 4$}
  \end{cases}
  \quad\text{so differentiating:}\quad
  f_Y(y) = 
  \begin{cases}
    \frac{1}{3\sqrt{y}} & \text{for $0 < y < 1$};\\
    \frac{1}{6\sqrt{y}} & \text{for $1 \le y < 4$};\\
    0 & \text{elsewhere}.
  \end{cases}
$$
2. For all values of $Y$, the pdf is non-negative. 
   In addition, $\int_Y f_Y(y)\, dy = 1$.
3. See  Fig.\ \@ref(fig:Xform) (right panel).
:::
`r if( includeBriefAnswers) "-->"`



<!-- ************************************************************************************ -->
## Answers for Chap. 8 {#AnswersChap8}

  

`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:CLTProb).**

$\text{E}(Y) = \int_0^1 y(3y^2)\, dy = 3/4$.
$\text{E}(Y^2) = 3/5$, so $\text{Var}(Y) = 3/80$. 
By the CLT, $\overline{Y}\sim N(3/4, 3/(80n) )$. 
Therefore  
\[
   \Pr\left( 3/4 - \sqrt{3/80} < \overline{Y} < 3/4 + \sqrt{3/80} \right)
   = \Pr\left( 0.56 < \overline{Y} < 0.94 \right)
\]
is needed. For a sample of size $n$,  
\[
   \Pr\left( \frac{0.56 - 0.75}{0.19/\sqrt{n}} < Z < \frac{0.56 - 0.75}{0.19/\sqrt{n}} \right)
   = \Pr(-\sqrt{n} < Z < \sqrt{n} )
\]
which approaches one as $n\to\infty$.
For example, if $n = 10$, $\Pr(-\sqrt{10} < Z < \sqrt{10} ) = 0.9984$.
:::
`r if( includeBriefAnswers) "-->"`




`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:EggsVariance).**

Let the weight be $E$, so $E\sim N(59, 0.7)$. 
By the CLT, the sample mean $\overline{E} \sim N(59, 0.7/20)$. 
So  
\[
   \Pr(\overline{E} > 59.5)
   = \Pr(Z > \frac{59.5 - 59}{\sqrt{0.7/20}})
   = \Pr(z > 2.67)
   \approx  0.003792562.
\]
1. We seek $\Pr(s^2 > 1)$. 
   Since  
\[
   \frac{(n - 1)s^2}{\sigma^2}\sim \chi^2_{n - 1}
\]
where $n = 12$ and $\sigma^2 = 0.7$. 
So  
\begin{align*}
   \Pr(s^2 > 1)
   &= \Pr\left( \frac{11 s^2}{0.7} > \frac{11\times 1}{0.7} \right)\\
   &=\Pr( \chi^2_{11} > 15.714)\\
   &\approx 0.152.
\end{align*}
:::
`r if( includeBriefAnswers) "-->"`



`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:EggsBroken).**

Let the number broken be $B$, so $B \sim \text{Pois}(0.2)$. 

1. The sample mean number (with $n = 20$) broken has the distribution $\overline{B}\sim N(0.2, 0.2/20)$ approx. 
So  
\[
   \Pr(B\ge 1) 
   = \Pr\left( Z > \frac{1 - 0.2}{\sqrt{0.2/20}} \right)
   = \Pr(Z > 8) = 0.
\]
1. In contrast, in any *single* carton, the probability of more than one broken egg is  
\[
   \Pr(B > 1) = 1 - \Pr(B = 0) = 1 - 0.8187 = 0.181
\]
using the Poisson distribution.
:::
`r if( includeBriefAnswers) "-->"`



`r if( includeBriefAnswers) "<!--"`
:::{.answer}
**Answer to Exercise\ \@ref(exr:ContRVM).**
  
1. $\text{E}(M) = 3/4$.
1. $\text{var}(M) = 3/80$.
1. $\overline{M}\sim N(3/4, 1/240)$.
1. $0.8788$.
:::
`r if( includeBriefAnswers) "-->"`


  

<!-- ************************************************************************************ -->
<!--
## Answers for Chap. 9 {#AnswersChap9}


:::{.answer}
**Answer to Exercise\ \@ref(exr:Reproduction).**

1. $f(\theta| y)\propto f(y\mid\theta)\times f(\theta)$, where (given):  
  \[
    f(y\mid \theta) = (1 - \theta)^y\theta
    \quad\text{and}\quad
    f(\theta) = \frac{\theta^{m - 1}(1 - \theta)^{n - 1}}{B(m, n)}.
  \]
  Combining then:  
  \[
     f(\theta| y)\propto \theta^{(m + 1) - 1} (1 - \theta)^{(n + y) - 1}.
  \]
   which is a beta distribution with parameters $m + 1$ and $n + y$.
2. Prior: $\text{E}(\theta) = m / (m + n) = 1.2/(1.2 + 2) = 0.375$.
   So then, $\text{E}(Y) = (1 - p)/p = 1.667$.
3. Posterior: $\text{E}(\theta) = (m + 1)/(m + 1 + n + y) = 0.3056$; slightly reduced.
:::
-->
  


















<!-- Restore size of captions -->
`r if( knitr::is_latex_output() ) "\\captionsetup{font=normalsize}"`

