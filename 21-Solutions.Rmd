
# Solutions

## Answers for Chap. 1

:::{.answer}
**Answer to Exercise \@ref(exr:BasicProbs).**

1. Probably the Venn diagram.
1. $\Pr(A\cup B) = \Pr(A) + \Pr(B) = \Pr(A\cap B) = 0.66$.
1. $0.13$.
1. $0.89$.
1. $0.11/0.24 \approx 0.4583...$
1. $\Pr(A) \times \Pr(B) = 0.53\times 0.24 = 0.1272 \ne \Pr(A\cap B) = 0.11$; not independent... but close!
:::





:::{.answer}
**Answer to Exercise \@ref(exr:DrawNumbers).**

1. $(50/100)\times (49/99)\times (48/98)\times (47/97) \approx 0.0578$.
1. $^{50}C_2\times ^{50}C_2 / ^{100}C_4 / = 1225/3201 \approx 0.3826$.
1. $\Pr(\text{at least 2 odd before 1st even}) = \Pr(\text{odd, odd, even, either}) + \Pr(\text{odd, odd, odd, even)} = (50/100)\times(49/99)\times(50/98) + (50/100)\times (49/99)\times(48/98)\times(50/97) \approx 0.1887$.
1. $\Pr(\text{sum odd}) = \Pr(\text{exactly 1 odd number drawn, OR exactly 3 odd numbers drawn}) = \displaystyle{\frac{1600}{3201}}$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:Quadratic).**

1. $S = \{ (a,b,c) \mid a\in(-\infty, 0)\cap (0, \infty), -\infty < b < \infty, -\infty < c < \infty\}$.
1. The solutions to a quadratic equation are given by
\[
   x = \frac{-b \pm \sqrt{b^2 - 4ac} }{2a}.
\]
For two equal roots, $b^2 - 4ac = 0$, so event $R$ is defined as $R = \{ (a,b,c) \mid b^2 - 4ac = 0, a\ne 0 \}$.
1. For no real roots, $b^2 - 4ac < 0$, so event $Z$ is defined as $Z = \{ (a,b,c) \mid b^2 - 4ac < 0, a\ne 0\}$.
:::



:::{.answer}
**Answer to Exercise \@ref(exr:GreenLights).**

1. The length of time (in seconds) between green lights at the intersection, say $G$.
2. $S = \{G \mid 15 \le G \le 150\}$.
3. No---no equally likely events are defined.
4. The probability can be *approximated*---observe the lights many times, and count how often there is less than 90 seconds between green
lights.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:Cricket).**

1. $C^7_5 \times C^5_4 \times C^2_1 \times C^1_1 = 210$.
2. $11^2 + (2\times 22) = 165$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:WalkScore).**
???
:::




:::{.answer}
**Answer to Exercise \@ref(exr:HatData).**

Tree diagram: Fig, \@ref(fig:HatTree); table: Table \@ref(tab:HatTable); Venn diagram: Fig. \@ref(fig:HatVenn).
:::


```{r HatTree, echo=FALSE, fig.align="center", fig.cap="Tree diagram for the hat-wearing example", fig.width=6.5, fig.height=4, out.width='70%'}

plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      main = "Tree diagram for the hat data",
      xlab = "",
      ylab = "",
      axes = FALSE)
#STEP 1
lines( x = c(0.2, 0.40),
       y = c(0.5, 0.75),
       lwd = 2)
lines( x = c(0.2, 0.40),
       y = c(0.5, 0.25),
       lwd = 2)
# STEP 2
lines( x = c(0.60, 0.80),
       y = c(0.75, 0.90),
       lwd = 2)
lines( x = c(0.60, 0.80),
       y = c(0.75, 0.60),
       lwd = 2)

lines( x = c(0.60, 0.80),
       y = c(0.25, 0.40),
       lwd = 2)
lines( x = c(0.60, 0.80),
       y = c(0.25, 0.10),
       lwd = 2)

# TEXT
text(x = 0.50,
     y = 0.75,
     labels = "Males")
text(x = 0.50,
     y = 0.25,
     labels = "Females")

text(x = 0.90,
     y = 0.90,
     labels = "Hat")
text(x = 0.90,
     y = 0.60,
     labels = "No hat")

text(x = 0.90,
     y = 0.40,
     labels = "Hat")
text(x = 0.90,
     y = 0.10,
     labels = "No hat")

# ADD PROBS
text(x = 0.38,
     y = 0.63,
     cex = 0.9,
     labels = "0.513")
text(x = 0.38,
     y = 0.37,
     cex = 0.9,
     labels = "0.487")

text(x = 0.65,
     y = 0.84,
     cex = 0.9,
     labels = "0.205")
text(x = 0.65,
     y = 0.66,
     cex = 0.9,
     labels = "0.795")

text(x = 0.65,
     y = 0.34,
     cex = 0.9,
     labels = "0.060")
text(x = 0.65,
     y = 0.16,
     cex = 0.9,
     labels = "0.940")

## STEPS
text(x = 0.50,
     y = 0.01,
     label = expression(bold("Step 1"))
     )
text(x = 0.90,
     y = 0.01,
     label = expression(bold("Step 2"))
     )
```


```{r HatTable, echo=FALSE}
BRIS <- read.csv("Data/sunglasses.csv")
BRIS$Gender <- factor(BRIS$Gender,
                      levels = c(1, 2),
                      labels = c("Males", 
                                 "Females"))
BRIS$Hat <- factor(BRIS$Hat,
                   levels = c(0, 1),
                   labels = c("Not Hat",
                              "Hat"))

HatTable <- xtabs( Count ~ Gender + Hat,
                   data = BRIS)
HatTable <- cbind( HatTable,
                   "Total" = rowSums(HatTable) )
knitr::kable(HatTable,
             caption = "The numbers of males and females wearing a hat in the middle of the day in Brisbane")
```



```{r HatVenn, echo=FALSE, fig.width=7, fig.height=7, out.width='70%', fig.align="center", fig.cap="The hat-wearing data as a Venn diagram"}
par( mfrow = c(2, 2))
colourMale <- rgb(0, 0, 255, 
                  max = 255, 
                  alpha = 125)
colourHat  <- rgb(0, 255, 0, 
                  max = 255, 
                  alpha = 125)

plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      ylab = "",
      xlab = "",
      main = expression(paste("Events ", italic(M), " and ", bar(italic(M)))),
      axes = FALSE)

polygon( x = c(0, 0, 1, 1),
         y = c(0, 1, 1, 0))
plotrix::draw.circle(x = 0.4, 
                     y = 0.5,
                     radius = 0.2,
                     col = colourMale)
text(x = 0.4,
     y = 0.5,
     labels = expression(paste(italic(M), ": 307")))
text(x = 0.8,
     y = 0.5,
     labels = expression(paste(bar(italic(M)), ": 366")))
mtext(text = expression(italic(S)),
      side = 1,
      adj = 0.25)


###############


plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      ylab = "",
      xlab = "",
      main = expression(paste("Events ", italic(H), " and ", bar(italic(H)))) ,
      axes = FALSE)


polygon( x = c(0, 0, 1, 1),
         y = c(0, 1, 1, 0))

plotrix::draw.circle(x = 0.6,
                     y = 0.5,
                     radius = 0.2,
                     col = colourHat)

text(x = 0.6,
     y = 0.5,
     labels = expression(paste(italic(H), ": 101")))
text(x = 0.2,
     y = 0.5,
     labels = expression(paste( bar(italic(H)), ": 651")))

mtext(text = expression(italic(S)),
      side = 1,
      adj = 0.25)


####################


plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      ylab = "",
      xlab = "",
      main = expression(paste("Events ", italic(M), " and ", italic(H))) ,
      axes = FALSE)


polygon( x = c(0, 0, 1, 1),
         y = c(0, 1, 1, 0))
plotrix::draw.circle(x = 0.4, 
                     y = 0.5,
                     radius = 0.2,
                     col = colourMale)
plotrix::draw.circle(x = 0.6,
                     y = 0.5,
                     radius = 0.2,
                     col = colourHat)
text(x = 0.3,
     y = 0.5,
     labels = expression(italic(M)))
text(x = 0.7,
     y = 0.5,
     labels = expression(italic(H)))
mtext(text = expression(italic(S)),
      side = 1,
      adj = 0.25)


#################



plot( x = c(0, 1),
      y = c(0, 1),
      type = "n",
      ylab = "",
      xlab = "",
      main = "The numbers in each section",
      axes = FALSE)


polygon( x = c(0, 0, 1, 1),
         y = c(0, 1, 1, 0))
plotrix::draw.circle(x = 0.4, 
                     y = 0.5,
                     radius = 0.2,
                     col = colourMale)
plotrix::draw.circle(x = 0.6,
                     y = 0.5,
                     radius = 0.2,
                     col = colourHat)
text(x = 0.3,
     y = 0.5,
     labels = "307")
text(x = 0.7,
     y = 0.5,
     labels = "22")
text(x = 0.7,
     y = 0.85,
     labels = expression(bar(italic(M)) ~ intersect() ~ bar(italic(H)) ~ ": 344") )
mtext(text = expression(italic(S)),
      side = 1,
      adj = 0.25)

# Intersection
text(x = 0.5, 
     y = 0.5, 
     label = "79")

```



:::{.answer}
**Answer to Exercise \@ref(exr:CarPassengers).**
1. Choose one driver, and the other seven passengers can sit anywhere:
   $2!\times 7! = 10080$.
1. Choose one driver, and the other seven passengers can sit anywhere:
   $3!\times 7! = 30240$.
1. Choose one driver, choose who sits in what car sets, and the other five passengers can sit anywhere:
   $2!\times 2! \times 5! = 480$.

:::



:::{.answer}
**Answer to Exercise \@ref(exr:MatchingBrackets).**
1. `()()` and `(())`. 
   There are two ways.
1. `()()()` and `(())()` and `()(())` and `((()))` and `(()())`. 
   There are five ways.
1. $\displaystyle \frac{1}{n + 1} \binom{2n}{n} = \frac{1}{n + 1}\frac{(2n)!}{n!n!}  = \frac{1}{(n + 1)!} \frac{(2n)!}{n!}$ as to be shown.
1. Write as $\displaystyle \frac{(2n)!}{n!\, n!} - \frac{(2n)!}{(n + 1)! (2n - n - 1)!}$.
   Simplifying: 
\begin{align*}
     \frac{(2n)!}{n!\, n!} - \frac{(2n)!}{(n + 1)! (n - 1)!}
   &= \frac{(2n)!}{n!\, n!} - \left( \frac{n}{n + 1}\right) \frac{(2n)!}{n!\,n!}\\
   &= \binom{2n}{n}\left(1 - \frac{n}{n + 1}\right) \\
   &= \frac{1}{n + 1} \binom{2n}{n}
\end{align*}
1. The first nine Catalan numbers, for $n = 0, \dots 8$, are $1, 1, 2, 5, 14, 42, 132, 429, 1430$
:::



:::{.answer}
**Answer to Exercise \@ref(exr:CompareMeansStress).**

????
:::






:::{.answer}
**Answer to Exercise \@ref(exr:Stirling).**

```{r fig.cap="Relative error of Stirling's approximation", fig.align="center", out.width="70%"}
# Define a function to compute Stirling numbers:
stirling <- function(n){ 
  sqrt(2 * pi *n) * (n/exp(1))^n
}

n <- 1:10
Actual <- factorial(n) 
Approx <- stirling(n)
RelError <- (Actual - Approx)/Actual * 100

cbind(Actual, Approx, RelError)

plot(RelError ~ n,
     ylim = c(0, 8),
     las = 1, 
     type = "b",
     pch = 19,
     lwd = 2,
     xlab = expression(italic(n)),
     ylab = "Relative error (%)",
     main = "Relative error of\nStirling's approximation")
```
:::




:::{.answer}
**Answer to Exercise \@ref(exr:DiceGame).**

1. $\Pr(\text{Player throwing first wins})$ means $\Pr(\text{First six on throw 1 or 3 or 5 or ...})$. So: $\Pr(\text{First six on throw 1}) + \Pr(\text{First six on throw 3}) + \cdots$.
   This produces a geometric progression that can be summed obtained (see App \@ref(UsefulSeries)).
2. Use Theorem \@ref(thm:TotalProb).
   Define the events $A = \text{Player 1 wins}$, $B_1 = \text{Player 1 throws first}$, and $B_2 = \text{Player 1 throws second}$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:RandomisedResponse).**

1. Use Theorem \@ref(thm:TotalProb) to find $\Pr(Y)$.
2. $Y$ = \{Yes\}, $D$ = \{Student has used illegal drugs in last 12 months\}, $\overline{D}$ = \{student hasn't used illegal drugs in last 12 months\}.
3. $\displaystyle \Pr(D)= \frac{N\Pr(Y) - [N - m]}{2m - N}$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:MCExam).**

Use Theorem \@ref(thm:TotalProb) to find $\Pr(C)$ where $C = \text{select correct answer}$, $K = \text{student knows answer}$. 
Then, $\Pr(C)  =\displaystyle {\frac{mp + q}{m}}$
:::


:::{.answer}
**Answer to Exercise \@ref(exr:MCExam).**

Use Theorem \@ref(thm:TotalProb) to find $\Pr(C)$ where $C = \text{select correct answer}$, $K = \text{student knows answer}$. 
Then, $\Pr(C)  =\displaystyle {\frac{mp + q}{m}}$
:::



:::{.answer}
**Answer to Exercise \@ref(exr:EPL).**
???
:::


:::{.answer}
**Answer to Exercise \@ref(exr:Newsletter).**

1. Anywhere between 0% and 8%.
1. $0.06/0/30 = 0.20$.
1. $0.06/0.08 = 0.75$.
1. $0.06$, as given in the question!
:::


:::{.answer}
**Answer to Exercise \@ref(exr:SchoolChildren).**
The total number of children: $69,279$.
Define $N$ as 'a first-nations student', $F$ as 'a female student', and $G$ as 'attends a government school'.
1. $(2540 + 2734 + 391 + 362) / 69,279 \approx 0.0870$.
1. $49,067/69,279 \approx 0.708$.
1. Many ways to approach this. For **government schools** only: 
$\Pr(F\mid N) = 2540/(2540 + 2734) \approx 0.4816$.
$\Pr(\bar{F} \mid N)  = 2734/(2540 + 2734) \approx 0.5184$.
These are---*very* roughly--about the same, so *approximately* independent.
1. Many ways to approach this. For **non-government schools** only: 
$\Pr(F\mid N) = 391/(391 + 9496)  \approx 0.0395$.
$\Pr(\bar{F} \mid N)  = 362/(391 + 9496) \approx 0.0366$.
These are---*very* roughly--about the same, so *approximately* independent.
1. MAKES NO SENSE!!
1. MAKES NO SENSE!!
0:::



:::{.answer}
**Answer to Exercise \@ref(exr:CombinSimplify).**
$\binom{25}{8}/binom{26}{6} = (25!\, 6!\, 19!)/(8!\,17!\,25!) = 171/28$.
:::



:::{.answer}
**Answer to Exercise \@ref(exr:CombinSolve).**
$n\left( {}^{n - 1}P_{r - 1} \right) = n\left((n - 1)!/\left( (n - 1) - (r - 1)\right)!\right) = n!/(n - r)! = {}^nP_r$.

???
:::


:::{.answer}
**Answer to Exercise \@ref(exr:CombinSolve2).**
\begin{align*}
   \frac{ {}^7 P_{r + 1}}{ {}^{7}C_r}
   &= \frac{7!}{(7 - (r + 1))!} \times \frac{(7 - r)!\, r!}{7!}\\
   &= \frac{7!}{(6 - r)!} \times \frac{(7 - r)!\, r!}{7!}\\
   &= \frac{(7 - r)!\, r!}{(6 - r)!}\\
   &= \frac{(7 - r)\times (6 - r)!\, r!}{(6 - r)!}\\
   &= (7 - r) r!\\
   &= 10.
\end{align*}
Rewrite: $r! = 10/(7 - r)$.
Since $r!$ is a positive integer, $r$ must be either $r = 2$ or $r = 5$.
Trying both, clearly $r = 2$.
:::


## Answers for Chap. 2

:::{.answer}
**Answer to Exercise \@ref(exr:SSpaceRV).**

1. $R_X = \{X \mid x \in (0, 1, 2) \}$; discrete.
2. $R_X = \{X \mid x \in (1, 2, 3\dots) \}$; discrete.
3. $R_X = \{X \mid x \in (0, \infty) \}$; continuous.
4. $R_X = \{X \mid x \in (0, \infty) \}$; continuous.
5. $R_X = \{X \mid x \in (0, 1, 2, \dots) \}$; discrete.
6. $R_X = \{X \mid x \in (0, 1, 2, \dots) \}$; discrete.
7. $R_X = \{X \mid x \in (0, \infty) \}$; continuous.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:DFdiscrete).**

1. $\displaystyle F_X(x) = 
   \begin{cases}
      0   & \text{for $x < 10$};\\
      0.3 & \text{for $10 \le x < 15$};\\
      0.5 & \text{for $15 \le x < 20$};\\
      1   & \text{for $x \ge 20$}.
    \end{cases}$
1. $\Pr(X > 13) = 1 - F_X(13) = 0.7$.
1. $\Pr(X \le 10 \mid X\le 15) = \Pr(X \le 10) / \Pr(X \le 15) = F_X(10)/F_X(15) = 0.3/0.5 = 0.6$.
:::



:::{.answer}
**Answer to Exercise \@ref(exr:DFcontinuous).**

1. $\displaystyle F_Z(z) = 
    \begin{cases}
        0                     &  \text{for $z \le -1$};\\
        6z/15 - z^2/15 + 7/15 & \text{for $-1 < z < 2$};\\
        1                     & \text{for $z \ge 2$}.
    \end{cases}$
1. $\Pr(Z < 0) = F_Z(0) = 7/15$.
:::



:::{.answer}
**Answer to Exercise \@ref(exr:DFdiscreteBackwards).**

1. $\displaystyle
   p_W(w) = \begin{cases}
               0.3 & \text{for $w = 10$};\\
               0.4 & \text{for $w = 20$};\\
               0.2 & \text{for $w = 30$};\\
               0.1 & \text{for $w = 40$};\\
               0   & \text{elsewhere}.
            \end{cases}$
1. $\Pr(W < 25) = 0.7$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:DFcontinuousBackwards).**

1. $\displaystyle
   f_Y(y) = \begin{cases}
               (4/3) - y^2 & \text{for $0 < y < 1$};\\
               0 & \text{elsewhere}.
            \end{cases}$
1. $\Pr(Y < 0.5) = 0.625$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:Chlorine).**
1. Easiest to draw, and see that this represents a *triangular distribution*, and find the area of the said triangle.
Integration can be used though.
2. PDF:
\[
   f_X(x) = 
   \begin{cases}
      \frac{2}{8.8\times 4.1} (x - 0.6) & \text{for $0.6 < x < 5$};\\
      \frac{2}{8.8\times 4.4} (9.4 - x) & \text{for $5 < x < 9.4$}.
   \end{cases}
\]
:::


:::{.answer}
**Answer to Exercise \@ref(exr:TriangularHospital).**
:::



:::{.answer}
**Answer to Exercise \@ref(exr:Exceedance).**
:::

```{r echo=FALSE}
Rain12 <- read.csv("Data/IDCJAC0001_044021/IDCJAC0001_044021_Data12.csv", 
                   na.strings = "null")
RainDec <- Rain12$Dec
RainJun <- Rain12$Jun

breaks <- c( 0, 0.01, 20,
             seq(40, 220, by = 20) )
outDec <- hist(RainDec,
               breaks = breaks,
               plot = FALSE)
outJun <- hist(RainJun, 
               breaks = breaks,
               plot = FALSE)

Buckets <- c("Zero", 
           "0 < R < 20",
           "20 <= R < 40",
           "40 <= R < 60",
           "60 <= R < 80",
           "80 <= R < 100",
           "100 <= R < 120",
           "120 <= R < 140",
           "140 <= R < 160",
           "160 <= R < 180",
           "180 <= R < 200",
           "200 <= R < 220")

cbind("Buckets" = Buckets,
      "Jun" = outJun$counts,
      "Dec" = outDec$counts)

exceedanceJun <-  ( sum(outJun$counts) - cumsum(outJun$counts) ) / sum(outJun$counts)
exceedanceDec <-  ( sum(outDec$counts) - cumsum(outDec$counts) ) / sum(outDec$counts)

plot( exceedanceJun ~ breaks[1:12], 
      type = "b",
      xlab = "Rainfall (in mm)",
      ylab = "Exceedance probability",
      main = "Charleville",
      ylim = c(0, 1.1),
      lwd = 2,
      lty = 1,
      pch = 19,
      las = 1)
lines( exceedanceDec ~ breaks[1:12], 
       type = "b",
      pch = 1,
      lty = 2,
      las = 1)
legend("topright",
       lwd = 2,
       pch = c(19, 1),
       lty = c(1, 2),
       legend = c("June",
                  "December"))
```

:::{answer}
**Answer for Exercise \@ref(exr:YouFriendInLine).**

Suppose I stand at Position 1; my friend can be at Positions 2 to 5, with distances 1, 2, 3 4.
Similar if I stand at Position 5.

Suppose I stand at Position 2; my friend can be at Positions 1, 3 to 5, with distances 1, 1, 2, 3.
Similar if I stand at Position 4.

Suppose I stand at Position 3; my friend can be at Positions 1, 2, 4, 5, with distances 1, 2, 2, 1.

So counting, the pdf for the distance $D$ is:

\[
   f_D(d) = 
   \begin{cases}
      4/10 & \text{for $d = 1$};\\
      3/10 & \text{for $d = 2$};\\
      2/10 & \text{for $d = 3$};\\
      1/10 & \text{for $d = 4$};\\
         0 & \text{elsewhere}.
   \end{cases}
\]
:::


:::{answer}
**Answer for Exercise \@ref(exr:Continuous1).**
:::


:::{answer}
**Answer for Exercise \@ref(exr:Discrete1).**
:::


:::{answer}
**Answer for Exercise \@ref(exr:Quartic).**
:::



:::{answer}
**Answer for Exercise \@ref(exr:Continuous2).**
:::



:::{answer}
**Answer for Exercise \@ref(exr:CardDistance).**
:::



:::{answer}
**Answer for Exercise \@ref(exr:BenfordsLaw).**
:::



:::{answer}
**Answer for Exercise \@ref(exr:Arcsine).**
:::


:::{answer}
**Answer for Exercise \@ref(exr:DFExpInverse).**

The pdf is
\[
   f_X(x) 
   = \frac{d}{dx} \exp(-1/x) 
   = \frac{\exp(-1/x)}{x^2}
\]
for $x > 0$.
See Fig. \@ref(fig:PlotDFExpInverse).
:::

```{r PlotDFExpInverse, echo=FALSE}
par( mfrow = c(1, 2))

f1 <- function(x){
  fy <- array(0, dim = length(x))
  fy <- ifelse(x > 0,
               exp(-1/x) / x^2,
               0)
  fy
}

x <- seq(-0.5, 5, length = 100)

plot( f1(x) ~ x,
      type = "l",
      lwd = 2,
      xlab = expression(italic(x)),
      ylab = expression(italic(f)(italic(x))),
      las = 1)



F1 <- function(x){
  fy <- array(0, dim = length(x))
  fy <- ifelse(x > 0,
               exp(-1/x),
               0)
  fy
}

x <- seq(-0.5, 8, length = 100)

plot( F1(x) ~ x,
      type = "l",
      lwd = 2,
      ylim = c(0, 1),
      xlab = expression(italic(x)),
      ylab = expression(italic(F)(italic(x))),
      las = 1)


```


:::{answer}
**Answer for Exercise \@ref(exr:PooledTest).**

$\Pr(\text{Pooled test is positive})$ 
${}={}$
$1 - \Pr(\text{Pooled test is negative})$ 
${}={}$
$1 - \Pr(\text{All individuals are negative})$ 
${}={}$
$1 -(0.9)^ 4 = 0.3439$.
So the pmf of $X$, whether the pooled test returns negative (i.e., $x = 0$) or positive (i.e., $x = 1$), is

\[
  p_X(x) = 
  \begin{cases}
     0.6561 & \text{for $x = 0$ (i.e., the pooled test is negative)};\\
     0.3439 & \text{for $x = 1$ (i.e., the pooled test is positive)}.
  \end{cases}
\]
:::



## Answers for Chap. 3


:::{.answer}
**Answer for Exercise \@ref(exr:C3ContA).**

1. $k = -3/2$.
2. See Fig. \@ref(fig:PDFY).
3. $\text{E}(Y) = ???$.
4. ???.
5. $\Pr(X > 1.5) = \int_{1.5}^2 f_Y(y)\, dy = ???$.

```{r, PDFY, echo=FALSE, fig.align="center", fig.cap="The pdf for Y", out.width='70%'}
xx <- seq(0, 3, 
          length = 500)
fy <- function(x){
  y <- 2*x - 3/2
  y <- ifelse(x < 1, 0, y)
  y <- ifelse( x > 2, 0, y)
  y
}

plot(x = xx,
     y = fy(xx),
     lwd = 2,
     type = "l",
     las = 1,
     main = expression("PDF for"~italic(D)),
     xlab = expression(italic(D)),
     ylab = "Prob. fn")
```

:::


:::{.answer}
**Answer to Exercise \@ref(exr:C3DiscreteA).**

$k = 1/4$.

1. $\text{E}(D) = 1.75$, $\text{var}(D) = 0.6875$.
1. $M_D(t) = \exp(t)/2 + \exp(2t)/4 + \exp(3t)/4$.
:::


:::{answer}
**Answer for Exercise \@ref(exr:YouFriendInLine).**

Using the pmf from Exercise \@ref(exr:YouFriendInLine):

\[
   \text{E}(X) = 
   \left(1\times\frac{4}{10}\right) + 
   \left(2\times\frac{3}{10}\right) + 
   \left(3\times\frac{2}{10}\right) + 
   \left(4\times\frac{1}{10}\right) = 2.
\]
In **R**:
```{r echo=TRUE}
set.seed(777023)

dist <- array(NA, dim = 1000)
for (i in (1:1000)){
  positions <- sample(1:5, 
                      size = 2, 
                      replace = FALSE)
  dist[i] = abs(diff(positions))
}
mean(dist)
```
:::



:::{.answer}
**Answer to Exercise \@ref(exr:C3DiscreteB).**

1. $M_Z'(t) = 0.6\exp(t)[0.3\exp(t) + 0.7]$ so $\text{E}(Z) = 0.6$.
Also, $M''_Z(t) = 0.18\exp(2t) + 0.6\exp(t)[0.3\exp(t) + 0.7]$ so $\text{E}(Z^2) = 0.78$, so $\text{var}(Z) = 0.42$ (be careful with the derivatives here!)
2. Expand the quadratic and find: $\Pr(Z = 0) = 0.49$, $\Pr(Z = 1) = 0.42$, $\Pr(Z = 2) = 0.09$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:C3MGFA).**

1. $M'_G(t) = \alpha\beta(1 - \beta t)^{-\alpha - 1}$ so $\text{E}(G) = \alpha\beta$.
   $M''_G(t) = \alpha\beta^2(\alpha + 1)(1 - \beta t)^{-\alpha - 2}$ so $\text{E}(G^2) = \alpha\beta^2(\alpha + 1)$ and $\text{var}(G) = \alpha\beta^2$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:C3Moments).**

1. \[ 
\mu'_r = \text{E}(X^r) = \int_{x = 0}^1 x^r 2(1 - x)\, dx = 2\left[ \left(\frac{x^{r + 1}}{r + 1} - \frac{x^{r + 2}}{r + 2}\right)\Big|_{0}^{1}\right] = 2\left[ \frac{1}{r + 1} - \frac{1}{r + 2}\right]
\].
1. Expanding, $\text{E}((X + 3)^2) = \text{E}(X^2) + 6\text{E}(X) + 9$.
   Now, $\text{E}(X) = \mu'_1 = 1/3$ from above, and $\text{E}(X^2) = \mu'_2 = 1/6$ from above.
   Hence $\text{E}((X + 3)^2) = 67/6$.
1. $\text{var}(X) = \text{E}(X^2) - \text{E}(X)^2 = 1/18$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:C3Cauchy).**

1. See Fig. \@ref(fig:Cauchy) (left panel).
1. Evaluate $F_X(t) = \displaystyle \int_{-\infty}^t \frac{1}{\pi(1 + x^2)}\,dx = \frac{1}{\pi}\arctan(x) + \frac{1}{2}$.
   See Fig. \@ref(fig:Cauchy) (right panel).
1. $\displaystyle \text{E}(X) =  \int_{-\infty}^t \frac{x}{\pi(1 + x^2)}\,dx = ...$, which is not defined.
:::

```{r Cauchy, echo=FALSE, fig.align="center", fig.cap="The Cauchy distribution", fig.height=4, fig.width=7,out.width='70%'}
par( mfrow = c(1, 2))
x <- seq(-5, 5,
         length = 100)
y <- 1 / (pi * (1 + x^2))
plot(y ~ x,
     lwd = 2,
     las = 1,
     type = "l",
     main = "Density function for\nthe Cauchy distribution",
     xlab = expression(italic(X)),
     ylab = "Density function")

Y <- atan(x)/pi + 0.5
plot(Y ~ x,
     lwd = 2,
     las = 1,
     ylim = c(0, 1),
     type = "l",
     main = "Distribution function for\nthe Cauchy distribution",
     xlab = expression(italic(X)),
     ylab = "Distribution function")
```



:::{.answer}
**Answer to Exercise \@ref(exr:SkewDiscreteCentralMomentsZero).**

Begin with Definition \@ref(def:MGF) for $M_X(t)$ and use fact that if a distribution is symmetric about 0 then $f_X(x) = f_X(-x)$ using symmetry. 
Transform the resulting integral.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:PooledTest2_.**

$\Pr(\text{Need individual tests})$ 
${}={}$
$\Pr(\text{Pooled test is positive})$ 
${}={}$
$1 - \Pr(\text{Pooled test is negative})$ 
${}={}$
$1 - \Pr(\text{All individuals are negative})$ 
${}={}$
$1 -(0.9)^ 4 = 0.3439$.
So the pmf of $N$, the number if tests needed, is

\[
  p_N(n) = 
  \begin{cases}
     0.6561 & \text{for $n = 1$ (i.e., pooled test only)};\\
     0.3439 & \text{for $n = 5$ (i.e., one pooled test, olus four individual tests)}
  \end{cases}
\]
Then $\text{E}(X) = (0.6561 \times 1) + (0.3439 \times 5) = 2.3756$ and
$\text{E}(X^2) = (0.6561 \times 1^2) + (0.3439 \times 5^2) =  9.2536$ so that $\text{var}(X) = 3.610125$.
So for a pool of four people, rather than four tests we would expected to have to conduct 2.3756 tests, a saving of $4 - 2.3756 = 1.6244$ tests.

If 200 people in total, testing each individual would cost $200\times 15 = \$3000$.
With $n = 4$, a total of 50 pools are created, and each pool saves 1.6244 tests, so the total numbert of tests expected to be saved in $50 \times 1.6244 = 81.22$; at \$15 each, the saving is $\$1218.30$.
:::

```{r PoolTestFig, echo=TRUE, fig.show='hide'}
n <- 2:14

probIndTestsNeeded <- 1 - 0.9^n
probOneTestNeeded <- 0.9^n
expectedTests <- (probOneTestNeeded * 1) + (probIndTestsNeeded * (n + 1) )
TestsSaved <- n - expectedTests

par(mfrow = c(1, 2))

plot( expectedTests ~ n,
      las = 1,
      ylim = c(0, 12),
      type = "b",
      main = "Expected number of tests\nfor pooling first",
      xlab = "Number in pooled test",
      ylab = "Expected number of tests")
plot( TestsSaved ~ n,
      las = 1,
      ylim = c(0, 2.5),
      type = "b",
      main = "The number of tests saved\nby pooling first",
      xlab = "Number in pooled test",
      ylab = "Expected number of tests saved/pool")

```
```{r PoolTestFig2, echo=FALSE, fig.cap="The advantage of initial pooled testing", out.width='90%', fig.width=7}
<<<PoolTestFig>>>
```


## Answers for Chap. 4

:::{.answer}
**Answer to Exercise \@ref(exr:BinChange).**
From what is given: $p_X(x) = \binom{n}{x} (1 - p)^x p^{n - x}$.
Then, define $Y = n - X$ and hence 
$f_Y(y) = \binom{n}{y} p^y (1 - p)^{n - y}$, which is $f_Y(y) = \binom{n}{n - x} p^{n - x} (1 - p)^{n}$.
It is easy to show that $\binom{n}{x} = \binom{n}{n - x}$ and hence $f_X(x)$ and $f_Y(y)$ are equivalent.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:SaltIntake).**

```{r echo=TRUE}
sum( dbinom(10:25, 
            size = 25,
            prob = 0.30) )
sum( dbinom(0:9, 
            size = 25,
            prob = 0.30) )
sum( dbinom(5:10, 
            size = 25,
            prob = 0.30) )
dgeom(x  = 6,
      prob = 0.30)
sum( dgeom(x  = 8:50,
           prob = 0.30) )

# This means 5 fails, before 3rd successses
dnbinom(x = 5,
        prob = 0.30,
        size = 3)
```

Assumes independence of people, and a *constant* probability.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:Placebos).**

```{r echo=TRUE}
sum( dbinom( 15:81,
             size = 81,
             prob = 0.20) )
sum( dbinom( 12:81,
             size = 81,
             prob = 0.20) )
dgeom(x = 3,
      prob = 0.20)

dnbinom(x = 5,
        prob = 0.20,
        size = 5)
sum( dbinom(50:81,
            size = 81,
            prob = 0.2) )
```
:::


:::{.answer}
**Answer to Exercise \@ref(exr:NoisyMiners).**

```{r echo=TRUE}
dpois( 0, 
       lambda = 3)
sum( dpois( 5:50, 
            lambda = 3) )
dpois( 2, 
       lambda = 6)
```
:::



:::{.answer}
**Answer to Exercise \@ref(exr:DisaggregationPoisson).**

See Fig. \@ref(fig:RainEventsPlotA).

```{r RainEventsPlot, fig.show="hide"}
x <- 0:10
pSummer <- dpois(x,
                 lambda = 2.5)
pWinter <- dpois(x,
                 lambda = 1.9)

plot( pWinter ~ x,
      las = 1,
      pch = 19,
      ylab = "Probability",
      xlab = "Number of rainfall events")
points( pSummer ~ x,
        pch = 0)
lines( ifelse(pWinter > pSummer, pWinter, pSummer) ~ x,
       type = "h", # Add vertical lines
       lty = 2,
       col = "grey")
 
legend("topright",
       pch = c(19, 0),
       legend = c("Winter", "Summer"))

sum( dpois(4:10,
     lambda = 1.9) )
sum( dpois(4:10,
     lambda = 2.5) )

sum( dpois(4:10, lambda = 2.5) ) /
   sum( dpois(2:10, lambda = 2.5) )

sum( dpois(3:10, lambda = 1.9) ) /
   sum( dpois(2:10, lambda = 1.9) )
```
:::

```{r, RainEventsPlotA, fig.width=5, echo=FALSE, results='hide', fig.cap="The number of rainfall events in summer and winter", fig.align="center"}
<<RainEventsPlot>>
```



:::{.answer}
**Answer to Exercise \@ref(exr:UnknownSize).**

1. $\log n_x = \log N + \log p + x\log (1 - p)$, which is a linear regression model of $\log n_x$ regressed on $x$, with intercept $\beta_0 = \log N + \log p$ and slope $\beta_1 = \log (1 - p)$.
1. So from the fitted slope, we can estimate $p$; then, using the estimated intercept, we can estimate $N$.
More specifically, the estimate of $p$ is $1 - \exp( \hat{\beta}_1)$, and the estimate of $N$ is then $\exp(\beta_0 - \log p)$.
The population size is estimate as about 894:
:::

```{r echo=TRUE}
x <- 1:6
nx <- c(247, 63, 20, 4, 2, 1)

m1 <- lm( log(nx) ~ x); coef(m1)
beta0 <- coef(m1)[1]
beta1 <- coef(m1)[2]

p <- 1 - exp(beta1); p
N <- exp(beta0 - log(p) ); N
```


:::{.answer}
**Answer to Exercise \@ref(exr:NigerianWater)**
Defining $X$ as the 'number of days until 4kWh/m^2^ was observed'.
Then, $X\sim \text{Geom}(p)$.

1. $\text{E}(X) = 1/p = 2$.
1. $\text{E}(X) = 1/p = 4$.
1. $\text{var}(X) = (1 - p)/p^2 = 12$.
1. $\Pr(X\le 3) = ?????$
:::


:::{.answer}
**Answer to Exercise \@ref(exr:QueuingPois).**

```{r}
queueLength <- 0
for (i in 1:60){
   queueLength <- queueLength + rpois(1, lambda = 0.5)
   cat("After ", i, " minutes past 8AM, queue length: ", queueLength, "\n")
   
}

queueLength <- 0
for (i in 1:60){
   if (i == 30) cat(" --- Server begins ---\n")
   queueLength <- queueLength + rpois(1, lambda = 0.5)
   if ( i > 30) {
      queueLength <- queueLength - rpois(1, lambda = 0.75)
      if (queueLength < 0 ) queueLength <- 0
   }
   cat("After ", i, " minutes, queue length: ", queueLength, "\n")
   
}

queueLength <- 0
for (i in 1:60){
   if (i == 30) cat("--- Server begins ---\n")
   queueLength <- queueLength + rpois(1, lambda = 0.5)
   if ( i > 30) {
      queueLength <- max( queueLength - rpois(1, lambda = 1.5), 0)
      if (queueLength < 0 ) queueLength <- 0
   }
   cat("After ", i, " minutes, queue length: ", queueLength, "\n")
   
}
```

:::


:::{.answer}
**Answer to Exercise \@ref(exr:PoissonEqualValues).**
Suppose $X\sim\text{Pois}(\lambda)$; then $\Pr(X) = \Pr(X + 1)$ implies

\begin{align*}
   \frac{\exp(-\lambda)\lambda^x}{x!} 
   &= \frac{\exp(-\lambda)\lambda^{x + 1}}{(x + 1)!} \\
   \frac{\lambda^x}{x!} 
   &= \frac{\lambda^{x} \lambda}{(x + 1) \times x!}
\end{align*}
so that $\lambda = x + 1$.
For example, if $x = 4$ we would have $\lambda = 5$.
And we can check:

```{r}
dpois(x = 4,     lambda = 5)
dpois(x = 4 + 1, lambda = 5)
```
:::


:::{.answer}
**Answer to Exercise \@ref(exr:DiscreteUniformVar).**

Since $\text{var}(Y) = \text{E}(Y^2) - \text{E}(Y)^2$, find $\text{E}(Y^2)$ using \@ref(eq:SumSquaredNaturalNumbers):

\begin{align*}
  \text{E}(Y^2)
  &= \sum_{i = 0}^{b - a} i^2\frac{1}{b - a + 1}\\
  &= \frac{1}{b - a + 1}(0^2 + 1^2 + 2^2 + \dots  +(b - a)^2)\\
  &= \frac{1}{b - a + 1}\frac{(b - a)(b - a + 1)(2(b - a) + 1)}{6}\\
  &= \frac{(b - a)(2(b - a) + 1)}{6}.
\end{align*}
Therefore
\begin{align*}
   \text{var}(X)
    = \text{var}(Y)
   &= \frac{(b - a)(2(b - a) + 1)}{6} - \left(\frac{b - a}2\right)^2\\
   &= \frac{(b - a)(b - a + 2)}{12}.
\end{align*}
:::



## Answers for Chap. 5


:::{.answer}
**Answer to Exercise \@ref(exr:BetaRepara).**

???
:::


:::{.answer}
**Answer to Exercise \@ref(exr:SpeedSimUnif).**

In a study modelling pedestrian road-crossing behaviour [@shaaban2017agent], the uniform distribution is used in the simulation to model the vehicle speeds.
The speeds have a minimum value of 30 km/h, and a maximum value of 72 km/h.
Write $X$ for the vehicle speeds; then $X\sim \text{Unif}(30, 72)$.

1. $\text{E}(X) = (72 + 30)/2 = 51$km.h^-1^.
$\text{var}(X) = (72 - 30)^2 / 12 = 14$(km.h^-1^)^2^ (more easily understood, as $\sqrt{\text{Var}(X)} = 12.12$km.h^-1^).
1. See Fig. \@ref(fig:VehicleSpeeds).



```{r}
1 - punif(60, 32, 70)
(1 - punif(65, 32, 70) ) /
  (1 - punif(60, 32, 70) )

```

:::

```{r, VehicleSpeeds, echo=TRUE, fig.align="center", fig.cap="Vehicle speeds"}
par(mfrow = c(1, 2))

x <- seq(10, 100,
         length = 1000)
plot( x = x,
      y = dunif(x, 
                min = 30,
                max = 72),
      type = "l",
      las = 1,
      xlab = "Vehicle speeds (in km/h)",
      ylab = "Probability density",
      main = "PDF for vehicle speeds")

x <- seq(10, 100,
         length = 1000)
plot( x = x,
      y = punif(x, 
                min = 30,
                max = 72),
      type = "l",
      las = 1,
      ylim = c(0, 1),
      xlab = "Vehicle speeds (in km/h)",
      ylab = "Probability density",
      main = "PDF for vehicle speeds")
```

:::{.exercise #SpeedSimNorm}

1. About 2.4% of vehicles are excluded.
1. $Y$ has the distribution of $X \mid (X > 30 \cap X < 72)$ if $X \sim N(48, 8.8^2)$.
The pdf is

\[
  f_Y(y) = 
  \begin{cases}
     0 & \text{for $y < 30$};\\
        \displaystyle \frac{1}{8.8k \sqrt{2\pi}}
                 \exp\left\{ -\frac{1}{2}\left( \frac{y - 48}{8.8}\right)^2 \right\} & \text{for $30\le y \le 72$};\\
     0 & \text{for $y > 72$}.
  \end{cases}
\]
where $k \approx \Phi(-2.045455) + (1 - \Phi(2.727273)) = 0.02359804$.


```{r}
# Proportion excluded:
pnorm(30, 48, 8.8) + # Slower than 30
   (1- pnorm(72, 48, 8.8)) # Faster than 72
```

:::



:::{.answer}
**Answer to Exercise \@ref(exr:SimulationGirlHeights).**

```{r, fig.align="center", fig.cap="Heights of children at day-care facilities" }
htMean <- function(x) {
  7.5 * x + 70
}
htSD <- function(x) {
  0.4575 * x + 1.515
}

NumSims <- 10000

Ages <- c(
  rep(2, NumSims * 0.32),
  rep(3, NumSims * 0.33),
  rep(4, NumSims * 0.25),
  rep(5, NumSims * 0.10)
)

Hts <- rnorm(NumSims,
             mean = htMean(Ages),
             sd = htSD(Ages))
hist(Hts,
     las = 1,
     xlab = "Heights (in cm)")

# Taller than 100:
cat("Taller than 100cm:", sum( Hts > 100) / NumSims * 100, "%\n")
# Mean and variance:
cat("Mean:", mean( Hts ), "cm; ",
    "Std dev: ", sd(Hts), "cm\n")

# Sort the heights to find where the tallest 20% are:
cat("Tallest 15% are taller than", 
    sort(Hts)[ NumSims * 0.85], "cm\n")
```

:::


:::{.answer}
**Answer to Exercise \@ref(exr:ConcreteDiffusion).**

Write $C$ for the diffusion coefficients; then $C \sim \text{Gamma}(27.05, 1.42)$.

2. $\text{E}(C) = \alpha\beta \approx 38.41$. 
   $\text{var}(C) = \alpha\beta^2 \approx 54.54$.
3. $\Pr(C > 30\mid C < 50) = \Pr(30 \cap 50) / \Pr( C < 50) = \Pr(30 < C < 50) / \Pr( C < 50) \ approx 0.870$.
Using **R**:

```{r}
topPart <- pgamma(50, shape = 27.05, scale = 1.42) - 
           pgamma(30, shape = 27.05, scale = 1.42)
bottomPart <-pgamma(50, shape = 27.05, scale = 1.42)

topPart / bottomPart
```

```{r fig.align="center", fig.cap="Diffusion coefficients"}
par(mfrow = c(1, 2))

x <- seq(0, 80,
         length = 1000)
y <- dgamma(x,
            shape = 27.05,
            scale = 1.42)
plot(y ~ x,
     las = 1,
     type = "l",
     xlab = "Diffusion coefficient",
     ylab = "Probability density",
     main = "PDF")


x <- seq(0, 80,
         length = 1000)
y <- pgamma(x,
            shape = 27.05,
            scale = 1.42)
plot(y ~ x,
     las = 1,
     type = "l",
     xlab = "Diffusion coefficient",
     ylab = "Distribution function",
     main = "DF")
```

A study of the service life of concrete in various conditions [@liu2012stochastic] modelled the diffusion coefficients using a gamma distribution, with $\alpha = 27.05$ and $\beta = 1.42$ (units not given).

1. Plot the pdf and df.
1. Determine the mean and standard deviation of the chloride diffusion coefficients used in the simulation.
1. If $C$ represents the chloride diffusion coefficients, compute $\Pr(C > 30\mid C < 50)$.
:::



## Answers for Chap. 6

:::{.answer}
**Answer to Exercise \@ref(exr:DiscreteXY).**

1. This corresponds to the cell $X = 1, Y = 2$:  the answer is $1/20$. 
1. $\Pr(X + Y \le 1) = \Pr(X = 0, Y = 0) + \Pr(X = 0, Y = 1) + \Pr(X = 1, Y=0) = 1/2$.
1. $\Pr(X > Y) = \Pr(X = 1, Y = 0) + \Pr(X = 2, Y = 0) + \Pr(X = 2, Y = 1) = 7/30$.
1. Write:

\[
   p_X(x) = \begin{cases}
            7/15 & \text{if $x = 0$};\\
            7/15 & \text{if $x = 1$};\\
            1/15 & \text{if $x = 2$};\\
            0 & \text{otherwise}.
            \end{cases}
\]
1. Only consider the column corresponding to $X = 1$:

\[
   p_{Y\mid X = 1}(y\mid x = 1) = 
   \begin{cases}
            (1/6)/(7/15) = 15/42 & \text{if $y = 0$};\\
            (1/4)/(7/15) = 15/28 & \text{if $y = 1$};\\
            (1/20)/(7/15) = 3/28 & \text{if $y = 2$};\\
            0 & \text{otherwise}.
   \end{cases}
\]
:::

:::{.answer}
**Answer to Exercise \@ref(exr:AandBsimple).**

1. $7$ ; 2. $5$; 3. $-6$; $35$.
:::



:::{.answer}
**Answer to Exercise \@ref(exr:DailyRainfallSim).**

```{r echo=FALSE}
set.seed(8584444)
```
```{r echo=TRUE}
annualRainfallList <- array( NA, dim = 1000)
for (i in 1:1000){
   rainAmounts <- array( 0, dim = 365) # Reset for each simulation

    wetDays <- rbinom(365, size = 1, prob = 0.32) # 1: Wet day
   locateWetDays <- which( wetDays == 1 )


   rainAmounts[locateWetDays] <- rgamma( n = length(locateWetDays),
                                         shape = 2,
                                         scale = 20)
   annualRainfallList[i] <- sum(rainAmounts)
}
# hist( annualRainfallList)
```

```{r echo=FALSE}
set.seed(8584444)
```
```{r echo=TRUE}
Days <- 1 : 365
prob <- (1 + cos( 2 * pi * Days/365) ) / 2.2

annualRainfallList2 <- array( NA, dim = 1000)
for (i in 1:1000){

  wetDays <- rbinom(365, size = 1, prob = prob) # 1: Wet day
  
  locateWetDays <- which( wetDays == 1 )
  
  rainAmounts2 <- array( 0, dim = 365)
  
  rainAmounts2[locateWetDays] <- rgamma( n = length(locateWetDays),
                                         shape = 2,
                                         scale = 20)
   annualRainfallList2[i] <- sum(rainAmounts2)
}
#hist( annualRainfallList2)
```

```{r echo=FALSE}
set.seed(8584444)
```
```{r echo=TRUE}
Days <- 1 : 365

probList <- array( dim = 365)
probList[1] <- 0.32

annualRainfallList3 <- array( NA, dim = 1000)

for (i in 1:1000){
  
  rainAmounts <- array( dim = 365 )

  for (day in 1:365) {
    if ( day == 1 ) {
      probList[1] <- 0.32
      wetDay <- rbinom(1, 
                       size = 1, 
                       prob = probList[1]) # 1: Wet day
      rainAmounts[1] <- rgamma( n = 1,
                                shape = 2,
                                scale = 20)

    } else {
    
      probList[i] <- ifelse( rainAmounts[day - 1] == 0,
                             0.15,
                             0.55)
      wetDay <- rbinom(1, 
                       size = 1, 
                       prob = probList[i]) # 1: Wet day

      if (wetDay) {
        rainAmounts[day] <- rgamma( n = 1,
                                    shape = 2,
                                    scale = 20)
      } else {
        rainAmounts[day] <- 0
      }
    }
  }
  annualRainfallList3[i] <- sum(rainAmounts)
    
}

#hist( annualRainfallList3)
```
:::


:::{.answer}
**Answer to Exercise \@ref(exr:PoissonGammaRainfall).**

For one month:

```{r}
set.seed(932649)
N <- rpois(1, lambda = 0.78)
Rain <- 0
if (N > 0 ){
  Amount <- sum( rgamma(N,
                        shape = 0.5,
                        scale = 6) )
  Rain <- Rain + Amount
}
```

For 1000 simulations:

```{r}
set.seed(932649)

Rain <- array(0,  dim = 1000)

for (i in 1:1000){
  N <- rpois(1, lambda = 0.78)
  if (N > 0 ){
    Amount <- sum( rgamma(N,
                          shape = 0.5,
                          scale = 6) )
    Rain[i] <- Rain[i] + Amount
  }
}

# Exact zeros:
sum(Rain == 0) / 1000
mean(Rain)
mean(Rain[Rain > 0])
```

:::


## Answers for Chap. 7

:::{.answer}
**Answer to Exercise \@ref(exr:Ycubed).**

For $0 < x < 2$, the transformation is one-to-one.
The inverse transform is $X = Y^{1/3}$, and so $0 < y < 8$.

1. $F_Y(y) = \Pr{Y\le y}
   = \Pr(X^3 \le y) = \Pr(X\le y^{1/3}) = F_X( y^{1/3})
   = \int_{u = 0}^{y^{1/3}} u/2\,du = u^2/4\Big|_{u = 0}^{u = y^{1/3}} = y^{2/3}/4.$
Differentiate to find the pdf: 
$\frac{d}{dy} y^{2/3}/4 = y^{-1/3}/6$. 
The pdf of $Y$ is

\[
   f_Y(y) = \begin{cases}
               y^{-1/3}/6 & \text{for $0 < y < 8$};\\
               0 & \text{otherwise}.
            \end{cases}
\]

2. Since $w(y) = y^{1/3}$, then $w'(y) = y^{-2/3}$.
Then:

\begin{align*}
   f_Y(y)
   &= f_X(y) |J|\\
   &= y^{1/3}/2 \times \overbrace{y^{-2/3}/3}^{|J|} \\
   &= y^{-1/3}/6.
\end{align*}
So the pdf of $Y$ is as above.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:JointDiscrete).**

Note $Y_1$ takes the values $1$ and $2$ for $Y_2 = 0$;
$Y_1$ takes the values $2$ and $3$ for $Y_2 = 1$.

The joint pf is shown in Table \@ref(tab:JDTable).
Hence,

\[
   f_{Y_1} = 
   \begin{cases} 
      2/14 & \text{if $y_1 = 1$};\\
      7/14 & \text{if $y_1 = 2$};\\
      5/14 & \text{if $y_1 = 3$};\\
      0    & \text{otherwise}.
    \end{cases}
\]

```{r JDTable, echo=FALSE}
JDTable <- array( dim = c(2, 4))

colnames(JDTable) <- c("",
                       "$Y_1 = 1$",
                       "$Y_1 = 2$",
                       "$Y_1 = 3$")
JDTable[1, ] <- c("$Y_2 = 0$",
                  "2/14",
                  "4/14",
                  "0")
JDTable[2, ] <- c("$Y_2 = 1$",
                  "0",
                  "3/14",
                  "5/14")
kable(JDTable)
```
:::

:::{.answer}
**Answer to Exercise \@ref(exr:GammaSum).**

$Y \sim\text{Gam}(\sum\alpha, \beta)$.
:::
  
  
:::{.answer}
**Answer to Exercise \@ref(exr:CauchySquared).**
  
Transformation is not 1-1. 
$f_Y(y)=\displaystyle {\frac{1}{\pi \sqrt{y}(1 + y)}}$ for $0 < y < \infty$.
:::

:::{.answer}
**Answer to Exercise \@ref(exr:ContTransform).**

1. $f_x(x) = x$ for $-0.5 < x < 0.5$.  
1. $F_Y(y) =\Pr(Y \le y) = 1 - 2\sqrt{4 - y}$ for $3.75 < y < 4$.
1. $f_Y(y) = (4 - y)^{-1/2}$.
:::

## Answers for Chap. 8

  
:::{.answer}
**Answer to Exercise \@ref(exr:CLTProb).**

$\text{E}(Y) = \int_0^1 y(3y^2)\, dy = 3/4$.
$\text{E}(Y^2) = 3/5$, so $\text{Var}(Y) = 3/80$. 
By the CLT, $\overline{Y}\sim N(3/4, 3/(80n) )$. 
Therefore

\[
   \Pr\left( 3/4 - \sqrt{3/80} < \overline{Y} < 3/4 + \sqrt{3/80} \right)
   = \Pr\left( 0.56 < \overline{Y} < 0.94 \right)
\]
is needed. For a sample of size $n$,

\[
   \Pr\left( \frac{0.56 - 0.75}{0.19/\sqrt{n}} < Z < \frac{0.56 - 0.75}{0.19/\sqrt{n}} \right)
   = \Pr(-\sqrt{n} < Z < \sqrt{n} )
\]
which approaches one as $n\to\infty$.
For example, if $n = 10$, $\Pr(-\sqrt{10} < Z < \sqrt{10} ) = 0.9984$.
:::
  

:::{.answer}
**Answer to Exercise \@ref(exr:EggsVariance).**

Let the weight be $E$, so $E\sim N(59, 0.7)$. 
By the CLT, the sample mean $\overline{E} \sim N(59, 0.7/12)$. 
So

\[
   \Pr(\overline{E} > 59.5)
   = \Pr(Z > \frac{59.5 - 59}{\sqrt{0.7/12}})
   = \Pr(z > 2.07)
   \approx 0.019.
\]
1. We seek $\Pr(s^2 > 1)$. 
   Since 
   
\[
   \frac{(n - 1)s^2}{\sigma^2}\sim \chi^2_{n - 1}
\]
where $n = 12$ and $\sigma^2 = 0.7$. 
So
\begin{align*}
   \Pr(s^2 > 1)
   &= \Pr\left( \frac{11 s^2}{0.7} > \frac{11\times 1}{0.7} \right)\\
   &=\Pr( \chi^2_{11} > 15.714)\\
   &\approx 0.152.
\end{align*}
:::
  
:::{.answer}
**Answer to Exercise \@ref(exr:EggsBroken).**

Let the number broken be $B$, so $B \sim \text{Pois}(0.2)$. 
The sample mean number broken has the distribution $\overline{B}\sim N(0.2, 0.2/\sqrt{12})$ approx. 
So

\[
   \Pr(B\ge 1) 
   = \Pr\left( Z > \frac{1 - 0.2}{\sqrt{0.2\sqrt{12}}} \right)
   = \Pr(Z > 6.196) = 0.
\]
In contrast, in any one carton, the probability of more than one
broken egg is

\[
   \Pr(B > 1) = 1 - \Pr(B = 0) = 1 - 0.8187 = 0.181
\]
using the Poisson distribution.
:::

:::{.answer}
**Answer to Exercise \@ref(exr:ContRVM).**
  
1. $\text{E}(M) = 3/4$.
1. $\text{var}(M) = 3/80$.
1. $\overline{M}\sim N(3/4, 1/240)$.
1. $0.8788$.
:::
  
  

  