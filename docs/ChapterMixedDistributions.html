<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Mixed distributions | The Theory of Statistical Distributions</title>
<meta name="author" content="Peter K. Dunn">
<meta name="description" content="On completion of this chapter, you should be able to: recognise mixed random variables. recognise censored models, hurdle models and compound Poisson–gamma models for modelling mixed random...">
<meta name="generator" content="bookdown 0.45 with bs4_book()">
<meta property="og:title" content="9 Mixed distributions | The Theory of Statistical Distributions">
<meta property="og:type" content="book">
<meta property="og:description" content="On completion of this chapter, you should be able to: recognise mixed random variables. recognise censored models, hurdle models and compound Poisson–gamma models for modelling mixed random...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Mixed distributions | The Theory of Statistical Distributions">
<meta name="twitter:description" content="On completion of this chapter, you should be able to: recognise mixed random variables. recognise censored models, hurdle models and compound Poisson–gamma models for modelling mixed random...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/rglWebGL-binding-1.3.31/rglWebGL.js"></script><link href="libs/rglwidgetClass-1.3.31/rgl.css" rel="stylesheet">
<script src="libs/rglwidgetClass-1.3.31/rglClass.min.js"></script><script src="libs/CanvasMatrix4-1.3.31/CanvasMatrix.min.js"></script><link rel="shortcut icon" href="icons/iconmonstr-chart-1-240.png">
<script>
    document.addEventListener('DOMContentLoaded', function() {
      // Find all R code blocks that should be toggleable.
      // Our Lua filter adds the 'r-code-box' class to the code block.
      var codeBlocks = document.querySelectorAll('.r-code-box');

      codeBlocks.forEach(function(codeBlock) {
        // Create the button element
        var button = document.createElement('button');
        button.textContent = 'Show R Code'; // Initial text for the button
        button.className = 'code-toggle-button'; // Assign CSS class

        // Insert the button directly before the code block.
        // The codeBlock's parentNode is the div.figure-with-code container.
        // We insert the button as a sibling of the codeBlock within that container.
        codeBlock.parentNode.insertBefore(button, codeBlock);

        // Hide the code block initially by default.
        codeBlock.style.display = 'none';

        // Add a click event listener to the button
        button.addEventListener('click', function() {
          if (codeBlock.style.display === 'none') {
            codeBlock.style.display = 'block'; // Show the code block
            button.textContent = 'Hide R Code'; // Change button text
          } else {
            codeBlock.style.display = 'none'; // Hide the code block
            button.textContent = 'Show R Code'; // Change button text back
          }
        });
      });
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/columns.css">
<link rel="stylesheet" href="html/largerDie.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Theory of Statistical Distributions</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">Theoretical foundations</li>
<li><a class="" href="ChapterSetTheory.html"><span class="header-section-number">1</span> Essentials of set theory</a></li>
<li><a class="" href="ChapterProbability.html"><span class="header-section-number">2</span> Probability</a></li>
<li><a class="" href="DistributionRandomVariables.html"><span class="header-section-number">3</span> Random variables and their distributions</a></li>
<li><a class="" href="ChapBivariate.html"><span class="header-section-number">4</span> Bivariate distributions</a></li>
<li><a class="" href="ChapExpectation.html"><span class="header-section-number">5</span> Mathematical expectation</a></li>
<li><a class="" href="ChapterTransformations.html"><span class="header-section-number">6</span> Transformations of random variables</a></li>
<li class="book-part">Standard univariate probability distributions</li>
<li><a class="" href="DiscreteDistributions.html"><span class="header-section-number">7</span> Standard discrete distributions</a></li>
<li><a class="" href="ContinuousDistributions.html"><span class="header-section-number">8</span> Standard continuous distributions</a></li>
<li><a class="active" href="ChapterMixedDistributions.html"><span class="header-section-number">9</span> Mixed distributions</a></li>
<li class="book-part">Multivariate random variables and distributions*</li>
<li><a class="" href="ChapMultivariate.html"><span class="header-section-number">10</span> Multivariate distributions*</a></li>
<li><a class="" href="MultivariateExtensions.html"><span class="header-section-number">11</span> Expectations for multivariate distributions*</a></li>
<li class="book-part">Sampling distributions</li>
<li><a class="" href="SamplingDistributions.html"><span class="header-section-number">12</span> Describing samples</a></li>
<li><a class="" href="OrderStatisticsChapter.html"><span class="header-section-number">13</span> Order statistcs</a></li>
<li><a class="" href="BayesianIntro.html"><span class="header-section-number">14</span> Introduction to Bayesian statistics</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="SymbolsUsed.html"><span class="header-section-number">A</span> Symbols used</a></li>
<li><a class="" href="UsefulSeries.html"><span class="header-section-number">B</span> Some useful series</a></li>
<li><a class="" href="ShortRIntro.html"><span class="header-section-number">C</span> Short R introduction</a></li>
<li><a class="" href="UseRDistributions.html"><span class="header-section-number">D</span> Using R with distributions</a></li>
<li><a class="" href="selected-solutions.html"><span class="header-section-number">E</span> Selected solutions</a></li>
<li><a class="" href="references.html"><span class="header-section-number">F</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PeterKDunn/DistTheory">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ChapterMixedDistributions" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Mixed distributions<a class="anchor" aria-label="anchor" href="#ChapterMixedDistributions"><i class="fas fa-link"></i></a>
</h1>
<div class="objectivesBox objectives">
<p>On completion of this chapter, you should be able to:</p>
<ul>
<li>recognise mixed random variables.</li>
<li>recognise censored models, hurdle models and compound Poisson–gamma models for modelling mixed random variables.</li>
<li>know the basic properties of the above mixed distributions.</li>
<li>apply these distributions as appropriate to problem solving.</li>
</ul>
</div>
<div id="introduction-3" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-3"><i class="fas fa-link"></i></a>
</h2>
<p>Mixed random variables commonly occur, but are not often studied.
Mixed random variables appear in diverse applications such as insurance, agriculture, climatology, fishing, etc.</p>
<p>In most practical cases, a mixed random variable <span class="math inline">\(X\)</span> has a discrete probability mass at <span class="math inline">\(X = 0\)</span>, and then are continuous for <span class="math inline">\(X &gt; 0\)</span>; this is the only type of mixed random variable we consider (though extensions to discrete masses occurring for other values of the random variable are often (but not always) similar).
For example:</p>
<ul>
<li>When modelling insurance, the zero probability corresponds to portfolios with zero claims; however, when claims are made, the total claim amount has a continuous distribution.</li>
<li>When modelling rainfall, the zero probability corresponds to receiving zero rainfall; however, when rain does fall, the total rainfall recorded has a continuous distribution.</li>
<li>When modelling fish catch, the zero probability corresponds to catching zero fish; however, when fish are caught, the mass of fish catch has a continuous distribution.</li>
</ul>
<p>Continuous data with a discrete probability at zero can be modelled in various ways, depending on how the discrete probability at <span class="math inline">\(X = 0\)</span> is incorporated.
Three approaches are considered in this chapter.</p>
<p><em>Censored models</em> (Sect. <a href="ChapterMixedDistributions.html#CensoredModels">9.2</a>) assume the existence of an underlying <em>latent variable</em>, defined for all real values.
However, values of the latent variable below zero cannot be observed (called <em>censoring</em>).
All the probabilities corresponding to values of the latent variable below zero are accumulated, and assigned to the probability of observing a value of zero.
The value of <span class="math inline">\(X = 0\)</span> represents <em>censored observations</em> of the latent variable.</p>
<p><em>Hurdle models</em> (Sect. <a href="ChapterMixedDistributions.html#HurdleModels">9.3</a>) treat the zeros as emerging from a two-step process.
Step one is a binary process, that models whether the event of interest (i.e., an insurance claim is made; rainfall is recorded; fish are caught) occurs.
Step two is a model for the continuous data of interest, conditional on the event of interest occurring.</p>
<p>Compound <em>Poisson-gamma models</em> (Sect. <a href="ChapterMixedDistributions.html#TweedieModels">9.4</a>) combine the discrete and continuous components in a single probability model.
Unlike the hurdle model, the discrete and continuous parts are not modelled separately; the entire distribution is modelled using a single probability model specific for modeling mixed random variables.</p>
</div>
<div id="CensoredModels" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Censored model<a class="anchor" aria-label="anchor" href="#CensoredModels"><i class="fas fa-link"></i></a>
</h2>
<div id="CensoredModelsDefinitions" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Definitions<a class="anchor" aria-label="anchor" href="#CensoredModelsDefinitions"><i class="fas fa-link"></i></a>
</h3>
<p>
Censored models assume the existence of an unobserved <em>latent variable</em>, say <span class="math inline">\(Y\)</span>, such that <span class="math inline">\(Y\in\mathbb{R}\)</span> with probability function <span class="math inline">\(f_Y(y)\)</span>.
Values of <span class="math inline">\(Y\)</span> below some threshold, say <span class="math inline">\(y^*\)</span> (commonly, <span class="math inline">\(y^* = 0\)</span>), are not directly observed.
Instead, <span class="math inline">\(X = \max(Y^*, Y)\)</span> is observed; that is, values of <span class="math inline">\(Y\)</span> less than <span class="math inline">\(y^*\)</span> are recorded as <span class="math inline">\(y^*\)</span>.
We will focus on the case where <span class="math inline">\(y^* = 0\)</span>.</p>
<div class="example">
<p><span id="exm:TobitAlcoholSpend" class="example"><strong>Example 9.1  (Latent variables and censoring) </strong></span>Consider a latent variable defined as the ‘desire to purchase alcohol’ <span class="math inline">\(Y\)</span>, where the value <span class="math inline">\(Y = 0\)</span> represents indifference to purchasing alcohol.
Some people may have a <em>very</em> strong aversion to purchasing alcohol, so that the value of <span class="math inline">\(Y\)</span> is large and negative.
Some people may have a <em>mild</em> aversion to purchasing alcohol, so that the value of <span class="math inline">\(Y\)</span> is small but still negative.
In both cases, however, an aversion to purchasing alcohol is present, and no alcohol is purchased.</p>
<p>The observed variable of interest could be <span class="math inline">\(X\)</span>, the average weekly spend on buying alcohol in dollars.
When <span class="math inline">\(Y \le 0\)</span>, we observe <span class="math inline">\(X = 0\)</span>; however, when <span class="math inline">\(Y &gt; 0\)</span>, a continuous amount is spent on purchasing alcohol (Fig. <a href="ChapterMixedDistributions.html#fig:AlcoholSpend">9.1</a>).</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:AlcoholSpend"></span>
<img src="09-MixedDistributions_files/figure-html/AlcoholSpend-1.png" alt="Left: the latent variable\ $Y$, the desire to buy alcohol. Right: the observed variable\ $X$, the average weekly spend on alcohol. The solid dot is the sum of all probabilities for which $Z \le 0$." width="100%"><p class="caption">
FIGURE 9.1: Left: the latent variable <span class="math inline">\(Y\)</span>, the desire to buy alcohol. Right: the observed variable <span class="math inline">\(X\)</span>, the average weekly spend on alcohol. The solid dot is the sum of all probabilities for which <span class="math inline">\(Z \le 0\)</span>.
</p>
</div>
<p>In this context, the value of the observed variable <span class="math inline">\(X\)</span> is said to be <em>censored</em>.</p>
<div class="definition">
<p><span id="def:Censoring" class="definition"><strong>Definition 9.1  (Censoring) </strong></span>A variable is called <em>censored</em> if its value is only observed when its above or below a certain threshold.</p>
<p><em>Left censoring</em> occurs when the true (latent) value is less than or equal to a known threshold, but the exact value is unknown.
We only know that the true (latent) value is <em>below</em> a certain threshold.</p>
<p><em>Right censoring</em> occurs when the true (latent) value is greater than or equal to a known threshold, but the exact value is unknown.
We only know that the true (latent) value is <em>above</em> a certain threshold.</p>
</div>
<div class="example">
<p><span id="exm:AlcoholLeftCensoring" class="example"><strong>Example 9.2  (Left censoring) </strong></span>The latent variable ‘desire to purchase alcohol’ used in Example <a href="ChapterMixedDistributions.html#exm:TobitAlcoholSpend">9.1</a> is <em>left censored</em>.</p>
</div>
<div class="example" ame="Right censoring">
<p><span id="exm:insectLeftCensoring" class="example"><strong>Example 9.3  </strong></span>In survival analysis, the time it takes insects to die (say <span class="math inline">\(X\)</span>) may be studied.
If the study ends at time <span class="math inline">\(t^*\)</span>, the time of death for any insects still alive is some value larger than <span class="math inline">\(t^*\)</span>; that is, <span class="math inline">\(X\ge t^*\)</span> but the exact time of death remains unknown.
The time to death is <em>right censored</em>.</p>
</div>
<div class="importantBox important">
<p><em>Censoring</em> is not the same as <em>truncation</em>.</p>
<p><em>Censoring</em> retains observations, but the exact value remains unknown.
<em>Truncation</em> removes observations whose value falls above or below a threshold.</p>
</div>
<p>Usually <span class="math inline">\(y^* = 0\)</span> (as in Example <a href="ChapterMixedDistributions.html#exm:TobitAlcoholSpend">9.1</a>), so that any value of <span class="math inline">\(Y \le 0\)</span> is recorded as <span class="math inline">\(y = 0\)</span>.
That is, we observe the random variable <span class="math inline">\(X\)</span> such that
<span class="math display">\[
  X = \max(Y, 0).
\]</span>
This means the probability function of <span class="math inline">\(X\)</span> is
<span class="math display">\[
  f_X(x) =
  \begin{cases}
    0       &amp; \text{if $X &lt; 0$}\\
    F_Y(0)  &amp; \text{if $X = 0$}\\
    f_Y(y)  &amp; \text{if $X &gt; 0$}
  \end{cases}
\]</span>
where <span class="math inline">\(F_Y(y)\)</span> is the distribution function of <span class="math inline">\(Y\)</span>.
The probability function for <span class="math inline">\(X\mid X &gt; 0\)</span>, the continuous part of the distribution only, is
<span class="math display" id="eq:PDFpositiveConditional">\[\begin{equation}
  f_{X\mid X &gt; 0}(x)
  = \frac{f_X(x)}{\Pr(X &gt; 0)}
  = \frac{f_Y(y)}{1 - F_Y(0)}
  \tag{9.1}
\end{equation}\]</span>
where again <span class="math inline">\(F_Y(y)\)</span> is the distribution function of <span class="math inline">\(Y\)</span>.
The distribution function of <span class="math inline">\(X\)</span> is
<span class="math display">\[
  F_{X\mid X&gt;0}(x) =
  \begin{cases}
    0             &amp; \text{for $x &lt; 0$}\\
    F_Y(0)        &amp; \text{for $x = 0$}\\
    F_Y(x)        &amp; \text{for $x &gt; 0$}
  \end{cases}
\]</span></p>
<p>If the latent distribution is a normal distribution, Equation <a href="ChapterMixedDistributions.html#eq:PDFpositiveConditional">(9.1)</a> can be written in terms of the standard normal density function <span class="math inline">\(\phi(\cdot)\)</span> and the standard normal distribution function <span class="math inline">\(\Phi(\cdot)\)</span> (see Sect. <a href="ContinuousDistributions.html#StandardNormal">8.3.2</a>).
In this case only, notice that
<span class="math display">\[\begin{align*}
   \Pr(X &gt; 0)
   &amp;= \Pr(Z &gt; (0 - \mu)/\sigma)\quad\text{(where $Z$ is a standard normal variate)} \\
   &amp;= \Pr(Z &gt; -\mu/\sigma) \\
   &amp;= 1 - \Phi( -\mu/\sigma) \\
   &amp;= \Phi(\mu/\sigma) \quad\text{(using the symmetry of the normal distribution)},
\end{align*}\]</span>
and hence Equation <a href="ChapterMixedDistributions.html#eq:PDFpositiveConditional">(9.1)</a> can be written as
<span class="math display" id="eq:PDFpositiveConditional2">\[\begin{equation}
  f_{X\mid X&gt;0}(x)
  = \frac{\phi\big((x-\mu)/\sigma\big)}{\Phi(\mu/\sigma)}.
  \tag{9.2}
\end{equation}\]</span>
If we write <span class="math inline">\(t = \mu/\sigma\)</span> and define <span class="math inline">\(\lambda(t) = \phi(t)/\Phi(t)\)</span>, this expression becomes
<span class="math display">\[
  f_{X\mid X&gt;0}(x) = ?????????????
\]</span>
LOST:
<span class="math display">\[
  f_{X\mid X&gt;0}(x)
  = \frac{f_Z(x)}{\Pr(Z &gt; 0)}
  = \frac{f_Z(x)}{1 - F_Z(0)}
\]</span></p>
<div class="example">
<p><span id="exm:TobitExamplesLatent2" class="example"><strong>Example 9.4  (Latent variables and censoring) </strong></span>Consider the number of hours worked (which can be observed), which must take a non-negative value.
We could assume an underlying, unobserved latent variable such as ‘willingness to work’.
Negative values for ‘willingness to work’, no matter how small or how large, all result in zero observed hours of work.</p>
</div>
</div>
<div id="CensoredModelsProperties" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Properties<a class="anchor" aria-label="anchor" href="#CensoredModelsProperties"><i class="fas fa-link"></i></a>
</h3>
<p>The expected value of the censored random variable <span class="math inline">\(X\)</span> can be found first separating the discrete and continuous parts of the distribution:
<span class="math display">\[\begin{align*}
  \operatorname{E}[X]
  &amp;= \operatorname{E}[X\mid X = 0] + \operatorname{E}[X\mid X &gt; 0]\\
  &amp;= \Pr(X = 0)\times 0 + \operatorname{E}[X\mid X &gt; 0]\\
  &amp;= \operatorname{E}[X\mid X &gt; 0]\\
  &amp;= \int_0^\infty x\cdot f_{X\mid X &gt; 0}(x)\,dx,\\
  &amp;= \frac{1}{\Phi()} \int_0^\infty x\cdot f_{X}(x)\,dx,
\end{align*}\]</span>
where <span class="math inline">\(f_{X\mid X &gt; 0}(x)\)</span> is given in Equation <a href="ChapterMixedDistributions.html#eq:PDFpositiveConditional2">(9.2)</a>).</p>
<p>When the censoring happens at <span class="math inline">\(x^* = 0\)</span>, the standardised score is <span class="math inline">\((x^* - \mu)/\sigma = -t\)</span>, where defining <span class="math inline">\(t = \mu/\sigma\)</span> proves useful.
Then <span class="math inline">\(1 - \Phi()\)</span>
Thus,
<span class="math display">\[\begin{align*}
  \operatorname{E}[X]
  &amp;= \int_0^\infty x\cdot f_{X\mid X &gt; 0}(x)\,dx,
  &amp;= \int_0^\infty x\cdot f_{X\mid X &gt; 0}(x)\,dx,
\end{align*}\]</span></p>
<p>Similarly,
<span class="math display">\[
  \operatorname{E}[X^2]
  = \operatorname{E}[X^2 \mid X &gt; 0]
  = \int_0^\infty x^2 \cdot f_{X\mid X&gt;0}(x)\, dx,
\]</span>
from which the variance can be obtained.
The same approach also gives the MGF as
<span class="math display">\[
  M_X(t) = M_{X\mid X &gt; 0}(t).
\]</span>
Clearly, further progress with these expressions requires knowing the distribution of <span class="math inline">\(X\)</span> and hence the distribution of the latent variable <span class="math inline">\(Z\)</span>.
It is common, but by no means universal, for the latent variable to be described by a normal distribution (when the models are also called <em>Tobit models</em>).</p>
<div class="example">
<p><span id="exm:TobitExample0" class="example"><strong>Example 9.5  (Censored model) </strong></span>Consider a latent variable <span class="math inline">\(Y\)</span>, and an observed variable <span class="math inline">\(X = \text{max}(0, Z)\)</span>.
Suppose that <span class="math inline">\(Z\)</span> has the normal distribution (Fig. <a href="ChapterMixedDistributions.html#fig:TobitPic">9.2</a>, left panel))
<span class="math display">\[
  Z \sim N(\mu = 0, \sigma^2 = 1),
\]</span>
so that <span class="math inline">\(\operatorname{E}[Z] = 0\)</span> and <span class="math inline">\(\operatorname{var}[Z] = 1\)</span>.
That is, <span class="math inline">\(Z\)</span> has a standard normal distribution (Sect <a href="ContinuousDistributions.html#StandardNormal">8.3.2</a>), and so
<span class="math display">\[
  \Pr(Z &lt; 0) = \Phi(0) = 0.5.
\]</span>
Recall the notation: <span class="math inline">\(\Phi(\cdot)\)</span> is the distribution function for a standard normal variate, and <span class="math inline">\(\phi(\cdot)\)</span> is the density function for a standard normal variate.</p>
<p>Then, define the random variable <span class="math inline">\(X\)</span> as
<span class="math display">\[
  f_X(x) =
  \begin{cases}
    0          &amp; \text{if $Z &lt; 0$};\\
    \Phi(0)    &amp; \text{if $Z = 0$};\\
    \phi(x)    &amp; \text{if $Z &gt; 0$},
  \end{cases}
\]</span>
as shown in Fig. <a href="ChapterMixedDistributions.html#fig:TobitPic">9.2</a> (right panel).</p>
<p>From Equation <a href="ChapterMixedDistributions.html#eq:PDFpositiveConditional">(9.1)</a>,
<span class="math display">\[
  f_{X\mid X &gt; 0}(x)
  = \frac{\phi(x)}{1 - \Phi(0)}
  = 2 \phi(x)
\]</span>
for <span class="math inline">\(X &gt; 0\)</span>.
From this expression,
<span class="math display">\[
  \operatorname{E}[X]
   = \operatorname{E}[X \mid X &gt; 0]
  = 2 \int_0^\infty x\cdot \phi(x)\, dx
  = \frac{2}{\sqrt{2\pi}}
  \approx 0.7979,
\]</span>
integrating the expression for <span class="math inline">\(\phi(x)\)</span> (Equation <a href="ContinuousDistributions.html#eq:StandardNormalPMF">(8.4)</a>).
Similarly, using integration by parts,
<span class="math display">\[
  \operatorname{E}[X^2]
   = \operatorname{E}[X^2 \mid X &gt; 0]
  = 2 \int_0^\infty x^2\cdot \phi(x)\, dx
  = 1/2.
\]</span>
Combining, this means that
<span class="math display">\[
  \operatorname{var}[X]
  = \frac{1}{2} - \left(\frac{2}{\sqrt{2\pi}}\right)^2
  = \frac{1}{2} - \frac{1}{\pi}
  \approx 0.182.
\]</span></p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:TobitPic"></span>
<img src="09-MixedDistributions_files/figure-html/TobitPic-1.png" alt="A censored model, using a normal distribution for the continuous component, with the threshold value at $Z = 0$." width="90%"><p class="caption">
FIGURE 9.2: A censored model, using a normal distribution for the continuous component, with the threshold value at <span class="math inline">\(Z = 0\)</span>.
</p>
</div>
<p></p>
</div>
</div>
<div id="HurdleModels" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Hurdle models<a class="anchor" aria-label="anchor" href="#HurdleModels"><i class="fas fa-link"></i></a>
</h2>
<div id="HurdleModelsDefinitions" class="section level3" number="9.3.1">
<h3>
<span class="header-section-number">9.3.1</span> Definitions<a class="anchor" aria-label="anchor" href="#HurdleModelsDefinitions"><i class="fas fa-link"></i></a>
</h3>
<p>
A <em>hurdle model</em> treats the zero values of the random variable <span class="math inline">\(X\)</span> as emerging from a two-step process.
The first step uses a Bernoulli distribution (Sect. <a href="DiscreteDistributions.html#BernoulliDistribution">7.3</a>) to model a random variable <span class="math inline">\(Y\)</span> that defines whether an event of interest occurs:
<span class="math display">\[
  \Pr(Y) =
  \begin{cases}
    1 - p    &amp; \text{if $Y = 0$; i.e., the event of interest \emph{does not} occur;}\\
    p        &amp; \text{if $Y = 1$; i.e., the event of interest \emph{does} occur.}
  \end{cases}
\]</span>
If the event does occur (i.e., conditional on <span class="math inline">\(X &gt; 0\)</span>), with probability <span class="math inline">\(1 - p\)</span>, then the continuous component is modelled using a probability density function <span class="math inline">\(f^+_X(x)\)</span> defined for positive real values only (such as an exponential distribution or a gamma distribution).</p>
<p>The probability function for the mixed random variable <span class="math inline">\(X\)</span> is therefore
<span class="math display">\[
   f_X(x) =
   \begin{cases}
      1 - p           &amp; \text{if $x = 0$}\\
      p\cdot f^+_X(x)    &amp; \text{if $x &gt; 0$,}
   \end{cases}
\]</span>
where <span class="math inline">\(f^+_X(x) = f_{X \mid X &gt; 0}(x)\)</span> is the density function for the continuous distribution defined for <span class="math inline">\(x\in\mathbb{R}_{+}\)</span>.
The distribution function is
<span class="math display">\[
   F_X(x) =
   \begin{cases}
      0                             &amp; \text{if $x &lt; 0$}\\
      1 - p                         &amp; \text{if $x = 0$}\\
      (1 - p) + p\cdot F^+_X(x)    &amp; \text{if $x &gt; 0$,}
   \end{cases}
\]</span>
where <span class="math inline">\(F^+_X(x) = F_{X\mid X &gt; 0}(x)\)</span> is the distribution function for the continuous distribution defined for <span class="math inline">\(x\in\mathbb{R}_{+}\)</span>.</p>
<div class="example">
<p><span id="exm:HurdleExample" class="example"><strong>Example 9.6  (Hurdle model) </strong></span>Consider the mixed random variable <span class="math inline">\(X\)</span>, with probability function <span class="math inline">\(f_X(x)\)</span>.
Suppose that, when <span class="math inline">\(X &gt; 0\)</span>, an exponential distribution is used to describe the distribution; that is
<span class="math display">\[
  f^+_X(x) = \frac{1}{\lambda}\exp(-x/\lambda)\quad\text{for $x &gt; 0$}.
\]</span>
Then, using <span class="math inline">\(p = 0.7\)</span> and <span class="math inline">\(\lambda = 1/2\)</span>, the probability function of <span class="math inline">\(X\)</span> is
<span class="math display">\[
  f_X(x)
  =
    \begin{cases}
       0.3                   &amp; \text{if $x = 0$}\\
       0.35\cdot \exp(-x/2)  &amp; \text{if $x &gt; 0$;}
    \end{cases}
\]</span>
see Fig. <a href="ChapterMixedDistributions.html#fig:HurdlePic">9.3</a>.</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:HurdlePic"></span>
<img src="09-MixedDistributions_files/figure-html/HurdlePic-1.png" alt="A hurdle model, showing an exponential distribution for the continuous component." width="90%"><p class="caption">
FIGURE 9.3: A hurdle model, showing an exponential distribution for the continuous component.
</p>
</div>
</div>
<div id="HurdleModelsProperties" class="section level3" number="9.3.2">
<h3>
<span class="header-section-number">9.3.2</span> Properties<a class="anchor" aria-label="anchor" href="#HurdleModelsProperties"><i class="fas fa-link"></i></a>
</h3>
<p>The expected value of the random variable <span class="math inline">\(X\)</span> can be found first separating the discrete and continuous parts of the distribution:
<span class="math display">\[\begin{align*}
  \operatorname{E}[X]
  &amp;= \operatorname{E}[X\mid X = 0] + \operatorname{E}[X\mid X &gt; 0]\\
  &amp;= (1 - p)\times 0 + p \operatorname{E}[X\mid X &gt; 0]\\
  &amp;= p \mu^+,
\end{align*}\]</span>
where <span class="math inline">\(\mu^+\)</span> denotes <span class="math inline">\(\operatorname{E}[X\mid X &gt; 0]\)</span>, the expected value of the distribution defined for <span class="math inline">\(X &gt; 0\)</span>.
Similarly,
<span class="math display">\[
  \operatorname{E}[X^2]
  = \operatorname{E}[X^2 \mid X &gt; 0]
  = p (\mu^2)^+,
\]</span>
where <span class="math inline">\((\mu^2)^+\)</span> denotes <span class="math inline">\(\operatorname{E}[X^2\mid X &gt; 0]\)</span>.
Then, the variance of <span class="math inline">\(X\)</span> is
<span class="math display">\[\begin{align*}
  \operatorname{var}[X]
  &amp;=  p[(\mu^2)^+ - p(\mu^+)^2]\\
  &amp;=  p(\sigma^2)^+ + p(1 - p)(\mu^+)^2.
\end{align*}\]</span>
where <span class="math inline">\(\sigma^2 = \operatorname{var}[X \mid X &gt; 0]\)</span>
The same approach also gives the MGF as
<span class="math display">\[\begin{align*}
  M_X(t)
  &amp;= (1 - p) + p\cdot M_{X^+}(t)\\
  &amp;= (1 - p) + p\cdot M_{X\mid X &gt; 0}(t),
\end{align*}\]</span>
where <span class="math inline">\(M_{X^+}(t)\)</span> is the MGF of the distribution defined for <span class="math inline">\(X &gt; 0\)</span>.</p>
<p>Clearly, further progress with these expressions requires knowing the distribution of <span class="math inline">\(X | X &gt; 0\)</span></p>
<div class="example">
<p><span id="exm:HurdleGamma" class="example"><strong>Example 9.7  (Hurdle model, using gamma distribution) </strong></span>Consider a random variable <span class="math inline">\(X\)</span> such that <span class="math inline">\(p = 0.75\)</span> (and hence <span class="math inline">\(\Pr(X = 0) = 1 - p = 0.25\)</span>), and where the distribution when <span class="math inline">\(X &gt; 0\)</span> follows a gamma distribution (Sect. <a href="ContinuousDistributions.html#GammaDistribution">8.5</a>) having <span class="math inline">\(\alpha = 2\)</span> and <span class="math inline">\(\beta = 1\)</span>, with the density function
<span class="math display">\[
  f_X^{+}(x; \alpha, \beta)
  = f_{X\mid X &gt; 0}(x; \alpha, \beta)
  = \frac{1}{\Gamma(2)} x \exp(-x)
  \quad\text{for $x &gt; 0$}.
\]</span>
For this gamma distribution, using results from Sect. <a href="ContinuousDistributions.html#GammaDistribution">8.5</a>, <span class="math inline">\(\mu^+ = \operatorname{E}[X\mid X &gt; 0] = \alpha\beta = 2\)</span> and <span class="math inline">\(\operatorname{var}[X\mid X &gt; 0] = \alpha\beta^2 = 2\)</span>.
Then, the probability function for <span class="math inline">\(X\)</span> is
<span class="math display">\[
  f_{X}(x)
  =
  \begin{cases}
     0.25                                &amp; \text{for $x = 0$}\\
     0.75 \times f_X^{+}(x; \alpha, \beta) &amp; \text{for $x &gt; 0$.}
  \end{cases}
\]</span>
Then
<span class="math display">\[\begin{align*}
  \operatorname{E}[X]
   &amp;= p\cdot \mu^+
    = 0.75 \times 2
    = 1.5\\
  \operatorname{var}[X]
   &amp;= p(\sigma^2)^+ + p(1 - p)(\mu^+)^2
   = 0.75\times 2 + 0.75\times 0.25\times 1.5^2
   \approx 1.921.
\end{align*}\]</span></p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:HurdleGamma"></span>
<img src="09-MixedDistributions_files/figure-html/HurdleGamma-1.png" alt="A hurdle model, using a gamma distribution for the continuous component." width="90%"><p class="caption">
FIGURE 9.4: A hurdle model, using a gamma distribution for the continuous component.
</p>
</div>
<p></p>
</div>
</div>
<div id="TweedieModels" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Compound Poisson-gamma distributions<a class="anchor" aria-label="anchor" href="#TweedieModels"><i class="fas fa-link"></i></a>
</h2>
<p>
Compound Poisson–gamma distribution take a different approach to modelling mixed random variables: Compound Poisson–gamma distributions model mixed random variables as a Poisson sum of independent gamma distributions.
Suppose the number of events observed (which is discrete) is <span class="math inline">\(N\)</span>, such that
<span class="math display" id="eq:PGp0">\[\begin{equation}
  N \sim \text{Pois}(\lambda).
   \tag{9.3}
\end{equation}\]</span>
That is, an event occurs <span class="math inline">\(N\)</span> times, but occurs at random following a Poisson distribution.
Given that <span class="math inline">\(N\)</span> has a Poisson distribution, it follows (from Sect. <a href="DiscreteDistributions.html#PoissonDistribution">7.7</a>) that
<span class="math display">\[
  \Pr(N = 0) = \exp(-\lambda)
\]</span>
is the probability that zero events are observed (i.e., <span class="math inline">\(N = 0\)</span>).
If, however, <span class="math inline">\(N &gt; 0\)</span>, then for <span class="math inline">\(i = 1, 2, \dots, N\)</span>, a continuous random variable <span class="math inline">\(Y_i\)</span> is observed, such that
<span class="math display">\[
   Y_i \sim \text{Gam}(\alpha_i, \beta).
\]</span>
If <span class="math inline">\(N = 0\)</span>, then no events <span class="math inline">\(Y_i\)</span> are observed at all; however, if <span class="math inline">\(N &gt; 0\)</span> then <span class="math inline">\(N\)</span> events are observed and
<span class="math display">\[
  X = \sum_{i = 1}^N Y_i
\]</span>
has a continuous distribution.
Then,
<span class="math display">\[
  X =
  \begin{cases}
    0                   &amp; \text{if $N = 0$};\\
    \sum_{i = 1}^N Y_i  &amp; \text{if $N &gt; 0$}.
  \end{cases}
\]</span>
By this definition <span class="math inline">\(X\)</span> has a <em>compound Poisson-gamma distribution</em>.
The distribution of <span class="math inline">\(X\)</span> has a probability mass at <span class="math inline">\(X = 0\)</span> where <span class="math inline">\(\Pr(Y = 0) = \Pr(N = 0) = \exp(-\lambda)\)</span>.</p>
<p><em>The probability functions for the compound Poisson-gamma distribution cannot be written in closed form.</em>
However, the probability function can be expressed as an infinite sum <span class="citation">(<a href="references.html#ref-dunn2005series">Dunn and Smyth 2005</a>)</span> or by inverting the MGF <span class="citation">(<a href="references.html#ref-mypapers:Dunn:fourier">Dunn and Smyth 2008</a>)</span> as discussed in Sect. <a href="ChapExpectation.html#DistributionFromMGF">5.5.5</a>.</p>
<p>The probability function as an infinite series can be determined from the development of the compound Poisson-gamma distribution above.
If <span class="math inline">\(N = 1\)</span> with <span class="math inline">\(\Pr(N = 1)\)</span> (from the Poisson distribution), then, <span class="math inline">\(X = Y\)</span> has the <span class="math inline">\(\text{Gam}(\alpha, \beta)\)</span> distribution.
That is,
<span class="math display">\[
  f_{X\mid N = 1}(x)
  = \frac{\beta^{\alpha}}{\Gamma(\alpha)} x^{\alpha -1}\exp(-\beta x) \quad \text{for $x &gt; 0$}.
\]</span></p>
<p>If <span class="math inline">\(N = 2\)</span> with <span class="math inline">\(\Pr(N = 2)\)</span> (from the Poisson distribution), then, <span class="math inline">\(X = Y_1 + Y_2\)</span>, where <span class="math inline">\(Y_i \sim\text{Gam}(\alpha, \beta)\)</span> for <span class="math inline">\(i = 1, 2\)</span>.
This means that <span class="math inline">\(X \sim \text{Gam}(2\alpha, \beta)\)</span>, which is easily shown using MGFS. (WHY; CROSS REF).
That is,
<span class="math display">\[
  f_{X\mid N = 2} (x)
  = \frac{\beta^{2\alpha}}{\Gamma(2\alpha)} x^{2\alpha -1}\exp(-\beta x) \quad \text{for $x &gt; 0$}.
\]</span></p>
<p>More generally, if <span class="math inline">\(N = n\)</span> with <span class="math inline">\(\Pr(N = n)\)</span> (from the Poisson distribution), then, <span class="math inline">\(X = Y_1 + Y_2+\cdots + Y_n\)</span>, and so <span class="math inline">\(X \sim\text{Gam}(n\alpha, \beta)\)</span>, so that
<span class="math display">\[
  f_{X\mid N = n} (x)
  = \frac{\beta^{n\alpha}}{\Gamma(n\alpha)} x^{n\alpha -1}\exp(-\beta x) \quad \text{for $x &gt; 0$}.
\]</span></p>
<p>Then, using the <em>Law of total probability</em> (Theorem <a href="ChapterProbability.html#thm:TotalProb">2.4</a>),
<span class="math display">\[\begin{align*}
  f_X(x)
  &amp;= \sum_{n = 1}^\infty \Pr(N = n) \cdot F_{X\mid N = n}(x)\\
  &amp;= \sum_{n = 1}^\infty \frac{\exp(-\lambda)\lambda^n}{n!} \cdot \frac{\beta^{n\alpha}}{\Gamma(n\alpha)} x^{n\alpha -1}\exp(-\beta x)\\
  &amp;= \exp(-\lambda - \beta x) \sum_{n = 1}^\infty \frac{\lambda^n}{n!} \frac{\beta^{n\alpha}}{\Gamma(n\alpha)} x^{n\alpha - 1}
\end{align*}\]</span>
for <span class="math inline">\(x &gt; 0\)</span>.
In addition, of course, we have that
<span class="math display">\[
  \Pr(X = 0) = \exp(-\lambda).
\]</span></p>
<hr>
<p>Even though the probability function has no closed form, the MGF is reasonably simple.
To find the MGF, first consider the value of <span class="math inline">\(N\)</span> as fixed; then, <span class="math inline">\(X = Y_1 + Y_2 + \cdots + Y_N\)</span> the MGF of <span class="math inline">\(X\)</span> is
<span class="math display">\[
  M_{X\mid N}(t) = \operatorname{E}[\exp(tX)\mid N].
\]</span>
Since the MGF of a sum of independent random variables is the product of their MGFs (Theorem <a href="ChapExpectation.html#thm:MGFIndependent">5.6</a>), we can assume that <span class="math inline">\(N\)</span> takes some specific value <span class="math inline">\(n\)</span> and write
<span class="math display">\[\begin{align*}
  M_{X\mid N}(t)
  &amp;= \operatorname{E}\left[ \exp\big(t(Y_2 + Y_2 + \cdots + Y_n)\big)\right] \\
  &amp;= \prod_{i = 1}^n \operatorname{E}[\exp(t Y_i)] \\
  &amp;= \left( M_Y(t)\right)^n
\end{align*}\]</span>
So the MGF of <span class="math inline">\(X\)</span> (rather than <span class="math inline">\(X\mid N\)</span> as above) is
<span class="math display">\[\begin{align*}
  M_X(t)
  &amp;= \operatorname{E}\left[ \operatorname{E}[ \exp(tX\mid N)]\right] \\
  &amp;= \operatorname{E}\left[ M_{X\mid N}(t))\right] \\
  &amp;= \operatorname{E}\left[ M_Y(t))^N\right] \\
\end{align*}\]</span>
and so
<span class="math display">\[
  M_X(t)=\exp\!\left\{\lambda\left[\Big(\frac{\beta}{\beta-t}\Big)^{\!\alpha}-1\right]\right\},\qquad t&lt;\beta
\]</span></p>
<hr>
<p>We have
<span class="math display">\[
M_X(t) = \mathbb{E}[e^{tX}]
        = \mathbb{E}\!\left[ \big(M_Y(t)\big)^{N} \right].
\]</span>
Writing the expectation as a sum over the possible values of <span class="math inline">\(N\)</span>,
<span class="math display">\[
  M_X(t)
  = \sum_{n=0}^\infty \big(M_Y(t)\big)^{n} \, \Pr(N = n).
\]</span>
Since <span class="math inline">\(N \sim \mathrm{Pois}(\lambda)\)</span>,
<span class="math display">\[
  \Pr(N = n) = \frac{\exp(-\lambda) \lambda^n}{n!}.
\]</span>
Substituting this expression into XREF
<span class="math display">\[\begin{align*}
  M_X(t)
  &amp;= \sum_{n = 0}^\infty
  \big(M_Y(t)\big)^{n} \cdot \frac{\exp(-\lambda) \lambda^n}{n!}\\
  &amp;= \exp(-\lambda) \sum_{n = 0}^\infty \frac{\left[\lambda \, M_Y(t)\right]^n}{n!}.
\end{align*}\]</span>
Using the series expansion <span class="math inline">\(\sum_{n = 0}^\infty z^n/n! = \exp(z)\)</span> (from Equation <a href="UsefulSeries.html#eq:Exponential">(B.8)</a>) with <span class="math inline">\(z = \lambda M_Y(t)\)</span>, this gives
<span class="math display">\[\begin{align*}
  M_X(t)
  &amp;= \exp(-\lambda) \cdot \exp\big(\lambda M_Y(t)\big)\\
  &amp;= \exp\{\lambda(M_Y(t) - 1) \\
  &amp;= \exp\!\left\{\lambda\left[\Big(\frac{\beta}{\beta-t}\Big)^{\!\alpha}-1\right]\right\},
\end{align*}\]</span>
provided <span class="math inline">\(t &lt; \beta\)</span>.</p>
<hr>
<p>From the MGF we can deduce
<span class="math display">\[\begin{align*}
  \operatorname{E}[X]
  &amp;= \lambda\alpha\/\beta\\
  \operatorname{var}[X]
  &amp;= \lambda\alpha(\alpha + 1)\beta^2.
\end{align*}\]</span></p>
<div class="example">
<p><span id="exm:PoissonGammaExample" class="example"><strong>Example 9.8  (Poisson--gamma distribution) </strong></span>Suppose
<span class="math display">\[
  N\sim\text{Pois}(\lambda = 3)
  \quad\text{and}\quad
  Y_i \sim\text{Gam}(\alpha = 1/2, \beta = 2/3)
\]</span>
(where <span class="math inline">\(\beta\)</span> is the scale parameter).
The mean and variance of <span class="math inline">\(X\)</span> is
<span class="math display">\[\begin{align*}
  \operatorname{E}[X]
  &amp;= \lambda\alpha\/\beta
   = 3\times \frac{1}{2}\times\frac{2}{3} = 1;\\
  \operatorname{var}[X]
  &amp;= \lambda\alpha(\alpha + 1)\beta^2
   = 3\times \left(\frac{1}{2}\times \frac{3}{2}\right)\left(\frac{5}{3}\right)^2 = 1.
\end{align*}\]</span>
Furthermore, from Equation <a href="ChapterMixedDistributions.html#eq:PGp0">(9.3)</a>,
<span class="math display">\[
  \Pr(X = 0) = \exp(-\lambda) = 0.0498.
\]</span>
This Poisson-gamma distribution is shown in Fig. <a href="ChapterMixedDistributions.html#fig:PoissonGammaExamples">9.5</a> (right panel).</p>
</div>
<!-- The parameters in the (alpha, beta, lambda) space:
\alpha = (2 - \xi)/(\xi - 1) [Not a function of (phi, mu)]
\beta = \phi(\xi - 1) / \mu^{\xi - 1}
\lambda = \mu^(2-\xi) / ( \phi (2-\xi))


So for instance:
alpha = 12 => xi = 5/3
alpha = 20 => xi = 22/21

-->
<pre><code>#&gt; alpha, beta, lambda, p0
#&gt; 20 0.04761905 1.05 0.3499377
#&gt; 0.5 0.6666667 3 0.04978707</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:PoissonGammaExamples"></span>
<img src="09-MixedDistributions_files/figure-html/PoissonGammaExamples-1.png" alt="Two compound Poisson--gamma models, both with mean and varaince set to $1$. The solid dot at $X = 0$ represents the discrete probability." width="90%"><p class="caption">
FIGURE 9.5: Two compound Poisson–gamma models, both with mean and varaince set to <span class="math inline">\(1\)</span>. The solid dot at <span class="math inline">\(X = 0\)</span> represents the discrete probability.
</p>
</div>
<p></p>
<div class="example">
<p><span id="exm:RainfallModelling" class="example"><strong>Example 9.9  (Modelling monthly rainfall) </strong></span>Modelling rainfall.
Using hurdle from Stern and Coe, Chandler and Wheater? Tobit thing from IWSM, and Poisson–gamma,</p>
</div>
</div>
<div id="MixedVariablesSimulation" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Simulation<a class="anchor" aria-label="anchor" href="#MixedVariablesSimulation"><i class="fas fa-link"></i></a>
</h2>
<div id="general" class="section level3" number="9.5.1">
<h3>
<span class="header-section-number">9.5.1</span> General<a class="anchor" aria-label="anchor" href="#general"><i class="fas fa-link"></i></a>
</h3>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:CensoredSim"></span>
<img src="09-MixedDistributions_files/figure-html/CensoredSim-1.png" alt="FIX!!!!! The solid dot at $X = 0$ represents the discrete probability." width="90%"><p class="caption">
FIGURE 9.6: FIX!!!!! The solid dot at <span class="math inline">\(X = 0\)</span> represents the discrete probability.
</p>
</div>
<p>…</p>
<p>A <em>hurdle</em> model could be used to model daily rainfall (e.g., <span class="citation">Stern and Coe (<a href="references.html#ref-stern1984model">1984</a>)</span>), using a Bernoulli distribution to distinguish wet and dry days, and then a gamma distribution to model rainfall amounts on wet days.</p>
<p>…</p>
<p>A compound Poisson–gamma model could also be used to model daily rainfall (e.g., <span class="citation">Yunus et al. (<a href="references.html#ref-yunus2017modelling">2017</a>)</span>).</p>
<div class="example">
<p><span id="exm:SimulationCensored" class="example"><strong>Example 9.10  (Simulations for censored models) </strong></span>Censored:</p>
</div>
<div class="example">
<p><span id="exm:SimulationHurdle" class="example"><strong>Example 9.11  (Simulations for hurdle models) </strong></span>Hurdle model; see Fig. <a href="ChapterMixedDistributions.html#fig:HurdleSim">9.7</a></p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:HurdleSim"></span>
<img src="09-MixedDistributions_files/figure-html/HurdleSim-1.png" alt="A simulation of the hurdle model. FIX!!!!! The solid dot at $X = 0$ represents the discrete probability." width="90%"><p class="caption">
FIGURE 9.7: A simulation of the hurdle model. FIX!!!!! The solid dot at <span class="math inline">\(X = 0\)</span> represents the discrete probability.
</p>
</div>
<div class="example">
<p><span id="exm:SimulationPGmodels" class="example"><strong>Example 9.12  (Simulations for compound Poisson--gamma models) </strong></span>Compound P–G; see Fig. <a href="ChapterMixedDistributions.html#fig:PoissonGammaSim">9.8</a></p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:PoissonGammaSim"></span>
<img src="09-MixedDistributions_files/figure-html/PoissonGammaSim-1.png" alt="A simulation of the compound Poisson--gamma models, both with mean and variance set to $1$. The solid dot at $X = 0$ represents the discrete probability." width="90%"><p class="caption">
FIGURE 9.8: A simulation of the compound Poisson–gamma models, both with mean and variance set to <span class="math inline">\(1\)</span>. The solid dot at <span class="math inline">\(X = 0\)</span> represents the discrete probability.
</p>
</div>
</div>
<div id="rainfall" class="section level3" number="9.5.2">
<h3>
<span class="header-section-number">9.5.2</span> Rainfall<a class="anchor" aria-label="anchor" href="#rainfall"><i class="fas fa-link"></i></a>
</h3>
<p>Simulation for the censored, hurdle and compound Poisson-gamma models can all be achieved by directly modelling the process by which the zeros are incorporated.
To demonstrate, consider modelling monthly rainfall at a certain location for one specific month each year.
Monthly rainfall is a mixed random variable; some months will record exactly zero rainfall, while months in which rain falls will have a continuous rainfall amount recorded.</p>
<p>Simulating monthly rainfall has uses in agriculture, hydrology, forestry and elsewhere (often as an input to other models).
The distribution of monthly rainfall obviously varies depending on location and the month selected for modelling; however, monthly rainfall at many locations typically contain some months (historically) that record zero rainfall (see, for example, <span class="citation">Hasan and Dunn (<a href="references.html#ref-hasan2010simple">2010a</a>)</span>).</p>
<p>Suppose we seek to model the monthly rainfall (im mm) <span class="math inline">\(R\)</span> at given location for a certain month, where about <span class="math inline">\(30\)</span>% of months record zero rainfall (i.e., <span class="math inline">\(\Pr(X = 0) = 0.30\)</span>), and the mean monthly rainfall (when rain is recorded) is about <span class="math inline">\(\mu_R = 50\)</span>.</p>
<p>We could model the monthly rainfall using a censored model (e.g., <span class="citation">Sansó and Guenni (<a href="references.html#ref-sanso2000nonstationary">2000</a>)</span>), a hurdle model (e.g, <span class="citation">Kenabatho et al. (<a href="references.html#ref-kenabatho2012stochastic">2012</a>)</span>) or a Poisson-gamma distribution (e.g., <span class="citation">Hasan and Dunn (<a href="references.html#ref-hasan2010simple">2010a</a>)</span>).</p>
<p>First consider a censored model.
The latent variable could represent how favourable the conditions are for rainfall’ say <span class="math inline">\(Y\sim N(\mu_R = 50, \sigma_R^2)\)</span>, with <span class="math inline">\(\Phi(0) = \Pr(Y &lt; 0) = 0.30\)</span>, for some variance <span class="math inline">\(\sigma_R^2\)</span>.
First, we can find the value of the standard normal variate <span class="math inline">\(Z\)</span> such that <span class="math inline">\(\Phi(z) = 0.30 = \Pr(Y &lt; 0)\)</span>:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_Zero_Rainfall</span> <span class="op">&lt;-</span> <span class="fl">0.30</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">p_Zero_Rainfall</span><span class="op">)</span> <span class="co"># This find z such that Phi(z) = 0.30</span></span>
<span><span class="co">#&gt; [1] -0.5244005</span></span></code></pre></div>
<p>This value of <span class="math inline">\(z\)</span> is the value such that
<span class="math display">\[
  z = -0.5244 = \frac{x^* - \mu_R}{\sigma^2_R} = \frac{0 - 50}{\sigma_R^2},
\]</span>
from which we find <span class="math inline">\(\sigma_R = 95.35\)</span>.
Thus, the monthly rainfall can be simulated:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">76103</span><span class="op">)</span> <span class="co"># For reproducibility</span></span>
<span><span class="va">num_Sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="va">mean_R</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">sd_R</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">mean_R</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">num_Sims</span>,</span>
<span>           mean <span class="op">=</span> <span class="va">mean_R</span>,</span>
<span>           sd <span class="op">=</span> <span class="va">sd_R</span><span class="op">)</span></span>
<span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">0.30</span></span>
<span></span>
<span><span class="co"># To get sd_R, note: z = (0 - mu)/sigma = \Phi(p0) =&gt; -mu/sigma = qnorm(p0)</span></span>
<span><span class="va">threshold_R</span> <span class="op">&lt;-</span> <span class="va">mean_R</span>  <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">p0</span><span class="op">)</span> <span class="op">*</span> <span class="va">sd_R</span> <span class="co"># SHOULD BE AT ZERO</span></span>
<span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">latent_Breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">250</span>, <span class="fl">450</span>,</span>
<span>                     by <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">###  truehist  is part of the MASS package,which must be loaded first, using: </span></span>
<span><span class="co">###  library(MASS)</span></span>
<span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/truehist.html">truehist</a></span><span class="op">(</span><span class="va">Y</span>,</span>
<span>         las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         breaks <span class="op">=</span> <span class="va">latent_Breaks</span>,</span>
<span>         col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span> <span class="st">"grey"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">latent_Breaks</span><span class="op">[</span><span class="va">latent_Breaks</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">plotColour1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">latent_Breaks</span><span class="op">[</span><span class="va">latent_Breaks</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>,  </span>
<span>         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Latent</span><span class="op">~</span><span class="va">variable</span><span class="op">)</span>,</span>
<span>         ylab <span class="op">=</span> <span class="st">"Probabiity fn"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Observed</span><span class="op">~</span><span class="va">variable</span><span class="op">~</span><span class="fu">italic</span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">truehist</span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">Y</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>         las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         breaks <span class="op">=</span> <span class="va">latent_Breaks</span><span class="op">[</span><span class="va">latent_Breaks</span><span class="op">&gt;=</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Observed</span><span class="op">~</span><span class="va">variable</span><span class="op">)</span>,</span>
<span>         ylab <span class="op">=</span> <span class="st">"Probabiity fn"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Observed</span><span class="op">~</span><span class="va">variable</span><span class="op">~</span><span class="fu">italic</span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>,</span>
<span>       y <span class="op">=</span> <span class="va">p0</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="09-MixedDistributions_files/figure-html/unnamed-chunk-2-1.png" width="672"></div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_Sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co">#Simulate</span></span>
<span></span>
<span><span class="co"># Compute max monthly rainfall</span></span></code></pre></div>
<hr>
<p>HURDLE:</p>
<p>To model the rainfall using a hurdle model, we use <span class="math inline">\(1 - p = 0.3\)</span> for the probability that no monthly rainfall is recorded; that is, <span class="math inline">\(p = 0.7\)</span>.
The information also gives <span class="math inline">\(\mu = \operatorname{E} = 50\)</span>; from Sect. <a href="ChapterMixedDistributions.html#HurdleModelsProperties">9.3.2</a>
<span class="math display">\[
  \mu = p \mu^+,
\]</span>
and so <span class="math inline">\(\mu^+ = \mu/p = 50/0.7 approx 71.43\)</span> is the mean rainfall, conditional on rain being recorded.
We could suppose an exponential distribution (with rate parameter <span class="math inline">\(\lambda\)</span>) for the rainfall amounts when rain is recorded; thus <span class="math inline">\(\operatorname{E}[X] = 1\lambda = 71.43\)</span> and so <span class="math inline">\(\lambda = 0.01399972\)</span>.
So the hurdle model is:
<span class="math display">\[\begin{align*}
  f_R(r)
  &amp;=
  \begin{cases}
    0.3 &amp; \\
    0.3\lambda \exp(-r/\lambda)
  \end{cases}\\
  &amp;=
  \begin{cases}
    0.3 &amp; \\
    0.004199916 \exp(-r/0.01399972).
  \end{cases}
\end{align*}\]</span></p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">76103</span><span class="op">)</span> <span class="co"># For reproducibility</span></span>
<span><span class="va">num_Sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">0.30</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">p0</span></span>
<span></span>
<span><span class="va">mean_R</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">mean_Rpositive</span> <span class="op">&lt;-</span> <span class="va">mean_R</span><span class="op">/</span><span class="va">p</span></span>
<span><span class="va">lambda_Exp</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">mean_Rpositive</span></span>
<span>  </span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span> <span class="cn">NA</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">num_Sims</span><span class="op">)</span></span>
<span><span class="va">p_Each_Month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">num_Sims</span>,</span>
<span>                       size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                       prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_Sims</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">p_Each_Month</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">R</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># No rainfall recorded</span></span>
<span>  <span class="op">}</span>  <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">R</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">1</span>, rate <span class="op">=</span> <span class="va">lambda_Exp</span><span class="op">)</span>    </span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">###</span></span>
<span><span class="co">###  truehist  is part of the MASS package,which must be loaded first, using: </span></span>
<span><span class="co">###  library(MASS)</span></span>
<span><span class="fu">truehist</span><span class="op">(</span><span class="va">R</span>,</span>
<span>         las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Hurdle</span><span class="op">~</span><span class="va">model</span><span class="op">)</span>,</span>
<span>         ylab <span class="op">=</span> <span class="st">"Probabiity fn"</span>,</span>
<span>         xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Observed</span><span class="op">~</span><span class="va">rainfall</span><span class="op">~</span><span class="fu">italic</span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>,</span>
<span>       y <span class="op">=</span> <span class="va">p0</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="09-MixedDistributions_files/figure-html/unnamed-chunk-4-1.png" alt="HURDLE MODEL" width="672"><p class="caption">
FIGURE 9.9: HURDLE MODEL
</p>
</div>
<p><strong>GAMMA SEEMS TO FAIL WITH THESE PARAMETERS ANYWAY: but check</strong></p>
<p>If we use the variance from the censored model (i.e., <span class="math inline">\(\sigma^2 = 95.35\)</span>), we can find the variance of the gamma distribution:
<span class="math display">\[\begin{align*}
  \operatorname{var}[X]
  &amp;= p(\sigma^2)^+ + p(1 - p)(\mu^+)^2\\
  95.35
  &amp;= 0.7(\sigma^2)^+ + 0.7\times 0.3(71.43)^2;
\end{align*}\]</span>
solving shows that we should use <span class="math inline">\((\sigma^2)^ = ??\)</span> for the variance of the gamma distribution (when <span class="math inline">\(X &gt; 0\)</span>).</p>
<p>We could suppose a gamma distribution for the rainfall amounts when rain is recorded; thus <span class="math inline">\(\alpha\beta = 71.43\)</span>.
If we use the variance from the censored model (i.e., <span class="math inline">\(\sigma^2 = 95.35\)</span>), we can find the variance of the gamma distribution:
<span class="math display">\[\begin{align*}
  \operatorname{var}[X]
  &amp;= p(\sigma^2)^+ + p(1 - p)(\mu^+)^2\\
  95.35
  &amp;= 0.7(\sigma^2)^+ + 0.7\times 0.3(71.43)^2;
\end{align*}\]</span>
solving shows that we should use <span class="math inline">\((\sigma^2)^ = ??\)</span> for the variance of the gamma distribution (when <span class="math inline">\(X &gt; 0\)</span>).</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span> <span class="fl">95.35</span> <span class="op">-</span> <span class="fl">0.7</span><span class="op">*</span><span class="fl">0.3</span><span class="op">*</span><span class="op">(</span><span class="fl">71.43</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">)</span><span class="op">/</span><span class="fl">0.7</span></span>
<span><span class="co">#&gt; [1] -1394.459</span></span></code></pre></div>
<p>OOPS!!</p>
<hr>
<p>P–G DSTN:</p>
<p>Need to convert <span class="math inline">\(p_0\)</span>, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> into <span class="math inline">\(\lambda, \alpha, \beta\)</span>. How (easily)?</p>
<hr>
<p>BUT WHY? JUST USE THEORETICAL DISTN! Well, we wan rainfall values to use upstream in a simulation for (eg) cropping.
MAXIMUM RAINFALL, with CI-like interval? Again… could do with distribution</p>
<p>PERHAPS CONNECT TO SOI</p>
</div>
</div>
<div id="MixedDistributionsExercises" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> Exercises<a class="anchor" aria-label="anchor" href="#MixedDistributionsExercises"><i class="fas fa-link"></i></a>
</h2>
<p>Selected answers appear in Sect. <a href="selected-solutions.html#AnswersChapMixedDistributions">E.9</a>.</p>
<div class="exercise">
<p><span id="exr:LatentVar" class="exercise"><strong>Exercise 9.1  </strong></span></p>
<ol start="4" style="list-style-type: decimal">
<li>Medical Costs
Observed variable: Annual medical expenses.</li>
</ol>
<p>Latent variable (<span class="math inline">\(z\)</span>): Underlying health need or risk.</p>
<p>Censoring: Many people incur <span class="math inline">\(0\)</span> expenses in a given year, despite possibly having latent health risks or needs.</p>
<p>Interpretation: People with latent need below some threshold never seek care (e.g. due to costs, access, or asymptomatic cases), leading to observed <span class="math inline">\(0\)</span>.</p>
</div>
<div class="exercise">
<p><span id="exr:LatentVar2" class="exercise"><strong>Exercise 9.2  </strong></span></p>
<ol start="5" style="list-style-type: decimal">
<li>Credit Card Balances
Observed variable: Balance at end of month.</li>
</ol>
<p>Latent variable (<span class="math inline">\(z\)</span>): Willingness or propensity to use credit.</p>
<p>Censoring: Some users consistently pay in full and carry no balance.</p>
<p>Interpretation: Some people have low latent demand for borrowing; observed balance is zero if the latent borrowing desire is below threshold.</p>
</div>
<div class="exercise">
<p><span id="exr:TobitHarder" class="exercise"><strong>Exercise 9.3  </strong></span>Consider a latent variable <span class="math inline">\(Y\)</span>, and an observed variable <span class="math inline">\(X = \text{max}(0, Y)\)</span>.
Suppose that <span class="math inline">\(Y\)</span> has the normal distribution
<span class="math display">\[
  Y \sim N(\mu = 1.5, \sigma^2 = 1),
\]</span>
so that <span class="math inline">\(\operatorname{E}[Y] = 1.5\)</span> and <span class="math inline">\(\operatorname{var}[Y] = 1\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Determine <span class="math inline">\(\Pr(Y &lt; 0)\)</span>, where <span class="math inline">\(Z\)</span> is a standard normal variate (Sect. <a href="ContinuousDistributions.html#StandardNormal">8.3.2</a>).</li>
<li>Using the functions <span class="math inline">\(\Phi(\cdot)\)</span> and <span class="math inline">\(\phi(\cdot)\)</span>, determine the probability function for <span class="math inline">\(X\)</span>.</li>
<li>Plot this probability function.</li>
</ol>
</div>

</div>
</div>



<div class="chapter-nav">
<div class="prev"><a href="ContinuousDistributions.html"><span class="header-section-number">8</span> Standard continuous distributions</a></div>
<div class="next"><a href="ChapMultivariate.html"><span class="header-section-number">10</span> Multivariate distributions*</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ChapterMixedDistributions"><span class="header-section-number">9</span> Mixed distributions</a></li>
<li><a class="nav-link" href="#introduction-3"><span class="header-section-number">9.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#CensoredModels"><span class="header-section-number">9.2</span> Censored model</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#CensoredModelsDefinitions"><span class="header-section-number">9.2.1</span> Definitions</a></li>
<li><a class="nav-link" href="#CensoredModelsProperties"><span class="header-section-number">9.2.2</span> Properties</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#HurdleModels"><span class="header-section-number">9.3</span> Hurdle models</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#HurdleModelsDefinitions"><span class="header-section-number">9.3.1</span> Definitions</a></li>
<li><a class="nav-link" href="#HurdleModelsProperties"><span class="header-section-number">9.3.2</span> Properties</a></li>
</ul>
</li>
<li><a class="nav-link" href="#TweedieModels"><span class="header-section-number">9.4</span> Compound Poisson-gamma distributions</a></li>
<li>
<a class="nav-link" href="#MixedVariablesSimulation"><span class="header-section-number">9.5</span> Simulation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#general"><span class="header-section-number">9.5.1</span> General</a></li>
<li><a class="nav-link" href="#rainfall"><span class="header-section-number">9.5.2</span> Rainfall</a></li>
</ul>
</li>
<li><a class="nav-link" href="#MixedDistributionsExercises"><span class="header-section-number">9.6</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PeterKDunn/DistTheory/blob/main/09-MixedDistributions.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PeterKDunn/DistTheory/edit/main/09-MixedDistributions.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>
</div>
<hr>
<div class="footer"><span style="color: gray; font-size:0.7em">Peter K. Dunn, 2024: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></span></div>
  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Theory of Statistical Distributions</strong>" was written by Peter K. Dunn. It was last built on Last updated: 2025-12-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
