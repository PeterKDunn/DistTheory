<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>13 Order statistcs | The Theory of Statistical Distributions</title>
<meta name="author" content="Peter K. Dunn">
<meta name="description" content="On completion of this chapter, you should be able to: determine the sampling distributions of a given order statistics. explain how to find the distributions of order statistics. use order...">
<meta name="generator" content="bookdown 0.45 with bs4_book()">
<meta property="og:title" content="13 Order statistcs | The Theory of Statistical Distributions">
<meta property="og:type" content="book">
<meta property="og:description" content="On completion of this chapter, you should be able to: determine the sampling distributions of a given order statistics. explain how to find the distributions of order statistics. use order...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="13 Order statistcs | The Theory of Statistical Distributions">
<meta name="twitter:description" content="On completion of this chapter, you should be able to: determine the sampling distributions of a given order statistics. explain how to find the distributions of order statistics. use order...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/rglWebGL-binding-1.3.31/rglWebGL.js"></script><link href="libs/rglwidgetClass-1.3.31/rgl.css" rel="stylesheet">
<script src="libs/rglwidgetClass-1.3.31/rglClass.min.js"></script><script src="libs/CanvasMatrix4-1.3.31/CanvasMatrix.min.js"></script><link rel="shortcut icon" href="icons/iconmonstr-chart-1-240.png">
<script>
    document.addEventListener('DOMContentLoaded', function() {
      // Find all R code blocks that should be toggleable.
      // Our Lua filter adds the 'r-code-box' class to the code block.
      var codeBlocks = document.querySelectorAll('.r-code-box');

      codeBlocks.forEach(function(codeBlock) {
        // Create the button element
        var button = document.createElement('button');
        button.textContent = 'Show R Code'; // Initial text for the button
        button.className = 'code-toggle-button'; // Assign CSS class

        // Insert the button directly before the code block.
        // The codeBlock's parentNode is the div.figure-with-code container.
        // We insert the button as a sibling of the codeBlock within that container.
        codeBlock.parentNode.insertBefore(button, codeBlock);

        // Hide the code block initially by default.
        codeBlock.style.display = 'none';

        // Add a click event listener to the button
        button.addEventListener('click', function() {
          if (codeBlock.style.display === 'none') {
            codeBlock.style.display = 'block'; // Show the code block
            button.textContent = 'Hide R Code'; // Change button text
          } else {
            codeBlock.style.display = 'none'; // Hide the code block
            button.textContent = 'Show R Code'; // Change button text back
          }
        });
      });
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/columns.css">
<link rel="stylesheet" href="html/largerDie.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Theory of Statistical Distributions</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">Theoretical foundations</li>
<li><a class="" href="ChapterSetTheory.html"><span class="header-section-number">1</span> Essentials of set theory</a></li>
<li><a class="" href="ChapterProbability.html"><span class="header-section-number">2</span> Probability</a></li>
<li><a class="" href="DistributionRandomVariables.html"><span class="header-section-number">3</span> Random variables and their distributions</a></li>
<li><a class="" href="ChapBivariate.html"><span class="header-section-number">4</span> Bivariate distributions</a></li>
<li><a class="" href="ChapExpectation.html"><span class="header-section-number">5</span> Mathematical expectation</a></li>
<li><a class="" href="ChapterTransformations.html"><span class="header-section-number">6</span> Transformations of random variables</a></li>
<li class="book-part">Standard univariate probability distributions</li>
<li><a class="" href="DiscreteDistributions.html"><span class="header-section-number">7</span> Standard discrete distributions</a></li>
<li><a class="" href="ContinuousDistributions.html"><span class="header-section-number">8</span> Standard continuous distributions</a></li>
<li><a class="" href="ChapterMixedDistributions.html"><span class="header-section-number">9</span> Mixed distributions</a></li>
<li class="book-part">Multivariate random variables and distributions*</li>
<li><a class="" href="ChapMultivariate.html"><span class="header-section-number">10</span> Multivariate distributions*</a></li>
<li><a class="" href="MultivariateExtensions.html"><span class="header-section-number">11</span> Expectations for multivariate distributions*</a></li>
<li class="book-part">Sampling distributions</li>
<li><a class="" href="SamplingDistributions.html"><span class="header-section-number">12</span> Describing samples</a></li>
<li><a class="active" href="OrderStatisticsChapter.html"><span class="header-section-number">13</span> Order statistcs</a></li>
<li><a class="" href="BayesianIntro.html"><span class="header-section-number">14</span> Introduction to Bayesian statistics</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="SymbolsUsed.html"><span class="header-section-number">A</span> Symbols used</a></li>
<li><a class="" href="UsefulSeries.html"><span class="header-section-number">B</span> Some useful series</a></li>
<li><a class="" href="ShortRIntro.html"><span class="header-section-number">C</span> Short R introduction</a></li>
<li><a class="" href="UseRDistributions.html"><span class="header-section-number">D</span> Using R with distributions</a></li>
<li><a class="" href="selected-solutions.html"><span class="header-section-number">E</span> Selected solutions</a></li>
<li><a class="" href="references.html"><span class="header-section-number">F</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PeterKDunn/DistTheory">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="OrderStatisticsChapter" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> Order statistcs<a class="anchor" aria-label="anchor" href="#OrderStatisticsChapter"><i class="fas fa-link"></i></a>
</h1>
<div class="objectivesBox objectives">
<p>On completion of this chapter, you should be able to:</p>
<ul>
<li>determine the sampling distributions of a given order statistics.</li>
<li>explain how to find the distributions of order statistics.</li>
<li>use order statistics in practical problems.</li>
</ul>
</div>
<div id="OrderStatisticsIntro" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Introduction<a class="anchor" aria-label="anchor" href="#OrderStatisticsIntro"><i class="fas fa-link"></i></a>
</h2>
<p>
In many applications, information about the minimum value, or the maximum value, in a sample is useful.
For example, knowing the maximum water height in a dam is useful for modelling controlled water releases; the mean water height is of little use here.
The minimum and maximum values in a sample are examples of <em>order statistics</em>.</p>
<p>More generally, order statistics refer to the values in a sample arranged in increasing order.
For a given random sample <span class="math inline">\(X_1, X_2, \dots, X_n\)</span>, the order statistics are defined and denoted as
<span class="math display">\[
  X_{(1)} \le X_{(2)} \le \cdots \le X_{(n)}
\]</span>
<span class="math inline">\(X_{(k)}\)</span> is the <span class="math inline">\(k\)</span>th order statistic, the <span class="math inline">\(k\)</span>th smallest value in a sample.</p>
<p>Important order statistics in a sample of size <span class="math inline">\(n\)</span> include the minimum value <span class="math inline">\(X_{(1)}\)</span>, the maximum value <span class="math inline">\(X_{(n)}\)</span>, and the range <span class="math inline">\(X_{(n)} - X_{(1)}\)</span>.</p>
<p>The median is also an important order statistic:
<span class="math display">\[
   \text{median} =
   \begin{cases}
      \displaystyle\frac{X_{(n/2)} + X_{(n/2 + 1)}}{2} &amp; \text{for $n$ even;}\\
      X_{([n + 1]/2)}                     &amp; \text{for $n$ is odd.}
  \end{cases}
\]</span>
In some circumstances, the median for <span class="math inline">\(n\)</span> even uses a slightly formula.</p>
<p>The inter-quartile range (IQR)index{Inter-quartile range} is also an order statistic:
<span class="math display">\[
   \text{IQR}
   =
   X_{(3n/4)} - X_{(n/4 )}.
\]</span>
Unless the sample size <span class="math inline">\(n\)</span> is a multiple of four, the exact order statistics <span class="math inline">\(X_{(3n/4)}\)</span> and <span class="math inline">\(X_{(n/4 )}\)</span> may not be defined, and in these situation different ways exist to approximate these order statistics.</p>
<div class="example">
<p><span id="exm:OrderedStatisticsMedianOddn" class="example"><strong>Example 13.1  (Median: $n$ odd) </strong></span>Consider a sample of five die rolls, say <span class="math inline">\(X_i\)</span>:
<span class="math display">\[
  x_1 = 5; \quad x_2 = 3; \quad  x_3 = 5; \quad  x_4 = 2; \quad  x_5 = 6.
\]</span>
The order statistics are
<span class="math display">\[
  x_{(1)} = 2; \quad  x_{(2)} = 3; \quad  x_{(3)} = 5; \quad  x_{(4)} = 5; \quad  x_{(5)} = 6.
\]</span>
The minimum value is <span class="math inline">\(X_{(1)} = 2\)</span>, and the maximum value is <span class="math inline">\(X_{(5)} = 6\)</span>.
The median value is <span class="math inline">\(X_{(3)} = 5\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:OrderedStatisticsMedianEvenn" class="example"><strong>Example 13.2  (Median: $n$ even) </strong></span>Consider a sample of six die rolls, say <span class="math inline">\(Y_i\)</span>:
<span class="math display">\[
  y_1 = 1; \quad y_2 = 4; \quad  y_3 = 6; \quad  y_4 = 2; \quad  y_5 = 5 \quad  y_6 = 1.
\]</span>
The order statistics are
<span class="math display">\[
  y_{(1)} = 1; \quad  y_{(2)} = 1; \quad  y_{(3)} = 2; \quad  y_{(4)} = 4; \quad  y_{(5)} = 5; \quad  y_{(6)} = 6.
\]</span>
The minimum value is <span class="math inline">\(y_{(1)} = 1\)</span>, and the maximum value is <span class="math inline">\(y_{(4)} = 6\)</span>.
The median value is <span class="math inline">\(\left(X_{(3)} + X_{(4)}\right)/2 = (2 + 4)/2 = 3\)</span>, which is not one of the observations in the sample.</p>
</div>
<p>As with any statistic, the order statistics have a sampling distribution.
The easiest order statistics for which to find the distribution are the maximum value (the <span class="math inline">\(n\)</span>th order statistic; Sect. <a href="OrderStatisticsChapter.html#OrderStatisticsMaxDistribution">13.2</a>) and the minimum value (first order statistic; Sect. <a href="OrderStatisticsChapter.html#OrderStatisticsMinDistribution">13.3</a>).</p>
</div>
<div id="OrderStatisticsMaxDistribution" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> Sampling distribution of the maximum value<a class="anchor" aria-label="anchor" href="#OrderStatisticsMaxDistribution"><i class="fas fa-link"></i></a>
</h2>
<p>Consider a sample of size <span class="math inline">\(n\)</span>, say <span class="math inline">\(X_1, X_2, \dots, X_n\)</span>, with all <span class="math inline">\(X_i\)</span> drawn independently from a distribution with density function <span class="math inline">\(f_X(x)\)</span> and distribution function <span class="math inline">\(F_X(x)\)</span>.
Then define <span class="math inline">\(X_{(n)} = \operatorname{max}\{X_1, X_2, \dots, X_n\}\)</span> as the maximum value in the sample.</p>
<p>The distribution function for <span class="math inline">\(X_{(n)}\)</span> is <span class="math inline">\(F_{X_{(n)}}(x) = \Pr(X_{{(n)}} \le x)\)</span>, by definition: the probability that the maximum value is less than some given value <span class="math inline">\(x\)</span>.
If the value of <span class="math inline">\(X_{(n)}\)</span> is less than or equal to some value <span class="math inline">\(x\)</span>, then the values in the sample must be less than that value <span class="math inline">\(x\)</span>.
Since the observations <span class="math inline">\(X_1, X_2, \dots X_n\)</span> are all independent and identically distributed, the probability that <em>all</em> observations are less than or equal to some value <span class="math inline">\(x\)</span> is
<span class="math display">\[
   F_{X_{(n)}}(x) = [F_X(x)]^{n}
\]</span>
for <span class="math inline">\(x \in R_X\)</span>.</p>
<p>The density function then is found by differentiating <span class="math inline">\(F_{X_{(n)}}(x)\)</span> with respect to <span class="math inline">\(x\)</span> (Sect. <a href="DistributionRandomVariables.html#DistributionFunction">3.4</a>), to obtain
<span class="math display">\[
   f_{X_{(n)}}(x) = n [F_X(x)]^{n - 1} \times f_X(x)
\]</span>
for <span class="math inline">\(x \in R_X\)</span>.</p>
<div class="definition">
<p><span id="def:OrderStatsMaximumDistn" class="definition"><strong>Definition 13.1  (Distribution of the maximum value) </strong></span>Consider a sample of size <span class="math inline">\(n\)</span>, say <span class="math inline">\(X_1, X_2, \dots, X_n\)</span>, with all <span class="math inline">\(X_i\)</span> drawn independently from a continuous distribution with density function <span class="math inline">\(f_X(x)\)</span> and distribution function <span class="math inline">\(F_X(x)\)</span>.
Then the distribution function for the maximum value (order statistic <span class="math inline">\(X_{(n)}\)</span>) is
<span class="math display">\[
   F_{X_{(n)}}(x) =
       \begin{cases}
      0                   &amp; \text{for $x \le 0$}\\
      [F_X(x)]^{n}        &amp; \text{for $0 &lt; x &lt; 1$}\\
      1                   &amp; \text{for $x \ge 1$.}
    \end{cases}
\]</span>
and the density function is
<span class="math display">\[
   f_{X_{(n)}}(x) =
      n [F_X(x)]^{n - 1} \times f_X(x)
\]</span>
for <span class="math inline">\(x\in R_X\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:OrderStatsMaxUniform" class="example"><strong>Example 13.3  (Uniform distribution: maximum value) </strong></span>For the continuous uniform distribution (Sect. <a href="ContinuousDistributions.html#ContinuousUniform">8.2</a>) defined on <span class="math inline">\([0, 1]\)</span>, the density function is
<span class="math display" id="eq:ContinuousUniformPMForder">\[\begin{equation}
   f_X(x; 0, 1)  = 1 \quad\text{for $0\le x\le 1$},
   \tag{13.1}
\end{equation}\]</span>
and the distribution function is
<span class="math display">\[
  F_X(x; 0, 1) =
  \begin{cases}
    0                &amp; \text{for $x &lt; 0$};\\
    \displaystyle x  &amp; \text{for $0 \le x \le 1$};\\
    1                &amp; \text{for $x &gt; 1$}.
  \end{cases}
\]</span>
Hence, the density function for the maximum value in a sample of size <span class="math inline">\(n\)</span> is, from Def. <a href="OrderStatisticsChapter.html#def:OrderStatsMaximumDistn">13.1</a>,
<span class="math display">\[
  f_{X_{(n)}}(x)
  = n\, x^{n - 1} \times 1
  = n \, x^{n - 1},
\]</span>
for <span class="math inline">\(0 &lt; x &lt; 1\)</span>.
In addition, the distribution function is, from Def. <a href="OrderStatisticsChapter.html#def:OrderStatsMaximumDistn">13.1</a>,
<span class="math display">\[
  F_{X_{(n)}}(x)
  =
  \begin{cases}
    0       &amp; \text{for $x &lt; 0$}\\
    x^n     &amp; \text{for $0 \le x \le 1$}\\
    1       &amp; \text{for $x &gt; 1$.}
  \end{cases}
\]</span></p>
<p>Using the density function of the maximum value as given above, the expected value and the variance of the maximum value can be found from their definitions; for example,
<span class="math display">\[\begin{align*}
  \operatorname{E}[X_{(n)}]   &amp;= \int_0^1 x \cdot n x^{n - 1}\, dx   = \frac{n}{n + 1};\\
  \operatorname{E}[X^2_{(n)}] &amp;= \int_0^1 x^2 \cdot n x^{n - 1}\, dx = \frac{n}{n + 2};\\
  \operatorname{var}[X_{(n)}] &amp;= \frac{n}{n + 2} - \left( \frac{n}{n + 1} \right)^2.
\end{align*}\]</span></p>
<p>For the case where <span class="math inline">\(n = 10\)</span>, then:
<span class="math display">\[
  f_{X_{(n)}}(x)
  = 10 \, x^{9},
\]</span>
for <span class="math inline">\(0 &lt; x &lt; 1\)</span>.
In addition, the distribution function is, from Def. <a href="OrderStatisticsChapter.html#def:OrderStatsMaximumDistn">13.1</a>,
<span class="math display">\[
  F_{X_{(n)}}(x)
  =
  \begin{cases}
    0               &amp; \text{for $x &lt; 0$}\\
    x^{10}          &amp; \text{for $0 \le x \le 1$}\\
    1               &amp; \text{for $x &gt; 1$.}
  \end{cases}
\]</span>
Fig. <a href="OrderStatisticsChapter.html#fig:OrderStatsMax">13.1</a> shows the probability density function (left panel) and the distribution function (right panel).
For example, the probability that the largest value in a sample of size <span class="math inline">\(10\)</span> is smaller than <span class="math inline">\(0.8\)</span> is
<span class="math display">\[
  F_{(10)}(0.8) = 0.8^{10} = 0.1073742\dots
\]</span></p>
<p>The expected value and variance of the maximum value are:
<span class="math display">\[\begin{align*}
  \operatorname{E}[X_{(n)}]   &amp;= \frac{10}{11} \approx 0.90909;\\
  \operatorname{var}[X_{(n)}] &amp;= \frac{10}{12} - \left( \frac{10}{11} \right)^2\approx 0.006887.
\end{align*}\]</span>
These results can be confirmed using a quick computer simulation:</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_Sims</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">sample_Size</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">x_Max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span> dim <span class="op">=</span> <span class="va">num_Sims</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_Sims</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">sample_Size</span>,</span>
<span>             min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">x_Max</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Mean of the maximum value"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x_Max</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mean of the maximum value 0.908552</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Variance of the maximum value"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x_Max</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Variance of the maximum value 0.006912192</span></span></code></pre></div>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:OrderStatsMax"></span>
<img src="13-OrderStatistics_files/figure-html/OrderStatsMax-1.png" alt="The distribution of the maximum value for the uniform distribution on $[0, 1]$ in a sample of size\ $10$. Left: the probability density function of the maximum value $X_{(10)}$. Right: the distribution function of the maximum value $X_{(10)}$. The grey, dotted lines show $F_{(10)}(0.8)$." width="90%"><p class="caption">
FIGURE 13.1: The distribution of the maximum value for the uniform distribution on <span class="math inline">\([0, 1]\)</span> in a sample of size <span class="math inline">\(10\)</span>. Left: the probability density function of the maximum value <span class="math inline">\(X_{(10)}\)</span>. Right: the distribution function of the maximum value <span class="math inline">\(X_{(10)}\)</span>. The grey, dotted lines show <span class="math inline">\(F_{(10)}(0.8)\)</span>.
</p>
</div>
</div>
<div id="OrderStatisticsMinDistribution" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> Sampling distribution of the minimum value<a class="anchor" aria-label="anchor" href="#OrderStatisticsMinDistribution"><i class="fas fa-link"></i></a>
</h2>
<p>Consider again a sample of size <span class="math inline">\(n\)</span>, say <span class="math inline">\(X_1, X_2, \dots, X_n\)</span>, with all <span class="math inline">\(X_i\)</span> drawn independently from a distribution with density function <span class="math inline">\(f_X(x)\)</span> and distribution function <span class="math inline">\(F_X(x)\)</span>.
Then define <span class="math inline">\(X_{(1)} = \operatorname{min}\{X_1, X_2, \dots, X_n\}\)</span> as the minimum value in the sample.</p>
<p>The distribution function for <span class="math inline">\(X_{(1)}\)</span> is <span class="math inline">\(F_{X_{(1)}}(x) = \Pr(X_{{(1)}} \le x)\)</span>.
If the value of <span class="math inline">\(X_{(1)}\)</span> is less than or equal to some value <span class="math inline">\(x\)</span>, then there must be <em>at least</em> one value less than that value <span class="math inline">\(x\)</span>.
Alternatively, this means that we cannot have <em>all</em> the sample values larger than the value <span class="math inline">\(x\)</span> (as then there must be <em>none</em> that are less than <span class="math inline">\(x\)</span>).</p>
<p>The probability that <em>all</em> values are larger than <span class="math inline">\(x\)</span> is <span class="math inline">\([1 - F_X(x)]^n\)</span> (since all <span class="math inline">\(n\)</span> values have identical, independent distributions).
Hence, the probability that <em>all</em> values are <em>not</em> larger than <span class="math inline">\(x\)</span> is
<span class="math display">\[
  1 - [1 - F_X(x)]^n
\]</span>
for <span class="math inline">\(x \in R_X\)</span>.
The density function is found by differentiating <span class="math inline">\(F_{X_{(1)}}(x)\)</span> with respect to <span class="math inline">\(x\)</span> (Sect. <a href="DistributionRandomVariables.html#DistributionFunction">3.4</a>), to obtain
<span class="math display">\[
  f_{X_{(1)}}(x) = n [1 - F_X(x)]^{n-1} f_X(x)
\]</span>
for <span class="math inline">\(x \in R_X\)</span>.</p>
<div class="definition">
<p><span id="def:OrderStatsMinimumDistn" class="definition"><strong>Definition 13.2  (Distribution of the minimum value) </strong></span>Consider a sample of size <span class="math inline">\(n\)</span>, say <span class="math inline">\(X_1, X_2, \dots, X_n\)</span>, with all <span class="math inline">\(X_i\)</span> drawn independently from a continuous distribution with density function <span class="math inline">\(f_X(x)\)</span> and distribution function <span class="math inline">\(F_X(x)\)</span>.
Then the distribution function for the minimum value (order statistic <span class="math inline">\(X_{(1)}\)</span>) is
<span class="math display">\[
   F_{(X_1)}(x) = 1 - [1 - F_X(x)]^{n}
\]</span>
and the density function is
<span class="math display">\[
   f_{(X_1)}(x) = n [1 - F_X(x)]^{n - 1} \times f_X(x)
\]</span>
for <span class="math inline">\(x\in R_X\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:OrderStatsMinUniform" class="example"><strong>Example 13.4  (Uniform distribution: minimum value) </strong></span>For the continuous uniform distribution (Sect. <a href="ContinuousDistributions.html#ContinuousUniform">8.2</a>) defined on <span class="math inline">\([0, 1]\)</span>, the density function and distribution function are giuven in Example <a href="OrderStatisticsChapter.html#exm:OrderStatsMaxUniform">13.3</a>.
Using these, the density function for the minimum value in a sample of size <span class="math inline">\(n\)</span> is
<span class="math display">\[
  f_{X_{(1)}}(x)
  = n(1 - x)^{n - 1} \times 1
  = n (1- x)^{n - 1},
\]</span>
for <span class="math inline">\(0 &lt; x &lt; 1\)</span>.
In addition, the distribution function is
<span class="math display">\[
  F_{X_{(1)}}(x)
  =
  \begin{cases}
    0             &amp; \text{for $x &lt; 0$}\\
    1 - (1 - x)^n &amp; \text{for $0 \le x \le 1$}\\
    1             &amp; \text{for $x &gt; 1$.}
  \end{cases}
\]</span></p>
<p>For the case where <span class="math inline">\(n = 10\)</span>,
<span class="math display">\[
  f_{X_{(1)}}(x)
  = 10 (1- x)^9,
\]</span>
for <span class="math inline">\(0 &lt; x &lt; 1\)</span>, and the distribution function is
<span class="math display">\[
  F_{X_{(1)}}(x)
  =
  \begin{cases}
    0                 &amp; \text{for $x &lt; 0$}\\
    1 - (1 - x)^{10}  &amp; \text{for $0 \le x\le 1$}\\
    1                 &amp; \text{for $x &gt; 0$.}
  \end{cases}
\]</span>
Figure <a href="OrderStatisticsChapter.html#fig:OrderStatsMin">13.2</a> shows the probability density function (left panel) and the distribution function (right panel).
For example, the probability that the smallest value in a sample of size <span class="math inline">\(10\)</span> is smaller than <span class="math inline">\(0.2\)</span> is
<span class="math display">\[
  F_{(1)}(0.2) = 1 - (1 - 0.2)^{10} = 0.8926\dots
\]</span>
This can be confirmed using a small simulation:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_Sims</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">sample_Size</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">x_Min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span> dim <span class="op">=</span> <span class="va">num_Sims</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_Sims</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">sample_Size</span>,</span>
<span>             min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">x_Min</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Proportion of smallest values less than 0.2: "</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x_Min</span><span class="op">)</span> <span class="op">/</span> <span class="va">num_Sims</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Proportion of smallest values less than 0.2:  0.911</span></span></code></pre></div>
<p>Using the density function of the minimum value, the expected value and the variance of the minimum value can be found too; for example,
<span class="math display">\[
  \operatorname{E}[X_{(10)}] = \int_0^1 x \cdot 10(1 - x)^9\, dx = 1/11 = 0.0909\dots
\]</span></p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:OrderStatsMin"></span>
<img src="13-OrderStatistics_files/figure-html/OrderStatsMin-1.png" alt="The distribution of the minimum value for the uniform distribution on $[0, 1]$ in a sample of size\ $10$. Left: the probability density function of the minimum value $X_{(1)}$. Right: the distribution function of the minimum value $X_{(1)}$. The grey, dotted lines show $F_{X_{(1)}}(0.2)$." width="90%"><p class="caption">
FIGURE 13.2: The distribution of the minimum value for the uniform distribution on <span class="math inline">\([0, 1]\)</span> in a sample of size <span class="math inline">\(10\)</span>. Left: the probability density function of the minimum value <span class="math inline">\(X_{(1)}\)</span>. Right: the distribution function of the minimum value <span class="math inline">\(X_{(1)}\)</span>. The grey, dotted lines show <span class="math inline">\(F_{X_{(1)}}(0.2)\)</span>.
</p>
</div>
</div>
<div id="OrderStatisticsDistribution" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> Sampling distribution of the <span class="math inline">\(k\)</span>th order statistic<a class="anchor" aria-label="anchor" href="#OrderStatisticsDistribution"><i class="fas fa-link"></i></a>
</h2>
<p>The ideas developed above for the distribution of the minimum and maximum value in a sample can be applied to other order statistics also.
Consider a sample from a continuous distribution with density function <span class="math inline">\(f_X(x)\)</span> and distribution function <span class="math inline">\(F_X(x)\)</span>.
The <span class="math inline">\(k\)</span>th order statistic <span class="math inline">\(X_{(k)}\)</span> has the distribution function <span class="math inline">\(F_{X_(k)}(x) = \Pr(X_{(k)}\le x)\)</span>.
By definition, this is the probability that the <span class="math inline">\(k\)</span>th smallest value in the sample is less than (or equal to) some value <span class="math inline">\(x\)</span>.</p>
<p>Writing <span class="math inline">\(X_{(k)} \le x\)</span> means that <em>at least</em> <span class="math inline">\(k\)</span> of the <span class="math inline">\(n\)</span> observations are smaller than the value <span class="math inline">\(x\)</span>; that is, <span class="math inline">\(k, k + 1, \dots n\)</span> of the <span class="math inline">\(n\)</span> observations are smaller than <span class="math inline">\(x\)</span>.</p>
<p>First, consider the case where exactly <span class="math inline">\(k\)</span> observations are smaller than <span class="math inline">\(x\)</span>.
This means there must be <span class="math inline">\(k\)</span> observations with a value less than or equal to <span class="math inline">\(x\)</span>; the probability of this is
<span class="math display">\[
  [F_X(x)]^k
\]</span>
In addition, the remaining <span class="math inline">\(n - k\)</span> observations must have a value <em>larger</em> than <span class="math inline">\(x\)</span>; the probability of this is
<span class="math display">\[
  [1 - F_{X}(x)]^{n -k}
\]</span>
The <span class="math inline">\(k\)</span> observations that are smaller than <span class="math inline">\(x\)</span> could be located in many different places among the <span class="math inline">\(n\)</span> values; these <span class="math inline">\(k\)</span> observations could be in <span class="math inline">\(\binom{n}{k}\)</span> different arrangements among the sample of size <span class="math inline">\(n\)</span>.</p>
<p>Combining, the probability that exactly <span class="math inline">\(k\)</span> observations are smaller than <span class="math inline">\(x\)</span> is
<span class="math display">\[
  \binom{n}{k} \cdot [F_X(x)]^k \cdot [1 - F_{X}(x)]^{n - k}.
\]</span></p>
<p>However, as noted above, there may be <em>more</em> than <span class="math inline">\(k\)</span> observations smaller than <span class="math inline">\(x\)</span> also.
Following the above ideas, the probability that exactly <span class="math inline">\(k + 1\)</span> observations are smaller than <span class="math inline">\(x\)</span> is
<span class="math display">\[
  \binom{n}{k + 1} \cdot [F_X(x)]^{k+1} \cdot [1 - F_{X}(x)]^{n - (k+1)}
\]</span>
and so on, up to all <span class="math inline">\(n\)</span> observations being less than <span class="math inline">\(x\)</span>.
Summing these probabilities gives
<span class="math display">\[
  \Pr(X_{(k)} \le x) = \sum_{i = k}^n \binom{n}{i} \cdot [F_X(x)]^i \cdot [1 - F_{X}(x)]^{n - i}.
\]</span></p>
<p>From this distribution function, the probability density function can be obtained as
<span class="math display">\[
  f_{X_{(k)}}(x)
  = \frac{d}{dx} F_{X_{(k)}}(x)
  = \frac{n!}{(k - 1)!\,(n - r)!}f_{X}(x) [F_{X}(x)]^{k - 1} [1 - F_{X}(x)]^{n - r},
\]</span>
for <span class="math inline">\(n &gt; k \ge 1\)</span> and <span class="math inline">\(n\)</span> and <span class="math inline">\(k\)</span> are integers.</p>
<div class="definition">
<p><span id="def:OrderStatsDistn" class="definition"><strong>Definition 13.3  (Distribution of an order statistic: continuous rv) </strong></span>Consider a sample of size <span class="math inline">\(n\)</span>, say <span class="math inline">\(X_1, X_2, \dots, X_n\)</span>, with all <span class="math inline">\(X_i\)</span> drawn independently from a continuous distribution with density function <span class="math inline">\(f_X(x)\)</span> and distribution function <span class="math inline">\(F_X(x)\)</span>.
Then the distribution function for the <span class="math inline">\(k\)</span>th order statistic <span class="math inline">\(X_{(k)}\)</span> is
<span class="math display" id="eq:OrderStatisticDF">\[\begin{equation}
  F_{X_{(k)}}(x) = \Pr(X_{(k)}\le x)
  =
  \sum_{i = k}^n \binom{n}{k}\times [F_{X}(x)]^i \times [1 - F_{X}(x)]^{n - i}
   \tag{13.2}
\end{equation}\]</span>
and the density function of the <span class="math inline">\(k\)</span>th order statistic <span class="math inline">\(X_{(k)}\)</span>
is:
<span class="math display" id="eq:OrderStatisticPDF">\[\begin{equation}
   f_{X_{(k)}}(x) = \frac{n!}{(k - 1)! (n - k)!} [F_X(x)]^{k-1} [1 - F_X(x)]^{n-k} f(x),
   \tag{13.3}
\end{equation}\]</span>
where <span class="math inline">\(n &gt; k &gt; 0\)</span> and <span class="math inline">\(n\)</span> and <span class="math inline">\(k\)</span> are integers.</p>
</div>
<div class="example">
<p><span id="exm:UniformkOrderStats" class="example"><strong>Example 13.5  (Uniform distribution: other order statistics) </strong></span>Consider the second and sixth order statistics from sample of size <span class="math inline">\(n = 10\)</span> from a Unif<span class="math inline">\((0, 1)\)</span> distribution (where <span class="math inline">\(f_X(x)\)</span> and <span class="math inline">\(F_X(x)\)</span> are given in Example <a href="OrderStatisticsChapter.html#exm:OrderStatsMaxUniform">13.3</a>); using Equation <a href="OrderStatisticsChapter.html#eq:OrderStatisticPDF">(13.3)</a>:
<span class="math display">\[\begin{align*}
   f_{X_{(2)}}(x)
   &amp;= \frac{10!}{1!\, 8!} x (1 - x)^8
    = 90 x (1 - x)^8\quad\text{and}\\
   f_{X_{(6)}}(x)
   &amp;= \frac{10!}{5!\, 4!} x^5 (1 - x)^4
    = 1260 x^5 (1 - x)^4.
\end{align*}\]</span></p>
<p>Consider simulating <span class="math inline">\(5\,000\)</span> samples of size <span class="math inline">\(n = 10\)</span> from a Unif<span class="math inline">\((0, 1)\)</span> distribution:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span>   <span class="co"># Take samples of size 10</span></span>
<span></span>
<span><span class="va">samples2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">5000</span>,               <span class="co"># 1000 repetitions</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>  <span class="co"># 2nd order statistic</span></span>
<span><span class="va">samples6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">5000</span>,               <span class="co"># 1000 repetitions</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>  <span class="co"># 6th order statistic</span></span></code></pre></div>
<p>The distribution of <span class="math inline">\(X_{(2)}\)</span> (i.e., <code>samples2</code>) and <span class="math inline">\(X_{(6)}\)</span> (i.e., <code>samples6</code>) are shown in Fig.  <a href="OrderStatisticsChapter.html#fig:OrderStats1">13.3</a>.</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:OrderStats1"></span>
<img src="13-OrderStatistics_files/figure-html/OrderStats1-1.png" alt="Simulating the distribution of two order statistics for the uniform distribution on $[0, 1]$ with a sample of size $10$. Left: the distribution of $X_{(2)}$. Right: the distribution of  $X_{(6)}$. The solid lines show the theoretical distributions." width="90%"><p class="caption">
FIGURE 13.3: Simulating the distribution of two order statistics for the uniform distribution on <span class="math inline">\([0, 1]\)</span> with a sample of size <span class="math inline">\(10\)</span>. Left: the distribution of <span class="math inline">\(X_{(2)}\)</span>. Right: the distribution of <span class="math inline">\(X_{(6)}\)</span>. The solid lines show the theoretical distributions.
</p>
</div>
<div class="example">
<p><span id="exm:ServerRoom" class="example"><strong>Example 13.6  (Air conditioner servicing) </strong></span>A new server room has four air-conditioning units installed.
The lifetime of each unit (in hours) follows an exponential distribution with mean <span class="math inline">\(\lambda = 2000\,\text{h}\)</span>.
The units operate independently.
A service technician is called when <em>two</em> of the units fail.
We seek the distribution of the time until the call to the technician is made.</p>
<p>Let <span class="math inline">\(T_1, T_2, T_3, T_4\)</span> denote the lifetimes of the four units.
Then:
<span class="math display">\[
  T_i \sim \text{Exponential}(\lambda)\quad\text{for $i = 1, 2, 3, 4$},
\]</span>
where <span class="math inline">\(\lambda = 1/2000\)</span>, and the <span class="math inline">\(T_i\)</span> are independent.
That is,
<span class="math display">\[
  f_{T_i}(t)= \frac{1}{\lambda}\exp(-t/\lambda)
  \quad\text{and}\quad
  F_{T_i}(t)= \exp(-t/\lambda)
\]</span>
for <span class="math inline">\(0 &lt; x &lt; \infty\)</span>.</p>
<p>Define the order statistics as <span class="math inline">\(T_{(1)} &lt; T_{(2)} &lt; T_{(3)} &lt; T_{(4)}\)</span>.
The technician is called at time <span class="math inline">\(T_{(2)}\)</span>, the <em>second failure</em>.
Since we have <span class="math inline">\(n = 4\)</span> and <span class="math inline">\(k = 2\)</span>, the distribution of <span class="math inline">\(T_{(2)}\)</span> is (from REF)
<span class="math display">\[
   f_{T_{(2)}}(t) =
   6 [\exp(-t/\lambda)]^1 [1 - \exp(-t/\lambda)] ^2 \times \frac{1}{\lambda}\exp(-t/\lambda),
\]</span>
which is very complicated.</p>
<p>However, the exponential distribution has the <em>memoryless property</em> (REF), so a different approach is much simpler.
The time to the <em>first</em> failure <span class="math inline">\(T_{(1)}\)</span> has the probability density function
<span class="math display">\[
   T_{(1)} \sim \text{Exponential}(4\lambda)
\]</span>
since <em>any</em> of the <span class="math inline">\(4\)</span> units can fail first.
The time <em>between</em> the first and second failure also has an exponential distribution, due to the memoryless property, this means that
<span class="math display">\[
  T_{(2)} - T_{(1)} \sim \text{Exponential}(3\lambda)
\]</span>
because only <span class="math inline">\(3\)</span> units remain after the first failure.</p>
<p>Thus, the total time until the second failure is:
<span class="math display">\[
  T_{(2)} = E_1 + E_2
\]</span>
where
<span class="math display">\[
  E_1 \sim \text{Exp}(4\lambda) \quad\text{and}\quad E_2 \sim \text{Exp}(3\lambda).
\]</span></p>
<p>This distribution is not exponential, but the <em>sum of two independent exponentials with different rates</em>.</p>
<p>The expected value is
<span class="math display">\[
\operatorname{E}[T_{(2)}] = \frac{1}{4\lambda} + \frac{1}{3\lambda} = \frac{1}{\lambda} \left( \frac{1}{4} + \frac{1}{3} \right) = 2000 \cdot \frac{7}{12} = 1166.6\dots\,\text{h}.
\]</span></p>
<p>On average, a technician will be called after about <span class="math inline">\(1166.67\,\text{h}\)</span>.</p>
</div>
<p>The PDF of <span class="math inline">\(T_{(2)}\)</span> can be found using <strong>convolution</strong>:
<span class="math display">\[
  f_{T_{(2)}}(t) = \int_0^t f_{E_1}(x) f_{E_2}(t - x)\, dx
\]</span>
where <span class="math inline">\(f_{E_1}(x) = 4\lambda e^{-4\lambda x}\)</span>, and <span class="math inline">\(f_{E_2}(x) = 3\lambda e^{-3\lambda x}\)</span>.
This approach can be extended to <em>any</em> <span class="math inline">\(k\)</span>th failure out of <span class="math inline">\(n\)</span> components.</p>
</div>
<div id="OrderStatisticsDiscrete" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> Order statistics for discrete random variables<a class="anchor" aria-label="anchor" href="#OrderStatisticsDiscrete"><i class="fas fa-link"></i></a>
</h2>
<p>Working with order statistics is easier with continuous random variables than for discrete random variables, because ties are not possible for continuous random variables (since <span class="math inline">\(\Pr(X = x) = 0\)</span> for some value <span class="math inline">\(x\)</span> when <span class="math inline">\(X\)</span> is a continuous random variable).
As a result, the formulas for discrete random variables are more complicated than for continuous random variables, since they need to accommodate the possibility of ties in the sample.</p>
<p>Let <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> be i.i.d. from a discrete distribution with probability mass function
<span class="math display">\[
   p_X(x) = \Pr(X = x),
\]</span>
and distribution function
<span class="math display">\[
   F_X(x) = \Pr(X \le x).
\]</span>
In the discrete case, defining
<span class="math display">\[
   F_X(x^-) = \lim_{t \uparrow x} F_X(t) = \Pr(X &lt; x).
\]</span>
proves helpful in what follows (see Fig. <a href="OrderStatisticsChapter.html#fig:OrderStatsDiscreteDefine">13.4</a>).
For discrete random variables defined over consecutive integers, <span class="math inline">\(x^- = x - 1\)</span>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:OrderStatsDiscreteDefine"></span>
<img src="13-OrderStatistics_files/figure-html/OrderStatsDiscreteDefine-1.png" alt="Explaining the meaning of $F_X(b^-)$." width="90%"><p class="caption">
FIGURE 13.4: Explaining the meaning of <span class="math inline">\(F_X(b^-)\)</span>.
</p>
</div>
<p>We begin with the first order statistic (the minimum value) to establish the general ideas of working with discrete random variables.
The first order statistic is <span class="math inline">\(X_{(1)} = \min\{ X_1, X_2, \dots, X_n \}\)</span>; then, following similar logic to the continuous case,
<span class="math display">\[\begin{align*}
F_{X_{(1)}}(x)
  &amp;= \Pr(X_{(1)} \le x) \\
  &amp;= 1 - \Pr(X_{(1)} &gt; x) \\
  &amp;= 1 - \Pr(X_1 &gt; x, X_2 &gt; x, \dots, X_n &gt; x) \\
  &amp;= 1 - \big[ 1 - F_X(x) \big]^n.
\end{align*}\]</span>
The probability mass function is the probability that all observations are at least <span class="math inline">\(x\)</span>, but not all are greater than <span class="math inline">\(x\)</span>:
<span class="math display">\[\begin{align*}
  p_{X_{(1)}}(x)
    &amp;= \Pr(X_{(1)} \ge x) - \Pr(X_{(1)} \ge x+1) \\
    &amp;= \big[ 1 - F_X(x^-) \big]^n - \big[ 1 - F_X(x) \big]^n.
\end{align*}\]</span></p>
<div class="example">
<p><span id="exm:DiscreteOrderStatsDiceMin" class="example"><strong>Example 13.7  (Rolling a fair die: minimum) </strong></span>Suppose a fair die is rolled <span class="math inline">\(n = 10\)</span> times, and the number <span class="math inline">\(X\)</span> that appears on each roll is recorded.
Then <span class="math inline">\(X \sim\text{Unif}(1, 6)\)</span> and so
<span class="math display">\[
  p_X(x)
  =
  \begin{cases}
    1/6 &amp; \text{for $x = 1, 2, \dots 6$}\\
    0   &amp; \text{elsewhere}
  \end{cases}
  \qquad
  \text{and}
  \qquad
  F_X(x)
  =
  \begin{cases}
    0                   &amp; \text{for $x &lt; 1$}\\
    \lfloor x \rfloor/6 &amp; \text{for $1 \le x \le 6$}\\
    1                   &amp; \text{for $x &gt; 6$.}
  \end{cases}
\]</span></p>
<p>Then the distribution function for the minimum value (i.e., <span class="math inline">\(X_{(1)}\)</span>) is
<span class="math display">\[\begin{align*}
  \Pr\big(X_{(1)} \le x\big)
  &amp;= \big[1 - F_X(x - 1)\big]^{10} \\
  &amp;=
  \begin{cases}
    0 &amp; \text{for $x &lt; 1$}\\
    \displaystyle 1 - \left[1 -\frac{\lfloor{x}\rfloor}{6}\right]^{10} &amp; \text{for $1 \le x\le 6$}\\
    1 &amp; \text{for $x &gt; 6$}
  \end{cases}
\end{align*}\]</span>
for <span class="math inline">\(1 \le x\le 6\)</span>.
If we focus on the distribution function at <em>integer outcomes</em> only,
<span class="math display">\[
  F_{X_{(1)}}(x)
  =
  1 - \left(\frac{6 - x}{6}\right)^{10} \qquad\text{at $x = 1, 2\dots, 6$}.
\]</span>
Since, for dice, the outcomes from rolling are consecutive integers, <span class="math inline">\(x^- = x - 1\)</span>; hence, the corresponding probability mass function is:
<span class="math display">\[
  \Pr\left(X_{(1)} = s\right)
  = \left(\frac{6 - x}{6}\right)^{10} - \left(\frac{5 - x}{6}\right)^{10}
  \quad
  \text{for $x = 1, \dots, 6$.}
\]</span>
These can be computed in <strong>R</strong>, then plotted (the dots in Fig. <a href="OrderStatisticsChapter.html#fig:OrderStatsDiscreteExample">13.5</a>, left panel):</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### THEORETICAL</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span></span>
<span><span class="va">CDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,</span>
<span>         <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="fl">6</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span><span class="op">^</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">CDF</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0000 0.8385 0.9827 0.9990 1.0000 1.0000</span></span>
<span><span class="co">#&gt; [7] 1.0000</span></span>
<span></span>
<span><span class="va">PMF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">CDF</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">PMF</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8385 0.1442 0.0164 0.0010 0.0000 0.0000</span></span></code></pre></div>
<p>The situation can be simulated and plotted also (the bars in Fig. <a href="OrderStatisticsChapter.html#fig:OrderStatsDiscreteExample">13.5</a>, left panel):</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### SIMULATION</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">62004</span><span class="op">)</span> <span class="co"># For reproducibility</span></span>
<span></span>
<span><span class="co"># Replicate many sets of 10 rolls of a die</span></span>
<span><span class="va">rolls_In_Set</span> <span class="op">&lt;-</span> <span class="fl">10</span>  <span class="co"># Sets f 10 rolls</span></span>
<span><span class="va">num_Sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span>    <span class="co"># Number of simulations</span></span>
<span></span>
<span><span class="va">rolls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span> x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>                 size <span class="op">=</span> <span class="va">rolls_In_Set</span> <span class="op">*</span> <span class="va">num_Sims</span>,</span>
<span>                 replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>                 </span>
<span><span class="co"># Arrange each set of 10 as a row </span></span>
<span><span class="va">rolls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rolls</span>,</span>
<span>                nrow <span class="op">=</span> <span class="va">num_Sims</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find the minimum in each row (i.e., each set of 10 rolls)</span></span>
<span><span class="va">min_Roll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">rolls</span>,</span>
<span>                  MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  FUN <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span>
<span><span class="va">min_Roll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">min_Roll</span>, </span>
<span>                   levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>For example, this means that in a set of <span class="math inline">\(10\)</span> rolls, the probability that the minimum roll is a two is about
<span class="math display">\[
  \Pr( X_{(7)} = 2) \approx 0.14 =  14\%.
\]</span></p>
</div>
<p>More generally, for the <span class="math inline">\(k\)</span>th order statistic <span class="math inline">\(X_{(k)}\)</span> for a discrete random variable <span class="math inline">\(X\)</span>, let <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> be i.i.d. from a discrete distribution with
<span class="math display">\[\begin{align*}
  p_X(x)   &amp;= \Pr(X = x);\\
  F_X(x)   &amp;= \Pr(X \le x); \text{and}\\
  F_X(x^-) &amp;=\Pr(X &lt; x).
\end{align*}\]</span></p>
<p>First, define the <em>number</em> of observations less than or equal to <span class="math inline">\(x\)</span> as
<span class="math display">\[
  Y = \sum_{j = 1}^n I\{X_j\le x\} \sim \mathrm{Binom}\!\left(n,\,F_X(x)\right).
\]</span>
Then
<span class="math display">\[\begin{align*}
  F_{X_{(k)}}(x)
  &amp;= \Pr\bigl(X_{(k)} \le x\bigr)
   = \Pr(Y \ge k) \\
  &amp;= \sum_{i = k}^n \binom{n}{i}\,F_X(x)^{i}\,[1 - F_X(x)]^{\,n - i}.
\end{align*}\]</span></p>
<p>For a discrete random variable <span class="math inline">\(X\)</span>, the probability mass function is how much the distributions function ‘jumps’ at the values of <span class="math inline">\(x\)</span>.
So, the probability mass function for <span class="math inline">\(X_{(k)}\)</span> can be found from the distribution function as
<span class="math display">\[\begin{align*}
  p_{X_{(k)}}(x)
    &amp;= \Pr\bigl(X_{(k)}=x\bigr)\\
    &amp;= F_{X_{(k)}}(x) - F_{X_{(k)}}(x^-) \notag\\
    &amp;= \sum_{i=k}^n \binom{n}{i}\,[F_X(x)]^{i}\,[1-F_X(x)]^{\,n-i}
     \;- \notag\\
    &amp;\qquad \qquad
       \sum_{i = k}^n \binom{n}{i}\,[F_X(x^-)]^{i}\,[1 - F_X(x^-)]^{\,n - i}.
\end{align*}\]</span></p>
<div class="definition">
<p><span id="def:OrderStatsDistnDiscrete" class="definition"><strong>Definition 13.4  (Distribution of an order statistic: discrete rv) </strong></span>Consider a sample of size <span class="math inline">\(n\)</span>, say <span class="math inline">\(X_1, X_2, \dots, X_n\)</span>, with all <span class="math inline">\(X_i\)</span> drawn independently from a discrete distribution with probability mass function <span class="math inline">\(f_X(x)\)</span> and distribution function <span class="math inline">\(F_X(x)\)</span>.
Then the distribution function of the <span class="math inline">\(k\)</span>th order statistic <span class="math inline">\(X_{(k)}\)</span> is
<span class="math display" id="eq:OrderStatisticDFdiscrete">\[\begin{equation}
  F_{X_{(k)}}(x)
  = \Pr\big(X_{(k)} \le x\big)
  = \sum_{i = k}^n \binom{n}{i}\, F_X(x)^{i}\,[1 - F_X(x)]^{n - i}
  \tag{13.4}
\end{equation}\]</span>
The probability mass function of the <span class="math inline">\(k\)</span>th order statistic <span class="math inline">\(X_{(k)}\)</span> at integer values of <span class="math inline">\(x\in R\)</span> is:
<span class="math display" id="eq:OrderStatisticPMF">\[\begin{align}
  p_{X_{(k)}}(x)
  &amp;= F_{X_{(k)}}(x) - F_{X_{(k)}}(x^-)\notag \\
  &amp;= \sum_{i = k}^n
         \binom{n}{i}
         \left\{
           F_X(x)^{i}\,[1 - F_X(x)]^{\,n - i}
           -
           F_X(x^-)^{i}\,[1 - F_X(x^-)]^{\,n - i}
         \right\}
   \tag{13.5}
\end{align}\]</span>
where <span class="math inline">\(n &gt; k &gt; 0\)</span> and <span class="math inline">\(n\)</span> and <span class="math inline">\(k\)</span> are integers.</p>
</div>
<div class="example">
<p><span id="exm:DiscreteOrderStatsDiceAny" class="example"><strong>Example 13.8  (Rolling a fair die: general order statistic) </strong></span>Continuing Example <a href="OrderStatisticsChapter.html#exm:DiscreteOrderStatsDiceMin">13.7</a>, where a standard six-sided die is rolled <span class="math inline">\(10\)</span> times.
The general <span class="math inline">\(k\)</span>-th order statistic <span class="math inline">\(X_{(k)}\)</span> is
<span class="math display">\[
  F_{X_{(k)}}(x)
  = \Pr\big(X_{(k)} \le x\big)
  = \sum_{i = k}^{10} \binom{10}{i}\,\left(\frac{x}{6}\right)^{i}\,\left(1 - \frac{x}{6}\right)^{10 - i},
\]</span>
for <span class="math inline">\(x\in\{1,\dots,6\}\)</span>.</p>
<p>Since, for dice, the outcomes from rolling are consecutive integers, <span class="math inline">\(x^- = x - 1\)</span>, the corresponding probability mass function is found using the discrete difference
<span class="math display">\[\begin{align*}
  \Pr\big(X_{(k)} =  x\big)
  &amp;=
  \Pr\big(X_{(k)}\le x\big) - \Pr\big(X_{(k)}\le x - 1\big)\\
  &amp;= \sum_{i = k}^{10} \binom{10}{i}
     \left\{\left(\frac{x}{6}\right)^{i}\,\left(1 - \frac{x}{6}\right)^{10 - i} - \right.\\
  &amp;\phantom{={}\sum_{i = k}^{10} \binom{10}{i}\Huge\{}
     \left.\left(\frac{x - 1}{6}\right)^{i}\,\left(1 - \frac{x - 1}{6}\right)^{10 - i}\right\}
\end{align*}\]</span>
So, for instance, the seventh order statistic (i.e., where <span class="math inline">\(k = 7\)</span>) is
<span class="math display">\[
  \Pr\big(X_{(7)} = x\big)
  =
  \sum_{i = 7}^{10} \binom{10}{i}
     \left\{\left(\frac{x}{6}\right)^{i}\,\left(1 - \frac{x}{6}\right)^{10 - i}
     -
            \left(\frac{x - 1}{6}\right)^{i}\,\left(1 - \frac{x - 1}{6}\right)^{10 - i}\right\}
\]</span>
for <span class="math inline">\(x\in\{ 1, 2, 3, 4, 5, 6\}\)</span>.
These can be computed in <strong>R</strong>, then plotted (the dots in Fig. <a href="OrderStatisticsChapter.html#fig:OrderStatsDiscreteExample">13.5</a>, right panel):</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### SIMULATED </span></span>
<span><span class="co"># Simulation, using  rolls  from the last Example</span></span>
<span><span class="va">Order_Stats_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span> <span class="va">rolls</span>,</span>
<span>                        MARGIN <span class="op">=</span> <span class="fl">1</span>, <span class="co"># i.e., across rows</span></span>
<span>                        FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">}</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">Order_Stats_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Order_Stats_7</span>, </span>
<span>                        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Order_Stats_7</span><span class="op">)</span><span class="op">/</span><span class="va">num_Sims</span></span>
<span><span class="co">#&gt; Order_Stats_7</span></span>
<span><span class="co">#&gt;     1     2     3     4     5     6 </span></span>
<span><span class="co">#&gt; 0.000 0.009 0.158 0.378 0.383 0.072</span></span></code></pre></div>
<p>The situation can be simulated and plotted also (the bars in Fig. <a href="OrderStatisticsChapter.html#fig:OrderStatsDiscreteExample">13.5</a>, right panel):</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### SIMULATED </span></span>
<span><span class="co"># Simulation, using  rolls  from the last Example</span></span>
<span><span class="va">Order_Stats_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span> <span class="va">rolls</span>,</span>
<span>                        MARGIN <span class="op">=</span> <span class="fl">1</span>, <span class="co"># i.e., across rows</span></span>
<span>                        FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">}</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">Order_Stats_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Order_Stats_7</span>, </span>
<span>                        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Order_Stats_7</span><span class="op">)</span><span class="op">/</span><span class="va">num_Sims</span></span>
<span><span class="co">#&gt; Order_Stats_7</span></span>
<span><span class="co">#&gt;     1     2     3     4     5     6 </span></span>
<span><span class="co">#&gt; 0.000 0.009 0.158 0.378 0.383 0.072</span></span>
<span></span>
<span><span class="co">### THEORETICAL</span></span>
<span><span class="va">x_Values</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">7</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span> dim <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">x</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">x_Values</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">DF</span><span class="op">[</span><span class="va">x</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">i</span><span class="op">)</span> <span class="op">*</span></span>
<span>                 <span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span><span class="op">^</span><span class="va">i</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">10</span> <span class="op">-</span> <span class="va">i</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">PMF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">DF</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">PMF</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.000 0.019 0.152 0.387 0.371 0.070</span></span></code></pre></div>
<p>For example, this means that, in a set of <span class="math inline">\(10\)</span> rolls, the probability that the seventh smallest roll is a two is about
<span class="math display">\[
  \Pr( X_{(7)} = 2) \approx 0.019 = 1.9\%.
\]</span></p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:OrderStatsDiscreteExample"></span>
<img src="13-OrderStatistics_files/figure-html/OrderStatsDiscreteExample-1.png" alt="Left: the distribution of the first order statistic (the minimum roll), in sets of $10$\ rolls. Right: the distribution of the $7$th order statistic, in sets of $10$\ rolls. In both cases, the bars show the values from $1\,000$ simulated sets of $10$\ rolls, and the solid dots are the theoretical values." width="90%"><p class="caption">
FIGURE 13.5: Left: the distribution of the first order statistic (the minimum roll), in sets of <span class="math inline">\(10\)</span> rolls. Right: the distribution of the <span class="math inline">\(7\)</span>th order statistic, in sets of <span class="math inline">\(10\)</span> rolls. In both cases, the bars show the values from <span class="math inline">\(1\,000\)</span> simulated sets of <span class="math inline">\(10\)</span> rolls, and the solid dots are the theoretical values.
</p>
</div>
</div>
<div id="QuantilesOrderStats" class="section level2" number="13.6">
<h2>
<span class="header-section-number">13.6</span> Quantiles and order statistics<a class="anchor" aria-label="anchor" href="#QuantilesOrderStats"><i class="fas fa-link"></i></a>
</h2>
<p>So far, order statistics have been defined.
A similar, but different, concept is that of <em>quantiles</em></p>
<p>For a random variable <span class="math inline">\(X\)</span> with distribution function <span class="math inline">\(F_X(x)\)</span>, the <em><span class="math inline">\(p\)</span>-th quantile</em> <span class="math inline">\(q_p\)</span> is
<span class="math display">\[
   q_p
   = F^{-1}(p)
   = \inf \{x \in \mathbb{R} : F(x) \ge p \} \quad \text{for $0 &lt; p &lt; 1$}.
\]</span>
Quantiles are fixed values determined by the <em>distribution</em>, whereas order statistics are random variables derived from a <em>finite sample</em>.
<em>Sample quantiles</em> are typically estimated from the data using order statistics.<br>
For example, the sample median is <span class="math inline">\(X_{(\lceil n/2 \rceil)}\)</span> (or an average of two adjacent order statistics when <span class="math inline">\(n\)</span> is even).</p>
<div class="softwareBox software">
<p>General order statistics in <strong>R</strong> are found by first <em>sorting</em> the sample values using <code><a href="https://rdrr.io/r/base/sort.html">sort()</a></code>, and the selecting the relevant values from the result using <em>indexing</em>; for example, <code>sort(x-Values)[3]</code> selects the <em>third sorted</em> value from the sample.</p>
<p><strong>R</strong> can also find quantiles, using the <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> function.
<code>quantile(x, probs)</code> computes the order statistics specified as probabilities (called <em>quantiles</em>) defined in <code>prob</code>.
Generally, the <em>exact</em> quantiles cannot be found, and are approximated.
<strong>R</strong> offers <em>nine</em> different methods for approximating quantiles that cannot be exactly defined <span class="citation">(<a href="references.html#ref-hyndman1996sample">Hyndman and Fan 1996</a>)</span>.</p>
</div>
<div class="example">
<p><span id="exm:RQuantiles" class="example"><strong>Example 13.9  (Quantiles in R) </strong></span></p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">9901</span><span class="op">)</span> <span class="co"># For reproducibility</span></span>
<span></span>
<span><span class="va">x_Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">50</span>, </span>
<span>                  min <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                  max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Place sample observations in order</span></span>
<span><span class="va">x_Sort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">x_Sample</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine first few values:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span> <span class="va">x_Sort</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0041 0.0309 0.0310 0.0324 0.0411 0.0430</span></span>
<span></span>
<span><span class="co"># Compute 25th quantiles (first quartile)</span></span>
<span><span class="co"># Using each of the none different methods in R:</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">method</span> <span class="kw">in</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Method "</span>, <span class="va">method</span>, <span class="st">": "</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x_Sort</span>, <span class="fl">0.25</span>, type <span class="op">=</span> <span class="va">method</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>      <span class="st">"\n"</span>,</span>
<span>      sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Method 1: 0.17359</span></span>
<span><span class="co">#&gt; Method 2: 0.17359</span></span>
<span><span class="co">#&gt; Method 3: 0.17055</span></span>
<span><span class="co">#&gt; Method 4: 0.17207</span></span>
<span><span class="co">#&gt; Method 5: 0.17359</span></span>
<span><span class="co">#&gt; Method 6: 0.17283</span></span>
<span><span class="co">#&gt; Method 7: 0.17715</span></span>
<span><span class="co">#&gt; Method 8: 0.17334</span></span>
<span><span class="co">#&gt; Method 9: 0.1734</span></span></code></pre></div>
</div>
<p></p>
</div>
<div id="OrderStatisticsExercises" class="section level2" number="13.7">
<h2>
<span class="header-section-number">13.7</span> Exercises<a class="anchor" aria-label="anchor" href="#OrderStatisticsExercises"><i class="fas fa-link"></i></a>
</h2>
<p>Selected answers appear in Sect. <a href="selected-solutions.html#AnswersOrderStatisticsChapter">E.13</a>.</p>
<div class="exercise">
<p><span id="exr:OrderStatisticsUniform" class="exercise"><strong>Exercise 13.1  </strong></span>Prove that the probably density function for the order statistics in the case of the continuous uniform distribution, shown in Eq. <a href="OrderStatisticsChapter.html#eq:ContinuousUniformPMForder">(13.1)</a>, is a valid density function.
(Hint: observe the similarity between Eq. <a href="OrderStatisticsChapter.html#eq:ContinuousUniformPMForder">(13.1)</a> and the beta density function in Sect. <a href="ContinuousDistributions.html#BetaDistribution">8.6</a>.)</p>
</div>
<div class="exercise">
<p><span id="exr:OrderStatisticsUniformExpectations" class="exercise"><strong>Exercise 13.2  </strong></span>Prove that the expected value and variance of the order statistics in the case of the continuous uniform distribution are
<span class="math display">\[
  \operatorname{E}[X] = k/(n + 1)\qquad\text{and}\qquad \operatorname{var}[X] = \frac{k (k + 1)}{(n + 1)(n + 2)},
\]</span>
as in Sect. <a href="OrderStatisticsChapter.html#OrderStatisticsDistribution">13.4</a>.
(Hint: observe the similarity between Eq. <a href="OrderStatisticsChapter.html#eq:ContinuousUniformPMForder">(13.1)</a> and the beta density function in Sect. <a href="ContinuousDistributions.html#BetaDistribution">8.6</a>.)</p>
</div>
<div class="exercise">
<p><span id="exr:OrderStatisticsPDF" class="exercise"><strong>Exercise 13.3  </strong></span>Find the distribution of the order statistics for a sample of size <span class="math inline">\(n\)</span> drawn from the continuous uniform distribution defined on <span class="math inline">\([-1, 1]\)</span>.</p>
<p>PLOTS??</p>
</div>
<div class="exercise">
<p><span id="exr:OrderStatisticsPDF2" class="exercise"><strong>Exercise 13.4  </strong></span>Find the distribution of the order statistics for samples of size <span class="math inline">\(n\)</span> drawn from the continuous distribution
<span class="math display">\[
  f_Y(y) = y/2\quad\text{for $0 &lt; y &lt; 2$}
\]</span>
and zero elsewhere.</p>
<p>PLOTS</p>
</div>
<div class="exercise">
<p><span id="exr:OrderStatisticsExponential" class="exercise"><strong>Exercise 13.5  </strong></span>Suppose a sample of <span class="math inline">\(n\)</span> independent values is taken from the exponential distribution <span class="math inline">\(\text{Exp}(\lambda)\)</span> (REF).</p>
<ol style="list-style-type: decimal">
<li>Determine the distribution function for the minimum value, <span class="math inline">\(X_{(1)}\)</span>.</li>
<li>Hence determine the density function for the minimum value, <span class="math inline">\(X_{(1)}\)</span>.</li>
<li>What is the probability that the minimum value in a sample of size <span class="math inline">\(n\)</span> is larger than <span class="math inline">\(\lambda/2\)</span>?</li>
<li>Compute the expected value of the minimum value in the sample.</li>
</ol>
<p>PLOTS</p>
</div>
<div class="exercise">
<p><span id="exr:OrderStatisticsExponential2" class="exercise"><strong>Exercise 13.6  </strong></span>Suppose a sample of <span class="math inline">\(n\)</span> independent values is taken from the exponential distribution <span class="math inline">\(\text{Exp}(\lambda)\)</span> (REF).</p>
<ol style="list-style-type: decimal">
<li>Determine the distribution function for the maximum value, <span class="math inline">\(X_{(n)}\)</span>.</li>
<li>Hence determine the density function for the maximum value, <span class="math inline">\(X_{(n)}\)</span>.</li>
<li>What is the probability that the maximum value in a sample of size <span class="math inline">\(n\)</span> is larger than <span class="math inline">\(\lambda/2\)</span>?</li>
<li>Compute the expected value of the maximum value in the sample.</li>
</ol>
<p>PLOTS</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-94" class="exercise"><strong>Exercise 13.7  </strong></span>A new computer server room has four air-conditioning units installed.
The lifetime of each unit follows an exponential, with a mean lifetime of <span class="math inline">\(2000\,\text{h}\)</span>.
When two units fail, a service technician is called.</p>
<ol style="list-style-type: decimal">
<li>Describe the distribution showing the wait time until a technician need to be called.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:OrderStatsDiscreteSpecialCases" class="exercise"><strong>Exercise 13.8  </strong></span>Consider Equation <a href="OrderStatisticsChapter.html#eq:OrderStatisticPMF">(13.5)</a>, which gives the <span class="math inline">\(k\)</span>th order statistic for a discrete random variable.</p>
<ol style="list-style-type: decimal">
<li>Show that the expression given for the probability mass function for the <em>minimum</em> value is given by using <span class="math inline">\(k = 1\)</span> in Equation <a href="OrderStatisticsChapter.html#eq:OrderStatisticPMF">(13.5)</a>.</li>
<li>Use Equation <a href="OrderStatisticsChapter.html#eq:OrderStatisticPMF">(13.5)</a> to find a formula for the probability mass function for the <em>maximum</em> value.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:OrderStatsDiscreteMultinomial" class="exercise"><strong>Exercise 13.9  </strong></span>The probability mass function for the <span class="math inline">\(k\)</span>th order statistic can be found in a different way than shown in Sect. <a href="OrderStatisticsChapter.html#OrderStatisticsDiscrete">13.5</a>.
First, define
<span class="math display">\[\begin{align*}
  a &amp;= F_X(x^-) = \Pr(X &lt; x);\\
  b &amp; = p_X(x) = \Pr(X = x); \text{and}\\
  c &amp;= 1 - a - b = \Pr(X &gt; x),
\end{align*}\]</span>
and use <span class="math inline">\((R, S, T)\)</span> to denote the <em>number</em> of observations that are less than, equal to, and greater than <span class="math inline">\(x\)</span>, respectively.</p>
<ol style="list-style-type: decimal">
<li>Show that <span class="math inline">\((R,S,T) \sim \mathrm{Multinomial}\big(n; a,b,c\big)\)</span>.</li>
<li>Consider the discrete random variable <span class="math inline">\(X\)</span>, where
<span class="math display">\[
p_X(x) =
\begin{cases}
   0.2 &amp; \text{for $x = 1$};\\
   0.5 &amp; \text{for $x = 2$};\\
   0.3 &amp; \text{for $x = 3$};\\
   0   &amp; \text{elsewhere.}
\end{cases}
  \]</span>
Show that the above expressions and Equation <a href="OrderStatisticsChapter.html#eq:OrderStatisticDFdiscrete">(13.4)</a> are equivalent for the case <span class="math inline">\(n = 3\)</span> and finding the second order statistic <span class="math inline">\(X_{(2)}\)</span>.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:RandomNumbers" class="exercise"><strong>Exercise 13.10  </strong></span>Suppose you choose a number at random from the continuous uniform distribution between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.
Then, you keep choosing numbers from this <span class="math inline">\(\text{Unif}(0, 1)\)</span> distribution until you obtain a number larger than the one you started with.
You record the number of times you have to select a number before you have success (i.e., a larger number that teh initially-selected number).</p>
<p>More precisely:</p>
<ol style="list-style-type: decimal">
<li>Let <span class="math inline">\(X\sim\text{Unif}(0, 1)\)</span>, your initial number.</li>
<li>You then draw <span class="math inline">\(Y_1, Y_2, \dots\sim\text{Unif}(0, 1)\)</span>, i.i.d., until you get a value <span class="math inline">\(Y_n &gt; X\)</span>.</li>
<li>Your score is <span class="math inline">\(N\)</span>, the number of trials until this happens.</li>
</ol>
<p>What is the expected value of <span class="math inline">\(N\)</span>, the number of values to draw to exceed the initially-selected number?</p>
</div>

</div>
</div>
<hr>
<div class="footer"><span style="color: gray; font-size:0.7em">Peter K. Dunn, 2024: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></span></div>
  <div class="chapter-nav">
<div class="prev"><a href="SamplingDistributions.html"><span class="header-section-number">12</span> Describing samples</a></div>
<div class="next"><a href="BayesianIntro.html"><span class="header-section-number">14</span> Introduction to Bayesian statistics</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#OrderStatisticsChapter"><span class="header-section-number">13</span> Order statistcs</a></li>
<li><a class="nav-link" href="#OrderStatisticsIntro"><span class="header-section-number">13.1</span> Introduction</a></li>
<li><a class="nav-link" href="#OrderStatisticsMaxDistribution"><span class="header-section-number">13.2</span> Sampling distribution of the maximum value</a></li>
<li><a class="nav-link" href="#OrderStatisticsMinDistribution"><span class="header-section-number">13.3</span> Sampling distribution of the minimum value</a></li>
<li><a class="nav-link" href="#OrderStatisticsDistribution"><span class="header-section-number">13.4</span> Sampling distribution of the \(k\)th order statistic</a></li>
<li><a class="nav-link" href="#OrderStatisticsDiscrete"><span class="header-section-number">13.5</span> Order statistics for discrete random variables</a></li>
<li><a class="nav-link" href="#QuantilesOrderStats"><span class="header-section-number">13.6</span> Quantiles and order statistics</a></li>
<li><a class="nav-link" href="#OrderStatisticsExercises"><span class="header-section-number">13.7</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PeterKDunn/DistTheory/blob/main/13-OrderStatistics.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PeterKDunn/DistTheory/edit/main/13-OrderStatistics.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Theory of Statistical Distributions</strong>" was written by Peter K. Dunn. It was last built on Last updated: 2025-12-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
