<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2 Probability | The Theory of Statistical Distributions</title>
<meta name="author" content="Peter K. Dunn">
<meta name="description" content="UpOn completion of this chapter you should be able to: understand the concepts of probability, and apply rules of probability. define probability from using different methods and apply them to...">
<meta name="generator" content="bookdown 0.45 with bs4_book()">
<meta property="og:title" content="2 Probability | The Theory of Statistical Distributions">
<meta property="og:type" content="book">
<meta property="og:description" content="UpOn completion of this chapter you should be able to: understand the concepts of probability, and apply rules of probability. define probability from using different methods and apply them to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2 Probability | The Theory of Statistical Distributions">
<meta name="twitter:description" content="UpOn completion of this chapter you should be able to: understand the concepts of probability, and apply rules of probability. define probability from using different methods and apply them to...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/rglWebGL-binding-1.3.31/rglWebGL.js"></script><link href="libs/rglwidgetClass-1.3.31/rgl.css" rel="stylesheet">
<script src="libs/rglwidgetClass-1.3.31/rglClass.min.js"></script><script src="libs/CanvasMatrix4-1.3.31/CanvasMatrix.min.js"></script><link rel="shortcut icon" href="icons/iconmonstr-chart-1-240.png">
<script>
    document.addEventListener('DOMContentLoaded', function() {
      // Find all R code blocks that should be toggleable.
      // Our Lua filter adds the 'r-code-box' class to the code block.
      var codeBlocks = document.querySelectorAll('.r-code-box');

      codeBlocks.forEach(function(codeBlock) {
        // Create the button element
        var button = document.createElement('button');
        button.textContent = 'Show R Code'; // Initial text for the button
        button.className = 'code-toggle-button'; // Assign CSS class

        // Insert the button directly before the code block.
        // The codeBlock's parentNode is the div.figure-with-code container.
        // We insert the button as a sibling of the codeBlock within that container.
        codeBlock.parentNode.insertBefore(button, codeBlock);

        // Hide the code block initially by default.
        codeBlock.style.display = 'none';

        // Add a click event listener to the button
        button.addEventListener('click', function() {
          if (codeBlock.style.display === 'none') {
            codeBlock.style.display = 'block'; // Show the code block
            button.textContent = 'Hide R Code'; // Change button text
          } else {
            codeBlock.style.display = 'none'; // Hide the code block
            button.textContent = 'Show R Code'; // Change button text back
          }
        });
      });
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/columns.css">
<link rel="stylesheet" href="html/largerDie.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Theory of Statistical Distributions</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">Theoretical foundations</li>
<li><a class="" href="ChapterSetTheory.html"><span class="header-section-number">1</span> Essentials of set theory</a></li>
<li><a class="active" href="ChapterProbability.html"><span class="header-section-number">2</span> Probability</a></li>
<li><a class="" href="DistributionRandomVariables.html"><span class="header-section-number">3</span> Random variables and their distributions</a></li>
<li><a class="" href="ChapBivariate.html"><span class="header-section-number">4</span> Bivariate distributions</a></li>
<li><a class="" href="ChapExpectation.html"><span class="header-section-number">5</span> Mathematical expectation</a></li>
<li><a class="" href="ChapterTransformations.html"><span class="header-section-number">6</span> Transformations of random variables</a></li>
<li class="book-part">Standard univariate probability distributions</li>
<li><a class="" href="DiscreteDistributions.html"><span class="header-section-number">7</span> Standard discrete distributions</a></li>
<li><a class="" href="ContinuousDistributions.html"><span class="header-section-number">8</span> Standard continuous distributions</a></li>
<li><a class="" href="ChapterMixedDistributions.html"><span class="header-section-number">9</span> Mixed distributions</a></li>
<li class="book-part">Multivariate random variables and distributions*</li>
<li><a class="" href="ChapMultivariate.html"><span class="header-section-number">10</span> Multivariate distributions*</a></li>
<li><a class="" href="MultivariateExtensions.html"><span class="header-section-number">11</span> Expectations for multivariate distributions*</a></li>
<li class="book-part">Sampling distributions</li>
<li><a class="" href="SamplingDistributions.html"><span class="header-section-number">12</span> Describing samples</a></li>
<li><a class="" href="OrderStatisticsChapter.html"><span class="header-section-number">13</span> Order statistcs</a></li>
<li><a class="" href="BayesianIntro.html"><span class="header-section-number">14</span> Introduction to Bayesian statistics</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="SymbolsUsed.html"><span class="header-section-number">A</span> Symbols used</a></li>
<li><a class="" href="UsefulSeries.html"><span class="header-section-number">B</span> Some useful series</a></li>
<li><a class="" href="ShortRIntro.html"><span class="header-section-number">C</span> Short R introduction</a></li>
<li><a class="" href="UseRDistributions.html"><span class="header-section-number">D</span> Using R with distributions</a></li>
<li><a class="" href="selected-solutions.html"><span class="header-section-number">E</span> Selected solutions</a></li>
<li><a class="" href="references.html"><span class="header-section-number">F</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PeterKDunn/DistTheory">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ChapterProbability" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Probability<a class="anchor" aria-label="anchor" href="#ChapterProbability"><i class="fas fa-link"></i></a>
</h1>
<div class="objectivesBox objectives">
<p>UpOn completion of this chapter you should be able to:</p>
<ul>
<li>understand the concepts of probability, and apply rules of probability.</li>
<li>define probability from using different methods and apply them to compute probabilities in various situations.</li>
<li>apply the concepts of conditional probability and independence.</li>
<li>differentiate between mutually exclusive events and independent events.</li>
<li>apply Bayes’ Theorem.</li>
<li>use combinations and permutations to compute the probabilities of various events involving counting problems.</li>
</ul>
</div>
<div id="IntroductionToProbability" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Introduction<a class="anchor" aria-label="anchor" href="#IntroductionToProbability"><i class="fas fa-link"></i></a>
</h2>
<p>Probability is a way of describing how likely it is for some event to occur.
A foundation in set theory allows the idea of probability to be developed, since probability relies heavily on many of the ideas from set theory.</p>
<p>Building upon this foundation, probability relates to the outcomes of <em>random processes</em> (or <em>random experiments</em>).</p>
<div class="definition">
<p><span id="def:RandomProcess" class="definition"><strong>Definition 2.1  (Random process) </strong></span>A <strong>random process</strong> (or <strong>random experiment</strong>) is a procedure that:</p>
<ul>
<li>can be repeated, in theory, indefinitely under essentially identical conditions; and</li>
<li>has well-defined outcomes; and</li>
<li>the outcome of any individual repetition is unpredictable.</li>
</ul>
</div>
<p>Examples of simple <em>random processes</em> include tossing a coin, or rolling a die.
While the outcome of any instance of a random process produces is unknown, the possible outcomes are known.</p>
</div>
<div id="SampleSpaces" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Sample spaces<a class="anchor" aria-label="anchor" href="#SampleSpaces"><i class="fas fa-link"></i></a>
</h2>
<p>When talking about probability, the <a href="ChapterSetTheory.html#def:UniversalSet"><em>universal set</em></a> is the set of all possible outcomes that can result from a random process, usually denoted <span class="math inline">\(S\)</span>, <span class="math inline">\(\Omega\)</span> or <span class="math inline">\(U\)</span>.</p>
<div class="definition">
<p><span id="def:SampleSpace" class="definition"><strong>Definition 2.2  (Sample space) </strong></span>A <em>sample space</em> (or <em>event space</em>, or <em>outcome space</em>) for a random process is a set of all possible outcomes from a random process, usually denoted by <span class="math inline">\(S\)</span>, <span class="math inline">\(\Omega\)</span> or <span class="math inline">\(U\)</span> (for the ‘universal set’).</p>
</div>
<div class="example">
<p><span id="exm:SampleSpaceDice" class="example"><strong>Example 2.1  (Sample space) </strong></span>Consider rolling a die.
The sample space is the set of all possible outcomes:
<span class="math display">\[
  S = \{ 1, 2, 3, 4, 5, 6\}.
\]</span></p>
</div>
<p>As with sets, the sample space may be finite, or countably infinite, or uncountably infinite.
When the sample space is finite or countably infinite, the sample space is called <em>discrete</em>.
If a sample space is an uncountably finite set, the sample space is called <em>continuous</em>.</p>
<div class="example">
<p><span id="exm:SampleSpaceDiceDiscrete" class="example"><strong>Example 2.2  (Discrete sample space) </strong></span>The sample space in Example <a href="ChapterProbability.html#exm:SampleSpaceDice">2.1</a> is <em>discrete</em>.</p>
</div>
<div class="example">
<p><span id="exm:SampleSpaceCont" class="example"><strong>Example 2.3  (Continuous sample space) </strong></span>Consider the height of students.
The sample space is <em>continuous</em> (see Example <a href="ChapterSetTheory.html#exm:HeightsOfPeople">1.14</a>).</p>
</div>
<p>Sample spaces can also be a <em>mixture</em> of discrete and continuous sample spaces.
In these sample spaces, part of the sample space is discrete, and part is continuous.
The most common example is when the discrete component refers to <span class="math inline">\(0\)</span> and the continuous part refers to the positive real numbers <span class="math inline">\(\mathbb{R}\)</span>.</p>
<div class="example">
<p><span id="exm:MixedSampleSpace" class="example"><strong>Example 2.4  (Mixed sample space) </strong></span>Consider the random process where we observe the rainfall recorded on any given day, <span class="math inline">\(R\)</span>.</p>
<p>If no rain fall, the rainfall recorded is exactly <span class="math inline">\(R = 0\)</span>; this is the discrete component.
However, if rain does fall, the <em>exact</em> amount cannot be recorded; this is teh continuous component.</p>
<p>The sample space is
<span class="math display">\[
  S = \{0\}\cup \mathbb{R}.
\]</span>
The sample space is <em>mixed</em>.</p>
</div>
</div>
<div id="Events" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Events<a class="anchor" aria-label="anchor" href="#Events"><i class="fas fa-link"></i></a>
</h2>
<p></p>
<div id="SimpleEvents" class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Simple events<a class="anchor" aria-label="anchor" href="#SimpleEvents"><i class="fas fa-link"></i></a>
</h3>
<p>While the sample space defines the set of <em>all</em> possible outcomes, usually we are interested in just some of those elements of the sample space.
Events are <em>subsets</em> of the sample space (and hence are also sets).</p>
<div class="definition">
<p><span id="def:Event" class="definition"><strong>Definition 2.3  (Event) </strong></span>An event <span class="math inline">\(E\)</span> is a subset of <span class="math inline">\(S\)</span>, and we write <span class="math inline">\(E \subseteq S\)</span>.</p>
</div>
<p>By this definition, <span class="math inline">\(S\)</span> itself is an event.
If the sample space is a finite or countable infinite set, then an event is a collection of sample points.</p>
<div class="example">
<p><span id="exm:TwoCoinToss" class="example"><strong>Example 2.5  (Events) </strong></span>Consider the simple random process of tossing a coin twice.
The <a href="ChapterProbability.html#def:SampleSpace">sample space</a> is the set
<span class="math display">\[S = \{ (H, H), \enskip(H, T), \enskip (T, H), \enskip (T, T)\},\]</span>
where
H
represents tossing a head and
T
represents tossing a tail, and the pair lists the result of the two tosses <em>in order</em>.</p>
<p>We can define the event <span class="math inline">\(A\)</span> as ‘tossing a head on the second toss’, and list the elements:
<span class="math display">\[A = \{ (H, H), \enskip (T, H)\};\]</span>
notice that <span class="math inline">\(A \subset S\)</span> (i.e., <span class="math inline">\(A\)</span> is a proper subset of <span class="math inline">\(S\)</span>).</p>
<p>The event <span class="math inline">\(T\)</span>, defined as ‘the set of outcomes corresponding to tossing <em>three</em> heads’, is the <a href="ChapterSetTheory.html#def:EmptySet"><em>null</em> or <em>empty set</em></a>; no sample points have three heads.
That is, <span class="math inline">\(T = \varnothing\)</span>.</p>
</div>
<div class="definition">
<p><span id="def:ElementaryEvent" class="definition"><strong>Definition 2.4  (Simple (elementary) event) </strong></span>In a sample space with a finite or countable infinite number of elements, an <em>simple event</em> (or a <em>elementary event</em>) is an event with one sample point, that cannot be decomposed into smaller events.</p>
</div>
<div class="example">
<p><span id="exm:ElementaryEvents" class="example"><strong>Example 2.6  (Simple events) </strong></span>Consider observing the outcome on a single roll of a die (Example <a href="ChapterProbability.html#exm:SampleSpaceDice">2.1</a>), where the sample space is the set of all possible outcomes:
<span class="math display">\[
  S = \{ 1, 2, 3, 4, 5, 6\}.
\]</span>
The six simple events are:
<span class="math display">\[\begin{align*}
   E_1 = \{1\}&amp;\quad \text{(i.e., roll a 1)}; &amp; E_2 = \{2\}:&amp;\quad \text{(i.e., roll a 2)};\\
   E_3 = \{3\}&amp;\quad \text{(i.e., roll a 3)}; &amp; E_2 = \{4\}:&amp;\quad \text{(i.e., roll a 4)};\\
   E_5 = \{5\}&amp;\quad \text{(i.e., roll a 5)}; &amp; E_2 = \{6\}:&amp;\quad \text{(i.e., roll a 6)}.
\end{align*}\]</span></p>
</div>
<p>An important concept is that of an <em>occurrence</em> of an event.</p>
<div class="definition">
<p><span id="def:Occurrence" class="definition"><strong>Definition 2.5  (Occurrence) </strong></span>An event <span class="math inline">\(A\)</span> <em>occurs</em> on a particular trial of a <a href="ChapterProbability.html#def:RandomProcess">random process</a> if the outcome of the trial is an element of the subset <span class="math inline">\(A\)</span> from the random process.</p>
</div>
</div>
<div id="CompoundEvents" class="section level3" number="2.3.2">
<h3>
<span class="header-section-number">2.3.2</span> Compound events<a class="anchor" aria-label="anchor" href="#CompoundEvents"><i class="fas fa-link"></i></a>
</h3>
<p>Simple events usually not of great interest; events of interest usually contains many elements of the sample space.
These are called <em>compound events</em>.</p>
<div class="definition">
<p><span id="def:CompoundEvents" class="definition"><strong>Definition 2.6  (Compound event) </strong></span>A collection of simple events is sometimes called a <em>compound event</em>.</p>
</div>
<p>Since compound events, like all events, are <em>sets</em>, operations on existing sets (Sect. 
<a href="ChapterSetTheory.html#RelationshipsBetweenSets">1.6</a>) can be used to define compound events.</p>
<div class="example">
<p><span id="exm:ElementaryCompoundEvents" class="example"><strong>Example 2.7  (Simple and compound events) </strong></span>Consider observing the outcome on a single roll of a die, as shown in Example <a href="ChapterProbability.html#exm:ElementaryEvents">2.6</a>.</p>
<p>Define the event <span class="math inline">\(T\)</span> as ‘numbers divisible by <span class="math inline">\(3\)</span>’ and event <span class="math inline">\(D\)</span> as ‘numbers divisible by <span class="math inline">\(2\)</span>’.
<span class="math inline">\(T\)</span> and <span class="math inline">\(D\)</span> are compound events:
<span class="math display">\[
   T =\{E_3, E_6\} = \{3, 6 \}
   \quad
   \text{and}
   \quad
   D = \{E_2, E_4, E_6\} = \{2, 4, 6 \}.
\]</span></p>
</div>
<p>The set operations in Sect. <a href="ChapterSetTheory.html#RelationshipsBetweenSets">1.6</a> apply to events, because events are sets.
However, different language is usually used, to indicate that events are real outcomes, whereas as sets are for describing structures more widely and abstractly (Table <a href="ChapterProbability.html#tab:CompareLanguage">2.1</a>).
For example, ‘disjoint’ is used for <em>sets</em> (Sect. <a href="ChapterSetTheory.html#RelationshipsBetweenSets">1.6</a>), whereas ‘mutually exclusive’ is used when referring to <em>events</em>.</p>
<div class="definition">
<p><span id="def:MutuallyExclusive" class="definition"><strong>Definition 2.7  (Mutually exclusive) </strong></span>Events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <em>mutually exclusive</em> if, and only if, <span class="math inline">\(A\cap B = \varnothing\)</span>; that is, they have no outcomes in common.
That is, Events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <em>mutually exclusive</em> if the corresponding sets are disjoint.</p>
</div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:CompareLanguage">TABLE 2.1: </span>The language used in set theory and probability. The examples are based on the examples of rolling a six-sided die, where the possible outcomes are <span class="math inline">\(\{1, 2, 3, 4, 5, 6\}\)</span>, <span class="math inline">\(A = \{1, 2, 3\}\)</span> and <span class="math inline">\(B = \{1, 6\}\)</span>.
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
Set theory
</th>
<th style="text-align:center;font-weight: bold;">
Probability
</th>
<th style="text-align:center;font-weight: bold;">
Example
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Set
</td>
<td style="text-align:center;">
Event
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
Element of set <span class="math inline">\(x \in A\)</span>
</td>
<td style="text-align:center;">
Simple events
</td>
<td style="text-align:center;">
<span class="math inline">\(\{1\}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
Universal set <span class="math inline">\(U\)</span>
</td>
<td style="text-align:center;">
Sample space, <span class="math inline">\(S\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\{1, 2, 3, 4, 5, 6\}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
Subset <span class="math inline">\(A\subseteq S\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(A\)</span> is an Event in <span class="math inline">\(S\)</span>
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
Union <span class="math inline">\(A\cup B\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(A\)</span> <strong>or</strong> <span class="math inline">\(B\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\{1, 2, 3, 6\}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
Intersection <span class="math inline">\(A\cap B\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(A\)</span> <strong>and</strong> <span class="math inline">\(B\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\{1\}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
Complement <span class="math inline">\(A^c\)</span>
</td>
<td style="text-align:center;">
Not <span class="math inline">\(A\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\{4, 5, 6\}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
Empty set <span class="math inline">\(\varnothing\)</span>
</td>
<td style="text-align:center;">
Impossible event
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
Disjoint sets
</td>
<td style="text-align:center;">
Mutually exclusive events
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
Set difference <span class="math inline">\(A\setminus B\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(A\)</span> occurs, but not <span class="math inline">\(B\)</span>
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table></div>
<div class="example">
<p><span id="exm:TwoCoinToss2" class="example"><strong>Example 2.8  (Tossing a coin twice) </strong></span>Consider the simple random process of tossing a coin twice (Example <a href="ChapterProbability.html#exm:TwoCoinToss">2.5</a>), and define events <span class="math inline">\(M\)</span> and <span class="math inline">\(N\)</span> as follows:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th><strong>Event</strong></th>
<th align="center"><strong>Notation</strong></th>
<th align="center"><strong>Set</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>‘Obtain a Head on Toss 1’</td>
<td align="center"><span class="math inline">\(M\)</span></td>
<td align="center"><span class="math inline">\(\{(HT), (HH)\}\)</span></td>
</tr>
<tr class="even">
<td>‘Obtain a Tail on Toss 1’</td>
<td align="center"><span class="math inline">\(N\)</span></td>
<td align="center"><span class="math inline">\(\{(TT), (TH)\}\)</span></td>
</tr>
</tbody>
</table></div>
<p>The two sets are <em>disjoint</em>, as there are no sample points in common.
The events are therefore <em>mutually exclusive</em>.</p>
</div>
<p>Since events are really just sets, the set algebra in Sect. <a href="ChapterSetTheory.html#SetAlgebra">1.7</a> applies to events also.</p>
<div class="example">
<p><span id="exm:RollDie" class="example"><strong>Example 2.9  (Rolling a die) </strong></span>Suppose we roll a single, six-sided die.
For rolling a die, the sample space is <span class="math inline">\(S = \{1, 2, 3, 4, 5, 6\}\)</span>.
We can define these two events:
<span class="math display">\[\begin{align*}
   E = \text{An even number is thrown}         &amp;= \{2, 4, \phantom{5, }6\};\\
   G = \text{A number larger than 3 is thrown} &amp;= \{\phantom{2,\ }4, 5, 6\}.
\end{align*}\]</span>
Then, the following compound events could be defined:
<span class="math display">\[\begin{align*}
   E \cap G       &amp;= \{4, 6\}      &amp;    E \cup G  &amp;= \{ 2, 4, 5, 6\}\\
   E^c            &amp;= \{ 1, 3, 5\}  &amp;    G^c       &amp;= \{ 1, 2, 3\}.
\end{align*}\]</span>
We can make other observations too:
<span class="math display">\[\begin{align*}
   E \cap G^c
   &amp;= \{2, 4, 6\} \cap \{ 1, 2, 3\} = \{ 2 \};\\
   E^c \cap G^c
   &amp;= \{1, 3, 5\} \cap \{ 1, 2, 3\} = \{ 1, 3 \}.
\end{align*}\]</span>
See the Venn diagram in Fig. <a href="ChapterProbability.html#fig:EventsFandG">2.1</a>.</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:EventsFandG"></span>
<img src="02-Probability_files/figure-html/EventsFandG-1.png" alt="A Venn diagram showing events $E$ and $G$." width="50%"><p class="caption">
FIGURE 2.1: A Venn diagram showing events <span class="math inline">\(E\)</span> and <span class="math inline">\(G\)</span>.
</p>
</div>
<div class="example">
<p><span id="exm:CricketBallEvents" class="example"><strong>Example 2.10  (Throwing a cricket ball) </strong></span>Consider throwing a cricket ball, where the distance of the throw (in metres) is of interest (Example <a href="ChapterSetTheory.html#exm:CricketBallDefine">1.19</a>).
We could define the sample space <span class="math inline">\(D\)</span> as <span class="math inline">\(D = \{ d \in \mathbb{R} \mid d \ge 0 \}\)</span>.
More practically, we could write
<span class="math display">\[
  D = \{ d \in \mathbb{R} \mid 0 &lt; d &lt; 150 \}
\]</span>
given that throwing a cricket ball greater than <span class="math inline">\(150\,\text{m}\)</span> is effectively impossible (it has never been recorded), and throwing a cricket ball exactly <span class="math inline">\(0\,\text{m}\)</span> is also impossible in practice.</p>
<p>We can define these two events:
<span class="math display">\[\begin{align*}
   B_1 &amp;= \{b \in S \mid b \ge 40\} &amp;&amp;\quad \text{(i.e., throw a cricket ball at least $40\,\text{m}$)};\\
   B_2 &amp;= \{b \in S \mid b &lt; 50\}   &amp;&amp;\quad \text{(i.e., throw a cricket ball less than $50\,\text{m}$)}.
\end{align*}\]</span>
Then:
<span class="math display">\[\begin{align*}
   B_1 \cap B_2   &amp;= \{b\in S \mid 40\le b&lt;50\}\quad \text{(i.e., throw the ball at least $40$m but less than $50\,\text{m}$)};\\
   B_1 \cup B_2   &amp;= S;\\
   B_1^c          &amp;= \{b\in S \mid b &lt; 40\}\quad \text{(i.e., throw the ball less than $40\,\text{m}$)}.
\end{align*}\]</span></p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:CricketBallSpace"></span>
<img src="02-Probability_files/figure-html/CricketBallSpace-1.png" alt="The two events\ $B_1$ and\ $B_2$ defined for throwing a cricket ball, and three other events defined with\ $B_1$ and\ $B_2$. When the open, the indicated value is \emph{not} included in the region." width="100%"><p class="caption">
FIGURE 2.2: The two events <span class="math inline">\(B_1\)</span> and <span class="math inline">\(B_2\)</span> defined for throwing a cricket ball, and three other events defined with <span class="math inline">\(B_1\)</span> and <span class="math inline">\(B_2\)</span>. When the open, the indicated value is included in the region.
</p>
</div>
</div>
</div>
<div id="Probability" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Probablility<a class="anchor" aria-label="anchor" href="#Probability"><i class="fas fa-link"></i></a>
</h2>
<p></p>
<div id="ProbabilityDefinition" class="section level3" number="2.4.1">
<h3>
<span class="header-section-number">2.4.1</span> Definitions<a class="anchor" aria-label="anchor" href="#ProbabilityDefinition"><i class="fas fa-link"></i></a>
</h3>
<p>Usually, we are interested in how likely it is for various outcomes from a random experiment to occur.
That is, how likely it is to observe any of the various events defined on the sample space.
<em>Probability</em> is the mathematical term for quantifying this likelihood.
The <em>probability</em> of an event <span class="math inline">\(E\)</span> occurring is denoted <span class="math inline">\(\text{Pr}(E)\)</span>.</p>
<div class="definition">
<p><span id="def:Probability" class="definition"><strong>Definition 2.8  (Probability) </strong></span><em>Probability</em> is a function that assigns a number to an event.
That is, for some event <span class="math inline">\(E\)</span>, the value <span class="math inline">\(\Pr(E)\)</span> represents the probability that event <span class="math inline">\(E\)</span> occurs.</p>
</div>
<div class="importantBox important">
<p>The probability of an event <span class="math inline">\(E\)</span> occurring can be denoted as <span class="math inline">\(\text{P}(E)\)</span>, <span class="math inline">\(\text{Pr}(E)\)</span>, <span class="math inline">\(\text{Pr}\{E\}\)</span>, or using other similar notation.</p>
</div>
<p>This definition in Def. <a href="ChapterProbability.html#def:Probability">2.8</a> allows <em>any</em> number to be assigned to an event, without rules or restrictions (‘assigns a number’).
Some restrictions must be placed on the numbers that can be assigned to make this definition workable and practical.</p>
</div>
<div id="ProbabilityAxioms" class="section level3" number="2.4.2">
<h3>
<span class="header-section-number">2.4.2</span> Three axioms of probability<a class="anchor" aria-label="anchor" href="#ProbabilityAxioms"><i class="fas fa-link"></i></a>
</h3>
<p>
While we have defined probability as a function that assigns a number to an event, we have not stated what numbers can be assigned as a ‘probability’.
What values should a probability take?
How should these numerical likelihoods be assigned?</p>
<p>A rigorous foundation for probability is found by using three fundamental axioms, called the <em>Axioms of Probability</em>.
Using these axioms, <em>all</em> other rules about probability can be derived.
These axioms formally define the rules that apply to all probabilities.</p>
<div class="tipBox tip">
<p>An <strong>axiom</strong> is a self-evident truth that does not require proof, or cannot be proven.
They form the starting point for building further proofs.</p>
</div>
<div class="definition">
<p><span id="def:ThreeAxioms" class="definition"><strong>Definition 2.9  (Kolmogorov's three axioms of probability) </strong></span>Consider a sample space <span class="math inline">\(S\)</span> for a random process, and an event <span class="math inline">\(A\)</span> in <span class="math inline">\(S\)</span> so that <span class="math inline">\(A\subseteq S\)</span>.
For every event <span class="math inline">\(A\)</span> (a subset of <span class="math inline">\(S\)</span>), a number <span class="math inline">\(\Pr(A)\)</span> can be assigned which is called the <em>probability</em> of event <span class="math inline">\(A\)</span>.</p>
<p>Kolmogorov’s three axioms of probability are:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Non-negativity</strong>: <span class="math inline">\(\Pr(A) \ge 0\)</span>.<br>
The probability of any event is a non-negative real number.</li>
<li>
<strong>Exhaustive</strong>: <span class="math inline">\(\Pr(S) = 1\)</span>.<br>
The event that <em>something</em> happens has probability <span class="math inline">\(1\)</span> (i.e., is certain), since the sample space lists <em>all</em> possible outcomes.</li>
<li>
<strong>Additivity</strong>: If <span class="math inline">\(A_1\)</span> and <span class="math inline">\(A_2\)</span> are two mutually exclusive events in <span class="math inline">\(S\)</span> (i.e., <span class="math inline">\(A_1 \cap A_2 = \varnothing\)</span>), then
<span class="math display">\[
   \Pr(A_1 \cup A_2) = \Pr(A_1) + \Pr(A_2).
\]</span>
</li>
</ol>
</div>
<p></p>
</div>
<div id="ProbabilityRules" class="section level3" number="2.4.3">
<h3>
<span class="header-section-number">2.4.3</span> Rules of probability<a class="anchor" aria-label="anchor" href="#ProbabilityRules"><i class="fas fa-link"></i></a>
</h3>
<p>These
purpose of these axioms is to formally define probability and the the rules that apply to probabilities.
These axioms of probability can be used to develop all other probability formulae.
For example, these properties follow from these three axioms, for any Events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> defined on a sample space <span class="math inline">\(S\)</span>:</p>
<ul>
<li>
<strong>Bounds</strong>:<br><span class="math inline">\(0 \le \Pr(A)\le 1\)</span>; that is, probabilities are numbers between zero and one inclusive for any event <span class="math inline">\(A\)</span>.</li>
<li>
<strong>Empty sets</strong>:<br><span class="math inline">\(\Pr(\varnothing) = 0\)</span>; that is, the probability of an impossible event is zero.</li>
<li>
<strong>Monotonicity</strong>:<br>
If <span class="math inline">\(A\subseteq B\)</span>, then <span class="math inline">\(\Pr(A) \le \Pr(B)\)</span>; that is, if every outcome in event <span class="math inline">\(A\)</span> is also in event <span class="math inline">\(B\)</span>, then the probability of <span class="math inline">\(A\)</span> cannot exceed the probability of <span class="math inline">\(B\)</span>.</li>
<li>
<strong>Complements</strong>:<br><span class="math inline">\(\Pr(A^c) = 1 - Pr(A)\)</span>; that is, the probability that event <span class="math inline">\(A\)</span> <em>does not</em> happens is <span class="math inline">\(1\)</span> minus the probability that it <em>does</em> happen.</li>
<li>
<strong>Addition</strong>:<br><span class="math inline">\(\Pr(A_1 \cup A_2) = \Pr(A_1) + \Pr(A_2) - \Pr(A_1 \cap A_2)\)</span>, a more general result than the third axiom.</li>
</ul>
<p>All of these can be proven using only the three axioms and the definitions that have been presented so far.
We giv etwo examoples of using the axiom to prove these results.</p>
<div id="CompRule" class="theroem" name="Empty sets">
<p>For the empty set <span class="math inline">\(\varnothing\)</span>,: <span class="math inline">\(\Pr(\varnothing) = 0\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-2" class="proof"><em>Proof</em>. </span>While this may appear ‘obvious’, it is not one of the three axioms.
By definition, the empty set <span class="math inline">\(\varnothing\)</span> contain no outcomes; hence <span class="math inline">\(\varnothing \cup A = A\)</span> for any event <span class="math inline">\(A\)</span>; the two events are <a href="ChapterProbability.html#def:MutuallyExclusive">mutually exclusive</a>.</p>
<p>So, by the third axiom, <span class="math inline">\(\varnothing\cap A = \varnothing\)</span>, as <span class="math inline">\(\varnothing\)</span> and <span class="math inline">\(A\)</span> are mutually exclusive.
Hence, by the <a href="ChapterProbability.html#def:ThreeAxioms">third axiom</a>
<span class="math display" id="eq:ByThirdAxiom">\[\begin{equation}
   \Pr(\varnothing\cup A) = \Pr(\varnothing) + \Pr(A).
   \tag{2.1}
\end{equation}\]</span>
But since <span class="math inline">\(\varnothing \cup A = A\)</span>, then <span class="math inline">\(\Pr(\varnothing \cup A) = \Pr(A)\)</span>, and so <span class="math inline">\(\Pr(A) = \Pr(\varnothing) + \Pr(A)\)</span> from Eq. <a href="ChapterProbability.html#eq:ByThirdAxiom">(2.1)</a>.
Hence <span class="math inline">\(\Pr(\varnothing) = 0\)</span>.</p>
</div>
<p>While this result may have seemed obvious, <em>all</em> probability formulae can be developed just from assuming the three axioms of probability.</p>
<div class="theorem">
<p><span id="thm:CompRule" class="theorem"><strong>Theorem 2.1  (Complementary rule of probability) </strong></span>For any event <span class="math inline">\(A\)</span>, the probability of ‘not <span class="math inline">\(A\)</span>’ is
<span class="math display">\[
   \Pr(A^c) = 1 - \Pr(A).
\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-3" class="proof"><em>Proof</em>. </span>By the definition of the <a href="ChapterSetTheory.html#def:IntersectionUnionSubset"><em>complement</em> of an event</a>, <span class="math inline">\(A^c\)</span> and <span class="math inline">\(A\)</span> are mutually exclusive.
Hence, by the <a href="ChapterProbability.html#def:ThreeAxioms">third axiom</a>, <span class="math inline">\(\Pr(A^c \cup A) = \Pr(A^c) + \Pr(A)\)</span>.</p>
<p>As <span class="math inline">\(A^c\cup A = S\)</span> (by definition of the complement) and <span class="math inline">\(\Pr(S) = 1\)</span> (Axiom 2), then <span class="math inline">\(1 = \Pr(A^c) + \Pr(A)\)</span>, and the result follows.</p>
</div>
<div class="importantBox important">
<p>The three axioms dictate that a probability is a real value between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.
Other ways also exists to quantify the likelihood of an event occuring.
For example, sometimes the chance of an event occurring is expressed as <em>odds</em>, which are <em>not</em> the same as probabilities.
Odds are the ratio of how often an event is likely to occur, to how often the event is likely to <em>not occur</em>.</p>
<p>Importantly: ‘odds’ and ‘probability’ are not the same.
The three axioms define the rules that all probabilities must follow.</p>
</div>
<p>Having seen these axioms, and the rules that follow from them, we can now consider <em>how</em> to determine the probability assigned to certain events.
</p>
</div>
</div>
<div id="AssignProbDiscrete" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Assigning probabilities: discrete samples spaces<a class="anchor" aria-label="anchor" href="#AssignProbDiscrete"><i class="fas fa-link"></i></a>
</h2>
<p>Developing a method of assigning a probability to an event is difficult.
However, for <em>discrete sample spaces</em>, two options are:</p>
<ul>
<li>finding probabilities using <em>classical probability</em> (Sect. <a href="ChapterProbability.html#ClassicalProb">2.5.1</a>).
This approach works when the simple events in the sample space are equally likely (i.e., there is no reason to suspect one outcome is more likely that any other).</li>
<li>
<em>estimating</em> probabilities using <em>relative-frequency</em> (Sect. <a href="ChapterProbability.html#EmpiricalApproach">2.5.2</a>), when trials can be repeated many times.</li>
</ul>
<div id="ClassicalProb" class="section level3" number="2.5.1">
<h3>
<span class="header-section-number">2.5.1</span> Classical probability<a class="anchor" aria-label="anchor" href="#ClassicalProb"><i class="fas fa-link"></i></a>
</h3>
<p>For a discrete sample space, <em>where all outcomes in the sample space are equally likely</em> (i.e., there is no reason to suspect one outcome is more likely that any other), the probability of an event <span class="math inline">\(E\)</span> is defined as
<span class="math display">\[
  \Pr(E)
  = \frac{|E|}{|S|}
  = \frac{\text{The number of elements in $E$}}{\text{The number of elements in $S$}},
\]</span></p>
<p>where <span class="math inline">\(|\cdot|\)</span> refers to the cardinality notation (Sect. <a href="ChapterSetTheory.html#Cardinality">1.5.4</a>).</p>
<p>A probability of <span class="math inline">\(0\)</span> is assigned to an event that <em>never</em> occurs (i.e., <span class="math inline">\(E\)</span> corresponds to an <em>impossible</em> event), and <span class="math inline">\(1\)</span> to an event that is <em>certain</em> to occur (i.e., <span class="math inline">\(E\)</span> corresponds to the universal set).
Notice that this approach conforms to the restriction on probabilities as numbers between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> inclusive, a result that follows from the three axioms of probability.</p>
<p>Using the classical approach to probability often requires careful counting of the number of elements in the sample space, and the number of elements in the event of interest.
Methods for this careful counting are explored further in Sect. <a href="ChapterProbability.html#CombsAndPerms">2.6</a>.</p>
</div>
<div id="EmpiricalApproach" class="section level3" number="2.5.2">
<h3>
<span class="header-section-number">2.5.2</span> Relative frequency (empirical) approach<a class="anchor" aria-label="anchor" href="#EmpiricalApproach"><i class="fas fa-link"></i></a>
</h3>
<p>The mathematical definition of probability through our axioms describe the <em>properties</em> of a probability measure. The classical definition of probability naturally satisfies these axioms, but requires equally-likely outcomes in the sample space <span class="math inline">\(S\)</span>.</p>
<p>However, outcomes are rarely equally likely; the probability of ‘receiving rain tomorrow’ is not always the same as the probability of ‘not receiving rain tomorrow’.
When a random process can be repeated many times, counting the number of times the event of interest occurs means we can compute the <em>proportion</em> of times the event occurs.
Mathematically, if the random process is repeated <span class="math inline">\(n\)</span> times, and event <span class="math inline">\(E\)</span> occurs in <span class="math inline">\(m\)</span> of these (<span class="math inline">\(m &lt; n\)</span>), then the <em>probability</em> of the event occurring is
<span class="math display">\[
   \Pr(E) = \lim_{n\to\infty} \frac{m}{n}.
\]</span>
In practice, <span class="math inline">\(n\)</span> needs to be very large—and the repetitions random—to compute probabilities with accuracy.
In practice then, only approximate probabilities can be found (since <span class="math inline">\(n\)</span> is finite in practice).</p>
<p>This is the <em>relative frequency</em> (or <em>empirical</em>) approach to probability.</p>
<p>This method cannot always be used in practice.
Consider the probability that the air bag in a car correctly deploys in a crash.
Crashing thousands of cars is not financially viable to estimate the probability that the air bag is correctly deploying.
Fortunately, car manufacturers can crash a small numbers of cars to get a very appoximate indications of the probabilities of correct air bag deployment.
Sometimes, computer simulations can be used to approximate the probabilities.</p>
<p>Again, a probability of <span class="math inline">\(0\)</span> is assigned to an event that <em>never</em> occurs (i.e., <span class="math inline">\(E\)</span> corresponds to an <em>impossible</em> event), and <span class="math inline">\(1\)</span> to an event that is <em>certain</em> to occur (i.e., <span class="math inline">\(E\)</span> corresponds to the universal set), as <span class="math inline">\(n\to\infty\)</span>.
Notice that this approach conforms to the restriction on probabilities as numbers between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> inclusive, a result that follows from the three axioms of probability.</p>
<div class="example">
<p><span id="exm:SalkVaccine" class="example"><strong>Example 2.11  (Salk vaccine) </strong></span>In 1954, Jonas Salk developed a vaccine against polio (<span class="citation">Williams (<a href="references.html#ref-book:Williams:BioStats">1994</a>)</span>, 1.1.3).
To test the effectiveness of the vaccine, the data in Table <a href="ChapterProbability.html#tab:Polio">2.2</a> were collected.</p>
<p>The relative frequency approach can be used to <em>estimate</em> the probabilities of developing polio <em>with</em> the vaccine and <em>without</em> the vaccine (the control group):
<span class="math display">\[\begin{align*}
   \Pr(\text{develop polio in control group})
   &amp;\approx \frac{115}{201\,229} = 0.000571;\\[3pt]
   \Pr(\text{develop polio in vaccinated group})
   &amp;\approx \frac{33}{200\,745} = 0.000164,
\end{align*}\]</span>
where ‘<span class="math inline">\(\approx\)</span>’ means ‘approximately equal to’.
The estimated <em>probability</em> of contracting polio in the control group is about 3.5 times greater than in the control group.
The precision of these sample estimates could be quantified by producing a <a href="https://bookdown.org/pkaldunn/SRM-Textbook/CIOneProportion.html">confidence interval for the proportions</a>.</p>
</div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:Polio">TABLE 2.2: </span>The number of paralytic cases for two groups of children: one group of controls and another vaccinated with the Salk polio vaccine.
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;">
</th>
<th style="text-align:right;font-weight: bold;">
Number treated
</th>
<th style="text-align:right;font-weight: bold;">
Paralytic cases
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Vaccinated
</td>
<td style="text-align:right;">
200 745
</td>
<td style="text-align:right;">
33
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
201 229
</td>
<td style="text-align:right;">
115
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="CombsAndPerms" class="section level2" number="2.6">
<h2>
<span class="header-section-number">2.6</span> Counting elements: combinatorics<a class="anchor" aria-label="anchor" href="#CombsAndPerms"><i class="fas fa-link"></i></a>
</h2>
<div id="MultiplicationRule" class="section level3" number="2.6.1">
<h3>
<span class="header-section-number">2.6.1</span> Basic ideas: multiplication rule<a class="anchor" aria-label="anchor" href="#MultiplicationRule"><i class="fas fa-link"></i></a>
</h3>
<p>Applying the classical approach to probability often requires counting the number of elements in a finite, discrete sample space, and in a given event.</p>
<div class="example">
<p><span id="exm:CountingElements" class="example"><strong>Example 2.12  (Counting elements) </strong></span>How many outcomes are possible when a coin is flipped <span class="math inline">\(3\)</span> times?
Listing the possible outcomes is feasible:
<span class="math display">\[\begin{align*}
  &amp;(\text{Head}, \text{Head}, \text{Head}),   &amp; &amp;(\text{Head}, \text{Head}, \text{Tail}),\\
  &amp;(\text{Head}, \text{Tail}, \text{Head}),   &amp; &amp;(\text{Head}, \text{Tail}, \text{Tail}),\\
  &amp;(\text{Tail}, \text{Head}, \text{Head}),   &amp; &amp;(\text{Tail}, \text{Head}, \text{Tail}),\\
  &amp;(\text{Tail}, \text{Tail}, \text{Head}),   &amp; &amp;(\text{Tail}, \text{Tail}, \text{Tail}).
\end{align*}\]</span>
We can also count four outcomes where a Tail is tossed last.</p>
<p>So the probability of the event ‘a tail of the final toss of three coin tosses’ is (using classical probability) <span class="math inline">\(4/8 = 0.5\)</span>.</p>
</div>
<p>If we were considering <span class="math inline">\(25\)</span> tosses of a coin, however, listing all the outcomes and counting them becomes tedious.
However, we don’t even need to know <em>what</em> the outcomes are; we only need to know <em>how many</em> outcomes there are.
This is where counting methods are useful.</p>
<p>The basic counting principle is the <em>multiplication rule</em>.</p>
<div class="definition">
<p><span id="def:MultiplicationRule" class="definition"><strong>Definition 2.10  (Multiplication rule) </strong></span>If Event 1 has <span class="math inline">\(m\)</span> possible outcomes, and Event 2 has <span class="math inline">\(n\)</span> possible outcomes, then the total number of combined outcomes is <span class="math inline">\(m\times n\)</span>.</p>
</div>
<p>The principle can be extended to any number of events.
For example: for three sets of events with <span class="math inline">\(m_1\)</span>, <span class="math inline">\(m_2\)</span> and <span class="math inline">\(m_3\)</span> outcomes respectively, the number of distinct triplets containing one element from each set is <span class="math inline">\(m_1 m_2 m_3\)</span>.</p>
<div class="example">
<p><span id="exm:CountingElements2" class="example"><strong>Example 2.13  (Counting elements) </strong></span>In Example <a href="ChapterProbability.html#exm:CountingElements">2.12</a>, we could use the multiplication rule.
On Flip 1, there are two possible outcomes.
Likewise, on Flips 2 and 3, there are two possible outcomes.
So the total number if possible outcomes is <span class="math inline">\(2\times 2\times 2 = 8\)</span>, as found in that example.</p>
<p>In <span class="math inline">\(25\)</span> tosses, there are <span class="math inline">\(2^{25} = 33\, 554\, 432\)</span> possible outcomes.</p>
</div>
<div class="example">
<p><span id="exm:MultiplicationRulemeals" class="example"><strong>Example 2.14  (Multiplication rule) </strong></span>Suppose a restaurants offers five main courses and three desserts.
If a ‘meal’ consists of one main plus one dessert, then <span class="math inline">\(5\times 3 = 15\)</span> meal combinations are possible.</p>
</div>
<div class="example">
<p><span id="exm:CountingElementsPasswords" class="example"><strong>Example 2.15  (Counting elements) </strong></span>Consider selecting a random password of <em>exactly</em> six characters in length, only using the set of all lower-case letters (‘<code>a</code>’, ‘<code>b</code>’, ‘<code>z</code>’).</p>
<p>There are <span class="math inline">\(26\)</span> choices for the first character, and <span class="math inline">\(26\)</span> choices for the second character, and so on,
So the total number of passwords is
<span class="math display">\[
  26^6 = 308\,915\,776.
\]</span></p>
</div>
<p>In the example above, notice that the letters can be reused; once a letter is selected, it is effectively returned to the pool of letters and can be chosen again.
This called selection <em>with replacement</em>; selected elements can be reselected.</p>
<p>The multiplication rule demonstrates the basic idea behind counting (or <em>enumerating</em>) events and sample spaces.
More generally, though, <em>permutations</em> and <em>combinations</em> are needed when selection are made <em>without replacement</em>: that is, once an elements is selected, it cannot be selected again.</p>
<p>Permutations and combinations are used to count outcomes when selections are made from a fixed number of elements, without replacement,
If the order of selection <em>is</em> important, <em>permutations</em> are appropriate.
If the order of selection <em>is not</em> important, <em>combinations</em> are appropriate.</p>
<div class="example">
<p><span id="exm:CombsAndPerms" class="example"><strong>Example 2.16  (Permutations and combinations) </strong></span>Consider selecting a random six-letter password from the set of lower-case letters only: ‘<code>a</code>’, ‘<code>b</code>’, ‘<code>z</code>’, where <em>no letter can be repeated</em> (which is unrealistic).
In passwords, the order of the characters is important: the passwords <code>listen</code> and <code>silent</code> are <em>different</em> passwords, even though they contain the same characters.
Since the <em>order</em> of the characters is important, <em>permutations</em> could be used to count how many passwords are possible.</p>
<p>Consider dealing five cards to two different players in a game.
The <em>order</em> in which the cards are dealt is not important; it only matters what cards have been dealt to each player.
Since the <em>order</em> in which the cards are dealt is not important, <em>combinations</em> could be used to count how many ways there are to deal the cards.</p>
</div>
<div class="importantBox important">
<p>This may help you remember when to use combinations and permutations:</p>
<ul>
<li>
<strong>P</strong>ermutations are used for <strong>p</strong>asswords: order is important.</li>
<li>
<strong>C</strong>ombinations are used when dealing <strong>c</strong>ards: order is not important.</li>
</ul>
</div>
<p>Permutations and combinations are studied further in the following sections (Sect. <a href="ChapterProbability.html#CombsAndPerms">2.6</a>).
However, counting the number of outcomes can also be achieved by listing the possible outcomes in other ways.</p>
<div class="example">
<p><span id="exm:TwoDice" class="example"><strong>Example 2.17  (Rolling two dice) </strong></span>Consider rolling two standard dice; the sample space is shown in Table <a href="ChapterProbability.html#tab:TwoDice">2.3</a>, and has <span class="math inline">\(6\times 6 = 36\)</span> elements.
Then, for example, <span class="math inline">\(\Pr(\text{sum is 5}) = 4/36\)</span> is found by counting the equally-likely outcomes that sum to seven (Table <a href="ChapterProbability.html#tab:TwoDiceSum">2.4</a>).</p>
</div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:TwoDice">TABLE 2.3: </span>The sample space for rolling two dice.
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;">
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 1
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 2
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 3
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 4
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 5
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 6
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 1
</td>
<td style="text-align:right;">
(1, 1)
</td>
<td style="text-align:right;">
(1, 2)
</td>
<td style="text-align:right;">
(1, 3)
</td>
<td style="text-align:right;">
(1, 4)
</td>
<td style="text-align:right;">
(1, 5)
</td>
<td style="text-align:right;">
(1, 6)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 2
</td>
<td style="text-align:right;">
(2, 1)
</td>
<td style="text-align:right;">
(2, 2)
</td>
<td style="text-align:right;">
(2, 3)
</td>
<td style="text-align:right;">
(2, 4)
</td>
<td style="text-align:right;">
(2, 5)
</td>
<td style="text-align:right;">
(2, 6)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 3
</td>
<td style="text-align:right;">
(3, 1)
</td>
<td style="text-align:right;">
(3, 2)
</td>
<td style="text-align:right;">
(3, 3)
</td>
<td style="text-align:right;">
(3, 4)
</td>
<td style="text-align:right;">
(3, 5)
</td>
<td style="text-align:right;">
(3, 6)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 4
</td>
<td style="text-align:right;">
(4, 1)
</td>
<td style="text-align:right;">
(4, 2)
</td>
<td style="text-align:right;">
(4, 3)
</td>
<td style="text-align:right;">
(4, 4)
</td>
<td style="text-align:right;">
(4, 5)
</td>
<td style="text-align:right;">
(4, 6)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 5
</td>
<td style="text-align:right;">
(5, 1)
</td>
<td style="text-align:right;">
(5, 2)
</td>
<td style="text-align:right;">
(5, 3)
</td>
<td style="text-align:right;">
(5, 4)
</td>
<td style="text-align:right;">
(5, 5)
</td>
<td style="text-align:right;">
(5, 6)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 6
</td>
<td style="text-align:right;">
(6, 1)
</td>
<td style="text-align:right;">
(6, 2)
</td>
<td style="text-align:right;">
(6, 3)
</td>
<td style="text-align:right;">
(6, 4)
</td>
<td style="text-align:right;">
(6, 5)
</td>
<td style="text-align:right;">
(6, 6)
</td>
</tr>
</tbody>
</table></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:TwoDiceSum">TABLE 2.4: </span>The sum of rolling two dice.
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;">
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 1
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 2
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 3
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 4
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 5
</th>
<th style="text-align:right;font-weight: bold;">
Die 2: 6
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Die 1: 6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
12
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="PermutationSelectWithoutReplacement" class="section level3" number="2.6.2">
<h3>
<span class="header-section-number">2.6.2</span> Permutations<a class="anchor" aria-label="anchor" href="#PermutationSelectWithoutReplacement"><i class="fas fa-link"></i></a>
</h3>
<p>Permutations concern selecting elements from a fixed number of elements (without replacement).</p>
<div class="definition">
<p><span id="def:Permutations" class="definition"><strong>Definition 2.11  (Permutations) </strong></span>A <em>permutation</em> is an <em>ordered</em> selection of elements (without replacement).</p>
</div>
<p>Consider a finite, discrete sample space with <span class="math inline">\(n\)</span> distinct elements.
The first element chosen can be selected in <span class="math inline">\(n\)</span> different ways.
The second element must then be chosen, which can be done in <span class="math inline">\((n - 1)\)</span> ways (it cannot be the same as the first element, as selection is <em>without</em> replacement), using the multiplication rule.
There are then <span class="math inline">\((n - 2)\)</span> ways for the third, and so on.
Notice that once an element is selected, it cannot be selected again; this is called <em>selecting without replacement</em>.
</p>
<p>Continuing then, and using the multiplication rule (Def. <a href="ChapterProbability.html#def:MultiplicationRule">2.10</a>), there are
<span class="math display">\[
  n(n - 1)(n - 2)\ldots 2 \times 1
\]</span>
different ways to order the <span class="math inline">\(r\)</span> elements.
This is denoted by <span class="math inline">\(n!\)</span> and called ‘<span class="math inline">\(n\)</span>-factorial’:
<span class="math display">\[
   n! = n(n - 1)(n - 2) \ldots (2)(1)
\]</span>
where <span class="math inline">\(n\geq 1\)</span>, and we define <span class="math inline">\(0! = 1\)</span>.</p>
<div class="importantBox important">
<p>By definition, <span class="math inline">\(0! = 1\)</span>.
With this definition, many formulas (some follow) remain valid for all valid choices of <span class="math inline">\(n\)</span> and <span class="math inline">\(r\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:FactorialBasic" class="example"><strong>Example 2.18  (Factorials) </strong></span>Factorials get large very quickly: <span class="math inline">\(4! = 4\times 3\times 2\times 1 = 24\)</span>, but <span class="math inline">\(10! = 3\,628\,800\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:FactorialTrick" class="example"><strong>Example 2.19  (Factorials) </strong></span>Consider the expression
<span class="math display">\[
   \frac{6!}{3!} =
   \frac{6\times 5\times 4\times 3!}{3!} =
   6\times 5\times 4 = 120.
\]</span>
Notice that the top line did not need evaluation.
This trick is often used when working with factorials.
For instance, we can compute:
<span class="math display">\[
   \frac{57!}{53!} =
   \frac{57\times 56\times 55\times 54\times 53!}{53!} =
   57\times 56\times 55\times 54 = 9\,480\,240,
\]</span>
without needing to compute the value of <span class="math inline">\(57!\)</span> (which has the approximate value <span class="math inline">\(4\times 10^{76}\)</span>).</p>
</div>
<p>Now, consider a finite, discrete sample space <span class="math inline">\(S\)</span> with <span class="math inline">\(n\)</span> distinct elements again.
Suppose we wish to count the number of <em>permutations</em> of size <span class="math inline">\(r\)</span> that can be drawn from <span class="math inline">\(S\)</span>, when selected items <em>cannot</em> be reselected (‘<em>without</em> replacement’).</p>
<p>As before, there are <span class="math inline">\(n\)</span> options for the first item selected, and <span class="math inline">\(n - 1\)</span> options for the second item selected, since the element selected first <em>cannot</em> be re-selected.
The same idea applies for all <span class="math inline">\(r\)</span> elements.
Therefore, the number of permutations of size <span class="math inline">\(r\)</span>, when selection is <em>without</em> replacement, is (using the <em>multiplication rule</em> in Def. <a href="ChapterProbability.html#def:MultiplicationRule">2.10</a> and the idea in Example <a href="ChapterProbability.html#exm:FactorialTrick">2.19</a>):
<span class="math display">\[
   n \times (n - 1)\times (n - 2)\times\cdots\times (n - r + 1)
   = \frac{n!}{(n - r)!}.
\]</span>
This number is denoted by <span class="math inline">\(^nP_r\)</span>, and we write
<span class="math display">\[
   P^n_r = n(n - 1)(n - 2)\ldots (n - r + 1) = \frac{n!}{(n - r)!}.
\]</span>
This expression is referred to as <em>the number of permutations of <span class="math inline">\(r\)</span> elements from <span class="math inline">\(n\)</span> elements</em>.</p>
<div class="importantBox important">
<p>Notation for permutations varies.
Other notation for permutations include <span class="math inline">\(nPr\)</span>, <span class="math inline">\(^nP_r\)</span>, <span class="math inline">\(P_n^r\)</span> or <span class="math inline">\(P(n,r)\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:PermutationBasic" class="example"><strong>Example 2.20  (Permutations) </strong></span>Eight runners compete in a <span class="math inline">\(100\,\text{m}\)</span> race.
In how many ways could the Gold, Silver and Bronze medals be awarded?</p>
<p>This situation is like selecting <span class="math inline">\(r = 3\)</span> of the <span class="math inline">\(n = 8\)</span> runners to award medals.
In addition, the order is definitely important (the runner coming first would not be happy being given a Bronze medal), so permutations are appropriate.
There are
<span class="math display">\[
  P^8_3 = \frac{8!}{(8 - 3)!} = 336
\]</span>
ways in which the three medals could be allocated.</p>
</div>
<!-- I removed itemising here, as we had thing sthat could be misinterpreted, like  - factorial(n) -->
<div class="softwareBox software">
<p>In <strong>R</strong>, <span class="math inline">\(n!\)</span> is given by <code>factorial(n)</code>.</p>
<p>While there is no function to explicitly compute the number of permutations, two options for computing <span class="math inline">\(^nP_r\)</span> are to use<br><code>factorial(n) / factorial(n - r)</code><br>
or<br><code>prod( n : (n - r + 1) )</code><br>
or<br><code>prod( (n - r + 1) : n )</code><br>
(since <code><a href="https://rdrr.io/r/base/prod.html">prod()</a></code> computes the <em>product</em> of all given elements).</p>
<p>For example,
<span class="math display">\[
   P^{12}_3 =\frac{12\times 11\times 10\times 9!}{9!} = 12\times 11\times 10 = 1320
\]</span>
could be computed as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="fl">12</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1320</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span> <span class="fl">10</span><span class="op">:</span><span class="fl">12</span> <span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1320</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span> <span class="fl">12</span><span class="op">:</span><span class="fl">10</span> <span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1320</span></span></code></pre></div>
</div>
<p>Some of the common properties of permutations are given below.</p>
<ul>
<li>
<span class="math inline">\(P^n_n = n!\)</span>.</li>
<li>
<span class="math inline">\(P^n_0 = 1\)</span>.</li>
<li>
<span class="math inline">\(\displaystyle P^n_1 = n\)</span>.</li>
<li>
<span class="math inline">\(\displaystyle P^n_{n - 1} = n!\)</span>.</li>
<li>
<span class="math inline">\(\displaystyle\frac{P^n_r}{P^n_{r - 1}} = n - r + 1\)</span>.</li>
<li>
<span class="math inline">\(\displaystyle P^n_r = P^{n - 1}_r + r \times P^{n - 1}_{r - 1}\)</span>.</li>
<li>
<span class="math inline">\(\displaystyle P^n_r = n \times P^{n - 1}_{r - 1} = n \times (n - 1) \times P^{n - 2}_{r - 2}\)</span>, and so on.</li>
</ul>
</div>
<div id="Combinations" class="section level3" number="2.6.3">
<h3>
<span class="header-section-number">2.6.3</span> Combinations<a class="anchor" aria-label="anchor" href="#Combinations"><i class="fas fa-link"></i></a>
</h3>
<p>When the selection order is not important (i.e., when dealing a hand of cards), a <em>combination</em> is appropriate for counting the number of possibilities.</p>
<div class="definition">
<p><span id="def:Combinations" class="definition"><strong>Definition 2.12  (Combinations) </strong></span>A <em>combination</em> is an <em>unordered</em> selection of elements (without replacements).</p>
</div>
<p>Consider a finite, discrete sample space <span class="math inline">\(S\)</span> with <span class="math inline">\(n\)</span> distinct elements.
The number of <em>permutations</em> of size <span class="math inline">\(r\)</span> that can be drawn from the sample space <span class="math inline">\(S\)</span> is <span class="math inline">\(^n P_r\)</span>.
But some of these are effectively the same outcomes; for instance, these two hands of cards, shown in the order dealt, are the same since selection order is not important:
<span class="math display">\[
  (3\spadesuit, 5\heartsuit)\qquad\text{and}\qquad (5\heartsuit, 3\spadesuit).
\]</span>
So while both hands are counted separately for permutations, they are considered to be the <em>same</em> outcome for combinations.
(This means that the number of combinations of <span class="math inline">\(r\)</span> elements from <span class="math inline">\(n\)</span> elements will never be smaller than the number of permutations of <span class="math inline">\(r\)</span> elements from <span class="math inline">\(n\)</span> elements.)</p>
<p>If we have selected <span class="math inline">\(r\)</span> elements, there are <span class="math inline">\(r\)</span> ways to rearrange these elements (by the multiplication rule), all of which are the same of the order is not important.
So we can state that the number of combinations of <span class="math inline">\(r\)</span> elements drawn form <span class="math inline">\(n\)</span> elements, where order is not important, is
<span class="math display">\[
   C^n_r = \frac{P_r}{r!} = \frac{\text{number of permutations}}{\text{number of equivalent re-arrangements of that permutation}}.
\]</span>
More directly, the number of combinations of <span class="math inline">\(r\)</span> elements from <span class="math inline">\(n\)</span> elments, where the selection order is not important, is
<span class="math display" id="eq:CombinationPermutation">\[\begin{equation}
   C^n_r = \binom{n}{r} = \frac{n(n - 1)\ldots (n - r + 1)}{r!} = \frac{n!}{(n - r)!\,r!} = \frac{P^n_r}{r!}
       \tag{2.2}
\end{equation}\]</span>
when elements are ‘selected without replacement’.
The two most common notations are shown: <span class="math inline">\(^nC_r\)</span> and <span class="math inline">\(\binom{n}{r}\)</span>.</p>
<div class="importantBox important">
<p>Notation for combinations varies.
Other notation for combinations include <span class="math inline">\(nCr\)</span>, <span class="math inline">\({}^nC_r\)</span>, <span class="math inline">\(C_n^r\)</span>, <span class="math inline">\(\binom{n}{r}\)</span> or <span class="math inline">\(C(n,r)\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:CombinationBasic" class="example"><strong>Example 2.21  (Combinations in cards) </strong></span>Suppose a hand of five cards is drawn from a well-shuffled pack of <span class="math inline">\(52\)</span> cards.
Since the order is which the cards are dealt is not important, <em>combinations</em> are appropriate.
The number of possible hands is
<span class="math display">\[
  P^{52}_5 = \frac{52!}{(52 - 5)!} =
  \frac{52!}{47!} = \frac{52\times 51\times\cdots \times 48\times 47!}{47!} =
  52\times 51\times\cdots \times 48 = 311\,875\,200
\]</span>
Over <span class="math inline">\(311\)</span> million hands are possible.</p>
</div>
<div class="example">
<p><span id="exm:CombinationOzLotto" class="example"><strong>Example 2.22  (Oz Lotto combinations) </strong></span>In <em>Oz Lotto</em>, players select seven numbers from 47, and try to match these with seven randomly selected numbers.
The order in which the seven numbers are selected in not important, so <em>combinations</em> (not permutations) are appropriate.
That is, winning numbers drawn in the order, as <span class="math inline">\(\{1, 2, 3, 4, 5, 6, 7\}\)</span> are effectively the same as if they were drawn in the order <span class="math inline">\(\{7, 2, 1, 3, 4, 6, 5\}\)</span>.</p>
<p>The number of options for players to choose from is
<span class="math display">\[
   \binom{47}{7} = \frac{47!}{40!\times 7!} = 62\,891\,499;
\]</span>
that is, almost <span class="math inline">\(63\)</span> million combinations are possible.</p>
<p>The probability of picking the one correct set of seven numbers in a single guess is therefore
<span class="math display">\[
   \frac{1}{62\,891\,499} = 1.59\times 10^{-8} = 0.000\,000\,015\,9.
\]</span></p>
</div>
<div class="softwareBox software">
<p>In <strong>R</strong>:</p>
<ul>
<li>the <em>number</em> of combinations of <code>n</code> elements <code>k</code> at a time is found using <code>choose(n, k)</code>.</li>
<li>a <em>list</em> of all combinations of <code>n</code> elements, <code>m</code> at a time is given by <code>combn(x, m)</code>.</li>
<li>
<span class="math inline">\(n!\)</span> is given by <code>factorial(n)</code>.</li>
</ul>
</div>
<p>The binomial expansion
<span class="math display">\[
  (a + b)^n = \sum^{n}_{r = 0} \binom{n}{r} a^r b^{n - r}
\]</span>
for <span class="math inline">\(n\)</span> a positive integer, is often referred to as the <em>Binomial Theorem</em> and hence <span class="math inline">\(\binom{n}{r}\)</span> is referred to as a <em>binomial coefficient</em>.
This series, and associated properties, is sometimes useful in counting.
Some of the properties of combinations are stated below.</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\binom{n}{r} = \binom{n}{n - r}\)</span>, for <span class="math inline">\(r = 0, 1, \ldots, n\)</span>.</li>
<li>As a special case of the above, <span class="math inline">\(\binom{n}{0} = 1 = \binom{n}{n}\)</span>.</li>
<li>
<span class="math inline">\(\sum_{r = 0}^n \binom{n}{r} = 2^n\)</span>.</li>
</ol>
<div class="example">
<p><span id="exm:PermAndCombSizes" class="example"><strong>Example 2.23  () </strong></span>For any given values <span class="math inline">\(n\)</span> and <span class="math inline">\(r\)</span>, the number of permutations is never smaller than the number of combinations (as is clear from Eq. <a href="ChapterProbability.html#eq:CombinationPermutation">(2.2)</a>).
This is because many permutation corresponds to a single combination, since the order is important for permutations.</p>
<p>For example, suppose two cards have been dealt, in this order:
<span class="math display">\[
  3\spadesuit, 5\heartsuit.
\]</span>
The hand would be exactly the same if they had been dealt in the opposite order:
<span class="math display">\[
  5\heartsuit, 3\spadesuit.
\]</span>
Both hands count as one combination, since order is not important.</p>
<p>However, if the order <em>was</em> important, then the two hands are different, and both should be counted: there are <em>two</em> separate outcomes.</p>
<p>As a larger example:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The number of *combinations* of r = 3 items from n = 20:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 120</span></span>
<span></span>
<span><span class="co"># The number of *permutations* of r = 3 items from n = 20:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 720</span></span></code></pre></div>
</div>
<div class="example">
<p><span id="exm:ChooseDigits" class="example"><strong>Example 2.24  (Selecting digits) </strong></span>Consider the set of integers <span class="math inline">\({1, 3, 5, 7}\)</span> (these integers have no common factors).
Choose two numbers, <em>without replacement</em>; call the first <span class="math inline">\(a\)</span> and the second <span class="math inline">\(b\)</span>.
If we then compute <span class="math inline">\(a\times b\)</span>, then <span class="math inline">\(C^4_2 = 6\)</span> answers are possible since the <em>selection order is not important</em> (e.g., <span class="math inline">\(3 \times 7\)</span> gives the <em>same</em> answer as <span class="math inline">\(7 \times 3\)</span>).</p>
<p>However, if we compute <span class="math inline">\(a\div b\)</span>, then <span class="math inline">\(P^4_2 = 12\)</span> answers are possible, since the <em>selection order is important</em> (e.g., <span class="math inline">\(3 \div 7\)</span> gives a <em>different</em> answer than <span class="math inline">\(7 \div 3\)</span>).</p>
</div>
<p>Some of the common properties of combinations are given below.</p>
<ul>
<li>
<span class="math inline">\(\displaystyle\binom{n}{n} = \binom{n}{0} = 1\)</span>.</li>
<li>
<span class="math inline">\(\displaystyle\binom{n}{1} = n\)</span>.</li>
<li>
<span class="math inline">\(\displaystyle\binom{n}{r} = \binom{n}{n - r}\)</span>.</li>
<li>
<span class="math inline">\(\displaystyle\binom{n}{r} + \binom{n}{r - 1} = \binom{n + 1}{r}\)</span>.</li>
</ul>
</div>
</div>
<div id="AssignProbContinuous" class="section level2" number="2.7">
<h2>
<span class="header-section-number">2.7</span> Assigning probabilities: continuous sample spaces<a class="anchor" aria-label="anchor" href="#AssignProbContinuous"><i class="fas fa-link"></i></a>
</h2>
<div id="AllocatingProbabilitiesContinuous" class="section level3" number="2.7.1">
<h3>
<span class="header-section-number">2.7.1</span> Allocating probabilities<a class="anchor" aria-label="anchor" href="#AllocatingProbabilitiesContinuous"><i class="fas fa-link"></i></a>
</h3>
<p>Events defined on a continuous sample space do not have elements that can be counted (Sect. <a href="ChapterSetTheory.html#InfiniteSets">1.5.3</a>), so different means are needed to compute probabilities in these situations.
In fact, for a continuous sample space, the probability of observing any specific, individual outcome has probability <span class="math inline">\(0\)</span>.
So, for a continuous sample space <span class="math inline">\(S = \mathbb{R}\)</span>, the events
<span class="math display">\[\begin{align*}
   A &amp;= \{x \in S \mid 10 &lt; x &lt; 20\},\\
   B &amp;= \{x \in S \mid 10 \le x &lt; 20\},\\
   C &amp;= \{x \in S \mid 10 &lt; x \le 20\}\quad\text{and}\\
   D &amp;= \{x \in S \mid 10 \le x \le 20\}
\end{align*}\]</span>
all have the same probability.
In a continuous sample space, the probability of observing any single value (such as observing a value of <em>exactly</em> <span class="math inline">\(10\)</span>) is zero.
So, whether these endpoints of the interval are included or excluded, the probability is the same.</p>
<p>This means that a probability is not (and cannot be) based on counting elements for continuous sample spaces.
Instead, a <em>probability density function</em> (or PDF) is used to describe how the probability is assigned across the sample space.
A PDF is defined over the sample space, and quantifies the concentration of probability in different regions of the sample space.</p>
<p>For example, consider the heights of adult females (Example <a href="ChapterSetTheory.html#exm:HeightsOfPeople">1.14</a>).
Every female has a height, so the sample space <span class="math inline">\(S\)</span> of the heights of all females can be defined as, for instance,
<span class="math display">\[
   S = \{ x \in \mathbb{R} \mid 50 &lt; x &lt; 300\},
\]</span>
where <span class="math inline">\(x\)</span> is the height in centimetres.
We have assumed no height less than <span class="math inline">\(50\,\text{cm}\)</span> (the shortest-ever recorded height of an adult female is greater than this) or greater than <span class="math inline">\(300\,\text{cm}\)</span> (the tallest-ever recorded height of an adult female is less than this).
Since this is the sample space <span class="math inline">\(S\)</span>, the probability of event <span class="math inline">\(S\)</span> is one (by the third axiom of probability; Sect. <a href="ChapterProbability.html#ProbabilityAxioms">2.4.2</a>): we are certain that the height of any given woman is in <span class="math inline">\(S\)</span>.
That is, the total probability over <span class="math inline">\(S\)</span> is one; every adult female is represented somewhere within <span class="math inline">\(S\)</span>.</p>
<p>Now consider how that total probability of one could be distributed to various ranges of heights.
The probability of finding an adult female with a height less than <span class="math inline">\(75\,\text{cm}\)</span> (or <span class="math inline">\(29\,\text{inches}\)</span>) is basically impossible.
Almost no probability will be concentrated below <span class="math inline">\(75\,\text{cm}\)</span>.</p>
<p>The probability of finding an adult female with a height less than <span class="math inline">\(150\,\text{cm}\)</span> (or <span class="math inline">\(4\,\text{ft}\)</span> <span class="math inline">\(11\,\text{inches}\)</span>) is unlikely, but is possible.
Thus, only a little of the probability will be concentrated below <span class="math inline">\(150\,\text{cm}\)</span>.</p>
<p>Likewise, the probability of finding an adult female with a height greater than <span class="math inline">\(300\,\text{cm}\)</span> (or <span class="math inline">\(9\,\text{ft}\)</span> <span class="math inline">\(10\,\text{inches}\)</span>) is practically impossible.
Almost no probability will be concentrated above <span class="math inline">\(300\,\text{cm}\)</span>.</p>
<p>The probability of finding an adult female with a height greater than <span class="math inline">\(200\,\text{cm}\)</span> (or <span class="math inline">\(6\,\text{ft}\)</span> <span class="math inline">\(7\,\text{inches}\)</span>) is unlikely but not impossible; only a little of the probability will be concentrated above <span class="math inline">\(200\,\text{cm}\)</span>.</p>
<p>In contrast, the probability of finding an adult female with a height between <span class="math inline">\(150\,\text{cm}\)</span> and <span class="math inline">\(200\,\text{cm}\)</span> is <em>very</em> high; almost all of the probability will be concentrated between <span class="math inline">\(150\,\text{cm}\)</span> and <span class="math inline">\(200\,\text{cm}\)</span>.
We can draw a picture that represents this concentration of probability (Fig. <a href="ChapterProbability.html#fig:HeightsConcentrations">2.3</a>, top panel).
This figure shows how the probability is concentrated, or allocated, or <em>distributed</em>, over the sample space.</p>
<p>The total probability over <span class="math inline">\(S\)</span> is one; if you computed the area of the five rectangles in Fig. <a href="ChapterProbability.html#fig:HeightsConcentrations">2.3</a> (top panel) you would get one.
However, the values on the vertical axis are not really that helpful (they are <em>not</em> probabilities).
In the context of a continuous sample space, this means that the total <em>area under the graph</em> (i.e., the shaded areas in Fig. <a href="ChapterProbability.html#fig:HeightsConcentrations">2.3</a>) must be equal to one.</p>
<p>Rather than dividing the sample space into just five large intervals of height, a finer division of heights could be used; for instance, Fig. <a href="ChapterProbability.html#fig:HeightsConcentrations">2.3</a> (bottom panel) uses the same ideas but with <span class="math inline">\(10\,\text{cm}\)</span> intervals of heights.
This representation shows that most of the probability is concentrated <span class="math inline">\(155\,\text{cm}\)</span> to <span class="math inline">\(165\,\text{cm}\)</span>, suggesting that finding an adult female with a height in this range has a relatively high probability.
Again, the total probability over <span class="math inline">\(S\)</span> is one, so the total <em>area under the graph</em> (i.e., the shaded area) must be equal to one.
Again, the values on the vertical axis are not really that helpful, and are <em>not</em> probabilities.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:HeightsConcentrations"></span>
<img src="02-Probability_files/figure-html/HeightsConcentrations-1.png" alt="Allocating the concentration of probability over regions of the sample space. The shaded regions have an area of\ $1$." width="90%"><p class="caption">
FIGURE 2.3: Allocating the concentration of probability over regions of the sample space. The shaded regions have an area of <span class="math inline">\(1\)</span>.
</p>
</div>
<div class="importantBox important">
<p>For a continuous sample space, intervals of the sample space represent events, and areas under the curve represent probabilities.</p>
</div>
</div>
<div id="PDFs" class="section level3" number="2.7.2">
<h3>
<span class="header-section-number">2.7.2</span> Probability density functions<a class="anchor" aria-label="anchor" href="#PDFs"><i class="fas fa-link"></i></a>
</h3>
<p>As the intervals become smaller, the graph showing the allocations of probability become smoother (Fig. <a href="ChapterProbability.html#fig:HeightsConcentrationsSmooth">2.4</a>).
This smooth curve, say <span class="math inline">\(f(x)\)</span>, is called a <em>probability density function</em> (or PDF): it shows the density (or concentration) of probability over various ranges of the sample space.
Then, the <em>integral</em> over the sample space <span class="math inline">\(S\)</span> must equal one:
<span class="math display">\[
   \int_S f(x)\,dx = 1.
\]</span>
The vertical axis, as noted above, is not very informative, so is usually not given.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:HeightsConcentrationsSmooth"></span>
<img src="02-Probability_files/figure-html/HeightsConcentrationsSmooth-1.png" alt="Smoothly allocating the concentration of probability over regions of the sample space. The shaded region has an area of\ $1$." width="90%"><p class="caption">
FIGURE 2.4: Smoothly allocating the concentration of probability over regions of the sample space. The shaded region has an area of <span class="math inline">\(1\)</span>.
</p>
</div>
<p>With continuous sample spaces, the probability of observing some event <span class="math inline">\(E\)</span> is assigned to an <em>interval</em> on the sample space <span class="math inline">\(S\)</span>.
The probability of event <span class="math inline">\(E\)</span> is
<span class="math display">\[
   \Pr(E) = \int_E f(x)\,dx.
\]</span></p>
<p>The three axioms of probability (Sect. <a href="ChapterProbability.html#ProbabilityAxioms">2.4.2</a>) still apply for continuous sample space, though the equivalent statement involves <em>integration</em> of the density function <span class="math inline">\(f(x)\)</span> over the sample space <span class="math inline">\(S\)</span> rather than <em>summations</em> (compare to Sect. <a href="ChapterProbability.html#ProbabilityAxioms">2.4.2</a>):</p>
<ol style="list-style-type: decimal">
<li>
<strong>Non-negativity:</strong>
<em>Integration</em> over any region of the sample space must never produce a negative value, and so <span class="math inline">\(f(x) \ge 0\)</span> for <em>all</em> values of <span class="math inline">\(x\)</span>.</li>
<li>
<strong>Exhaustive:</strong>
Over the whole sample space, the probability function must <em>integrate</em> to one:
<span class="math display">\[
  \int_S f(x)\,dx = 1.
\]</span>
</li>
<li>
<strong>Additivity:</strong>
The probability of the union of any non-overlapping regions is the sum of the individual regions:
<span class="math display">\[
  \int_{A_1} f(x)\, dx + \int_{A_2} f(x)\, dx  = \int_{A_1 \cup A_2} f(x)\, dx.
\]</span>
</li>
</ol>
<p>Using these axioms implies a probability function for some event <span class="math inline">\(A\)</span> is defined on the continuous sample space <span class="math inline">\(S\)</span> as
<span class="math display">\[
   \Pr(X\in A) = \int_{A(x)} f_X(x)\, dx.
\]</span></p>
<div class="importantBox important">
<p>The probability function <span class="math inline">\(f_X(x)\)</span> does <strong>not</strong> give the probability of observing the value <span class="math inline">\(X = x\)</span>.
Because the sample space has an infinite number of elements, the probability of observing any single point is zero.
Instead, probabilities are computed for <em>intervals</em>.</p>
<p>This implies that <span class="math inline">\(f_X(x) &gt; 1\)</span> may be true for some values of <span class="math inline">\(x\)</span>, provided the total area over the sample space is one.</p>
</div>
</div>
</div>
<div id="SubjectiveApproach" class="section level2" number="2.8">
<h2>
<span class="header-section-number">2.8</span> Assigning probability: subjective approach<a class="anchor" aria-label="anchor" href="#SubjectiveApproach"><i class="fas fa-link"></i></a>
</h2>
<p>‘Subjective’ probabilities are estimated after identifying the information that may influence the probability, and then evaluating and combining this information.
You use this method when someone asks you about your team’s chance of winning on the weekend.</p>
<p>The final (subjective) probability may, for example, be computed using mathematical models that use the relevant information.
When different people or systems identify different information as relevant, and combine them differently, different subjective probabilities eventuate.</p>
<p>Some examples include:</p>
<ul>
<li>What is the chance that an investment will return a positive yield next year?</li>
<li>How likely is it that Auckland will have above average rainfall next year?</li>
</ul>
<p>Subjective probabilities can be used for discrete or continuous sample space; as always, probabilities can only be allocated to regions for continuous sample spaces.</p>
<div class="example">
<p><span id="exm:ChanceRain" class="example"><strong>Example 2.25  (Subjective probability) </strong></span>What is the likelihood of rain in Charleville (a town in western Queensland) during April?
Many farmers could give a subjective estimate of the probability based on their experience and the conditions on their farm.</p>
<p>Using the classical approach to determine the probability is not possible.
While two outcomes are possible—it <em>will</em> rain, or it <em>will not</em> rain—these are almost certainly not <em>equally likely</em>.</p>
<p>A relative frequency approach could be adopted.
Data from the <a href="http://www.bom.gov.au">Bureau of Meterology</a>, from 1942 to 2022 (81 years), shows rain fell in 71 years during April.
An <em>approximation</em> to the probability is therefore <span class="math inline">\(71 / 81 = 0.877\)</span>, or <span class="math inline">\(87.7\)</span>%.
This approach does not take into account current climatic or weather conditions, that can change every year.</p>
</div>
</div>
<div id="DiagramsForProbability" class="section level2" number="2.9">
<h2>
<span class="header-section-number">2.9</span> Using diagrams to visualise outcomes<a class="anchor" aria-label="anchor" href="#DiagramsForProbability"><i class="fas fa-link"></i></a>
</h2>
<div id="VennDiagrams" class="section level3" number="2.9.1">
<h3>
<span class="header-section-number">2.9.1</span> Venn diagrams<a class="anchor" aria-label="anchor" href="#VennDiagrams"><i class="fas fa-link"></i></a>
</h3>
<p>Venn diagrams can be useful for visualising probabilities, usig regions (often circles) to represent events.
Venn diagrams are useful for two events, sometimes for three, but become unworkable for more than three.
Often, tables can be used to better represent situations shown in Venn diagrams (Sect. <a href="ChapterProbability.html#Tables">2.9.2</a>).</p>
<div class="example">
<p><span id="exm:VennDiagramExample" class="example"><strong>Example 2.26  (Venn diagrams) </strong></span>Suppose Event A has probability <span class="math inline">\(\Pr(A) = 0.4\)</span> and Event B has <span class="math inline">\(\Pr(B) = 0.3\)</span>.
In addition, <span class="math inline">\(\Pr(A\cap B) = 0.1\)</span>.
A Venn diagram (Fig. <a href="ChapterProbability.html#fig:SimpleVenn">2.5</a>) shows the two events in the sample space.
The intersection (with probability <span class="math inline">\(0.1\)</span>) includes elements from <em>both</em> Event <span class="math inline">\(A\)</span> and Event <span class="math inline">\(B\)</span>.</p>
<p>We can see, for example, that <span class="math inline">\(\Pr(A\setminus B) = 0.3\)</span>, and <span class="math inline">\(\Pr(A\cup B) = 0.6\)</span>.</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SimpleVenn"></span>
<img src="02-Probability_files/figure-html/SimpleVenn-1.png" alt="A Venn diagram for a simple situation with two events. The rectangle represents the sample space\ $S$; the purple circle represents Event\ $A$ and the green circle represents Event\ $B$. Left: the two events. Right: the probabilities for each section of the sample soace." width="90%"><p class="caption">
FIGURE 2.5: A Venn diagram for a simple situation with two events. The rectangle represents the sample space <span class="math inline">\(S\)</span>; the purple circle represents Event <span class="math inline">\(A\)</span> and the green circle represents Event <span class="math inline">\(B\)</span>. Left: the two events. Right: the probabilities for each section of the sample soace.
</p>
</div>
</div>
<div id="Tables" class="section level3" number="2.9.2">
<h3>
<span class="header-section-number">2.9.2</span> Tables of probability<a class="anchor" aria-label="anchor" href="#Tables"><i class="fas fa-link"></i></a>
</h3>
<p>With two variables of interest, probability tables may be a convenient way of summarizing the information.
A probability represents the whole sample spacem an shows how the sample space is divided between two events.</p>
<div class="example">
<p><span id="exm:TableDiagramExample" class="example"><strong>Example 2.27  (Probability tables) </strong></span>The information in Example <a href="ChapterProbability.html#exm:VennDiagramExample">2.26</a> can be compiled into a two-way table (Table <a href="ChapterProbability.html#tab:SimpleTable">2.5</a>): Events <span class="math inline">\(A\)</span> and ‘not <span class="math inline">\(A\)</span>’ are shown in the columns, and Events <span class="math inline">\(B\)</span> and ’not <span class="math inline">\(B\)</span> are shown in the rows.</p>
</div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:SimpleTable">TABLE 2.5: </span>The probabilities in a two-way table.
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;">
</th>
<th style="text-align:right;font-weight: bold;">
A
</th>
<th style="text-align:right;font-weight: bold;">
Not A
</th>
<th style="text-align:right;font-weight: bold;">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;font-weight: bold;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Not B
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;font-weight: bold;">
0.7
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Total
</td>
<td style="text-align:right;font-weight: bold;">
0.4
</td>
<td style="text-align:right;font-weight: bold;">
0.6
</td>
<td style="text-align:right;font-weight: bold;font-weight: bold;">
1.0
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="TreeDiagrams" class="section level3" number="2.9.3">
<h3>
<span class="header-section-number">2.9.3</span> Tree diagrams<a class="anchor" aria-label="anchor" href="#TreeDiagrams"><i class="fas fa-link"></i></a>
</h3>
<p><em>Tree diagrams</em> are useful when a <a href="ChapterProbability.html#def:RandomProcess">random process</a> can be seen, or thought of, as occurring in steps or stages.
The probabilities in the second step may depend on what happens on the forst step (which are called <em>conditional probabilities</em>, which are studied further in Sect. <a href="ChapterProbability.html#CondProbIndependence">2.10</a>)
The ideas extend to multiple steps.</p>
<div class="example">
<p><span id="exm:TreeSimple" class="example"><strong>Example 2.28  (Tree diagrams) </strong></span>Suppose the probability that a customer makes a purchase using the online store is <span class="math inline">\(0.35\)</span>; then, the probability that the customer requests a refund is <span class="math inline">\(0.30\)</span>.
However, if a customer makes a purchase using the physical store, the probability that the customer requests a refund is <span class="math inline">\(0.05\)</span>.
That is, most customers make purchases at the physical store, and are less likely to request a refund compared to online customers.</p>
<p>The two events of interest are:
<span class="math display">\[\begin{align*}
  O&amp;: \text{The customer makes a purchase online; and}\\
  R&amp;: \text{The customer requests a refund.}
\end{align*}\]</span>
Using this notation, <span class="math inline">\(\Pr(O) = 0.35\)</span>, and so <span class="math inline">\(\Pr(O^c) = 0.65\)</span> is the probability that a customer makes a purchase in a physical store.
The value of <span class="math inline">\(\Pr(R)\)</span> (and hence <span class="math inline">\(\Pr(R)\)</span>) <em>depends</em> on whether the purchase was made online or in-store.</p>
<p>The situation can be considered as having two stages.
Stage 1 is where the purchase was made (online, or in a physical store).
Stage 2 is whether the customer requests a refund.
The tree diagram for the situation is shown in Fig. <a href="ChapterProbability.html#fig:SimpleTree">2.6</a>.
The probabilities in Stage 2 are different, depending on where the purchase was made.</p>
</div>
<p>To understand how to use tree diagrams requires a stuy of <em>conditional probability</em>, which we do next.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SimpleTree"></span>
<img src="02-Probability_files/figure-html/SimpleTree-1.png" alt="Tree diagram for the customer-satisfaction example." width="67%"><p class="caption">
FIGURE 2.6: Tree diagram for the customer-satisfaction example.
</p>
</div>
</div>
</div>
<div id="CondProbIndependence" class="section level2" number="2.10">
<h2>
<span class="header-section-number">2.10</span> Conditional probability and independent events<a class="anchor" aria-label="anchor" href="#CondProbIndependence"><i class="fas fa-link"></i></a>
</h2>
<div id="CondProb" class="section level3" number="2.10.1">
<h3>
<span class="header-section-number">2.10.1</span> Conditional probability<a class="anchor" aria-label="anchor" href="#CondProb"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<p>The tree diagram in Example <a href="ChapterProbability.html#exm:TreeSimple">2.28</a> is an example of <em>conditional probability</em>: the probability of requesting a refund is <em>conditional on</em> (or <em>depends on</em>) whether the customer made an online or in-store purchase.</p>
<p>In Example <a href="ChapterProbability.html#exm:TreeSimple">2.28</a>, we see that <span class="math inline">\(\Pr(R) = 0.30\)</span> <em>if</em> event <span class="math inline">\(O\)</span> has occurred; we write <span class="math inline">\(\Pr(R \mid O ) = 0.30\)</span>, which we read as ‘The probability that Event <span class="math inline">\(R\)</span> occurs <em>given that</em> Event <span class="math inline">\(O\)</span> has occurred’.
<span class="math inline">\(\Pr(R \mid O )\)</span> is a <em>conditional probability</em>.</p>
<p>We see also that <span class="math inline">\(\Pr(R) = 0.05\)</span> <em>if</em> event <span class="math inline">\(O\)</span> has <em>not</em> occurred; we write <span class="math inline">\(\Pr(R \mid O^c ) = 0.05\)</span>, which we read as ‘The probability that Event <span class="math inline">\(R\)</span> occurs <em>given that</em> Event <span class="math inline">\(O\)</span> has <em>not</em> occurred’.
<span class="math inline">\(\Pr(R \mid O^c )\)</span> is also a <em>conditional probability</em>.</p>
<p>More generally, assume that a sample space <span class="math inline">\(S\)</span> for the <a href="ChapterProbability.html#def:RandomProcess">random process</a> has been constructed, an event <span class="math inline">\(A\)</span> has been identified, and its probability, <span class="math inline">\(\Pr(A)\)</span>, has been determined.
We then receive additional information that some event <span class="math inline">\(B\)</span> has occurred.
Possibly, this new information can change the value of <span class="math inline">\(\Pr(A)\)</span>.</p>
<p>We now need to determine the probability that <span class="math inline">\(A\)</span> will occur, <em>given</em> that we know the information provided by event <span class="math inline">\(B\)</span>.
We call this probability the <em>conditional probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span></em>, denoted by <span class="math inline">\(\Pr(A \mid B)\)</span>.</p>
<div class="example">
<p><span id="exm:ConditionalPrinIntro" class="example"><strong>Example 2.29  (Conditional probability) </strong></span>Suppose I roll a die.
Define event <span class="math inline">\(A\)</span> as ‘rolling a 6’.
Then, you would compute <span class="math inline">\(\Pr(A) = 1/6\)</span> (using the classical approach; Sect. <a href="ChapterProbability.html#ClassicalProb">2.5.1</a>).</p>
<p>However, suppose I provide you with extra information: Event <span class="math inline">\(B\)</span> has already occurred, where Event <span class="math inline">\(B\)</span> is the event ‘the number rolled is even’.</p>
<p>With this extra information, only three numbers could possibly have been rolled; the <em>reduced sample space</em> is
<span class="math display">\[
   S^* = \{2, 4, 6 \}.
\]</span>
All of these three outcomes are equally likely.
However, the probability that the number is a six is now <span class="math inline">\(\Pr(A\mid B) = 1/3\)</span>.</p>
<p>Knowing the extra information in Event <span class="math inline">\(B\)</span> has changed the calculation of <span class="math inline">\(\Pr(A)\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:Planes" class="example"><strong>Example 2.30  (Planes) </strong></span>Consider these two events:
<span class="math display">\[\begin{align*}
   D:&amp;\quad \text{A person dies};\\
   F:&amp;\quad \text{A person falls from an airborne plane with no parachute}.
\end{align*}\]</span>
Consider the probability <span class="math inline">\(\Pr(D \mid F)\)</span>.
If you are told that someone falls out of an airborne plane with no parachute, the probability that they die is very high.</p>
<p>Then, consider the probability <span class="math inline">\(\Pr(F\mid D)\)</span>.
If you are told that some has died, the cause is very unlikely to be a fall from an airborne plane.</p>
<p>Thus, the first probability is very close to one, and the second is very close to zero.</p>
</div>
<p>Two methods exist for computing conditional probability: first principles, or a formal definition of <span class="math inline">\(\Pr(A \mid B)\)</span>.
Using first principles, consider the original sample space <span class="math inline">\(S\)</span>: remove the sample points inconsistent with the new information that <span class="math inline">\(B\)</span> has provided; form a new sample space, say <span class="math inline">\(S^*\)</span>; then recompute the probability of Event <span class="math inline">\(A\)</span> relative to <span class="math inline">\(S^*\)</span>.
<span class="math inline">\(S^*\)</span> is called the <em>reduced sample space</em>.</p>
<p>This method is appropriate when the number of outcomes is relatively small.
The following formal definition applies more generally.</p>
<div class="definition">
<p><span id="def:ConditionalProb" class="definition"><strong>Definition 2.13  (Conditional probability) </strong></span>Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be events in <span class="math inline">\(S\)</span> with <span class="math inline">\(\Pr(B) &gt; 0\)</span>.
Then
<span class="math display">\[
   \Pr(A \mid B) = \frac{\Pr(A\cap B)}{\Pr(B)}.
\]</span></p>
</div>
<p>The definition automatically takes care of the sample space reduction noted earlier.</p>
<div class="example">
<p><span id="exm:RainfallDF" class="example"><strong>Example 2.31  (Rainfall) </strong></span>Consider again the rainfall at Charleville in April (Example <a href="ChapterProbability.html#exm:ChanceRain">2.25</a>).
Define <span class="math inline">\(L\)</span> as the event ‘receiving <em>more than</em> <span class="math inline">\(30\)</span> mm in April’, and <span class="math inline">\(R\)</span> as the event ‘receiving <em>any</em> rainfall in April’.
Event <span class="math inline">\(L\)</span> occurs 24 times in the 81 years of data, while Event <span class="math inline">\(R\)</span> occurs 71 times.</p>
<p>Using the relative frequency approach with the <a href="http://www.bom.gov.au">Bureau of Meteorology</a> data, the probability of obtaining <em>more than</em> <span class="math inline">\(30\)</span> mm in April is:
<span class="math display">\[
   \Pr(L) = \frac{24}{81} = 0.296.
\]</span>
However, the <em>conditional probability</em> of receiving more than <span class="math inline">\(30\)</span> mm, <em>given</em> that some rainfall was recorded, is:
<span class="math display">\[
   \Pr(L \mid  R) = \frac{\Pr(L \cap R)}{\Pr(R)} = \frac{\Pr(L)}{\Pr(R)} = \frac{0.2963}{0.8765} = 0.338.
\]</span>
If we know rain has fallen, the probability that the amount was greater than <span class="math inline">\(30\)</span> mm is 0.338.
Without this prior knowledge, the probability is 0.296.
That is, the probability of rolling a <span class="math inline">\(6\)</span>, <em>given that the rolled number is an even number</em>, is <span class="math inline">\(1/3\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:MumpsIndependence" class="example"><strong>Example 2.32  (Conditional probability) </strong></span><span class="citation">Soud et al. (<a href="references.html#ref-data:Soud2009:Mumps">2009</a>)</span> discusses the response of students to a mumps outbreaks in Kansas in 2006.
Students were asked to isolate; Table <a href="ChapterProbability.html#tab:MumpsIsolation">2.6</a> shows the behaviour of male and female student in the studied sample.</p>
<p>For females, the probability of complying with the isolation request is:
<span class="math display">\[
   \Pr(\text{Compiled} \mid  \text{Females}) = 63/84 = 0.75.
\]</span>
For males, the probability of complying with the isolation request is
<span class="math display">\[
   \Pr(\text{Compiled} \mid  \text{Males}) = 36/48 = 0.75.
\]</span></p>
<p>Whether we look at only females or only males, the probability of selecting a student in the sample that complied with the isolation request is the same: <span class="math inline">\(0.75\)</span>.
Also, the <em>non-conditional</em> probability that a student isolated (ignoring their sex) is:
<span class="math display">\[
   \Pr(\text{Student isolated}) = \frac{99}{132} = 0.75.
\]</span></p>
</div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:MumpsIsolation">TABLE 2.6: </span>Students response to isolation request at a Kansas university.
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;">
</th>
<th style="text-align:center;font-weight: bold;">
Complied with isolation
</th>
<th style="text-align:center;font-weight: bold;">
Did not comply with isolation
</th>
<th style="text-align:center;font-weight: bold;">
TOTAL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Females
</td>
<td style="text-align:center;">
63
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
84
</td>
</tr>
<tr>
<td style="text-align:left;">
Males
</td>
<td style="text-align:center;">
36
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
48
</td>
</tr>
</tbody>
</table></div>
<p></p>
</div>
<div id="GeneralMultiplicationRule" class="section level3" number="2.10.2">
<h3>
<span class="header-section-number">2.10.2</span> General multiplication rule<a class="anchor" aria-label="anchor" href="#GeneralMultiplicationRule"><i class="fas fa-link"></i></a>
</h3>
<p>A consequence of Def. <a href="ChapterProbability.html#def:ConditionalProb">2.13</a> is the following theorem.</p>
<div class="theorem">
<p><span id="thm:GeneralMultRule" class="theorem"><strong>Theorem 2.2  (Multiplication rule for probabilities) </strong></span>For any events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, the probability of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is
<span class="math display">\[\begin{align*}
     \Pr(A\cap B)
     &amp;= \Pr(A) \Pr(B \mid A)\\
     &amp;= \Pr(B) \Pr(A \mid B).
\end{align*}\]</span></p>
</div>
<p>This rule can be generalised to any number of events.
For example, for three events <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span>,
<span class="math display">\[
  \Pr(A\cap B\cap C) = \Pr(A)\Pr(B\mid A)\Pr(C\mid A\cap B).
\]</span></p>
<div class="example">
<p><span id="exm:MultiplicationCustomers" class="example"><strong>Example 2.33  (General multiplication rule) </strong></span>Consider again the probabilities in Example <a href="ChapterProbability.html#exm:TreeSimple">2.28</a>.
We have <span class="math inline">\(\Pr(O) = 0.35\)</span>; then:
<span class="math display">\[\begin{align*}
  \Pr(R \mid O)   &amp;= 0.30\quad\text{and so}\quad \Pr(R^c \mid O) = 0.70;\\
  \Pr(R \mid O^c) &amp;= 0.05\quad\text{and so}\quad \Pr(R^c \mid O^c) = 0.95.
\end{align*}\]</span>
Using the general multiplication rule,
<span class="math display">\[\begin{align*}
  \Pr(R \cap O)       &amp;=   \Pr(R \mid O)     \times \Pr(O)   = 0.30\times 0.35 = 0.105;\\
  \Pr(R^c \cap O)     &amp;=   \Pr(R^c \mid O)   \times \Pr(O)   = 0.70\times 0.35 = 0.245;\\
  \Pr(R \cap O^c)     &amp;=   \Pr(R \mid O^c)   \times \Pr(O^c) = 0.05\times 0.65 = 0.0325;\\
  \Pr(R^c \cap O^c)   &amp;=   \Pr(R^c \mid O^c) \times \Pr(O^c) = 0.95\times 0.65 = 0.6175.
\end{align*}\]</span>
These four probabilities represent the ‘final destinations’ in the tree diagram, which we can now add to (Fig. <a href="ChapterProbability.html#fig:SimpleTree2">2.7</a>).
Notice that these probabilities on the right add to one, as they represent the entire sample space: every customer is represented on one of the four branches.</p>
<p>We can also determine the probability that a customer requests a refund:
<span class="math display">\[
  \Pr(R) = \Pr(R \cap O) + \Pr(R \cap O^c) = 0.105 + 0.0325 = 0.1375.
\]</span>
We can then determine the probability that a customer was an <em>online</em> customer, given that a refund was requested
<span class="math display">\[
  \Pr(O\mid R) = \frac{\Pr(O\cap R)}{\Pr(R)} = \frac{0.105}{0.1375} = 0.7636\dots.
\]</span>
If a refund is requested, the probability the customer was an online shopper is about <span class="math inline">\(0.76\)</span>.</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SimpleTree2"></span>
<img src="02-Probability_files/figure-html/SimpleTree2-1.png" alt="Tree diagram for the customer-satisfaction example, adding the probabilities of the four outcomes." width="75%"><p class="caption">
FIGURE 2.7: Tree diagram for the customer-satisfaction example, adding the probabilities of the four outcomes.
</p>
</div>
<p>The tree diagram in Example <a href="ChapterProbability.html#exm:TreeSimple">2.28</a> is an example of <em>conditional probability</em>: the probability of requesting a refund is <em>conditional on</em> (or <em>depends on</em>) whether the customer made an online or in-store purchase.</p>
</div>
<div id="Independence" class="section level3" number="2.10.3">
<h3>
<span class="header-section-number">2.10.3</span> Independent events<a class="anchor" aria-label="anchor" href="#Independence"><i class="fas fa-link"></i></a>
</h3>
<p>The important idea of <em>independent events</em> can now be defined.</p>
<div class="definition">
<p><span id="def:Independence" class="definition"><strong>Definition 2.14  (Independence) </strong></span>Two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <em>independent events</em> if and only if
<span class="math display">\[
  \Pr(A\cap B) = \Pr(A)\Pr(B).
\]</span>
Otherwise the events <em>not independent</em> (or <em>dependent</em>).</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-4" class="proof"><em>Proof</em>. </span>Exercise.</p>
</div>
<p>Provided <span class="math inline">\(\Pr(B) &gt; 0\)</span>, Defs. <a href="ChapterProbability.html#def:ConditionalProb">2.13</a> and <a href="ChapterProbability.html#def:Independence">2.14</a> show that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent if, and only if, <span class="math inline">\(\Pr(A \mid B) = \Pr(A)\)</span>.
This statement of independence makes sense: <span class="math inline">\(\Pr(A \mid B)\)</span> is the probability of <span class="math inline">\(A\)</span> occurring if <span class="math inline">\(B\)</span> has already occurred, while <span class="math inline">\(\Pr(A)\)</span> is the probability that <span class="math inline">\(A\)</span> occurs without any knowledge of whether <span class="math inline">\(B\)</span> has occurred or not.
If these are equal, then <span class="math inline">\(B\)</span> has occurring has made no difference to the probability that <span class="math inline">\(A\)</span> occurs, which is what <em>independence</em> means.</p>
<div class="example">
<p><span id="exm:unlabeled-div-5" class="example"><strong>Example 2.34  </strong></span>In Example <a href="ChapterProbability.html#exm:MumpsIndependence">2.32</a>, the probability of males isolating was the <em>same</em> as the probability of females isolating.
The sex of the student is <em>independent</em> of whether they isolate.
That is, whether we look at females or males, the probability that they isolated is the same.</p>
</div>
<p>The idea of independence can be generalised to more than two events.
For three events, the following definition of <em>mutual independence</em> applies, which naturally extends to any number of events.</p>
<div class="definition">
<p><span id="def:MutualIndependence" class="definition"><strong>Definition 2.15  (Mutual independence) </strong></span>Three events <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> are <em>mutually independent</em> if, and only if,
<span class="math display">\[\begin{align*}
     \Pr(A\cap B) &amp; = \Pr(A)\Pr(B).\\
     \Pr(A\cap C) &amp; = \Pr(A)\Pr(C).\\
     \Pr(B\cap C) &amp; = \Pr(B)\Pr(C).\\
     \Pr(A\cap B\cap C) &amp; = \Pr(A) \Pr(B) \Pr(C).
     \end{align*}\]</span></p>
</div>
<p>Three events can be <em>pairwise</em> independent in the sense of Def. <a href="ChapterProbability.html#def:Independence">2.14</a>, but not be <em>mutually independent</em>.</p>
<p>The following theorem concerning independent events is sometimes useful.</p>
<div class="theorem">
<p><span id="thm:IndependenceFeatures" class="theorem"><strong>Theorem 2.3  (Independent events) </strong></span>If <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent events, then</p>
<ul>
<li>
<span class="math inline">\(A\)</span> and <span class="math inline">\(B^c\)</span> are independent.</li>
<li>
<span class="math inline">\(A^c\)</span> and <span class="math inline">\(B\)</span> are independent.</li>
<li>
<span class="math inline">\(A^c\)</span> and <span class="math inline">\(B^c\)</span> are independent.</li>
</ul>
</div>
<div class="proof">
<p><span id="unlabeled-div-6" class="proof"><em>Proof</em>. </span>Exercise.</p>
</div>
</div>
<div id="IndependentEvents" class="section level3" number="2.10.4">
<h3>
<span class="header-section-number">2.10.4</span> Independent and mutually exclusive events<a class="anchor" aria-label="anchor" href="#IndependentEvents"><i class="fas fa-link"></i></a>
</h3>
<p>Mutually exclusive evets (Def. <a href="ChapterProbability.html#def:MutuallyExclusive">2.7</a>) and independent events (Def. <a href="ChapterProbability.html#def:Independence">2.14</a>) sometimes get confused.</p>
<p>The simple events defined by the outcomes in a sample space are mutually exclusive, since only one can occur in any realisation of the random process.
Mutually exclusive events have no common outcomes: for example, both passing and failing this course is not possible in the one semester.
Obtaining one excludes the possibility of the other… so <em>whether one occurs depends on whether the other has occurred</em>.</p>
<p>In contrast, if two events are <em>independent</em>, then whether or not one occurs does not affect the chance of the other happening.
If event <span class="math inline">\(A\)</span> can occur, then <span class="math inline">\(B\)</span> happening will not influence the chance of <span class="math inline">\(A\)</span> happening if they are independent, so <em>it does not exclude the possibility of the other occurring</em>.</p>
<p>Confusion between mutual exclusiveness and independence arises sometimes because the sample space is not clearly identified.</p>
<p>Consider a random process involving tossing two coins <em>at the same time</em>.
The sample space is
<span class="math display">\[
   S_2 = \{(HH), (HT), (TH), (TT)\}
\]</span>
and these outcomes are mutually exclusive, each with probability <span class="math inline">\(1/4\)</span> (using the classical approach).
For example, <span class="math inline">\(\Pr\big( (HH) \big) = 1/4\)</span>.</p>
<p>An alternative view of this random process is to think of <em>repeating the process of tossing a coin once</em>.
For one toss of a coin, the sample space
<span class="math display">\[
   S_1 = \{ H, T \}
\]</span>
and <span class="math inline">\(\Pr(H) = 1/2\)</span> is the probability of getting a head on the <em>first</em> toss.
This is also the probability of getting a head on the <em>second</em> toss.</p>
<p>The events ‘getting a head on the first toss’ and ‘getting a head on the second toss’ are <strong>not mutually exclusive</strong>, because both events can occur together: the event <span class="math inline">\((HH)\)</span> is an outcome in <span class="math inline">\(S_2\)</span>.
Whether or not the outcomes <span class="math inline">\((HH)\)</span> occurred <em>simultaneously</em>, because the two coins were tossed at the one time, or <em>sequentially</em>, in that one coin was tossed twice, is irrelevant.</p>
<p>Our interest is in the <em>joint</em> outcomes from two tosses.
The event ‘getting a head on the “first” toss’ is:
<span class="math display">\[
   E_1 = \{ (HH), (HT) \}
\]</span>
and ‘getting a head on the “second” toss’ is
<span class="math display">\[
   E_2 = \{ (HH), (TH) \},
\]</span>
where <span class="math inline">\(E_1\)</span> and <span class="math inline">\(E_2\)</span> are events defined on <span class="math inline">\(S_2\)</span>.
This makes it clear that Events <span class="math inline">\(E_1\)</span> and <span class="math inline">\(E_2\)</span> are not mutually exclusive because <span class="math inline">\(E_1\cap E_2 \ne \varnothing\)</span>.</p>
<p>The two events <span class="math inline">\(E_1\)</span> and <span class="math inline">\(E_2\)</span> are <em>independent</em> because, whether or not a head occurs on one of the tosses, the probability of a head occurring on the other is still <span class="math inline">\(1/2\)</span>.
Seeing that the events are independent provides another way of calculating the probability of the two heads occurring ‘together’: <span class="math inline">\(1/2\times 1/2 = 1/4\)</span>, since the probabilities of <em>independent</em> events can be multiplied</p>
<div class="example">
<p><span id="exm:Mendell" class="example"><strong>Example 2.35  (Mendell's peas) </strong></span><span class="citation">Mendel (<a href="references.html#ref-BIB:Mendel:hybrids">1886</a>)</span> conducted famous experiments in genetics.
In one study, Mendel crossed a pure line of round yellow peas with a pure line of wrinkled green peas.
Table <a href="ChapterProbability.html#tab:PeaTable">2.7</a> shows what happened in the <em>second</em> generation.
For example, <span class="math inline">\(\Pr(\text{round peas}) = 0.7608\)</span>.
Biologically, about <span class="math inline">\(75\)</span>% of peas are expected to be round; the data appear reasonably sound in this respect.</p>
<p>Is the type of pea (rounded or wrinkled) <em>independent</em> of the colour?
That is, if the pea is rounded, does it impact the colour of the pea?</p>
<p>Independence can be evaluated using the formula is <span class="math inline">\(\Pr(\text{round} \mid \text{yellow}) = \Pr(\text{round})\)</span>.
In other words, the fact that the pea is yellow does not affect that probability that the pea is rounded.
From Table <a href="ChapterProbability.html#tab:PeaTable">2.7</a>:
<span class="math display">\[\begin{align*}
   \Pr(\text{rounded})
   &amp;= 0.5665 + 0.1942 = 0.7608,\\
   \Pr(\text{round} \mid \text{yellow})
   &amp;= 0.5665/(0.5665 + 0.1817) = 0.757.
\end{align*}\]</span></p>
<p>These two probabilities are very close.
The data in the table are just a <em>sample</em> (from the population of all peas), so assuming the colour and shape of the peas are independent is reasonable.</p>
</div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:PeaTable">TABLE 2.7: </span>The second generation results from Mendel’s experiment, crossing a pure line of round yellow peas with a pure line of wrinkled green peas.
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;">
</th>
<th style="text-align:right;font-weight: bold;">
Yellow
</th>
<th style="text-align:right;font-weight: bold;">
Green
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rounded
</td>
<td style="text-align:right;">
0.5665
</td>
<td style="text-align:right;">
0.1942
</td>
</tr>
<tr>
<td style="text-align:left;">
Wrinkled
</td>
<td style="text-align:right;">
0.1817
</td>
<td style="text-align:right;">
0.0576
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="SSPartitions" class="section level3" number="2.10.5">
<h3>
<span class="header-section-number">2.10.5</span> Partitioning the sample space<a class="anchor" aria-label="anchor" href="#SSPartitions"><i class="fas fa-link"></i></a>
</h3>
<p>The concepts introduced in this section allow us to determine the probability of an event using the <em>event-partioning approach</em>, which we now discuss.</p>
<div class="definition">
<p><span id="def:Partitioning" class="definition"><strong>Definition 2.16  (Partitioning) </strong></span>The events <span class="math inline">\(B_1, B_2, \ldots , B_k\)</span> are said to represent a <em>partition</em> of the sample space <span class="math inline">\(S\)</span> if</p>
<ol style="list-style-type: decimal">
<li>the events are <em>mutually exclusive</em>: <span class="math inline">\(B_i \cap B_j = \varnothing\)</span> for all <span class="math inline">\(i \neq j\)</span>.</li>
<li>the events are <em>exhaustive</em>: <span class="math inline">\(B_1 \cup B_2 \cup \ldots \cup B_k = S\)</span>.</li>
<li>the events have a non-zero probability of occurring: <span class="math inline">\(\Pr(B_i) &gt; 0\)</span> for all <span class="math inline">\(i\)</span>.</li>
</ol>
</div>
<p>The implication is that when the random process is performed, exactly one and only one of the events <span class="math inline">\(B_i\)</span> (<span class="math inline">\(i = 1, \ldots, k)\)</span> occurs.
We use this concept in the following theorem.</p>
<div class="theorem">
<p><span id="thm:TotalProb" class="theorem"><strong>Theorem 2.4  (Law of total probability) </strong></span>Let <span class="math inline">\(A\)</span> be an event in <span class="math inline">\(S\)</span> and <span class="math inline">\(\{B_1, B_2, \ldots , B_k\}\)</span> a partition of <span class="math inline">\(S\)</span>.
Then
<span class="math display">\[\begin{align*}
   \Pr(A)
   &amp;= \Pr(A \mid B_1) \Pr(B_1) + \Pr(A \mid B_2)\Pr(B_2) + \ldots \\
   &amp; \qquad {} + \Pr(A \mid B_k)\Pr(B_k).
\end{align*}\]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-7" class="proof"><em>Proof</em>. </span>The proof follows from writing <span class="math inline">\(A = (A\cap B_1) \cup (A\cap B_2) \cup \ldots \cup (A\cap B_k)\)</span>, where the events on the RHS are mutually exclusive.
The <a href="ChapterProbability.html#def:ThreeAxioms">third axiom</a> of probability together with the multiplication rule yield the result.</p>
</div>
<div class="example">
<p><span id="exm:TheroemTotalprob" class="example"><strong>Example 2.36  (Law of total probability) </strong></span>Consider event <span class="math inline">\(A\)</span>: ‘rolling an even number on a die’, and also define the events
<span class="math display">\[
   B_i:\quad\text{The number $i$ is rolled on a die}
\]</span>
where <span class="math inline">\(i = 1, 2, \dots 6\)</span>.
The Events <span class="math inline">\(B_i\)</span> represent a <a href="ChapterProbability.html#def:Partitioning"><em>partition</em></a> of the sample space, as the Events <span class="math inline">\(B_i\)</span> are mutually exclusive, exhaustive and all have non-zero probability of occurring.</p>
<p>Then, using the <em>Law of total probability</em> (Sect. <a href="ChapterProbability.html#thm:TotalProb">2.4</a>):
<span class="math display">\[\begin{align*}
   \Pr(A)
   &amp;= \Pr(A \mid B_1)\times \Pr(B_1)\quad +  \quad\Pr(A \mid B_2)\times \Pr(B_2) \quad+ {}\\
   &amp;\quad \Pr(A \mid B_3)\times \Pr(B_3)\quad + \quad\Pr(A\mid B_4)\times \Pr(B_4) \quad+ {} \\
   &amp;\quad \Pr(A \mid B_5)\times \Pr(B_5)\quad +  \quad\Pr(A\mid B_6)\times \Pr(B_6)\\
   &amp;= \left(0\times \frac{1}{6}\right) + \left(1\times \frac{1}{6}\right) + {} \\
   &amp;\quad \left(0\times \frac{1}{6}\right) + \left(1\times \frac{1}{6}\right) + {}\\
   &amp;\quad \left(0\times \frac{1}{6}\right) + \left(1\times \frac{1}{6}\right)
    = \frac{1}{2}.
\end{align*}\]</span>
This the same answer obtained using the classical approach.</p>
</div>
</div>
<div id="BayesTheorem" class="section level3" number="2.10.6">
<h3>
<span class="header-section-number">2.10.6</span> Bayes’ theorem<a class="anchor" aria-label="anchor" href="#BayesTheorem"><i class="fas fa-link"></i></a>
</h3>
<p>If an event is known to have occurred (i.e., has non-zero probability), and the sample space is partitioned, a result known as <em>Bayes’ theorem</em> enables us to determine the probabilities associated with each of the partitioned events.</p>
<div class="theorem">
<p><span id="thm:Bayes" class="theorem"><strong>Theorem 2.5  (Bayes' theorem) </strong></span>Let <span class="math inline">\(A\)</span> be an event in <span class="math inline">\(S\)</span> such that <span class="math inline">\(\Pr(A) &gt; 0\)</span>, and <span class="math inline">\(\{ B_1, B_2, \ldots , B_k\}\)</span> is a <a href="ChapterProbability.html#def:Partitioning">partition</a> of <span class="math inline">\(S\)</span>.
Then
<span class="math display">\[
   \Pr(B_i \mid A) = \frac{\Pr(B_i) \Pr(A \mid B_i)}
                          {\displaystyle \sum_{j = 1}^k \Pr(B_j)\Pr(A \mid B_j)}
\]</span>
for <span class="math inline">\(i = 1, 2, \dots, k\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-8" class="proof"><em>Proof</em>. </span>This is a direct application of Def. <a href="ChapterProbability.html#def:ConditionalProb">2.13</a>, the multiplication rule and Theorem <a href="ChapterProbability.html#thm:TotalProb">2.4</a>.</p>
</div>
<p>Notice that the right-side includes conditional probabilities of the form <span class="math inline">\(\Pr(A\mid B_i)\)</span>, while the left-side contains the probability <span class="math inline">\(\Pr(B_i\mid A)\)</span>.
In effect, the theorem takes a conditional probability and can ‘reverse’ the conditioning.</p>
<p>Bayes’ theorem has many uses, as it uses conditional probabilities that are easy to find or estimate to compute a conditional probability that is <em>not</em> easy to find or estimate.
The theorem is the basis of a branch of statistics known as <em>Bayesian statistics</em> which involves using pre-existing evidence in drawing conclusions from data.</p>
<div class="example">
<p><span id="exm:BreastCancer" class="example"><strong>Example 2.37  (Breast cancer) </strong></span>The success of mammograms for detecting breast cancer has been well documented <span class="citation">(<a href="references.html#ref-white1993mammography">White, Urban, and Taylor 1993</a>)</span>.
Mammograms are generally conducted on women over <span class="math inline">\(40\)</span>, though breast cancer rarely occurs in women under <span class="math inline">\(40\)</span> also.</p>
<p>We can define two events of interest:
<span class="math display">\[\begin{align*}
   C:&amp;\quad \text{The woman has breast cancer; and}\\
   D:&amp;\quad \text{The mammogram returns a positive test result.}
\end{align*}\]</span>
As with any diagnostic tool, a mammogram is not perfect.
<em>Sensitivity</em> and <em>specificity</em> are used to describe the accuracy of a test:</p>
<ul>
<li>
<em>Sensitivity</em> is the probability of a <em>true</em> positive test result: the probability of a positive test result for people <em>with</em> the disease.
This is <span class="math inline">\(\Pr(D \mid C)\)</span>.</li>
<li>
<em>Specificity</em> is the probability of a <em>true</em> negative test result: the probability of a negative test for people <em>without</em> the disease.
This is <span class="math inline">\(\Pr(D^c \mid C^c)\)</span>.</li>
</ul>
<p>Clearly, we would like both these probabilities to be a high as possible.
For mammograms <span class="citation">(<a href="references.html#ref-houssami2003sydney">Houssami et al. 2003</a>)</span>, the <em>sensitivity</em> is estimated as about <span class="math inline">\(0.75\)</span> and the <em>specificity</em> as about <span class="math inline">\(0.90\)</span>.
We can write:</p>
<ul>
<li>
<span class="math inline">\(\Pr(D \mid C ) = 0.75\)</span> (and so <span class="math inline">\(\Pr(D^c \mid C) = 0.25\)</span>);</li>
<li>
<span class="math inline">\(\Pr(D^c \mid C^c) = 0.90\)</span> (and so <span class="math inline">\(\Pr(D \mid C^c) = 0.10\)</span>).</li>
</ul>
<p>Furthermore, about <span class="math inline">\(2\)</span>% of women under <span class="math inline">\(40\)</span> will get breast cancer <span class="citation">(<a href="references.html#ref-houssami2003sydney">Houssami et al. 2003</a>)</span>; that is, <span class="math inline">\(\Pr(C) = 0.02\)</span> (and hence <span class="math inline">\(\Pr(C^c) = 0.98\)</span>).</p>
<p>For this study, the probabilities <span class="math inline">\(\Pr(D\mid C)\)</span> are easy to find: women who are <em>known</em> to have breast cancer have a mammogram, and we record whether the mammogram result is positive or negative.</p>
<p>But consider a woman under <span class="math inline">\(40\)</span> who gets a mammogram.
When the results are returned, her interest is whether they have breast cancer, <em>given</em> the test results; for example <span class="math inline">\(\Pr(C \mid D)\)</span>.
In other words: if the test returns a positive result, what is the probability that she actually has breast cancer?</p>
<p>That is, we would like to take probabilities like <span class="math inline">\(\Pr(D\mid C)\)</span>, that can be found easily, and determine <span class="math inline">\(\Pr(C \mid  D)\)</span>, which is of interest in practice.
Using <a href="ChapterProbability.html#thm:Bayes">Bayes’ Theorem</a>:
<span class="math display">\[\begin{align*}
   \Pr(C \mid D)
   &amp;= \frac{\Pr(C) \times \Pr(D \mid  C)}
            {\Pr(C)\times \Pr(D \mid  C) + \Pr(C^c)\times \Pr(D \mid  C^c) }\\
   &amp;= \frac{0.02 \times 0.75}
            {(0.02\times 0.75) + (0.98\times 0.10)}\\
   &amp;= \frac{0.015}{0.015 + 0.098} =  0.1327.
\end{align*}\]</span>
Consider what this says: Given that a mammogram returns a <em>positive test</em> (for a woman under <span class="math inline">\(40\)</span>), the probability that the woman really has breast cancer is only about <span class="math inline">\(6\)</span>%…
This partly explains why mammograms for women under <span class="math inline">\(40\)</span> are not commonplace: most women who return a positive test result actually do not have breast cancer.</p>
<p>The reason for this surprising result is explained in Example <a href="ChapterProbability.html#exm:BreastCancerTree">2.38</a>.</p>
</div>
<div class="example">
<p><span id="exm:BreastCancerTree" class="example"><strong>Example 2.38  (Breast cancer) </strong></span>Consider using a tree diagram to describe the breast cancer information from Example <a href="ChapterProbability.html#exm:BreastCancer">2.37</a> (Fig. <a href="ChapterProbability.html#fig:BreastTree">2.8</a>).
By following each ‘branch’ of the tree, we can compute, for example:
<span class="math display">\[
   \Pr(C \cap D) = \Pr(C)\times \Pr(D\mid C) = 0.02 \times 0.75 = 0.015;
\]</span>
that is, the probability that a woman has a positive test <strong>and</strong> breast cancer is about <span class="math inline">\(0.015\)</span>.
But compare:
<span class="math display">\[
   \Pr(C^c \cap D) = \Pr(C^c)\times \Pr(D\mid C^c) = 0.98 \times 0.10 = 0.098;
\]</span>
that is, the probability that a woman has a positive test <strong>and no</strong> breast cancer (that is, a <em>false</em> positive) is about <span class="math inline">\(0.098\)</span>.</p>
<p>This explains the surprisingly result in Example <a href="ChapterProbability.html#exm:BreastCancer">2.37</a>: because breast cancer is so uncommon in younger women, the <em>false</em> positives (<span class="math inline">\(0.098\)</span>) overwhelm the <em>true</em> positives (<span class="math inline">\(0.015\)</span>).</p>
<p>After a positive mammogram, further tests are conducted to conform a cancer diagnosis.
In younger women, almost every positive mammogram returns a negative diagnosis from further tests.</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:BreastTree"></span>
<img src="02-Probability_files/figure-html/BreastTree-1.png" alt="Tree diagram for the breast-cancer example." width="67%"><p class="caption">
FIGURE 2.8: Tree diagram for the breast-cancer example.
</p>
</div>
<div class="example">
<p><span id="exm:BreastCancerVenn" class="example"><strong>Example 2.39  (Breast cancer) </strong></span>Consider again the breast cancer data (Example <a href="ChapterProbability.html#exm:BreastCancer">2.37</a>, where the events <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> were defined <a href="ChapterProbability.html#exm:BreastCancer">earlier</a>).
A Venn diagram could be constructed to show the sample space (Fig. <a href="ChapterProbability.html#fig:BreastVenn">2.9</a>).</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:BreastVenn"></span>
<img src="02-Probability_files/figure-html/BreastVenn-1.png" alt="The Venn diagram for the breast cancer example. The rectangle in each panel represents the sample space." width="90%"><p class="caption">
FIGURE 2.9: The Venn diagram for the breast cancer example. The rectangle in each panel represents the sample space.
</p>
</div>
<p></p>
</div>
</div>
<div id="ProbStatisticalComputing" class="section level2" number="2.11">
<h2>
<span class="header-section-number">2.11</span> Statistical computing and simulation<a class="anchor" aria-label="anchor" href="#ProbStatisticalComputing"><i class="fas fa-link"></i></a>
</h2>
<div id="SimulationWhyUse" class="section level3" number="2.11.1">
<h3>
<span class="header-section-number">2.11.1</span> Why use computing and simulation?<a class="anchor" aria-label="anchor" href="#SimulationWhyUse"><i class="fas fa-link"></i></a>
</h3>
<p>Computing and working with probabilities can be hard!
In many cases, using a computer, or a computer <em>simulation</em>, can be helpful.</p>
<div class="definition">
<p><span id="def:Simulation" class="definition"><strong>Definition 2.17  (Simulation) </strong></span>A <em>simulation</em> is when a computer is used to imitate a real situation many times, so that probabilities or outcomes can be <em>estimated</em>.</p>
</div>
<p>Using a computer can be useful for many reasons when working with probabilities and statistics more generally:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Checking answers, intuition and reasoning.</strong>
Simulation can be used to check answers and reasoning.
Analytic solutions can be verified by comparing to simulation results.</li>
<li>
<strong>Demonstration of theory.</strong>
Simulation can be used to visually demonstrate theory (e.g., Sect. <a href="ChapterProbability.html#SimulationTheoryDemo">2.11.3</a>).
Sometimes the theory can be difficult to understand, and a simulation can bridge the gap between formulas and reality.</li>
<li>
<strong>Confirmation and validation of results.</strong>
Simulation can confirm (not <em>prove</em>) counter-intuitive results (such as the Monty Hall problem (Exercise <a href="ChapterProbability.html#exr:SimulationMontyHall">2.39</a>), the birthday paradox (Exercise <a href="ChapterProbability.html#exr:BirthdayProblem">2.23</a>), or non-transitive dice (Exercise <a href="ChapterProbability.html#exr:NonTransitiveDice">2.37</a>).</li>
<li>
<strong>Answering tedious or complex situations.</strong>
Simulation can make tedious, difficult or complex computations easier.
Simulation gives quick approximations that bypass heavy combinatorial formulas.
In some cases, simulation can be used for problems with no closed-form solutions.</li>
<li>
<strong>Performing sensitivity analysis.</strong>
Simulation allows easy tweaking or changing of parameters to see the impacts on the results.</li>
</ol>
<p>An example of each is given below.
The full benefit of simulation may only be apparent once more is learnt about distribution theory as you progress through this book.</p>
<p>Simulation, by definition, imitates a scenario many times.
Each scenario uses a computer to replicate the scenario, using a random number (e.g., a random die roll; a random hand of cards; etc.).
In general, more precise estimates are found using a larger number of replications.</p>
<p>How many simulations are necessary for useful precision?
No single answer exists, but since computers are fast using a large number of replications is not usually a imposition.
For instance, <span class="math inline">\(5\,000\)</span> simulations is a reasonable number for simple scenarios.
The impact of the number of simulations is covered in more detail in Chap. <a href="SamplingDistributions.html#SamplingDistributions">12</a>.</p>
<p>Computers do not produces truly <em>random numbers</em>, but rather <em>pseudo-random numbers</em> that are generated from a random number seed.
The same random number seed produces the same sequence of pseudo-random numbers.
In this book, so that examples are reproducible, we set the <em>random number seed</em> when using <strong>R</strong> (using <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code>), so that our examples are reproducible.
(Nonetheless, we call these ‘random numbers’ with the understanding that they are really pseudo-random numbers…)
The <strong>R</strong> function <code><a href="https://rdrr.io/r/base/lapply.html">replicate()</a></code> allows an <strong>R</strong> expression to be repeated (‘replicated’) a given number of times, and often proves useful for creating simulations.</p>
</div>
<div id="SimulationChecking" class="section level3" number="2.11.2">
<h3>
<span class="header-section-number">2.11.2</span> Simulation to check answers, intuition and reasoning<a class="anchor" aria-label="anchor" href="#SimulationChecking"><i class="fas fa-link"></i></a>
</h3>
<p>Consider drawing five cards at random from a fair pack; what is the probability that at least cards <span class="math inline">\(3\)</span> are hearts?</p>
<p>This question is not too difficult to answer using the counting methods of Sect. <a href="ChapterProbability.html#CombsAndPerms">2.6</a>; you should show that the answer is approximately <span class="math inline">\(0.0927\)</span>.
However, it can be easy to miscount.
We could use an <strong>R</strong> simulation to check the answer.</p>
<p>First, set up the simulation:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 'Make' the deck of cards.</span></span>
<span><span class="co"># Note: the denomination is not important, just the suit</span></span>
<span><span class="va">Deck</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Hearts"</span>, <span class="fl">13</span><span class="op">)</span>,   <span class="co"># 13 cards of each suit</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Diamonds"</span>, <span class="fl">13</span><span class="op">)</span>, </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Clubs"</span>, <span class="fl">13</span><span class="op">)</span>, </span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Spades"</span>, <span class="fl">13</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12043</span><span class="op">)</span>   <span class="co"># For reproducibility </span></span>
<span><span class="va">num_Reps</span> <span class="op">&lt;-</span> <span class="fl">5000</span>  <span class="co"># Number of replications to use</span></span></code></pre></div>
<p>Then we simulate numerous hands of <span class="math inline">\(5\)</span> cards using <code><a href="https://rdrr.io/r/base/lapply.html">replicate()</a></code>.
The first input is the number of replications (i.e., <code>num_Reps</code>) and the second is the command to be replicated (in this case, taking a <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> of <code>size</code> five from the <code>Deck</code> of cards, with <code>replace</code>-ment):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Each replication goes into a column of  Hands</span></span>
<span><span class="va">Hands</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">num_Reps</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">Deck</span>,   <span class="co"># Sample from the  Deck  of cards</span></span>
<span>                                    size <span class="op">=</span> <span class="fl">5</span>,  <span class="co"># A hand of *five* cards </span></span>
<span>                                    replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="op">)</span> <span class="co"># Without replacement</span></span>
<span><span class="va">Hands</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>  <span class="co"># Show the first four columns; each col is a hand of five cards</span></span>
<span><span class="co">#&gt;      [,1]       [,2]       [,3]       [,4]    </span></span>
<span><span class="co">#&gt; [1,] "Clubs"    "Spades"   "Diamonds" "Clubs" </span></span>
<span><span class="co">#&gt; [2,] "Diamonds" "Spades"   "Hearts"   "Hearts"</span></span>
<span><span class="co">#&gt; [3,] "Spades"   "Diamonds" "Diamonds" "Spades"</span></span>
<span><span class="co">#&gt; [4,] "Hearts"   "Diamonds" "Diamonds" "Hearts"</span></span>
<span><span class="co">#&gt; [5,] "Diamonds" "Diamonds" "Clubs"    "Spades"</span></span></code></pre></div>
<p>Then count the number of Hearts in each <code>Hand</code> (i.e., in each column):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For each Hand (i.e., column), count how many  Hearts</span></span>
<span><span class="va">num_Hearts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">Hands</span> <span class="op">==</span> <span class="st">"Hearts"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the count of Hearts in those first four hands:</span></span>
<span><span class="va">num_Hearts</span><span class="op">[</span><span class="fl">1</span> <span class="op">:</span> <span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 0 1 2</span></span></code></pre></div>
<p>Then determine how many of these <code>Hands</code> have at least three hearts:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count how many have *at least 3* hearts</span></span>
<span><span class="va">at_Least_3_Hearts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="va">num_Hearts</span> <span class="op">&gt;=</span> <span class="fl">3</span> <span class="op">)</span>  </span></code></pre></div>
<p>Then fin dthe probability, and print the result:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the *probability* of at least three Hearts</span></span>
<span><span class="va">prob_At_Least_3_Hearts</span> <span class="op">&lt;-</span> <span class="va">at_Least_3_Hearts</span> <span class="op">/</span> <span class="va">num_Reps</span></span>
<span></span>
<span><span class="co"># Print the (rounded) results (where  "\n"  means to start a new line)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"The prob. estimate is"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prob_At_Least_3_Hearts</span><span class="op">)</span>, </span>
<span>           <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span> <span class="co"># Round to four decimal places</span></span>
<span><span class="co">#&gt; The prob. estimate is 0.0978</span></span></code></pre></div>
<p>This is close to what we computed using theory.
A more precise estimate would be found using a larger number of simulations.</p>
</div>
<div id="SimulationTheoryDemo" class="section level3" number="2.11.3">
<h3>
<span class="header-section-number">2.11.3</span> Simulation to demonstrate theory<a class="anchor" aria-label="anchor" href="#SimulationTheoryDemo"><i class="fas fa-link"></i></a>
</h3>
<p>The <em>Weak Law of Large Numbers</em> is an important statistical concept.</p>
<div class="definition">
<p><span id="def:WeakLawLargeNumbers" class="definition"><strong>Definition 2.18  (Weak Law of Large Numbers) </strong></span>The sample proportion of a random outcome converges (in probability) to the true probability as the number of trials increases.</p>
</div>
<p>This can be shown by running a computer simulation, to simulate large numbers of coin tosses.
First, set up the scenario:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">966141</span><span class="op">)</span> <span class="co"># For repeatability</span></span>
<span></span>
<span><span class="co"># Set the number of replications to use</span></span>
<span><span class="va">Num_Tosses</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></code></pre></div>
<p>Then we use the <strong>R</strong> function <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> to take a ‘sample’ of heads and tails (with replacement!) for each replication:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Tosses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"H"</span>, <span class="st">"T"</span><span class="op">)</span>,    <span class="co"># Choose "H"  or  "T"</span></span>
<span>                 size <span class="op">=</span> <span class="va">Num_Tosses</span>,  <span class="co"># Do this for each replication</span></span>
<span>                 replace <span class="op">=</span> <span class="cn">TRUE</span>,     <span class="co"># H and T can be reselected </span></span>
<span>                 prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="co"># Pr(Head) = Pr(Tail) = 0.5</span></span>
<span><span class="va">Tosses</span><span class="op">[</span><span class="fl">1</span> <span class="op">:</span> <span class="fl">10</span><span class="op">]</span>                       <span class="co"># Show the first 10 results</span></span>
<span><span class="co">#&gt;  [1] "H" "T" "T" "H" "H" "H" "T" "T" "H" "H"</span></span></code></pre></div>
<p>Notice that the probability of a Head (and Tail) is set as <span class="math inline">\(0.5\)</span> in the simulation, to simulate tossing a coin.
After each toss, the probability of obtaining a head using all the available information up to that toss was computed:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Toss_Number</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">Num_Tosses</span>            <span class="co"># Sequence: from 1 to Num_Tosses</span></span>
<span></span>
<span><span class="co"># Compute P(Heads) after each toss (cumsum()  is the 'cumulative sum')</span></span>
<span><span class="va">Prop_Heads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">Tosses</span> <span class="op">==</span> <span class="st">"H"</span><span class="op">)</span> <span class="op">/</span> <span class="va">Toss_Number</span></span>
<span><span class="va">Prop_Heads</span><span class="op">[</span><span class="fl">1</span> <span class="op">:</span> <span class="fl">8</span><span class="op">]</span>  <span class="co"># Show the first eight results</span></span>
<span><span class="co">#&gt; [1] 1.0000000 0.5000000 0.3333333 0.5000000</span></span>
<span><span class="co">#&gt; [5] 0.6000000 0.6666667 0.5714286 0.5000000</span></span></code></pre></div>
<p>The results can be plotted (Fig. <a href="ChapterProbability.html#fig:SimTosses">2.10</a>):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Prop_Heads</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"The proportion of heads after a given number of tosses"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Toss number"</span>,          <span class="co"># Label on x-axis</span></span>
<span>     ylab <span class="op">=</span> <span class="st">"Proportion of heads"</span>,  <span class="co"># Label on y-axis</span></span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,       <span class="co"># Show a "l"ine rather than "p"oints</span></span>
<span>     lwd <span class="op">=</span> <span class="fl">2</span>,          <span class="co"># Make line of width '2'</span></span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,   <span class="co"># y-axis limits</span></span>
<span>     las <span class="op">=</span> <span class="fl">1</span>,          <span class="co"># Make axes labels horizontal</span></span>
<span>     col <span class="op">=</span> <span class="st">"cyan4"</span><span class="op">)</span>    <span class="co"># Line colour</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span> h <span class="op">=</span> <span class="fl">0.5</span>,       <span class="co"># Draw horizontal line at y = 0.5</span></span>
<span>        col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span>  <span class="co"># Make line grey in colour</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SimTosses"></span>
<img src="02-Probability_files/figure-html/SimTosses-1.png" alt="A simulation of tossing a fair coin $500$ times. The probability of getting a head is computed from the data after each toss. The grey horizontal line is at $0.5$." width="100%"><p class="caption">
FIGURE 2.10: A simulation of tossing a fair coin <span class="math inline">\(500\)</span> times. The probability of getting a head is computed from the data after each toss. The grey horizontal line is at <span class="math inline">\(0.5\)</span>.
</p>
</div>
<p>For one such simulation, these running probabilities are shown in Fig. <a href="ChapterProbability.html#fig:SimTosses">2.10</a>.
While the result of any single toss is unpredictable, we see the <em>Weak Law of Large Numbers</em> in action: the sample proportion of heads approaches <span class="math inline">\(0.5\)</span> as the number of tosses increases.</p>
<p>Using the empirical approach shows why probabilities are between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> (inclusive), since the proportions <span class="math inline">\(m/n\)</span> are always between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> (inclusive).
In this case, the sample proportion of heads converges (in probability) to the true probability of a head <span class="math inline">\(p = 0.5\)</span> as the number of trials increases.</p>
</div>
<div id="SimulationConfirmation" class="section level3" number="2.11.4">
<h3>
<span class="header-section-number">2.11.4</span> Simulation to confirm and validate results<a class="anchor" aria-label="anchor" href="#SimulationConfirmation"><i class="fas fa-link"></i></a>
</h3>
<p>Consider the breast cancer example (Example <a href="ChapterProbability.html#exm:BreastCancer">2.37</a>), where we saw that the probability of having breast cancer after a positive test results is quite low.
This result is surprising, so we could use a computer to confirm that this is correct.</p>
<p>Step 1 is to set up the scenario, by setting the random number seed (for reproducibility) and defining some parameters:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">population_Size</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">cancer_Prob</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span></span>
<span><span class="co"># Test sensitivity and specificity </span></span>
<span><span class="va">correct_Positive</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></span>
<span><span class="va">correct_Negative</span> <span class="op">&lt;-</span> <span class="fl">0.90</span></span></code></pre></div>
<p>Now we apply a useful ‘trick’, by first allocating each patient a random number between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Allocate a random number between 0 and 1 to each patient</span></span>
<span><span class="va">patient_Probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span> <span class="va">population_Size</span><span class="op">)</span></span>
<span><span class="va">patient_Probs</span><span class="op">[</span><span class="fl">1</span> <span class="op">:</span> <span class="fl">8</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.8604976 0.8495931 0.8000998 0.6782192</span></span>
<span><span class="co">#&gt; [5] 0.2884367 0.5052399 0.2357213 0.5244750</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> command produces random numbers between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> for each person in the population.
Each time <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> is run, different random numbers are allocated to each person in the population.</p>
<p>Now, a number less than <span class="math inline">\(0.02\)</span> is equivalent to saying the patient has cancer (the given probability is <span class="math inline">\(2\)</span>%).
This is the same as saying about <span class="math inline">\(0.02\)</span> of people will have cancer in the population.
This is like flipping a biased coin for each patient, where the chance of landing on ‘cancer’ is <span class="math inline">\(2\)</span>%.</p>
<p>Now we can obtain a list of whether each person has cancer or not.
Each time <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> is run, different people, and a different <em>number</em> of people in the population, with cancer can vary:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cancer_Result</span> <span class="op">&lt;-</span> <span class="va">patient_Probs</span> <span class="op">&lt;</span> <span class="va">cancer_Prob</span></span>
<span><span class="va">cancer_Result</span><span class="op">[</span><span class="fl">1</span> <span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">#&gt;  [8] FALSE FALSE FALSE</span></span></code></pre></div>
<p>Then, split the population into those <em>with</em> cancer and those <em>without</em> cancer:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Now find those *with* cancer who return a positive result</span></span>
<span><span class="va">with_Cancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span> <span class="va">cancer_Result</span><span class="op">)</span> <span class="co"># Indices of people *with* cancer</span></span>
<span><span class="va">no_Cancer</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="op">!</span><span class="va">cancer_Result</span><span class="op">)</span> <span class="co"># Indices of people *without* cancer</span></span></code></pre></div>
<p>The test sensitivity and specificity now can be applied (using the same trick as above):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Patients WITH cancer: 75% chance the test is positive</span></span>
<span><span class="va">with_Cancer_and_Positive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">with_Cancer</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">correct_Positive</span></span>
<span></span>
<span><span class="co"># Patients WITHOUT cancer: 10% chance the test is (wrongly) positive</span></span>
<span><span class="va">no_Cancer_and_Positive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">no_Cancer</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">correct_Negative</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine results</span></span>
<span><span class="va">positive_Test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="va">with_Cancer</span><span class="op">[</span><span class="va">with_Cancer_and_Positive</span><span class="op">]</span>,</span>
<span>  <span class="va">no_Cancer</span><span class="op">[</span><span class="va">no_Cancer_and_Positive</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Again, each time that <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> is run, different people, and a different <em>number</em> of people in the population, can return positive test results:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># True positives among those who tested positive</span></span>
<span><span class="va">true_positives</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cancer_Result</span><span class="op">[</span><span class="va">positive_Test</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Total positives</span></span>
<span><span class="va">total_positives</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">positive_Test</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimated Prob(cancer | positive test)</span></span>
<span><span class="va">cancer_Given_Pos</span> <span class="op">&lt;-</span> </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">total_positives</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">true_positives</span> <span class="op">/</span> <span class="va">total_positives</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="cn">NA</span></span>
<span>  <span class="op">}</span></span>
<span><span class="va">cancer_Given_Pos</span></span>
<span><span class="co">#&gt; [1] 0.1351119</span></span></code></pre></div>
<p>Now print some useful information:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Prob (cancer | positive test) :"</span>, <span class="va">cancer_Given_Pos</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Prob (cancer | positive test) : 0.1351119</span></span></code></pre></div>
<p>The above code has three places where random numbers are used:</p>
<ul>
<li>to randomly allocate people to have cancer or not;</li>
<li>to randomly determine which people <em>with</em> cancer return a positive result; and</li>
<li>to randomly determine which people <em>without</em> cancer return a positive result.</li>
</ul>
<p>Thus, each time the above code is run will produce different results (unless the random-number seed remains the same).</p>
<p>A <em>simulation</em> repeats the above scenario many times, over many replications each with different random numbers used.
Then, the probability of interest (here, the probability of having cancer, given a positive test result) can be averaged over the many replications.
To do this (for <span class="math inline">\(5\,000\)</span> replications), the above code is repeated and the result of interest is retained from each replication (in <code>cancer_Given_Pos</code>):</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the parameters for the scenario</span></span>
<span><span class="va">num_Reps</span> <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># The number of replications</span></span>
<span><span class="va">population_Size</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">cancer_Prob</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span></span>
<span><span class="co"># Set the test sensitivity and specificity </span></span>
<span><span class="va">correct_Positive</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></span>
<span><span class="va">correct_Negative</span> <span class="op">&lt;-</span> <span class="fl">0.90</span></span>
<span></span>
<span><span class="co"># Create an array to hold the info we need from each replication</span></span>
<span><span class="va">cancer_Given_Pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span> dim <span class="op">=</span> <span class="va">num_Reps</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now replicate the scenario  num_Reps  times:</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_Reps</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Allocate a random number between 0 and 1 to each patient</span></span>
<span>  <span class="va">patient_Probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span> <span class="va">population_Size</span><span class="op">)</span></span>
<span>  <span class="va">cancer_Result</span> <span class="op">&lt;-</span> <span class="op">(</span> <span class="va">patient_Probs</span> <span class="op">&lt;</span> <span class="va">cancer_Prob</span> <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Now find those *with* and *without* cancer who return a positive result</span></span>
<span>  <span class="va">with_Cancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span> <span class="va">cancer_Result</span><span class="op">)</span> <span class="co"># Indices of people *with* cancer</span></span>
<span>  <span class="va">no_Cancer</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="op">!</span><span class="va">cancer_Result</span><span class="op">)</span> <span class="co"># Indices of people *without* cancer</span></span>
<span>  </span>
<span>  <span class="co"># Patients WITH cancer: 75% chance the test is positive</span></span>
<span>  <span class="va">with_Cancer_and_Positive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">with_Cancer</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">correct_Positive</span></span>
<span>  </span>
<span>  <span class="co"># Patients WITHOUT cancer: 10% chance the test is (wrongly) positive</span></span>
<span>  <span class="va">no_Cancer_and_Positive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">no_Cancer</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">correct_Negative</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Combine results</span></span>
<span>  <span class="va">positive_Test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="va">with_Cancer</span><span class="op">[</span><span class="va">with_Cancer_and_Positive</span><span class="op">]</span>,</span>
<span>    <span class="va">no_Cancer</span><span class="op">[</span><span class="va">no_Cancer_and_Positive</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># True positives among those who tested positive</span></span>
<span>  <span class="va">true_positives</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cancer_Result</span><span class="op">[</span><span class="va">positive_Test</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Total positives</span></span>
<span>  <span class="va">total_positives</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">positive_Test</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Estimated Prob(cancer | positive test)</span></span>
<span>  <span class="va">cancer_Given_Pos</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span> <span class="va">total_positives</span> <span class="op">&gt;</span> <span class="fl">0</span>, </span>
<span>                                 <span class="va">true_positives</span> <span class="op">/</span> <span class="va">total_positives</span>, <span class="co"># If  TRUE</span></span>
<span>                                 <span class="cn">NA</span><span class="op">)</span>                               <span class="co"># If  FALSE</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Average over the replications</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cancer_Given_Pos</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1328058</span></span></code></pre></div>
<p>In Example <a href="ChapterProbability.html#exm:BreastCancer">2.37</a>, the probability was given as <span class="math inline">\(0.1327\)</span>, which compares favourably with this answer from simulation (which is an approximation).</p>
</div>
<div id="SimulationComplex" class="section level3" number="2.11.5">
<h3>
<span class="header-section-number">2.11.5</span> Simulation to answers tedious or complex situations<a class="anchor" aria-label="anchor" href="#SimulationComplex"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose <span class="math inline">\(10\)</span> people are invited to a party, and sit at a round table; however, two people (say, Anh and Barb) refuse to sit next to each other.
What is the probability that a random seating arrangement satisfies this constraint?</p>
<p>This is difficult (but not impossible) to compute exactly: the number of circular permutations need to be counted, while excluding adjacent pairs.
Simulation, however, could be used.
The strategy is:</p>
<ul>
<li>Set up the simulation.</li>
<li>Repeat this numerous times:
<ul>
<li>Create a random permutation of the seating arrangements for <span class="math inline">\(10\)</span> people.</li>
<li>Check if Anh and Barb are ‘neighbours’ for this arrangement.</li>
</ul>
</li>
<li>Print the result.</li>
</ul>
<p>The process is repeated for numerous randomly-generated seating arrangements, and the proportion of acceptable seating arrangements computed.</p>
<p>First, set up the scenario:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">8723</span><span class="op">)</span> <span class="co"># Set the random number seed, for reproducibility</span></span>
<span></span>
<span><span class="va">num_Reps</span> <span class="op">&lt;-</span> <span class="fl">5000</span>  <span class="co"># Set the number of simulations</span></span>
<span></span>
<span><span class="co"># 'Name' the 10 people by using the 'initials' of the ten people</span></span>
<span><span class="va">People</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="co"># The first 10 capital letters</span></span>
<span><span class="va">People</span></span>
<span><span class="co">#&gt;  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"</span></span></code></pre></div>
<p>Then, we create an <strong>R</strong> function to determine if Anh (who is <code>A</code>) and Barb (who is <code>B</code>) are next to each other:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The function takes a seating arrangement as input.</span></span>
<span><span class="co"># It checks, for any given seating arrangement, if Anh and Barb are neighbours.</span></span>
<span></span>
<span><span class="va">check_If_Neighbours</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Arrangement</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Arrangement</span><span class="op">)</span>  <span class="co"># n  is the length of the arrangement (so, n = 10)</span></span>
<span>  </span>
<span>  <span class="co"># We must allow for circular adjacency: first and last are also neighbours.</span></span>
<span>  <span class="co"># So, we add the person in the first position to the end as well:</span></span>
<span>  <span class="va">extended_Arrangement</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Arrangement</span>, </span>
<span>                            <span class="va">Arrangement</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">are_Neighbours</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span> </span>
<span>  <span class="co"># Assume not neighbours, unless we find them adjacent.</span></span>
<span>  <span class="co"># TRUE means they *ARE* neighbours; FALSE means they *ARE NOT* neighbours.</span></span>
<span>  </span>
<span>  <span class="co"># Loop over the  n  people, and check their neighbour to the right.</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Check if Anh and Barb  are neighbours</span></span>
<span>    <span class="co"># First: check if A, then B to he right:</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">extended_Arrangement</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"A"</span> <span class="op">&amp;&amp;</span>  </span>
<span>        <span class="va">extended_Arrangement</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="st">"B"</span><span class="op">)</span> <span class="va">are_Neighbours</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span>    <span class="co"># Then: check if B, then A to he right:</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">extended_Arrangement</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"B"</span> <span class="op">&amp;&amp;</span></span>
<span>        <span class="va">extended_Arrangement</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span> <span class="va">are_Neighbours</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># Return the value of are_Neighbours, to state whether the given arrangement</span></span>
<span>  <span class="co"># has  A  and  B  as nighbours (TRUE) or not (FALSE):</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">are_Neighbours</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To replicate this numerous times, the <strong>R</strong> function <code><a href="https://rdrr.io/r/base/lapply.html">replicate()</a></code> is used; it repeatedly evaluates given <strong>R</strong> code a specified number of times.
In this case:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run simulation</span></span>
<span><span class="co"># Summing works, because  TRUE  is treated as 1, FALSE  is treated as 0</span></span>
<span><span class="va">seated_Together</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">num_Reps</span>, </span>
<span>                                  <span class="fu">check_If_Neighbours</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">People</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co"># sample(People) makes a random arrangement of the 10 people</span></span></code></pre></div>
<p>The command first creates a random arrangement of poeple (i.e., <code>sample(People)</code>), and then checks if the given permutation of people has Anh and Barb seated as neighbours (using our function <code>check_If_Neighbours()</code>).
This is replicated <code>num_Reps</code> times (using <code><a href="https://rdrr.io/r/base/lapply.html">replicate()</a></code>), and adds up (using <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>) how many times they are seated together.
Then, the result can be printed:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimated probability</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="va">seated_Together</span> <span class="op">/</span> <span class="va">num_Reps</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Prob. of an UNacceptable seating arrangement: approx. "</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span> <span class="co"># Round to four decimal places</span></span>
<span><span class="co">#&gt; Prob. of an UNacceptable seating arrangement: approx.  0.216</span></span></code></pre></div>
</div>
<div id="SimulationSensitivityAnalysis" class="section level3" number="2.11.6">
<h3>
<span class="header-section-number">2.11.6</span> Simulation for sensitivity analysis<a class="anchor" aria-label="anchor" href="#SimulationSensitivityAnalysis"><i class="fas fa-link"></i></a>
</h3>
<p><em>Sensitivity analysis</em> refers to the process of checking how (and by how much) the results of a problem or model change when the inputs or assumptions are adjusted: how <em>sensitive</em> the results are to those inputs.</p>
<p>Suppose a doctor schedules <span class="math inline">\(20\)</span> patients per day, but history shows that each patient has a chance of not showing up (a ‘no-show’).
For simplicity, assume that each patient has the same ‘no-show’ probability, and that patients operate independently.
If more than <span class="math inline">\(15\)</span> patients show up on any one day, the clinic runs late.
What is the probability the clinic runs late?
(In a later chapter, a theoretical approach will be introduced to answering this type of question; Sect. <a href="DiscreteDistributions.html#BinomialDistribution">7.4</a>).</p>
<p>For this scenario, the probability that each patients is a no-show could be varied (e.g., <span class="math inline">\(10\)</span>%; <span class="math inline">\(15\)</span>%; <span class="math inline">\(20\)</span>%), to see the impact this has on the probability that the clinic runs late.</p>
<p>First, set up the scenario:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">8091</span><span class="op">)</span> <span class="co"># For reproducibility</span></span>
<span></span>
<span><span class="va">num_Reps</span> <span class="op">&lt;-</span> <span class="fl">50000</span>     <span class="co"># Number of replications (i.e., simulated days)</span></span>
<span><span class="va">daily_Patients</span> <span class="op">&lt;-</span> <span class="fl">20</span>  <span class="co"># Number of patients per day</span></span></code></pre></div>
<p>Then we create an <strong>R</strong> function to simulate what happens on a day, for any given no-show probability:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an R function to simulate what happens on a day</span></span>
<span><span class="va">simulate_Day</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">no_Show_Prob</span> <span class="op">=</span> <span class="fl">0.15</span>,  <span class="co"># No-show probability</span></span>
<span>                         <span class="va">num_Patients</span> <span class="op">=</span> <span class="fl">20</span>,    <span class="co"># Number of patients per day</span></span>
<span>                         <span class="va">patient_Limit</span> <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">{</span> <span class="co"># More than this many: clinic late</span></span>
<span>  </span>
<span>  <span class="co"># Allocate a random number between 0 and 1 to each patient</span></span>
<span>  <span class="va">patient_Probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span> <span class="va">num_Patients</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># sum()  works, because  TRUE = 1,  and  FALSE = 0</span></span>
<span>  <span class="va">number_No_Shows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="va">patient_Probs</span> <span class="op">&lt;</span> <span class="va">no_Show_Prob</span> <span class="op">)</span></span>
<span></span>
<span>  <span class="va">running_Late</span> <span class="op">&lt;-</span> <span class="op">(</span> <span class="op">(</span><span class="va">num_Patients</span> <span class="op">-</span> <span class="va">number_No_Shows</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">patient_Limit</span><span class="op">)</span> </span>
<span>  <span class="co"># TRUE  means clinic will run late.  FALSE  means clinic will NOT run late</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">running_Late</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Then run the simulation for the various no-show probabilities:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Declare the no-show probabilities to use</span></span>
<span><span class="va">no_Show_Probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.15</span>,</span>
<span>                     by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find the mean of the TRUE and FALSE values returned.</span></span>
<span><span class="co"># This works because  R  treats TRUE as 1, FALSE as 0</span></span>
<span><span class="va">prob_Day_Is_Late</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">no_Show_Probs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">no_Show_Probs</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span><span class="op">{</span> <span class="co"># For each probability:</span></span>
<span>  <span class="va">num_Days_Run_Late</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">num_Reps</span>, </span>
<span>                                     <span class="fu">simulate_Day</span><span class="op">(</span><span class="va">no_Show_Probs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">prob_Day_Is_Late</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">num_Days_Run_Late</span> <span class="op">/</span> <span class="va">num_Reps</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The results then can be printed (and plotted; see Fig. <a href="ChapterProbability.html#fig:probLate">2.11</a>):</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_Day_Is_Late</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1.0000 1.0000 0.9999 0.9998 0.9989 0.9974</span></span>
<span><span class="co">#&gt;  [7] 0.9945 0.9891 0.9821 0.9706 0.9567 0.9385</span></span>
<span><span class="co">#&gt; [13] 0.9180 0.8916 0.8595 0.8307</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">prob_Day_Is_Late</span> <span class="op">~</span> <span class="va">no_Show_Probs</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"b"</span>,     <span class="co"># Plot "both" lines and points</span></span>
<span>     las <span class="op">=</span> <span class="fl">1</span>,        <span class="co"># Make axis labels horizontal</span></span>
<span>     lwd <span class="op">=</span> <span class="fl">2</span>,        <span class="co"># Line width of 2</span></span>
<span>     col <span class="op">=</span> <span class="st">"cyan4"</span>,  <span class="co"># Set colour</span></span>
<span>     xlab <span class="op">=</span> <span class="st">"Probability that a patient is a no-show"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Probability that clinic runs late"</span><span class="op">)</span></span></code></pre></div>
<p>Clearly, the greater the no-show probability, the smaller the chance of running late (as expected).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:probLate"></span>
<img src="02-Probability_files/figure-html/probLate-1.png" alt="A simulations that shows the probability that a day at a medical clinic runs late." width="80%"><p class="caption">
FIGURE 2.11: A simulations that shows the probability that a day at a medical clinic runs late.
</p>
</div>
<p>We could also change the number of patients scheduled each day to see what the impact is (e.g., <span class="math inline">\(18\)</span> or<br><span class="math inline">\(22\)</span> patients).</p>
</div>
</div>
<div id="ProbabilityExercises" class="section level2" number="2.12">
<h2>
<span class="header-section-number">2.12</span> Exercises<a class="anchor" aria-label="anchor" href="#ProbabilityExercises"><i class="fas fa-link"></i></a>
</h2>
<p>Selected answers appear in Sect. <a href="selected-solutions.html#AnswersChapProbability">E.2</a>.</p>
<div class="exercise">
<p><span id="exr:BasicProbs" class="exercise"><strong>Exercise 2.1  </strong></span>Suppose <span class="math inline">\(\Pr(A) = 0.53\)</span>, <span class="math inline">\(\Pr(B) = 0.24\)</span> and <span class="math inline">\(\Pr(A\cap B) = 0.11\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Display the situation using a Venn diagram, tree diagram and a table.
Which is easier in this situation?</li>
<li>Find <span class="math inline">\(\Pr(A\cup B)\)</span>.</li>
<li>Find <span class="math inline">\(\Pr(A^c\cap B)\)</span>.</li>
<li>Find <span class="math inline">\(\Pr(A^c \cup B^c)\)</span>.</li>
<li>Find <span class="math inline">\(\Pr(A \mid B)\)</span>.</li>
<li>Are events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> independent?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:DrawNumbers" class="exercise"><strong>Exercise 2.2  </strong></span>Suppose a box contains <span class="math inline">\(100\)</span> tickets numbered from <span class="math inline">\(1\)</span> to <span class="math inline">\(100\)</span> inclusive.
Four tickets are drawn from the box one at a time (without replacement).
Find the probability that:</p>
<ol style="list-style-type: decimal">
<li>all four numbers drawn are <em>odd</em>.</li>
<li>exactly two odd numbers are drawn.</li>
<li>
<em>at least</em> two odd numbers are drawn before drawing the first even number.</li>
<li>the <em>sum</em> of the numbers drawn is odd.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:GreenLights" class="exercise"><strong>Exercise 2.3  </strong></span>A courier company is interested in the length of time a certain set of traffic lights is green.
The lights are set so that the time between green lights in any one direction is between <span class="math inline">\(15\)</span> and <span class="math inline">\(150\)</span> seconds.
An employee observes the lights and record the length of time between consecutive green lights.</p>
<ol style="list-style-type: decimal">
<li>What is the random variable?</li>
<li>What is the sample space?</li>
<li>Can the classical approach to probability be used to determine the probability that the time between green lights is less than <span class="math inline">\(90\)</span> seconds?
Why or why not?</li>
<li>Can the relative frequency approach be used to determine the same probability?
If so, how? If not, why not?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:Cricket" class="exercise"><strong>Exercise 2.4  </strong></span>Suppose a touring cricket squad consist of fifteen players, from which a team of eleven must be chosen for each game.
Suppose a squad consists of seven batters, five bowlers, two all-rounders and one wicketkeeper.</p>
<ol style="list-style-type: decimal">
<li>Find the number of teams possible if the <em>playing team</em> consists of five batters, four bowlers, one all-rounder and one wicketkeeper.</li>
<li>After a game, each member of one playing team shakes hands with each member of the opposing playing team, and each member of both playing teams shakes hands with the two umpires.
How many handshakes are there in total at the conclusion of a game?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:HatData" class="exercise"><strong>Exercise 2.5  </strong></span>Researchers <span class="citation">(<a href="references.html#ref-data:Dexter2019:SunProtection">Dexter et al. 2019</a>)</span> observed the behaviour of pedestrians in Brisbane, Queensland, around midday in summer.
The researchers found the probability of wearing a hat was <span class="math inline">\(0.025\)</span> for males, and <span class="math inline">\(0.060\)</span> for females.
Using this information:</p>
<ol style="list-style-type: decimal">
<li>Construct a tree diagram for the sample space.</li>
<li>Construct a table of the sample space.</li>
<li>Construct the Venn diagram of the sample space.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:CarPassengers" class="exercise"><strong>Exercise 2.6  </strong></span>A family with six non-driving children, and two driving parents has an eight-seater vehicle.</p>
<ol style="list-style-type: decimal">
<li>In how many ways can the family be seated in the car (and legally go driving)?</li>
<li>Suppose one of the children obtains their driving licence.
In how many ways can the family be seated in the car (and legally go driving) now?</li>
<li>Two of the children needs car seats, and there are two car seats fixed in the vehicle (i.e., they cannot be moved to different seats).
If the two parents are the only drivers, in how many ways can the family be seated in the car (and legally go driving) now?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:Monopoly" class="exercise"><strong>Exercise 2.7  </strong></span>A group of four people sit down to play Monopoly.
The eight tokens are distributed randomly.
In how many ways can this be done?</p>
</div>
<div class="exercise">
<p><span id="exr:PassWords" class="exercise"><strong>Exercise 2.8  </strong></span>A company password policy is that users must select an eight-letter password comprising lower-case letters.
The company is considering each of the following changes separately:</p>
<ol style="list-style-type: decimal">
<li>Suppose the policy changes to allow eight-, nine-, or ten-letter passwords of just lower-case letters.
How many passwords are possible now?</li>
<li>Suppose the policy changes to allow eight-letter passwords comprising lower-case and upper-case letters letters.
How many passwords are possible now?</li>
<li>Suppose the policy changes to allow eight-letter passwords comprising lower-case, upper-case letters letters and the ten digits <span class="math inline">\(0\)</span> to <span class="math inline">\(9\)</span>.
How many passwords are possible now?</li>
<li>Suppose the policy changes to allow eight-letter passwords comprising lower-case, upper-case letters letters and the ten digits <span class="math inline">\(0\)</span> to <span class="math inline">\(9\)</span>, and each password must have one of each category.
How many passwords are possible now?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:MatchingBrackets" class="exercise"><strong>Exercise 2.9  </strong></span>Many document processors help users match brackets.
Bracket matching is an interesting mathematical problem!
For instance, the string <code>(())</code> is syntactically valid, whereas <code>())(</code> is not, even though both contain two opening and two closing brackets.</p>
<ol style="list-style-type: decimal">
<li>List all the ways in which two opening and two closing brackets can be written in a way that is syntactically valid.</li>
<li>How many ways can three opening and three closing brackets be written in a way that is syntactically valid?
List these.</li>
<li>In general, the number of ways that <span class="math inline">\(n\)</span> opening and <span class="math inline">\(n\)</span> closing brackets can be written that is syntactically valid is given by the <em>Catalan numbers</em> <span class="math inline">\(C_n\)</span>, where:
<span class="math display">\[
C_{n}
=
{\frac {1}{n + 1}}\binom{2n}{n}.
\]</span>
Show that an equivalent expression for <span class="math inline">\(C_n\)</span> is <span class="math inline">\(\displaystyle C_n = {\frac {(2n)!}{(n + 1)!\,n!}}\)</span>.</li>
<li>Show that another equivalent expression for <span class="math inline">\(C_n\)</span> is <span class="math inline">\(\displaystyle \binom{2n}{n} - \binom{2n}{n + 1}\)</span> for <span class="math inline">\(n\geq 0\)</span>.</li>
<li>Find the first nine Catalan numbers, starting with <span class="math inline">\(C_0\)</span>.
<!-- Also see: https://brilliant.org/wiki/catalan-numbers/ -->
</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:Stirling" class="exercise"><strong>Exercise 2.10  </strong></span><em>Stirling’s approximation</em> is
<span class="math display">\[
   n!\approx {\sqrt {2\pi n}}\left({\frac {n}{e}}\right)^{n}.
\]</span></p>
<ol style="list-style-type: decimal">
<li>Compare the values of the actual factorials with the Stirling approximation values for <span class="math inline">\(n = 1, \dots, 10\)</span>.
(Use technology!)</li>
<li>Plot the <em>relative error</em> in Stirling’s approximation for <span class="math inline">\(n = 1, \dots, 10\)</span>.
(Again, use technology!)</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:DiceGame" class="exercise"><strong>Exercise 2.11  </strong></span>In a two-person game, a fair die is thrown in turn by each player.
The first player to roll a <img src="Dice/die5.png" width="10"> wins.</p>
<ol style="list-style-type: decimal">
<li>Find the probability that the first player to throw the die wins.</li>
<li>Suppose the player to throw first is selected by the toss of a fair coin.
Show that each player has an equal chance of winning.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:RandomisedResponse" class="exercise"><strong>Exercise 2.12  </strong></span>To get honest answers to sensitive questions, sometimes the <em>randomised response technique</em> is used.
For example, suppose the aim is to discover the proportion of students who have used illegal drugs in the past twelve months.</p>
<p><span class="math inline">\(N\)</span> cards are prepared, where <span class="math inline">\(m\)</span> have the statement ‘I <em>have</em> used an illegal drug in the past twelve months’.
The remaining <span class="math inline">\(N - m\)</span> cards have the statement ‘I <em>have not</em> used an illegal drug in the past twelve months’.</p>
<p>Each student in the sample then selects one card at random from the prepared pile of <span class="math inline">\(N\)</span> cards, and answers ‘True’ or ‘False’ when asked the question ‘Is the statement on the selected card true or false?’ without divulging which statement is on the card.
Since the interviewer does not know which card has been presented, the interviewer does not know if the person has used drugs or not from this answer.</p>
<p>Let <span class="math inline">\(T\)</span> be the probability that a student answers ‘True’, and <span class="math inline">\(p\)</span> be the probability that a student chosen at random has used an illegal drug.
Assume that each student answers the question on the chosen card truthfully.</p>
<ol style="list-style-type: decimal">
<li>From an understanding of the problem, show that
<span class="math display">\[
  T = (1 - p) + \frac{m}{N}(2p - 1).
\]</span>
</li>
<li>Find an expression for <span class="math inline">\(p\)</span> in terms of <span class="math inline">\(T\)</span>, <span class="math inline">\(m\)</span> and <span class="math inline">\(N\)</span> by rearranging the previous expression.</li>
<li>Explain what happens for <span class="math inline">\(m = 0\)</span>, <span class="math inline">\(m = N\)</span> and <span class="math inline">\(m = N/2\)</span>, and why these make sense <em>in the context of the question</em>.</li>
<li>Suppose that, in a sample of 400 students, 175 answer ‘True’.
Estimate <span class="math inline">\(p\)</span> from the expression found above, given that <span class="math inline">\(N = 100\)</span> and <span class="math inline">\(m = 25\)</span>.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:MCExam" class="exercise"><strong>Exercise 2.13  </strong></span>A multiple choice question contains <span class="math inline">\(m\)</span> possible choices.
There is a probability of <span class="math inline">\(p\)</span> that a candidate chosen at random will know the correct answer.
If a candidate does not know the answer, the candidate guesses and is equally likely to select any of the <span class="math inline">\(m\)</span> choices.</p>
<p>For a randomly selected candidate, what is the probability of the question being answered correctly?</p>
</div>
<div class="exercise">
<p><span id="exr:EPL" class="exercise"><strong>Exercise 2.14  </strong></span>In the 2019/2020 English Premier League (EPL), at full-time the home team had won <span class="math inline">\(91\)</span> out of <span class="math inline">\(208\)</span> games, the away team won <span class="math inline">\(67\)</span>, and <span class="math inline">\(50\)</span> games were drawn.
(Data from: <a href="https://sports-statistics.com/sports-data/soccer-datasets/" class="uri">https://sports-statistics.com/sports-data/soccer-datasets/</a>)</p>
<p>Define <span class="math inline">\(W\)</span> as a win, and <span class="math inline">\(D\)</span> as a draw.</p>
<ol style="list-style-type: decimal">
<li>Explain the difference between <span class="math inline">\(\Pr(W)\)</span> and <span class="math inline">\(\Pr(W \mid D^c)\)</span>.</li>
<li>Compute both probabilities, and comment.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:TwoPointsInSquare" class="exercise"><strong>Exercise 2.15  </strong></span>Consider a square of size <span class="math inline">\(1\times 1\)</span> metre.
A random process consists of selecting two points at random in the square.</p>
<ol style="list-style-type: decimal">
<li>What is the sample space for the distance between the two points?</li>
<li>Suppose a grid (lines parallel to the sides) is drawn on the square such that grid lines are equally spaced <span class="math inline">\(25\)</span> cm apart.
Two points are chosen again, but must be on the intersection of the grid lines.
Write some <strong>R</strong> code to generate the sample space for the distance between the two points.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:LocalNewsletter" class="exercise"><strong>Exercise 2.16  </strong></span>Suppose that <span class="math inline">\(30\)</span>% of the residents of a certain suburb subscribe to a local newsletter.
In addition, <span class="math inline">\(8\)</span>% of residents belong to a local online group.</p>
<ol style="list-style-type: decimal">
<li>What percentage of residents <em>could</em> belong to both?
Give a range of possible values.</li>
<li>Suppose <span class="math inline">\(6\)</span>% belong to both.
Compute:
<ol style="list-style-type: lower-alpha">
<li>The probability than a random chosen newsletter subscriber is also a member of the online group.</li>
<li>The probability than a random chosen online member is also a subscriber to the newsletter.</li>
</ol>
</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:SchoolKids" class="exercise"><strong>Exercise 2.17  </strong></span>The data in Table <a href="ChapterProbability.html#tab:EdTable">2.8</a> tabulates information about school children in Queensland in 2019 <span class="citation">(<a href="references.html#ref-mypaper:Dunn:GLM-IEE">Dunn 2023</a>)</span>.</p>
<ol style="list-style-type: decimal">
<li>What is the probability that a randomly chosen student is a First Nations student?</li>
<li>What is the probability that a randomly chosen student is in a government school?</li>
<li>Is the sex of the student approximately independent of whether the student is a First Nations student, for students in government schools?</li>
<li>Is the sex of the student approximately independent of whether the student is a First Nations student, for students in non-government schools?</li>
<li>Is whether the student is a First Nations student approximately independent of the type of school, for female students?</li>
<li>Is whether the student is a First Nations student approximately independent of the type of school, for male students?</li>
<li>Based on the above, what can you conclude from the data?</li>
</ol>
</div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:EdTable">TABLE 2.8: </span>The number of First Nations and non-First Nations students in various Queensland schools in 2019.
</caption>
<thead><tr>
<th style="text-align:left;font-weight: bold;">
</th>
<th style="text-align:right;font-weight: bold;">
Number First Nations students
</th>
<th style="text-align:right;font-weight: bold;">
Number non-First Nations students
</th>
</tr></thead>
<tbody>
<tr grouplength="2">
<td colspan="3" style="border-bottom: 1px solid;">
<em>Government schools</em>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Females
</td>
<td style="text-align:right;">
2540
</td>
<td style="text-align:right;">
21219
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Males
</td>
<td style="text-align:right;">
2734
</td>
<td style="text-align:right;">
22574
</td>
</tr>
<tr grouplength="2">
<td colspan="3" style="border-bottom: 1px solid;">
<em>Non-government schools</em>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Females
</td>
<td style="text-align:right;">
391
</td>
<td style="text-align:right;">
9496
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Males
</td>
<td style="text-align:right;">
362
</td>
<td style="text-align:right;">
9963
</td>
</tr>
</tbody>
</table></div>
<div class="exercise">
<p><span id="exr:CardsAces" class="exercise"><strong>Exercise 2.18  </strong></span>Two cards are randomly drawn (without replacement) from a <span class="math inline">\(52\)</span>-card pack.</p>
<ol style="list-style-type: decimal">
<li>What is the probability the second card is an <strong>Ace</strong>?</li>
<li>What is the probability that the first card is lower in rank (<strong>Ace</strong> low) than the second?</li>
<li>What is the probability that the card ranks are in consecutive order where <strong>Ace</strong> is low <em>or</em> high and order is irrelevant (e.g., (Jack, Queen), (Queen, Jack), (Ace, Two) or (kKng, Ace))?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:Octaves" class="exercise"><strong>Exercise 2.19  </strong></span>An octave contains <span class="math inline">\(12\)</span> distinct notes: seven white keys and 5 black keys on a piano.</p>
<ol style="list-style-type: decimal">
<li>How many different eight-note sequences within a single octave can be played using the white keys only?</li>
<li>How many different eight-note sequences within a single octave can be played if the white and black keys alternate (starting with either colour)?</li>
<li>How many different eight-note sequences within a single octave can be played if the white and black keys alternate and no key is played more than once?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:SomeProb" class="exercise"><strong>Exercise 2.20  </strong></span>Find <span class="math inline">\(\Pr(A\cap B)\)</span> if <span class="math inline">\(\Pr(A) = 0.2\)</span>, <span class="math inline">\(\Pr(B) = 0.4\)</span>, and <span class="math inline">\(\Pr(A\mid B) + \Pr(B \mid A) = 0.375\)</span>.</p>
</div>
<div class="exercise">
<p><span id="exr:SolvePermk" class="exercise"><strong>Exercise 2.21  </strong></span>Solve <span class="math inline">\(12\times P^7_k = 7\times P^6_{k + 1}\)</span> using:</p>
<ol style="list-style-type: decimal">
<li>algebra; and then</li>
<li>using <strong>R</strong> to search over all possible values of <span class="math inline">\(k\)</span>.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:SolvePermk2" class="exercise"><strong>Exercise 2.22  </strong></span>Solve <span class="math inline">\(P^7_{r + 1} = 10 {C^7_r}\)</span> for <span class="math inline">\(r\)</span>.</p>
</div>
<div class="exercise">
<p><span id="exr:BirthdayProblem" class="exercise"><strong>Exercise 2.23  </strong></span></p>
<ol style="list-style-type: decimal">
<li>Take a guess: how many randomly-selected individuals would you need so that the probability that <em>at least two</em> have the same birthday would exceed <span class="math inline">\(50\)</span>%?</li>
<li>Show that the probability that, for a group of <span class="math inline">\(N\)</span> randomly selected individuals, <em>at least two</em> have the same birthday (assuming <span class="math inline">\(365\)</span> days in a year) can be written as
<span class="math display">\[
  1 - \left(\frac{365}{365}\right) \times \left(\frac{364}{365}\right) \times \left(\frac{363}{365}\right) \times \dots\times \left(\frac{365 - n + 1}{365}\right).
\]</span>
</li>
<li>Graph the relationship for various values of <span class="math inline">\(N\)</span>, using the above form to compute the probability.</li>
<li>What assumptions are necessary?
Are these reasonable?</li>
<li>Use computer simulation to confirm these results.</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:SixNumbersConsecutive" class="exercise"><strong>Exercise 2.24  </strong></span>Six numbers are randomly selected <em>without replacement</em> from the numbers <span class="math inline">\(1, 2, 3,\dots, 45\)</span>.
Model this process using <strong>R</strong> to estimate the probability that there are <em>no consecutive numbers</em> amongst the numbers selected.
(That is, no sequence like <code>4, 5</code> or <code>33, 34</code> or <code>21, 22, 23</code> appears, once the numbers are sorted smallest to largest.)</p>
</div>
<div class="exercise">
<p><span id="exr:TwoEventsOverline" class="exercise"><strong>Exercise 2.25  </strong></span>Suppose the events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> have probabilities <span class="math inline">\(\Pr(A) = 0.4\)</span> and <span class="math inline">\(\Pr(B) = 0.3\)</span>, and <span class="math inline">\(\Pr(A\cup B) = 0.5\)</span>.
Determine <span class="math inline">\(\Pr( A^c \cap B^c)\)</span>.
Are <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> independent events?</p>
</div>
<div class="exercise">
<p><span id="exr:TwoEventsAbsorption" class="exercise"><strong>Exercise 2.26  </strong></span>For sets <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, show that:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(A\cup (A\cap B) = A\)</span>;</li>
<li>
<span class="math inline">\(A\cap (A\cup B) = A\)</span>.</li>
</ol>
<p>These are called the <em>absorption laws</em>.</p>
</div>
<div class="exercise">
<p><span id="exr:NewCars" class="exercise"><strong>Exercise 2.27  </strong></span>A new cars can be purchased with options:</p>
<ul>
<li>Seven different paints colours are available;</li>
<li>Three different trim levels are available;</li>
<li>Cars can be purchased with or without a sunroof.</li>
</ul>
<p>How many possible combinations are possible?</p>
</div>
<div class="exercise">
<p><span id="exr:NumberPlates" class="exercise"><strong>Exercise 2.28  </strong></span>Suppose number plates have three numbers, followed by two letters then another number.
How many number plates are possible with this scheme?</p>
</div>
<div class="exercise">
<p><span id="exr:PairsPoker" class="exercise"><strong>Exercise 2.29  </strong></span>In some forms of poker, five cards are dealt to each player, and certain combinations then beat other combinations.</p>
<ol style="list-style-type: decimal">
<li>What is the probability that the initial five cards include <em>exactly</em> one pair.
(This implies <em>not</em> getting a three of a kind or four of a kind.)
Explain your reasoning.</li>
<li>What is the probability that the initial five cards includes <em>only</em> picture cards (Ace, King, Queen, Jack)?</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-9" class="exercise"><strong>Exercise 2.30  </strong></span>Prove that <span class="math inline">\(P^n_n = P^n_{n-1}\)</span>.</p>
</div>
<div class="exercise">
<p><span id="exr:NoTechP" class="exercise"><strong>Exercise 2.31  </strong></span>Without using any technology, compute the value of <span class="math inline">\(\displaystyle \frac{C^{25}_8}{C^{25}_6}\)</span>.</p>
</div>
<div class="exercise">
<p><span id="exr:ComplexNumbers" class="exercise"><strong>Exercise 2.32  </strong></span>Use set notation to show the relationship between the complex numbers <span class="math inline">\(\mathbb{C}\)</span> and <span class="math inline">\(\mathbb{R}\)</span>.</p>
</div>
<div class="exercise">
<p><span id="exr:ProbHarder" class="exercise"><strong>Exercise 2.33  </strong></span></p>
<ol style="list-style-type: decimal">
<li>If <span class="math inline">\(A_1, A_2, \dots, A_n\)</span> are independent events, prove that
<span class="math display">\[
\Pr(A_1 \cup A_2 \cup \dots \cup A_n) = 1 - [1 - \Pr(A_1)][1 - \Pr(A_2)] \dots [1 - \Pr(A_n)].
\]</span>
</li>
<li>Consider two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> such that <span class="math inline">\(\Pr(A) = r\)</span> and <span class="math inline">\(\Pr(B) = s\)</span> with <span class="math inline">\(r, s &gt; 0\)</span> and <span class="math inline">\(r + s &gt; 1\)</span>.
Prove that
<span class="math display">\[
   \Pr(A \mid B) \ge 1 - \left(\frac{1 - r}{s} \right).
\]</span>
</li>
</ol>
</div>
<div class="exercise">
<p><span id="exr:AngleInSquare" class="exercise"><strong>Exercise 2.34  </strong></span>Consider the diagram in Fig. <a href="ChapterProbability.html#fig:AngleInSquare">2.12</a>.
The point <span class="math inline">\(P\)</span> is randomly placed within the <span class="math inline">\(1\times 1\)</span> square <span class="math inline">\(ABCD\)</span>.
What is the probability that the angle <span class="math inline">\(APB\)</span> is <em>greater</em> than <span class="math inline">\(90^\circ\)</span>?</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:AngleInSquare"></span>
<img src="02-Probability_files/figure-html/AngleInSquare-1.png" alt="Point $P$ is placed randomly in the $1\times 1$ square $ABCD$." width="30%"><p class="caption">
FIGURE 2.12: Point <span class="math inline">\(P\)</span> is placed randomly in the <span class="math inline">\(1\times 1\)</span> square <span class="math inline">\(ABCD\)</span>.
</p>
</div>
<div class="exercise">
<p><span id="exr:SquareInCircle" class="exercise"><strong>Exercise 2.35  </strong></span>Consider the diagram in Fig. <a href="ChapterProbability.html#fig:SquareInCircle">2.13</a>.
What is the probability that a point randomly placed within the circle (with radius <span class="math inline">\(r = 1\)</span>) also lands within the square?</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:SquareInCircle"></span>
<img src="02-Probability_files/figure-html/SquareInCircle-1.png" alt="A random point is placed within the circle with centre\ $C$ and radius $r = 1$." width="30%"><p class="caption">
FIGURE 2.13: A random point is placed within the circle with centre <span class="math inline">\(C\)</span> and radius <span class="math inline">\(r = 1\)</span>.
</p>
</div>
<div class="exercise">
<p><span id="exr:Locks" class="exercise"><strong>Exercise 2.36  </strong></span>A combination lock work by setting (for example) four digits to numbers in a specified order.
Suggest a more accurate name for a ‘<em>combination</em> lock’.</p>
</div>
<div class="exercise">
<p><span id="exr:NonTransitiveDice" class="exercise"><strong>Exercise 2.37  </strong></span>Consider the following dice:</p>
<ul>
<li>Die A: The six sides are labelled: </li>
<li>Die B: The six sides are labelled: </li>
<li>Die C: The six sides are labelled: </li>
</ul>
<p>These dice are <em>non-transitive</em> (Miwin’s dice); that is, in the long run, Die A beats Die B, Die B beats Die C… but Die C also beats Die A.</p>
<p>Use a computer simulation to confirm these results by ‘rolling’ them many times, and find the probabilities of each die winning against the other two.</p>
</div>
<div class="exercise">
<p><span id="exr:SimulationSensivityNumber" class="exercise"><strong>Exercise 2.38  </strong></span>Adjust the <strong>R</strong> code used in Sect. <a href="ChapterProbability.html#SimulationSensitivityAnalysis">2.11.6</a> so examine how the probability of running late changes as the number of booked patients increases from <span class="math inline">\(15\)</span> up to <span class="math inline">\(25\)</span> people.</p>
</div>
<div class="exercise">
<p><span id="exr:SimulationMontyHall" class="exercise"><strong>Exercise 2.39  </strong></span>A game show contestant is told there is a car behind one of three doors, and a goat behind each of the other doors.
The contestant is asked to select a door.</p>
<p>The host of the show (who knows where the car is) now opens one of the doors <em>not</em> selected by the contestant, and reveals a goat.
The host now gives the contestant the choice of either (a) retaining the door chosen first, or (b) switching and choosing the other (unopened) door.</p>
<ol style="list-style-type: decimal">
<li>Which of the following <em>do you think</em> is the contestant’s best strategy?</li>
<li>Always retain the first choice.</li>
<li>Always change and select the other door.</li>
<li>Choose either unopened door at random.</li>
<li>Use a computer simulation to estimate the probabilities to determine the best strategy.
<em>Hint:</em> remember the crucial information: the host of the show knows where the car is, and opens one of the doors <em>not</em> selected by the contestant, <em>and reveals a goat</em>.</li>
</ol>
</div>

</div>
</div>
<hr>
<div class="footer"><span style="color: gray; font-size:0.7em">Peter K. Dunn, 2024: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></span></div>
  <div class="chapter-nav">
<div class="prev"><a href="ChapterSetTheory.html"><span class="header-section-number">1</span> Essentials of set theory</a></div>
<div class="next"><a href="DistributionRandomVariables.html"><span class="header-section-number">3</span> Random variables and their distributions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ChapterProbability"><span class="header-section-number">2</span> Probability</a></li>
<li><a class="nav-link" href="#IntroductionToProbability"><span class="header-section-number">2.1</span> Introduction</a></li>
<li><a class="nav-link" href="#SampleSpaces"><span class="header-section-number">2.2</span> Sample spaces</a></li>
<li>
<a class="nav-link" href="#Events"><span class="header-section-number">2.3</span> Events</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#SimpleEvents"><span class="header-section-number">2.3.1</span> Simple events</a></li>
<li><a class="nav-link" href="#CompoundEvents"><span class="header-section-number">2.3.2</span> Compound events</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#Probability"><span class="header-section-number">2.4</span> Probablility</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ProbabilityDefinition"><span class="header-section-number">2.4.1</span> Definitions</a></li>
<li><a class="nav-link" href="#ProbabilityAxioms"><span class="header-section-number">2.4.2</span> Three axioms of probability</a></li>
<li><a class="nav-link" href="#ProbabilityRules"><span class="header-section-number">2.4.3</span> Rules of probability</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#AssignProbDiscrete"><span class="header-section-number">2.5</span> Assigning probabilities: discrete samples spaces</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ClassicalProb"><span class="header-section-number">2.5.1</span> Classical probability</a></li>
<li><a class="nav-link" href="#EmpiricalApproach"><span class="header-section-number">2.5.2</span> Relative frequency (empirical) approach</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#CombsAndPerms"><span class="header-section-number">2.6</span> Counting elements: combinatorics</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#MultiplicationRule"><span class="header-section-number">2.6.1</span> Basic ideas: multiplication rule</a></li>
<li><a class="nav-link" href="#PermutationSelectWithoutReplacement"><span class="header-section-number">2.6.2</span> Permutations</a></li>
<li><a class="nav-link" href="#Combinations"><span class="header-section-number">2.6.3</span> Combinations</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#AssignProbContinuous"><span class="header-section-number">2.7</span> Assigning probabilities: continuous sample spaces</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#AllocatingProbabilitiesContinuous"><span class="header-section-number">2.7.1</span> Allocating probabilities</a></li>
<li><a class="nav-link" href="#PDFs"><span class="header-section-number">2.7.2</span> Probability density functions</a></li>
</ul>
</li>
<li><a class="nav-link" href="#SubjectiveApproach"><span class="header-section-number">2.8</span> Assigning probability: subjective approach</a></li>
<li>
<a class="nav-link" href="#DiagramsForProbability"><span class="header-section-number">2.9</span> Using diagrams to visualise outcomes</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#VennDiagrams"><span class="header-section-number">2.9.1</span> Venn diagrams</a></li>
<li><a class="nav-link" href="#Tables"><span class="header-section-number">2.9.2</span> Tables of probability</a></li>
<li><a class="nav-link" href="#TreeDiagrams"><span class="header-section-number">2.9.3</span> Tree diagrams</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#CondProbIndependence"><span class="header-section-number">2.10</span> Conditional probability and independent events</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#CondProb"><span class="header-section-number">2.10.1</span> Conditional probability</a></li>
<li><a class="nav-link" href="#GeneralMultiplicationRule"><span class="header-section-number">2.10.2</span> General multiplication rule</a></li>
<li><a class="nav-link" href="#Independence"><span class="header-section-number">2.10.3</span> Independent events</a></li>
<li><a class="nav-link" href="#IndependentEvents"><span class="header-section-number">2.10.4</span> Independent and mutually exclusive events</a></li>
<li><a class="nav-link" href="#SSPartitions"><span class="header-section-number">2.10.5</span> Partitioning the sample space</a></li>
<li><a class="nav-link" href="#BayesTheorem"><span class="header-section-number">2.10.6</span> Bayes’ theorem</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ProbStatisticalComputing"><span class="header-section-number">2.11</span> Statistical computing and simulation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#SimulationWhyUse"><span class="header-section-number">2.11.1</span> Why use computing and simulation?</a></li>
<li><a class="nav-link" href="#SimulationChecking"><span class="header-section-number">2.11.2</span> Simulation to check answers, intuition and reasoning</a></li>
<li><a class="nav-link" href="#SimulationTheoryDemo"><span class="header-section-number">2.11.3</span> Simulation to demonstrate theory</a></li>
<li><a class="nav-link" href="#SimulationConfirmation"><span class="header-section-number">2.11.4</span> Simulation to confirm and validate results</a></li>
<li><a class="nav-link" href="#SimulationComplex"><span class="header-section-number">2.11.5</span> Simulation to answers tedious or complex situations</a></li>
<li><a class="nav-link" href="#SimulationSensitivityAnalysis"><span class="header-section-number">2.11.6</span> Simulation for sensitivity analysis</a></li>
</ul>
</li>
<li><a class="nav-link" href="#ProbabilityExercises"><span class="header-section-number">2.12</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PeterKDunn/DistTheory/blob/main/02-Probability.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PeterKDunn/DistTheory/edit/main/02-Probability.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Theory of Statistical Distributions</strong>" was written by Peter K. Dunn. It was last built on Last updated: 2025-12-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
