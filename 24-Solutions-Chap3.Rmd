## Answers for Chap. 3


:::{.answer}
**Answer for Exercise \@ref(exr:C3ContA).**

1. $k = -2$.
2. See Fig. \@ref(fig:PDFY).
3. $\text{E}(Y) = 5/3$.
4. $\text{E}(Y^2) = 17/6$, so $\text{var(Y)} = 17/6 - (5/3)^2 = 1/18$.
5. $\Pr(X > 1.5) = \int_{1.5}^2 f_Y(y)\, dy = 3/4$.

```{r, PDFY, echo=FALSE, fig.align="center", fig.cap="The pdf for Y", out.width='70%'}
xx <- seq(0, 3, 
          length = 500)
fy <- function(x){
  y <- 2*x - 2
  y <- ifelse(x < 1, 0, y)
  y <- ifelse( x > 2, 0, y)
  y
}

plot(x = xx,
     y = fy(xx),
     lwd = 2,
     type = "l",
     las = 1,
     main = expression("PDF for"~italic(Y)),
     xlab = expression(italic(Y)),
     ylab = "Prob. fn")
```

:::


:::{.answer}
**Answer to Exercise \@ref(exr:C3DiscreteA).**

$k = 1/4$.

1. $\text{E}(D) = 7/4 = 1.75$; $\text{E}(D^2) = 15/4$ so $\text{var}(D) = 11/16 = 0.6875$.
1. $M_D(t) = \exp(t)/2 + \exp(2t)/4 + \exp(3t)/4$.
:::


:::{answer}
**Answer for Exercise \@ref(exr:YouFriendInLine2).**

Using the pmf from Exercise \@ref(exr:YouFriendInLine):

\[
   \text{E}(X) = 
   \left(0\times\frac{4}{10}\right) + 
   \left(1\times\frac{3}{10}\right) + 
   \left(2\times\frac{2}{10}\right) + 
   \left(3\times\frac{1}{10}\right) = 1.
\]
In **R**:
```{r echo=TRUE}
set.seed(777023)

dist <- array(NA, dim = 1000)
for (i in (1:1000)){
  positions <- sample(1:5, 
                      size = 2, 
                      replace = FALSE)
  dist[i] = abs(diff(positions)) - 1
}
mean(dist)
```
:::



:::{.answer}
**Answer to Exercise \@ref(exr:C3DiscreteB).**

1. $M_Z'(t) = 0.6\exp(t)[0.3\exp(t) + 0.7]$ so $\text{E}(Z) = 0.6$.
Also, $M''_Z(t) = 0.18\exp(2t) + 0.6\exp(t)[0.3\exp(t) + 0.7]$ so $\text{E}(Z^2) = 0.78$, so $\text{var}(Z) = 0.42$ (be careful with the derivatives here!)
2. Expand the quadratic and find: $\Pr(Z = 0) = 0.49$, $\Pr(Z = 1) = 0.42$, $\Pr(Z = 2) = 0.09$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:C3MGFA).**

1. $M'_G(t) = \alpha\beta(1 - \beta t)^{-\alpha - 1}$ so $\text{E}(G) = \alpha\beta$.
   $M''_G(t) = \alpha\beta^2(\alpha + 1)(1 - \beta t)^{-\alpha - 2}$ so $\text{E}(G^2) = \alpha\beta^2(\alpha + 1)$ and $\text{var}(G) = \alpha\beta^2$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:C3Moments).**

1. \[ 
\mu'_r = \text{E}(X^r) = \int_{x = 0}^1 x^r 2(1 - x)\, dx = 2\left[ \left(\frac{x^{r + 1}}{r + 1} - \frac{x^{r + 2}}{r + 2}\right)\Big|_{0}^{1}\right] = 2\left[ \frac{1}{r + 1} - \frac{1}{r + 2}\right]
\].
1. Expanding, $\text{E}((X + 3)^2) = \text{E}(X^2) + 6\text{E}(X) + 9$.
   Now, $\text{E}(X) = \mu'_1 = 1/3$ from above, and $\text{E}(X^2) = \mu'_2 = 1/6$ from above.
   Hence $\text{E}((X + 3)^2) = 67/6$.
1. $\text{var}(X) = \text{E}(X^2) - \text{E}(X)^2 = 1/18$.
:::



:::{.answer}
**Answer to Exercise \@ref(exr:C3NoMean).**

1. $\text{E}(Y) = \int_2^\infty y\frac{2}{y}\,dy = 2\log y\Big|_2^\infty$, which does not converge.
1. If $\text{E}(Y)$ is not defined, that $\text{var}(Y)$ cannot be defined either.
1. See Fig. \@ref(fig:NoMeanPlots), left panel.
1. $F_Y(y) = \int_2^y 2/t^2\, dt = 1 - (2/y)$; see Fig. \@ref(fig:NoMeanPlots), right panel.
1. $F_Y(y) = 0.5$ gives the median as 4.
1. $F_Y(y) = 1/4$ gives $Q_1 = 8/3$; $F_Y(y) = 3/4$ gives $Q_3 = 8$; so IQR is $8 - 8/3 = 16/3$.
1. $\Pr(Y > 4\mid Y > 3) = \Pr(Y > 4)/\Pr(Y > 3)$.
   Then, $\Pr(Y > 4) = 1 - \Pr(Y < 4) = 1/2$ using the df;
   and   $\Pr(Y > 3) = 1 - \Pr(Y < 3) = 2/3$ using the df;
   so the answer is 3/4. 
:::

```{r NoMeanPlots, echo=FALSE, fig.align="center", fig.cap="The probability and distribution functions for a distribution with no mean", out.width='80%', fig.width=7, fig.height=3}
y <- seq(0, 5, 
         length = 200)
ypdf <- function(x){
  ifelse(y > 2, 
         2/y^2,
         0)
}
ycdf <- function(x){
  ifelse(y > 2, 
         1 - 2/y,
         0)
}

par( mfrow = c(1, 2))

plot( ypdf(y) ~ y,
      las = 1,
      lwd = 2,
      type = "l",
      xlab = expression(italic(y)), 
      ylab = "Prob. fn.",
      main = "Probability function")

y <- seq(0, 10, 
         length = 200)

plot( ycdf(y) ~ y,
      las = 1,
      lwd = 2,
      ylim = c(0, 1),
      type = "l",
      xlab = expression(italic(y)) ,
      ylab = "Dist. fn.",
      main = "Distribution  function")

```


:::{.answer}
**Answer to Exercise \@ref(exr:C3Cauchy).**

1. See Fig. \@ref(fig:Cauchy) (left panel).
1. Evaluate $F_X(t) = \displaystyle \int_{-\infty}^t \frac{1}{\pi(1 + x^2)}\,dx = \frac{1}{\pi}\arctan(x) + \frac{1}{2}$.
   See Fig. \@ref(fig:Cauchy) (right panel).
1. $\displaystyle \text{E}(X) =  \int_{-\infty}^t \frac{x}{\pi(1 + x^2)}\,dx = ...$, which is not defined.
:::

```{r Cauchy, echo=FALSE, fig.align="center", fig.cap="The Cauchy distribution", fig.height=4, fig.width=7,out.width='70%'}
par( mfrow = c(1, 2))
x <- seq(-5, 5,
         length = 100)
y <- 1 / (pi * (1 + x^2))
plot(y ~ x,
     lwd = 2,
     las = 1,
     type = "l",
     main = "Density function for\nthe Cauchy distribution",
     xlab = expression(italic(X)),
     ylab = "Density function")

Y <- atan(x)/pi + 0.5
plot(Y ~ x,
     lwd = 2,
     las = 1,
     ylim = c(0, 1),
     type = "l",
     main = "Distribution function for\nthe Cauchy distribution",
     xlab = expression(italic(X)),
     ylab = "Distribution function")
```



:::{.answer}
**Answer to Exercise \@ref(exr:SkewDiscreteCentralMomentsZero).**

Begin with Definition \@ref(def:MGF) for $M_X(t)$ and use fact that if a distribution is symmetric about 0 then $f_X(x) = f_X(-x)$ using symmetry. 
Transform the resulting integral.
:::



:::{.answer}
**Answer to Exercise \@ref(exr:TriangularHospitalExp).**

First, the pdf needs to be defined (see Fig. \@ref(fig:WaitingTimes)), and define $W$ as the waiting time.
Let $H$ be the 'height' of the triangle.
The area of triangle $A_1$ is $3H/4$, and the area of triangle $A_2$ is $51H/4$, so the value of $H$ is $2/27$.

The two lines, $L_1$ and $L_2$ can be found (find the slope; determine the linear equation) so that:

\[
   f_W(w) =
   \begin{cases}
      4w/81 - 14/81       & \text{for $3.5 < w < 5$};\\
      -4w/1377 + 122/1377 & \text{for $5 \le w < 30.5$}.
   \end{cases}
\]

1. $\text{E}(W)$ can be computed as usual across the two parts of the pdf: $\text{E}(W) = \frac{1}{4} + \frac{51}{4} = 13$ minutes.
1. $\text{E}(W^2)$ can be computed in two parts also: $\text{E}(W^2) = \frac{163}{144} + \frac{29\,699}{144} = 16598/8$.
   Hence $\text{var}(Y) = (1659/8) - 13^2 = 307/8\approx 38.375$, so the *standard deviation* is $\sqrt{38.375} = 6.19$  minutes.
:::


```{r WaitingTimes, echo=FALSE, fig.width=9, out.width='100%',fig.align="center", fig.cap="Waiting times"}
flo <- function(x){
  (4/81) * x - (14/81)
}
fhi <- function(x){
  (-4/1377) * x + (122/1377)
}

ff <- function(x){
  y <- array( 0, 
              dim = length(x))
  
  lo <- (x <= 3.5)
  hi <- (x >= 30.5)
  midlo <- (x > 3.5) & (x < 5)
  midhi <- (x >= 5)  & (x < 30.5)
  
  y[midlo] <- flo( x[midlo] )
  y[midhi] <- fhi( x[midhi] )
  y
}

y <- seq(0, 35,
         length = 500)

plot(ff(y) ~ y, 
     type="l",
     las = 1,
     lwd = 2,
     xlab = expression(italic(W)),
     ylab = "Prob. fn.",
     ylim = c(0, 0.095) )


polygon( x = c(3.5, 5, 5, 3.5),
         y = c(0, 2/27, 0, 0),
         col = grey(0.7))
polygon( x = c(5, 5, 30.5, 5),
         y = c(0, 2/27, 0, 0),
         col = grey(0.8))

ylo <- seq(0, 7, 
           length = 100)
lines(flo(ylo) ~ ylo,
      lty = 2,
      col = "grey",
      lwd = 2)

yhi <- seq(3, 30.5, 
           length = 100)
lines(fhi(yhi) ~ yhi,
      lty = 2,
      col = "grey",
      lwd = 2)

lines(ff(y) ~ y, 
     lwd = 2)


abline(v = c(3.5, 5, 30.5),
        lty = 2, 
        col = "grey")
abline(h = 2/27,
       lty = 2,
       col = "grey")
points(x = 5,
       y = 2/27,
       pch = 19)

text( 4.25, 0.007,
      labels = expression(italic(A)[1]))
text( 15, 0.02,
      labels = expression(italic(A)[2]))

text(15, fhi(15),
     pos = 3,
     labels = expression(italic(L)[2]))
text(5.5, fhi(5.5),
     pos = 3,
     labels = expression(italic(L)[1]))
```



:::{.answer}
**Answer to Exercise \@ref(exr:FindkGiveVar).**
First see that the area under the curve must be one, so

\[
   1 = \int_{-c}^c k(3x^2 + 4)\, dx = k(2c^3 + 8c).
\]
Then, note that $\text{E}(W) = 0$ (as the pdf is symmetric about 0), so that $\text{var}(X) = \text{E}(X^2)$, and:

\[
  \text{E}(X^2) = \int_{-c}^c k x^2 (3x^2 + 4)\, dx
  = k c^3\frac{18c^2 + 40}{15} = \frac{28}{15},
\]
and hence, equating the top lines of both fractions:

\[
  k c^3(9c^2 + 20) = 14.
\]
So we have two equations in two unknowns.
Equating we obtain, after some algebra,

\[
  9 c^4 - 8c^2 - 112 = 0.
\]
This is just a quadratic equation in $c^2$; so write

\[
  9 X^2 - 8X - 112 = (9X + 28)(X - 4) = 0
\]
with the two solutions $X = c^2 = -28/9$ (which has no real solutions for $c$), and $X = c^2 = 4$, so that $c = 2$ (as the pdf must be positive).
:::


:::{.answer}
**Answer to Exercise \@ref(exr:SolitonDist).**

1. $\text{E}(X) = \sum_{x = 1}^K x. p_X(x) = (1/6) + \sum_{x = 2}^K 1(x - 1)$.
   $\text{E}(X^2) = \frac{1}{K} + \sum_{x=2}^K \frac{x}{x - 1}$ with no closed form, so the variance is a PITA.
   No closed form!
1. See Fig. \@ref(fig:Soliton).
1. Applying the definition:

\[  
  M_X(t) = \text{E}(\exp(tX)) = \frac{1}{K} 
     + \left( 
     \frac{\exp(2t)}{2\times 1} +
     \frac{\exp(3t)}{3\times 2} +
     \frac{\exp(4t)}{4\times 3} + \dots +
     \frac{\exp(Kt)}{K\times (K - 1)}\right).
\]

```{r Soliton, echo=FALSE, fig.align="center", fig.cap="The Soliton distribution", fig.width=5}
pSoliton <- function(K){
  y <- array( dim = K)
  Kseq <- 2:K

  y[1] <- 1/K
  y[2:K] <- 1/(Kseq * (Kseq - 1) )
  y
}


par(mfrow = c(1, 2))

K <- 6
px <- pSoliton(K)

plot(px ~ I(1:K), 
     type = "p",
     pch = 19,
     las = 1,
     xlab = expression(italic(x)),
     ylab = "Prob. fn.")
lines(px ~ I(1:K), 
     type = "h",
     lty = 2,
     col = "grey",
     lwd = 2)

K <- 10
px <- pSoliton(K)

plot(px ~ I(1:K), 
     type = "p",
     pch = 19,
     las = 1,
     xlab = expression(italic(x)),
     ylab = "Prob. fn.")
lines(px ~ I(1:K), 
     type = "h",
     lty = 2,
     col = "grey",
     lwd = 2)
```
:::



:::{.answer}
**Answer to Exercise \@ref(exr:InvertMGFcontinuous).**

1. Since $M_X(t) = \lambda/(\lambda - t)$, then $M_X(it) = \lambda/(\lambda - it)$. 
   Then

\begin{align*}
  f_X(x) 
  &= \int_{-\infty}^{\infty} M_X(it) ] \exp(-itx)\, dt \\ 
  &= \int_{-\infty}^{\infty} \frac{\lambda}{\lambda - it} (\cos(-tx) + \sin(-tx))\, dt\\
  &= \int_{-\infty}^{\infty} \frac{\lambda(\lambda + it)}{\lambda^2 + t^2} (\cos(tx) - \sin(tx))\, dt \\
  &= \int_{-\infty}^\lambda \frac{\lambda}{\lambda^2 + t^2} (\lambda\cos(tx) + t\sin(tx))\, dt.
\end{align*}


```{r Integrand, echo=FALSE, fig.cap="The integrand", fig.align="center"}
t <- seq(-50, 2, # Recall: t only from -infty to lambda (= 2)
         length = 1000)
integrand <- function(t, lambda=2, x=1){
  lambda / (lambda^2 + t^2) *
    (lambda * cos(t * x) + t*sin(t*x))
}

plot(integrand(t) ~ t,
     type = "l",
     xlab = expression(italic(t)),
     ylab = "Integrand",
     lwd = 2,
     las = 1)
abline(h = 0,
       col = "grey")
```
:::



:::{.answer}
**Answer to Exercise \@ref(exr:PooledTest2).**

$\Pr(\text{Need individual tests})$ 
${}={}$
$\Pr(\text{Pooled test is positive})$ 
${}={}$
$1 - \Pr(\text{Pooled test is negative})$ 
${}={}$
$1 - \Pr(\text{All individuals are negative})$ 
${}={}$
$1 -(0.9)^ 4 = 0.3439$.
So the pmf of $N$, the number if tests needed, is

\[
  p_N(n) = 
  \begin{cases}
     0.6561 & \text{for $n = 1$ (i.e., pooled test only)};\\
     0.3439 & \text{for $n = 5$ (i.e., one pooled test, olus four individual tests)}
  \end{cases}
\]
Then $\text{E}(X) = (0.6561 \times 1) + (0.3439 \times 5) = 2.3756$ and
$\text{E}(X^2) = (0.6561 \times 1^2) + (0.3439 \times 5^2) =  9.2536$ so that $\text{var}(X) = 3.610125$.
So for a pool of four people, rather than four tests we would expected to have to conduct 2.3756 tests, a saving of $4 - 2.3756 = 1.6244$ tests.

If 200 people in total, testing each individual would cost $200\times 15 = \$3000$.
With $n = 4$, a total of 50 pools are created, and each pool saves 1.6244 tests, so the total numbert of tests expected to be saved in $50 \times 1.6244 = 81.22$; at \$15 each, the saving is $\$1218.30$.
:::

```{r PoolTestFig, echo=TRUE, fig.show='hide'}
n <- 2:14

probIndTestsNeeded <- 1 - 0.9^n
probOneTestNeeded <- 0.9^n
expectedTests <- (probOneTestNeeded * 1) + (probIndTestsNeeded * (n + 1) )
TestsSaved <- n - expectedTests

par(mfrow = c(1, 2))

plot( expectedTests ~ n,
      las = 1,
      ylim = c(0, 12),
      type = "b",
      main = "Expected number of tests\nfor pooling first",
      xlab = "Number in pooled test",
      ylab = "Expected number of tests")
plot( TestsSaved ~ n,
      las = 1,
      ylim = c(0, 2.5),
      type = "b",
      main = "The number of tests saved\nby pooling first",
      xlab = "Number in pooled test",
      ylab = "Expected number of tests saved/pool")

```
```{r PoolTestFig2, echo=FALSE, fig.cap="The advantage of initial pooled testing", out.width='90%', fig.width=7}
<<<PoolTestFig>>>
```




