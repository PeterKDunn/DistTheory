\part{Appendices}

# (APPENDIX) Appendices {-}



# Some useful series {#UsefulSeries}

For convenience and reference, some results are given here involving series that occur frequently in probability and statistical theory.


## Finite series

* Sum of natural numbers:  
\begin{equation}
   1 + 2 + 3 + \ldots + n 
   = \frac{n(n + 1)}{2}.
   (\#eq:SumNaturalNumbers)
\end{equation}

* Sum of squares of natural numbers:  
\begin{equation}
   1^2 + 2^2 + 3^2 + \ldots + n^2
   = \frac{n}{6}(n + 1)(2n + 1).
   (\#eq:SumSquaredNaturalNumbers)
 \end{equation}
 
* Geometric series:  
\begin{equation}
   a + ar + ar^2 + \ldots + ar^{n - 1} 
   = \frac{a(1 - r^n)}{1 - r}
   (\#eq:SumGeometricFinite).
\end{equation}
See the next section for the case where $n\to\infty$.

* Binomial expansion:  
\begin{equation}
   (a + b)^n = b^n + \binom{n}{1}ab^{n - 1} + \ldots + \binom{n}{r}a^r b^{n - r} + \ldots a^n.
   (\#eq:BinomialSeries)
\end{equation}



## Infinite series and limits

* Geometric series:  
\begin{equation}
     \sum_{n = 0}^\infty a r^n
   = a + ar + ar^2 + \ldots
   \rightarrow \frac{a}{1 - r} \text{ as $n \rightarrow \infty$}
  (\#eq:SumGeometricInfinite)
\end{equation}
where the infinite series only converges if $|r| < 1$.
* Geometric-like series:  
\begin{equation}
     \sum_{n = 0}^\infty a n r^n
   = ar + 2ar^2 + 3ar^3 + \ldots
   \rightarrow \frac{ar}{(1 - r)^2}
  (\#eq:SumGeometricInfinite2)
\end{equation}
where the infinite series only converges if $|r| < 1$.  
\begin{equation}
     \sum_{n=0}^\infty a n^2 r^n
   = ar + 4ar^2 + 9ar^3 \ldots 
   \rightarrow \frac{ar(r + 1)}{(1 - r)^3}
  (\#eq:SumGeometricInfinite3)
\end{equation}
where the infinite series only converges if $|r| < 1$.


* Exponential function:  
\begin{align}
   e^z
   &= 1 + z + \frac{z^2}{2!} + \frac{z^3}{3!} + \ldots
   (\#eq:Exponential)\\
   e^{-z}
   &= 1 - z + \frac{z^2}{2!} - \frac{z^3}{3!} + \ldots
   (\#eq:ExponentialNegative) \\
   e
   &= \lim_{n\to\infty} \left(1 + \frac{1}{z}\right)^z
   (\#eq:ExponentialLimit)\\
   1/e
   &= \lim_{n\to\infty} \left(1 - \frac{1}{z}\right)^z
   (\#eq:ExponentialNegLimit)
\end{align}

* Logarithmic series:  
\begin{align}
   \log(1 + z)
   &= z - \frac{z^2}{2} + \frac{z^3}{3} - \ldots
   (\#eq:Logarithmic)\\
   \log(1 - z)
   &= -z - \frac{z^2}{2} - \frac{z^3}{3} - \ldots
   (\#eq:LogarithmicNegative)
\end{align}

* Others:  
\begin{align}
   (1 - z)^{-1}
   &= 1 + z + z^2 + z^3 + \ldots
   (\#eq:Other1)\\
   (1 - z)^{-r}
   &= 1 + rz + \frac{r(r + 1)z^2}{2!} + \frac{r(r + 1)(r + 2)z^3}{3!} + \ldots
   (\#eq:Other2)
\end{align}



Note that the expressions on the RHS above do not converge to the LHS for all values of $z$.



# Using R with distributions {#UseRDistributions}

In **R**, standard distributions have four associated functions:

* Computing the [probability function](#ProbabilityFunction): All begin with `p` (such as `pnorm()` for the normal distribution).
* Computing the [distribution function](DistributionFunction): All begin with `d`(such as `dnorm()`).
* Computing the quantile function: All begin with `q` (such as `qnorm()`).
* Generating random numbers: All begin with `r` (such as `rnorm()`).

For example, the fours function above are called, for the normal distribution (denoted `norm` in **R**):

* `dnorm()`
* `pnorm()`
* `qnorm()`
* `rnorm()`





## Univariate distributions

Common parameters:

* `x`: Values where to evaluate the probability function
* `q`: Quantiles
* `p`: Probabilities
* `n`: The number of random observations to generate

Most distributions have other parameters also; check the help (e.g., `?punif`).

Distribution       | Probability function | Distribution function | Quantile function | Random numbers
----------------|-------------------------|-----------------------|-------------------|-----------------
Discrete uniform   |                      |                       |                   |  `sample()`
Binomial           | `dbinom()`           | `pbinom()`            | `qbinom()`        | `rbinom(n, )`
Poisson            | `dpois()`            | `ppois()`             | `qpois()`         | `rpois(n, )`
Geometric          | `dgeom()`            | `pgeom()`             | `qgeom()`         | `rgeom(n, )`
Negative binomial  | `dnbinom()`          | `pnbinom()`           | `qnbinom()`       | `rnbinom(n, )`
Continuous uniform | `dunif()`            | `punif()`             | `qunif()`         | `runif(n, )`
Normal             | `dunif()`            | `punif()`             | `qunif()`         | `runif(n, )`
Gamma              | `dgamma()`           | `pgammma()`           | `qgamma()`        | `rgamma(n, )`
$t$                | `dt()`               | `pt()`                | `qt()`            | `rt(n, )`
$\chi$-squared     | `dchisq()`           | `pchisq()`            | `qchisq()`        | `rchisq(n, )`
$F$                | `df()`               | `pf()`                | `qf()`            | `rf(n, )`



## Multivariate distributions 

The **multinomial** distribution: 

* `rmultinom()`
* `dmultinom()`

The **multivariate normal** distribution:
  
* `dmnorm()`
* `pmnorm()`
* `rmnorm()`


# Other useful R functions {#OtherUsefulR}

## General functions {#OtherUsefulRGeneral}

* `seq()` produces a **seq**uence of integers:
  * `seq(1, 4)` produces the list: $1$, $2$, $3$, $4$.
  * `seq(0, 10, by = 2)` produces a list going up **by** two each time: $0$, $2$, $4$, $6$, $8$, $10$.
  * `seq(0, 10, length = 3)` produces a list of **length** three: $0$, $5$, $10$.
  * A colon can also be used in special cases: `3 : 7` produces: $3$, $4$, $5$, $6$, $7$.
* `c()` is used to **c**oncatenate (join together) a series of values:
  * `c("fred", "martha")` creates a vector with two text elements.
  * `c(1, 8, 3.14, -2)`create a vector with four numerical elements.

Logical comparison in **R** are possible (notice the use of `==`):

```{r}
DaysOfWeek <- c("Mon", "Tues", "Wed", "Thurs", "Fri", "Sat", "Sun")
HoursSleep <- c(8, 8, 8, 8, 6, 6, 10)

HoursSleep == 8
HoursSleep > 8
HoursSleep >= 8

HoursSleep == 6 | HoursSleep == 10 # | means "OR"

HoursSleep > 6 & HoursSleep < 10 # & means "AND"

which(HoursSleep == 8)
which(HoursSleep > 8)
which(HoursSleep >= 8)

which(HoursSleep == 6 | HoursSleep == 10 ) # | means "OR"

which(HoursSleep > 6 & HoursSleep < 10 ) # & means "AND"

WeekEnd <- DaysOfWeek == "Sat" | DaysOfWeek == "Sun"

WeekDay <- !WeekEnd # ! means "NOT"

```

Specific elements of a vector can be accessed using square brackets:

```{r}
HoursSleep[1]
HoursSleep[3:5]

HoursSleep[WeekEnd]
```



## Statistical functions {#OtherUsefulRStatistical}

Because **R** is primarily a statistical package and environment, all the basic statistical functions are available, including 

* `mean()`: Find the mean of a set of values.
   Example: `mean( c(1, 2, 3, 4))`.
* `median()`: Find the median of a set of values.
   Example: `median( c(1, 2, 3, 4))`.
* `sd()`: Finds the *sample* standard deviation of a set of values.
   Example: `sd( c(1, 2, 3, 4))`.
* `var()`: Finds the *sample* variance of a set of values.
   Example: `var( c(1, 2, 3, 4))`.
* `lm()`: To fit a linear regression model:

```{r}
x <- c(1, 2, 3, 4, 5)
y <- c(12, 10, 9, 7, 4)

out <- lm(y ~ x) # Read: 'y as a function of x'
coef(out)
summary(out)
```


## Plotting functions {#OtherUsefulRPlotting}

Three systems exists for plotting in **R**, believe it or not.
Here, we discuss the base system.

`plot()` is the basic function for plotting, with *many* options:

* `plot(x, y)` and `plot(y ~ x)` both produce a scatterplot, with `y` on the vertical axis and `x` on the horizontal axis.
* `plot(..., type = "l")` plots with **l**ines rather than points.
* `plot(..., lwd = "3")` plots with a **l**ine **w**i**d**th thrice as thick.
* `plot(..., xlab = "text", ylab = "Info")` adds an **lab**el to the **x** and **y** axes respectively.
* `plot(..., main = "Title")` adds a **main** title to the plot.
* `plot(..., col = "green")` plots in green rather than the default (black).

`plot()` starts a new canvas every time it is called.
`lines()` and `points()` add **lines** and **points** respectively to an existing plot.
`legend()` adds a legend to an existing plot.


```{r, fig.align='center', fig.cap="An example plot: the probability function for two exponential distributions", out.width='60%', fig.width=5.5}
x <- seq(0, 4, length = 100)
y1 <- dexp(x, rate = 2) # Probability function for an exponential distn

plot(y1 ~ x,
     type = "l", # Use lines, not points
     lwd = 2, # Make lines a bit thicker
     xlab = "Values of x",
     ylab = "Probability function",
     main = "Probability function for\nexponential distribution",
      # NOTE: using  \n  adds a line break, and # is used for comments
     col = "red", 
     las = 1, # Makes the axis labels all horizontal
     xlim = c(0, 4.5), # Changes the displayed limits of the x-axis
     ylim = c(0, 3) ) # Changes the displayed limits on the y-axis

y2 <- dexp(x, rate = 3)
lines( y2 ~ x, # ADD a line to existing point
       lwd = 2,
       col = "blue")

legend("topright", # The location
       lwd = 2,
       col = c("red", "blue"),
       legend = c("Rate = 2",
                  "Rate = 3")
       )

```

