\part{Appendices}

# (APPENDIX) Appendices {-}





# Symbols used {#SymbolsUsed}




## Symbols and abbreviations used {#Symbols}

(ref:Sets) Chap.\ \@ref(ChapterSetTheory)

(ref:Probability) Chap.\ \@ref(ChapterProbability)

(ref:RandomVariables) Chap.\ \@ref(DistributionRandomVariables)

(ref:Expectation) Chap.\ \@ref(ChapExpectation)

(ref:ContinuousDistributions) Chap.\ \@ref(ContinuousDistributions)


```{r OtherSymbols, echo=FALSE}
SymbolsTab <- array( dim = c(33, 3))

colnames(SymbolsTab) <- c("Symbol", 
                          "Meaning", 
                          "Reference")

SymbolsTab[1, ] <- c("$\\in$", 
                     "Is an element of", 
                     "(ref:Sets)")
SymbolsTab[2, ] <- c("$\\subset$", 
                     "Proper subset", 
                     "(ref:Sets)")
SymbolsTab[3, ] <- c("$\\subseteq$", 
                     "Subset", 
                     "(ref:Sets)")
SymbolsTab[4, ] <- c("$\\cup$", 
                     "Set union; or", 
                     "(ref:Sets)")
SymbolsTab[5, ] <- c("$\\cap$", 
                     "Set intersection; and", 
                     "(ref:Sets)")
SymbolsTab[6, ] <- c("$A\\setminus B$", 
                     "Set difference", 
                     "(ref:Sets)")
SymbolsTab[7, ] <- c("Superscript $c$", 
                     "Set complement", 
                     "(ref:Sets)")
SymbolsTab[8, ] <- c("$|A|$", 
                     "Cardinality of set\\ $A$", 
                     "(ref:Sets)")
SymbolsTab[9, ] <- c("$\\aleph_0$", 
                     "The smallest infinite cardinality", 
                     "(ref:Sets)")
SymbolsTab[10, ] <- c("$\\mathfrak{c}$", 
                     "Cardinality of the continuum", 
                     "(ref:Sets)")
SymbolsTab[11, ] <- c("$\\mathbb{N}$", 
                     "Set of natural (counting) numbers", 
                     "(ref:Sets)")
SymbolsTab[12, ] <- c("$\\mathbb{Z}$", 
                     "Set of integers", 
                     "(ref:Sets)")
SymbolsTab[13, ] <- c("$\\mathbb{Q}$", 
                     "Set rational numbers" , 
                     "(ref:Sets)")
SymbolsTab[14, ] <- c("$\\mathbb{R}$", 
                     "Set of real numbers", 
                     "(ref:Sets)")
SymbolsTab[15, ] <- c("$\\mathbb{R}^{+}_0$", 
                     "Set of non-negative real numbers", 
                     "(ref:Sets)")
SymbolsTab[16, ] <- c("$\\mathbb{R}_{+}$", 
                     "Set of positive real numbers", 
                     "(ref:Sets)")
SymbolsTab[17, ] <- c("$\\mathbb{R}_{-}$", 
                     "Set of negative real numbers", 
                     "(ref:Sets)")
SymbolsTab[18, ] <- c("$\\mathbb{C}$", 
                     "Set of complex numbers", 
                     "(ref:Sets)")


SymbolsTab[19, ] <- c("$P^n_r$", 
                     "Permutation of\\ $r$ elements from\\ $n$", 
                     "(ref:Probability)")
SymbolsTab[20, ] <- c("$C^n_r$; $\\binom{n}{r}$", 
                     "Combination of\\ $r$ elements from\\ $n$", 
                     "(ref:Probability)")

SymbolsTab[21, ] <- c("$p_X(x)$", 
                     "Probability mass function of\\ $X$", 
                     "(ref:Probability)")
SymbolsTab[22, ] <- c("$f_X(x)$", 
                     "Probability density function of\\ $X$", 
                     "(ref:Probability)")
SymbolsTab[23, ] <- c("$F_X(x)$", 
                     "Distribution function for\\ $X$", 
                     "(ref:Probability)")

SymbolsTab[24, ] <- c("$\\operatorname{E}[X]$; $\\mu$", 
                     "Expected value, or mean, of\\ $X$", 
                     "(ref:RandomVariables)")
SymbolsTab[25, ] <- c("$\\operatorname{var}[X]$; $\\sigma^2$", 
                     "Variance of\\ $X$", 
                     "(ref:RandomVariables)")
SymbolsTab[26, ] <- c("$\\gamma_1$", 
                     "Skewness", 
                     "(ref:RandomVariables)")

SymbolsTab[27, ] <- c("$\\gamma_2$", 
                     "Excess kurtosis", 
                     "(ref:Expectation)")
SymbolsTab[28, ] <- c("$M_X(t)$", 
                     "Moment-generating function", 
                     "(ref:Expectation)")
SymbolsTab[29, ] <- c("$\\mu'_r$", 
                     "$r$th raw moment", 
                     "(ref:Expectation)")
SymbolsTab[30, ] <- c("$\\mu_r$", 
                     "$r$th central moment", 
                     "(ref:Expectation)")

SymbolsTab[31, ] <- c("$\\phi(\\cdot)$", 
                     "Standard normal density function", 
                     "(ref:ContinuousDistributions)")
SymbolsTab[32, ] <- c("$\\Phi(\\cdot)$", 
                     "Cumulative standard normal distribution function", 
                     "(ref:ContinuousDistributions)")
SymbolsTab[33, ] <- c("$\\operatorname{erf}(x)$", 
                     "Error function", 
                     "(ref:ContinuousDistributions)")


if( knitr::is_latex_output() ) {
  kable( SymbolsTab,
         format = "latex",
         booktabs = TRUE,
         escape = FALSE,
         align = c("c", "l", "c") ) %>%
#         linesep = c("\\addlinespace", "", "\\addlinespace", "",  "\\addlinespace", "\\addlinespace", "", "\\addlinespace", "", "")) %>%  # Else adds a space every 5 lines...
        # caption = "Some symbols used") %>%
	row_spec(0, bold = TRUE) %>%
  column_spec(column = 1, width = "25mm") %>% 
  kable_styling(font_size = 9)
}
if( knitr::is_html_output() ) {
  kable( SymbolsTab,
                format = "html",
                booktabs = TRUE,
                align = c("c", "l", "c")) %>%
                #caption = "Some symbols used")
  row_spec(0, bold = TRUE)
}
```







# Some useful series {#UsefulSeries}

For convenience and reference, some results are given here involving series that occur frequently in probability and statistical theory.


## Finite series

* Sum of natural numbers:  
\begin{equation}
   1 + 2 + 3 + \ldots + n 
   = \frac{n(n + 1)}{2}.
   (\#eq:SumNaturalNumbers)
\end{equation}

* Sum of squares of natural numbers:  
\begin{equation}
   1^2 + 2^2 + 3^2 + \ldots + n^2
   = \frac{n}{6}(n + 1)(2n + 1).
   (\#eq:SumSquaredNaturalNumbers)
 \end{equation}
 
* Geometric series:  
\begin{equation}
   a + ar + ar^2 + \ldots + ar^{n - 1} 
   = \frac{a(1 - r^n)}{1 - r}
   (\#eq:SumGeometricFinite).
\end{equation}
See the next section for the case where $n\to\infty$.

* Binomial expansion:  
\begin{equation}
   (a + b)^n = b^n + \binom{n}{1}ab^{n - 1} + \ldots + \binom{n}{r}a^r b^{n - r} + \ldots a^n.
   (\#eq:BinomialSeries)
\end{equation}



## Infinite series and limits {#InfiniteSeriesLimits}

* Geometric series:  
\begin{equation}
     \sum_{n = 0}^\infty a r^n
   = a + ar + ar^2 + \ldots
   \rightarrow \frac{a}{1 - r} \text{ as $n \rightarrow \infty$} \quad\text{for $|r|<1$.}
  (\#eq:SumGeometricInfinite)
\end{equation}
* Geometric-like series:  
\begin{equation}
     \sum_{n = 0}^\infty a n r^n
   = ar + 2ar^2 + 3ar^3 + \ldots
   \rightarrow \frac{ar}{(1 - r)^2} \quad\text{for $|r|<1$.}
  (\#eq:SumGeometricInfinite2)
\end{equation}
\begin{equation}
     \sum_{n=0}^\infty a n^2 r^n
   = ar + 4ar^2 + 9ar^3 \ldots 
   \rightarrow \frac{ar(r + 1)}{(1 - r)^3} \quad\text{for $|r|<1$.}
  (\#eq:SumGeometricInfinite3)
\end{equation}


* Exponential function:  
\begin{align}
   e^z
   &= \sum_{i = 1}^n \frac{z^i}{i!}
    = 1 + z + \frac{z^2}{2!} + \frac{z^3}{3!} + \ldots \quad\text{for all values of $z$}.
   (\#eq:Exponential)\\
   e^{-z}
   &= \sum_{i = 1}^n \frac{(-z)^i}{i!}
    = 1 - z + \frac{z^2}{2!} - \frac{z^3}{3!} + \ldots \quad\text{for all values of $z$}.
   (\#eq:ExponentialNegative) \\
   e
   &= \lim_{z\to\infty} \left(1 + \frac{1}{z}\right)^z
   (\#eq:ExponentialLimit)\\
   1/e
   &= \lim_{z\to\infty} \left(1 - \frac{1}{z}\right)^z
   (\#eq:ExponentialNegLimit)
\end{align}

* Logarithmic series:  
\begin{align}
   \log(1 + z)
   &= z - \frac{z^2}{2} + \frac{z^3}{3} - \ldots \quad\text{for $|z|<1$}.
   (\#eq:Logarithmic)\\
   \log(1 - z)
   &= -z - \frac{z^2}{2} - \frac{z^3}{3} - \ldots \quad\text{for $|z|<1$}.
   (\#eq:LogarithmicNegative)
\end{align}

* Others:  
\begin{align}
   (1 - z)^{-1}
   &= 1 + z + z^2 + z^3 + \ldots \quad\text{for $|z|<1$}.
   (\#eq:Other1)\\
   (1 - z)^{-r}
   &= 1 + rz + \frac{r(r + 1)z^2}{2!} + \frac{r(r + 1)(r + 2)z^3}{3!} + \ldots \quad\text{for $|z|<1$}.
   (\#eq:Other2)
\end{align}

Note that the expressions on the RHS above do not converge to the LHS for all values of $z$.




# Short R introduction {#ShortRIntro}

## General ideas

Whn you start **R**, you are presented with a *prompt* asking you enter some information:

```
>
```

We do not show this prompt with the **R** code in this book, to enable any code that we show do be cut-and-paste directly into **R** and evaluated.
The `>` is how **R** prompts you to enter something for it to do.

**R** can be used a fancy calculator:

```{r}
(-5 + 7) * 2
2 * pi * 3
exp(-1)
sqrt( 9 ) * sin(3 * pi / 2)
```

The output begins with `[1]` to indicate the first item of output; sometimes, numerous values appear in the output (see Sect.\ \@ref(RVector) for examples).

Note that spaces are not important to **R**, so these are all the same to **R**:

```{r}
1 +                2
1          +  2
1+2
1 + 2
```

The last is better for human readability, so is recommended.

**R** also allows *variables* to be used, and values can be assigned to variables using `=` or the more tradiational `<-` combination of characters. 
Variables cannot start with a digit.

```{r}
Radius = 2
Area = pi * Radius^2
Area

side1 <- 2
side2 <- 4
hypot <- sqrt( side1^2 + side2^2 )
hypot
```

Notice that the *value* of a variable is displayed by typing the variable name.

Comments can be added using `#`; any text following a `#` is ignored by **R**:

```{r}
hourly_Wage <- 20  # Hourly wage, in $ per hr
hours_Worked <- 16 # Number of hours worked

# This all assumes no overtime rates!

weekly_Income <- hourly_Wage * hours_Worked # Income in dollar for the week
weekly_Income
```

In complete lines of instructions cause **R** to wait for the instruction to be completed.
For instance, suppose you type:

```{r eval=FALSE}
sqrt( 4  # Notce: no closing of parentheses
```

**R** will change the prompt from a `>` to ` `+`, indicating that you need to *add* more information to complete the command.
Once teh command is complete, **R** evaluates the instruction:

```{r}
sqrt(4
)
```

## Using functions in R {#FunctionsInR}

**R** has thousands of functions to perform specific tasks.
We have already seen two being used above:

* `sqrt()` takes the square root of a given value.
* `exp()` find the value of $\exp(x) = e^x$ for some given value of $x$.

Functions, in general, can take many inputs.

Consider the function `log()`.
We can type

```{r}
log(100)
```

If we look at the help for the `log()` function (by typing `?log`), we see the usage is described like this:

```
Usage
log(x, base = exp(1))
```

That is, the function can take *two* inputs: one called `x`, and one called `base`.
The help information is starting that the default value of `base`, if it is not told otherwise, is assumed to be `exp(1)` (which is $\exp(1)= e^1 = 2.71828\dots$).
In other words, the default logarithm is the *natural logarithm*.

Since my command above (i.e., `log(100)`) only gave one input to the `log()` functions, the value of the second input (i.e., `base`) uses the default value of `exp(1)`.
That is, $\log_e 100 = \ln 100 = 4.605\dots$.

To specify a different base, we can set the value of `base` explicitly:

```{r}
log(100, 10)
```

The inputs are assumed by **R** to have been given in the order shown in the help; that is `x = 100` and `base = 10`. 
It is clearer, though, to *name* the value of the second input:

```{r}
log(100, base = 10)
```

The value of the first input can be named also:

```{r}
log(x = 100, base = 10)
```
When inputs are *named*, they can appear in any order:

```{r}
log(base = 10, x = 100)
```

Some functions in **R** have *many* inputs.
Some functions are collected into _**R** packages_ that provide additional functionality. 


## General functions {#OtherUsefulRGeneral}

* `seq()` produces a **seq**uence of integers:
  * `seq(1, 4)` produces the list: $1$, $2$, $3$, $4$.
  * `seq(0, 10, by = 2)` produces a list going up **by** two each time: $0$, $2$, $4$, $6$, $8$, $10$.
  * `seq(0, 10, length = 3)` produces a list of **length** three: $0$, $5$, $10$.
  * A colon can also be used in special cases: `3 : 7` produces: $3$, $4$, $5$, $6$, $7$.
* `c()` is used to **c**oncatenate (join together) a series of values:
  * `c("fred", "martha")` creates a vector with two text elements.
  * `c(1, 8, 3.14, -2)`create a vector with four numerical elements.
* `cat()` is often used to print information.
* `matrix()` is used to produces matrices (of $2$-dimensions):
  * `matrix(data = c(1, 2, 3, 4, 5, 6), byrow = TRUE, ncol = 3)` produces the $2\times 3$ array (i.e., `ncol = 3` means the number of columns is\ $3$):
$$
  \left[
  \begin{array}{ccc}
    1 & 2 & 3\\
    4 & 5 & 6\\
  \end{array}
  \right].
$$

```{r}
matrix(data = c(1, 2, 3, 4, 5, 6), byrow = TRUE, ncol = 3)
```
  * `matrix(data = c(1, 2, 3, 4, 5, 6), bycol = TRUE, nrow = 2` produces the $2\times 3$ array (i.e., `nrow = 2` means the number of rows is\ $2$):
$$
  \left[
  \begin{array}{ccc}
    1 & 3 & 5\\
    2 & 4 & 6\\
  \end{array}
  \right].
$$
* `array()` produces matrix-like structure, but they can have many dimensions (not just two, like `matrix()`)
  * `array( dim = c(2, 4))` produces an empty $2\times 4$ array.
  * `array( data = c(1, 2, 3, 4, 5, 6, 7, 8), dim = c(2, 2, 2))` produces a $2\times 2\times 2$ array:
```{r}
array( data = c(1, 2, 3, 4, 5, 6, 7, 8), dim = c(2, 2, 2))
```
* `t()` **t**ransposes a matrix or array:

```{r}
A <- matrix( c(1, -2, -20, 3), ncol = 2)
A
t(A)
```


Logical comparison in **R** are possible (notice the use of `==` rather than `=`):

```{r}
Days_Of_Week <- c("Mon", "Tues", "Wed", "Thurs", "Fri", "Sat", "Sun")
Hours_Sleep <- c(8, 8, 8, 8, 6, 6, 10)

Hours_Sleep == 8
Hours_Sleep > 8
Hours_Sleep >= 8

Hours_Sleep == 6 | Hours_Sleep == 10 # | means "OR"

Hours_Sleep > 6 & Hours_Sleep < 10 # & means "AND"

which(Hours_Sleep == 8)
which(Hours_Sleep > 8)
which(Hours_Sleep >= 8)

which(Hours_Sleep == 6 | Hours_Sleep == 10 ) # | means "OR"

which(Hours_Sleep > 6 & Hours_Sleep < 10 ) # & means "AND"

Weekend <- Days_Of_Week == "Sat" | Days_Of_Week == "Sun"

Week_Day <- !Weekend # ! means "NOT"

Hours_Sleep[Week_Day]

Hours_Sleep[Weekend]


cat("These are the hours of sleep on weekdays:", Hours_Sleep[Week_Day], "\n")
   # Notice that  \n  is used to create a new line.
```

Specific elements of a vector can be accessed using square brackets:

```{r}
Hours_Sleep[1]
Hours_Sleep[3:5]

Hours_Sleep[Weekend]
```



## Vector operations {#RVector}

**R** is a *vectorised* system; that is, operations work on all elements of a vector:

```{r}
x <- 0 : 10
x
x + 3
2 * x

sqrt(x) # The square root function
cos(x)  # The cosine function
exp( -x ) # The exponential function
```


## Statistical functions {#OtherUsefulRStatistical}

Because **R** is primarily a statistical package and environment, all the basic statistical functions are available, including 

* `mean()`: Find the mean of a *sample* of values.
   Example: `mean( c(1, 2, 3, 4))`.
* `median()`: Find the median of a *sample* of values.
   Example: `median( c(1, 2, 3, 4))`.
* `sd()`: Finds the standard deviation of a *sample* of values.
   Example: `sd( c(1, 2, 3, 4))`.
* `var()`: Finds the variance of a *sample* of values.
   Example: `var( c(1, 2, 3, 4))`.
* `lm()`: To fit a linear regression model:

```{r}
x <- c(1, 2, 3, 4, 5)
y <- c(12, 10, 9, 7, 4)

out <- lm(y ~ x) # Read: 'y as a function of x'
coef(out)
summary(out)
```


## Probability and counting functions {#RProbCounting}

* the *number* of *combinations* of `n` elements taken `k` at a time is found using `choose(n, k)`.
* $n!$ is given by `factorial(n)`.
* the *number* of *permutations* of `n` elements taken `k` at a time is found using `choose(n, k) * factorial(k)`.
* a list of all combinations of `n` elements, `m` at a time, is given by `combn(x, m)`.
* $\Gamma(x)$ is given by `gamma(x)`.




## Plotting functions {#OtherUsefulRPlotting}

Three systems exists for plotting in **R**, believe it or not.
Here, we discuss the base system.

`plot()` is the basic function for plotting, with *many* options:

* `plot(x, y)` and `plot(y ~ x)` both produce a scatterplot, with `y` on the vertical axis and `x` on the horizontal axis.
* `plot(..., type = "l")` plots with **l**ines rather than points.
* `plot(..., lwd = "3")` plots with a **l**ine **w**i**d**th thrice as thick.
* `plot(..., xlab = "text", ylab = "Info")` adds an **lab**el to the **x** and **y** axes respectively.
* `plot(..., main = "Title")` adds a **main** title to the plot.
* `plot(..., col = "green")` plots in green rather than the default (black).

`plot()` starts a new canvas every time it is called.
`lines()` and `points()` add **lines** and **points** respectively to an existing plot.
`legend()` adds a legend to an existing plot.


```{r, fig.align='center', fig.cap="An example plot: the probability function for two exponential distributions", out.width='60%', fig.width=5.5}
x <- seq(0, 4, length = 100)
y1 <- dexp(x, rate = 2) # Probability function for an exponential distn

plot(y1 ~ x,
     type = "l", # Use lines, not points
     lwd = 2, # Make lines a bit thicker
     xlab = "Values of x",
     ylab = "Probability function",
     main = "Probability function for\nexponential distribution",
      # NOTE: using  \n  adds a line break, and # is used for comments
     col = "red", 
     las = 1, # Makes the axis labels all horizontal
     xlim = c(0, 4.5), # Changes the displayed limits of the x-axis
     ylim = c(0, 3) ) # Changes the displayed limits on the y-axis

y2 <- dexp(x, rate = 3)
lines( y2 ~ x, # ADD a line to existing point
       lwd = 2,
       col = "blue")

legend("topright", # The location
       lwd = 2,
       col = c("red", "blue"),
       legend = c("Rate = 2",
                  "Rate = 3")
       )

```


# Using R with distributions {#UseRDistributions}

In **R**, standard distributions have four associated functions:

* Computing the [probability function](#def:ProbabilityFunction): All begin with `p` (such as `pnorm()` for the normal distribution).
* Computing the [distribution function](#def:DistributionFunction): All begin with `d`(such as `dnorm()`).
* Computing the quantile function: All begin with `q` (such as `qnorm()`).
* Generating random numbers: All begin with `r` (such as `rnorm()`).

For example, the fours function above are called, for the normal distribution (denoted `norm` in **R**):

* `dnorm()`
* `pnorm()`
* `qnorm()`
* `rnorm()`





## Univariate distributions

Common parameters:

* `x`: Values where to evaluate the probability function
* `q`: Quantiles
* `p`: Probabilities
* `n`: The number of random observations to generate

Most distributions have other parameters also; check the help (e.g., `?punif`).

Distribution       | Probability function | Distribution function | Quantile function | Random numbers
----------------|-------------------------|-----------------------|-------------------|-----------------
Discrete uniform   |                      |                       |                   |  `sample()`
Binomial           | `dbinom()`           | `pbinom()`            | `qbinom()`        | `rbinom(n, )`
Poisson            | `dpois()`            | `ppois()`             | `qpois()`         | `rpois(n, )`
Geometric          | `dgeom()`            | `pgeom()`             | `qgeom()`         | `rgeom(n, )`
Negative binomial  | `dnbinom()`          | `pnbinom()`           | `qnbinom()`       | `rnbinom(n, )`
Continuous uniform | `dunif()`            | `punif()`             | `qunif()`         | `runif(n, )`
Normal             | `dunif()`            | `punif()`             | `qunif()`         | `runif(n, )`
Gamma              | `dgamma()`           | `pgammma()`           | `qgamma()`        | `rgamma(n, )`
$t$                | `dt()`               | `pt()`                | `qt()`            | `rt(n, )`
$\chi$-squared     | `dchisq()`           | `pchisq()`            | `qchisq()`        | `rchisq(n, )`
$F$                | `df()`               | `pf()`                | `qf()`            | `rf(n, )`



## Multivariate distributions 

The **multinomial** distribution: 

* `rmultinom()`
* `dmultinom()`

The **multivariate normal** distribution:
  
* `dmnorm()`
* `pmnorm()`
* `rmnorm()`


