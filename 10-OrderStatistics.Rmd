
# Order statistcs {#OrderStatisticsChapter}


::: {.objectivesBox .objectives data-latex="{iconmonstr-target-4-240.png}"}
On completion of this module, you should be able to:

* DO SOMETHING
:::



## Introduction  {#OrderStatisticsIntro}

\index{Order statistics|(}
In many applications, information about the minimum value, or the maximum value, in a sample is useful.
For example, knowing the maximum water height in a dam is useful for modelling controlled releases.
The minimum and maximum values in a sample are examples of *order statistics*.

More generally, order statistics refer to the values in a sample arranged in increasing order. 
For a given random sample $X_1, X_2, \dots, X_n$, the order statistics are defined and denoted as
$$
  X_{(1)} \le X_{(2)} \le \cdots \le X_{(n)}
$$
$X_{(k)}$ is the $k$th order statistic, the $k$th smallest value.

Important order statistics in a sample of size\ $n$ include:

* the minimum value: $X_{(1)}$; and
* the maximum value: $X_{(n)}$; and
* the range: $X_{(n)} - X_{(1)}$.

The median is also an important order statistic.
When\ $n$ is odd, the median is $X_{([n + 1]/2)}$;
when\ $n$ is even, the median value is usually specified as the mean of the middle two order statistics:
$$
   \text{median} = \frac{X_{(n/2)} + X_{(n/2 + 1)}}{2}\qquad\text{for $n$ even.}
$$


:::{.example #OrderedStatisticsMedianOddn name="Median ($n$ odd)"}
Consider a sample of five die rolls, say $X_i$:
$$
  x_1 = 5; \quad x_2 = 3; \quad  x_3 = 5; \quad  x_4 = 2; \quad  x_5 = 6.
$$
The order statistics are 
$$
  x_{(1)} = 2; \quad  x_{(2} = 3; \quad  x_{(3)} = 5; \quad  x_{(4)} = 5; \quad  x_{(5)} = 6.
$$
The minimum value is $X_{(1)} = 2$, and the maximum value is $X_{(5)} = 6$.
The median value is $X_{(3)} = 5$.
:::


:::{.example #OrderedStatisticsMedianEvenn name="Median ($n$ even)"}
Consider a sample of six die rolls, say $Y_i$:
$$
  y_1 = 1; \quad y_2 = 4; \quad  y_3 = 6; \quad  y_4 = 2; \quad  y_5 = 5 \quad  y_6 = 1.
$$
The order statistics are 
$$
  y_{(1)} = 1; \quad  y_{(2} = 1; \quad  y_{(3)} = 2; \quad  y_{(4)} = 4; \quad  y_{(5)} = 5; \quad  y_{(6)} = 6.
$$
The minimum value is $y_{(1)} = 1$, and the maximum value is $y_{(4)} = 6$.
The median value is $\left(X_{(3)} X_{(3)}\right)/2 = (2 + 4)/2 = 3$, which is not one of the observations in the sample.
:::


## Distribution of the minimum and maximum value {#OrderStatisticsMinMaxDistribution}

As with any statistic, the order statistics have a distribution.
The easiest order statistics for which to find the distribution are the minimum (first order statistic) and the maximum (the $n$th order statistic).


Minimum:
$$
   f_{(X_1)}(x) = n [1 - F_X(x)]^{n - 1} \times f_X(x)
$$
and
$$
   F_{(X_1)}(x) = 1 - [1 - F_X(x)]^{n}
$$
Maximum:
$$
   f_{(X_n)}(x) = n [F_X(x)]^{n - 1} \times f_X(x)
$$
and
$$
   F_{(X_n)}(x) = [F_X(x)]^{n}
$$




## Distribution of the $k$th order statistic {#OrderStatisticsDistribution}

The ideas developed above for the distribution of the minimum and maximum value in a sample can be applied to other order statistics also.
If the sample is from a continuous distribution with density function\ $f_X(x)$ and distribution function\ $F_X(x)$, the density function of the $k$th order statistic $X_{(k)}$ is:
\begin{equation}
   f_{X_{(k)}}(x) = \frac{n!}{(k-1)! (n-k)!} [F(x)]^{k-1} [1 - F(x)]^{n-k} f(x),
   (\#eq:OrderStatisticDF)
\end{equation}
where $n > k > 0$ and\ $n$ and\ $k$ are integers.


::: {.example}
Consider simulating $1\,000$ samples of size $n = 10$ from a Uniform$(0, 1)$ distribution.
The distribution of $X_{(2)}$ and $X_{(10)}$ (i.e., the maximum value) are shown in Fig.\  \@ref(fig:OrderStats1).
:::


```{r OrderStats1, echo=TRUE, fig.align="center", fig.cap="Simulating the distribution of two order statistics for the uniform distribution. Left: the distribution of $X_{(2)}$. Right: the distribution of  $X_{(10)}$ (i.e., the maximum value).", fig.width=8, fig.height=4, out.width="90%"}
set.seed(123)  # For reproducibility

n <- 10   # Take samples of size 10
samples2 <- replicate(1000,               # 1000 repetitions
                      sort(runif(n))[2])  # 2nd order statistic
samples10 <- replicate(1000,           # 1000 repetitions
                       max(runif(n)))  # 10th order statistic

par(mfrow = c(1, 2))

hist(samples2, 
     col = plotColour1, 
     las = 1,
     main = expression(Distribution~of~italic(X)[(2)]),
     xlab = expression(italic(X)[(2)]),
     ylab = "Density")
hist(samples10, 
     col = plotColour1, 
     main = expression(atop(Distribution~of~italic(X)[(10)]),
                            "("*the~maximum~value*")"),
     xlab = expression(italic(X)[(10)]),
     ylab = "Density")
```


:::{.example #OrdsrStatisticsUniform name="Order statistics (uniform distribution)"}
For the continuous uniform distribution (Sect.\ \@ref(ContinuousUniform)) defined on $[0, 1]$, the density function is
\begin{equation}
   f_X(x; 0, 1)  = 1 \quad\text{for $0\le x\le 1$},
   (\#eq:ContinuousUniformPMForder)
\end{equation}
and the distribution function is
$$
  F_X(x; 0, 1) = 
  \begin{cases}
    0                & \text{for $x < 0$};\\
    \displaystyle x  & \text{for $0 \le x \le 1$};\\ 
    1                & \text{for $x > 1$}.
  \end{cases}
$$
Hence, Eq. \@ref(eq:OrderStatisticDF) becomes
\begin{equation}
   f_{X_{(k)}}(x) 
   = \frac{n!}{(k - 1)! (n - k)!} x^{k-1} (1 - x)^{n-k},
   (\#eq:OrderStatisticUniformPDF)
\end{equation}
for the $k$th order statistic $X_{(k)}$ in a sample of size\ $n$.
Since this is a density function, the total area must be one (Exercise\ \@ref(exr:OrderStatisticsUniform)).
The distributions are shown in Fig.\ \@ref(OrderStatsUnif) for $k = 2$ and $k = 10$.
The simulated order statistics (Fig.\ \@ref(fig:OrderStats1)) compare favourable with these theoretical distributions.

The mean value of the $k$th order statistic is (Exercise\ \@ref(exr:OrderStatisticsUniformExpectations)):
$$
  \operatorname{E}[X] 
  = \frac{n!}{(k - 1)!\, (n - k)!} \int_0^1 x^k (1 - x)^{n-k}\,dx
  = \frac{k}{n + 1}.
$$
Similarly (Exercise\ \@ref(exr:OrderStatisticsUniformExpectations)), 
$$
  \operatorname{var}[X] = \frac{k(n + 1 - k)}{(n + 1)^2\, (n + 2)}.
$$

For example, in a sample of size $n = 10$, the second order statistic (i.e., $k = 2$) is
$$
   f_{X_{(k)}}(x) 
   = \frac{10!}{1!\, 8!} x^{1} (1 - x)^{8}
   = 90 x (1 - x)^{8}
$$
for $0 < x < 1$, where 
$$
  \operatorname{E}[X] 
  = \frac{2}{11}
  \approx 0.1818\dots.
$$
and
$$
  \operatorname{var}[X] 
  = \frac{2\times (10 + 1 - 2)}{11^2 \times 12}
  = \frac{18}{1452}
  \approx 0.01239\dots.
$$
In **R**

```{r}
# 2nd order statistic
mean(samples2)   # Simulated mean of X_{(2)}
var(samples2)    # Simulated varianceof X_{(2)}
```

Likewise, in a sample of size $n = 10$, the tenth order statistic (i.e., $k = 10$) is
$$
   f_{X_{(k)}}(x) 
   = \frac{10!}{9!\, 0!} x^{9} (1 - x)^{0}
   = 10 x^{9}
$$
for $0 < x < 1$, and
$$
  \operatorname{E}[X] 
  = \frac{10}{11}
  \approx 0.909\dots.
$$
and
$$
  \operatorname{var}[X] 
  = \frac{10\times (10 + 1 - 10)}{11^2 \times 12}
  = \frac{10}{1452}
  \approx 0.006887052\dots.
$$
In **R**:

```{r}
# 10th order statistic (i.e., maximum)
mean(samples10)   # Simulated mean of X_{(10)}
var(samples10)    # Simulated variance of X_{(10)}
```

:::


```{r OrderStatsUnif, echo=TRUE, fig.align="center", fig.cap="The distribution of two order statistics for the uniform distribution. Left: the distribution of $X_{(2)}$. Right: the distribution of  $X_{(10)}$ (i.e., the maximum value).", fig.width=8, fig.height=4, out.width="90%"}
### Uniform order stats for 2nd and 10th order stats
f_Order <- function(x, n, k){
  factorial(n)/( factorial(k - 1) * factorial(n - k)) *
    x^(k - 1) * 
    (1 - x)^(n - k)
}

par(mfrow = c(1, 2))

x <- seq(0, 1,
         length = 100)

plot( f_Order(x, n = 10, k = 2) ~ x,
      lwd = 2,
      axes = FALSE,
      xlab = expression(italic(x)),
      ylab = "Density",
      main = expression( atop(Distribution~of~"2nd",
                              order~statistic)),
      type = "l")
axis(side = 1)
box()

plot( f_Order(x, n = 10, k = 10) ~ x,
      lwd = 2,
      axes = FALSE,
      xlab = expression(italic(x)),
      ylab = "Density",
      main = expression( atop(Distribution~of~"10th",
                              order~statistic)),
      type = "l")
axis(side = 1)
box()
```


## Joint distribution



## Finsihing up...

Order statistics are fundamental in probability and statistics. 
They underlie robust estimation, reliability analysis, and form the basis of many intuitive statistics.

\index{Order statistics|)}


## Exercises  {#OrderStatisticsExercises}

:::{.exercise #OrderStatisticsUniform}
Prove that the probably density function for the order statistics in the case of the uniform distribution, shown in Eq.\ \@ref(eq:ContinuousUniformPMForder), is a valid density function.
(Hint: observe the similarity between Eq.\ \@ref(eq:ContinuousUniformPMForder) and the beta desity function in Sect.\ \@ref(BetaDistribution).)
:::


:::{.exercise #OrderStatisticsUniformExpectations}
Prove that the expected value and variance of the order statistics in the case of the uniform distribution are
$$
  \operatorname{E}[X] = k/(n + 1)\qquad\text{and}\qquad \operatorname{var}[X] = \frac{k (k + 1)}{(n + 1)(n + 2)},
$$
as in Sect.\ \@ref(OrderStatisticsDistribution).
(Hint: observe the similarity between Eq.\ \@ref(eq:ContinuousUniformPMForder) and the beta desity function in Sect.\ \@ref(BetaDistribution).)
:::



:::{.exercise #OrderStatisticsPDF}
Find the distribution of the order statistics for the uniform distribution defined on $[-1, 1]$.
:::


:::{.exercise #OrderStatisticsPDF2}
Find the distribution of the order statistics for the distribution
$$
  f_Y(y) = x/2\quad\text{for $0 < y < 2$}
$$
and zero elsewhere.
:::
