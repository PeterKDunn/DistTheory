
# Order statistcs {#OrderStatisticsChapter}


::: {.objectivesBox .objectives data-latex="{iconmonstr-target-4-240.png}"}
On completion of this module, you should be able to:

* DO SOMETHING
:::



## Introduction  {#OrderStatisticsIntro}

\index{Order statistics|(}
In many applications, information about the minimum value, or the maximum value, in a sample is useful.
For example, knowing the maximum water height in a dam is useful for modelling controlled releases.
The minimum and maximum values in a sample are examples of *order statistics*.

More generally, order statistics refer to the values in a sample arranged in increasing order. 
For a given random sample $X_1, X_2, \dots, X_n$, the order statistics are defined and denoted as
$$
  X_{(1)} \le X_{(2)} \le \cdots \le X_{(n)}
$$
$X_{(k)}$ is the $k$th order statistic, the $k$th smallest value.

Important order statistics in a sample of size\ $n$ include:

* the minimum value: $X_{(1)}$; and
* the maximum value: $X_{(n)}$.

The median is also an important order statistic.
When\ $n$ is odd, the median is $X_{([n + 1]/2)}$;
when\ $n$ is even, the median value is usually specified as the mean of the middle two order statistics:
$$
   \text{median} = \frac{X_{(n/2)} + X_{(n/2 + 1)}}{2}\qquad\text{for $n$ even.}
$$


:::{.example}
Consider a sample of five die rolls, say $X_i$:
$$
  x_1 = 5; \quad x_2 = 3; \quad  x_3 = 5; \quad  x_4 = 2; \quad  x_5 = 6.
$$
The order statistics are 
$$
  x_{(1)} = 2; \quad  x_{(2} = 3; \quad  x_{(3)} = 5; \quad  x_{(4)} = 5; \quad  x_{(5)} = 6.
$$
The minimum value is $X_{(1)} = 2$, and the maximum value is $X_{(5)} = 6$.
The median value is $X_{(3)} = 5$.
:::


:::{.example}
Consider a sample of six die rolls, say $Y_i$:
$$
  y_1 = 1; \quad y_2 = 4; \quad  y_3 = 6; \quad  y_4 = 2; \quad  y_5 = 5 \quad  y_6 = 1.
$$
The order statistics are 
$$
  y_{(1)} = 1; \quad  y_{(2} = 1; \quad  y_{(3)} = 2; \quad  y_{(4)} = 4; \quad  y_{(5)} = 5; \quad  y_{(6)} = 6.
$$
The minimum value is $y_{(1)} = 1$, and the maximum value is $y_{(4)} = 6$.
The median value is $\left(X_{(3)} X_{(3)}\right)/2 = (2 + 4)/2 = 3$, which is not one of the observations in the sample.
:::


## Distribution of the $k$th order statistic

As with any statistic, the order statistics have a distribution.
If the sample is from a continuous distribution with density function\ $f_X(x)$ and distribution function\ $F_X(x)$, the density function of the $k$th order statistic $X_{(k)}$ is:
\begin{equation}
   f_{X_{(k)}}(x) = \frac{n!}{(k-1)! (n-k)!} [F(x)]^{k-1} [1 - F(x)]^{n-k} f(x)
   (\#eq:OrderStatisticDF)
\end{equation}

NEED PROOF

::: {.example}
Consider simulating $1\,000$ samples of size $n = 10$ from a Uniform$(0, 1)$ distribution.
The distribution of $X_{(2)}$ and $X_{(10)}$ (i.e., the maximum value) are shown in Fig.\  \@ref(fig:OrderStats1).
:::


```{r OrderStats1, echo=TRUE, fig.align="center", fig.cap="The distribution of two order statistics. Left: the distribution of $X_{(2)}$. Right: the distribution of  $X_{(10)}$ (i.e., the maximum value).", fig.width=8, fig.height=4, out.width="90%"}
set.seed(123)  # For reproducibility

n <- 10   # Take samples of size 10
samples2 <- replicate(1000,               # 1000 repetitions
                      sort(runif(n))[2])  # 2nd order statistic
samples10 <- replicate(1000,           # 1000 repetitions
                       max(runif(n)))  # 10th order statistic

par(mfrow = c(1, 2))

hist(samples2, 
     col = plotColour1, 
     las = 1,
     main = expression(Distribution~of~italic(X)[(2)]),
     xlab = expression(italic(X)[(2)]),
     ylab = "Density")
hist(samples10, 
     col = plotColour1, 
     main = expression(atop(Distribution~of~italic(X)[(10)]),
                            "("*the~maximum~value*")"),
     xlab = expression(italic(X)[(10)]),
     ylab = "Density")
```


:::{.example}
Develop the distribution of order statistics for, say, the uniform distribution and hence get var()X) and E(X).

For the continuous uniform distribution (Sect.\ \@ref(ContinuousUniform)) defined on $[0, 1]$, the density functioin is
\begin{equation}
   f_X(x; a, b)  = 1 \quad\text{for $0\le x\le 1$},
   (\#eq:ContinuousUniformPMForder)
\end{equation}
and the distribution function is
$$
  F_X(x; 0, 1) = 
  \begin{cases}
    0                & \text{for $x < 0$};\\
    \displaystyle x  & \text{for $0 \le x \le 1$};\\ 
    1                & \text{for $x > 1$}.
  \end{cases}
$$
Hence, Eq. \@ref(OrderStatisticDF) becomes
$$
   f_{X_{(k)}}(x) 
   = \frac{n!}{(k - 1)! (n - k)!} x^{k-1} (1 - x)^{n-k},
$$
for the $k$th order statistic in a sample of size\ $n$.
Since this is a density function, the total area must be one (confirm, using the beta distribution densoity????????????????????? Eq.\ \@ref(eq:BetaDistribution); exercise??).

The mean value of the $k$th order statistic (DEFN> PROOF) is
$$
  \operatorname{E}[X] = 
  \frac{n!}{(k - 1)! (n - k)!} \int_0^1 x \times x^{k-1} (1 - x)^{n-k}\,dx.
$$
The integral looks like a beta function in Eq.\ \@ref(eq:BetaFunction).

For example, in a sample of size $n= 10$, the second order statistic (i.e., $k = 2$) is
$$
   f_{X_{(k)}}(x) 
   = \frac{10!}{(1)! (8)!} x^{1} (1 - x)^{8}
   = 90 x (1 - x)^{8}
$$
for $0 < x < 1$.
Since this is a density function, the total area must be one (confirm!).
Using this density function, we can deduce that
$$
   \operatorname{E}[X] = 
$$
:::


## Theoretical vs Simulated Mean of $X_{(k)}$

For Uniform$(0, 1)$, the expected value of the $k$th order statistic in a sample of size\ $n$ is
$$
  \operatorname{E}[X_{(k)}] = k/(n+1).
$$ 
Let's compare that to our simulation:

```{r}
# 2nd order statistic
mean(samples2)   # Simulated mean of X_{(2)}
2 / (10 + 1)     # Theoretical value: 2/11 = 0.1818...

# 10th order statistic (i.e., maximum)
mean(samples10)   # Simulated mean of X_{(10)}
10 / (10 + 1)     # Theoretical value: 10/11 = 0.909...
```


## Closing Thoughts

Order statistics are fundamental in probability and statistics. 
They underlie robust estimation, reliability analysis, and form the basis of many intuitive statistics.

\index{Order statistics|)}


## Exercises  {#OrderStatisticsExercises}
