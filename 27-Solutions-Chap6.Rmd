## Answers for Chap. 6

:::{.answer}
**Answer to Exercise \@ref(exr:DiscreteXY).**

1. This corresponds to the cell $X = 1, Y = 2$:  the answer is $5/24\approx 0.208333$. 
2. $\Pr(X + Y \le 1) = \Pr(X = 0, Y = 0) + \Pr(X = 0, Y = 1) + \Pr(X = 1, Y = 0) = 1/2$.
3. $\Pr(X > Y) = \Pr(X = 1, Y = 0) = 1/4$.
4. Write:

\[
   p_X(x) = \begin{cases}
            7/24 & \text{if $x = 0$};\\
            17/24 & \text{if $x = 1$};\\
            0 & \text{otherwise}.
            \end{cases}
\]
5. Only consider the column corresponding to $X = 1$:

\[
   p_{Y\mid X = 1}(y\mid x = 1) = 
   \begin{cases}
            (1/4)/(17/24) = 6/17 & \text{if $y = 0$};\\
            (1/4)/(17/24) = 6/17 & \text{if $y = 1$};\\
            (5/24)/(17/24) = 5/17 & \text{if $y = 2$};\\
            0 & \text{otherwise}.
   \end{cases}
\]
:::


:::{.answer}
**Answer to Exercise \@ref(exr:AandBsimple).**

1. $13 + 4 = 17$.
2. $5 + 2 = 7$.
3. $(2\times 13) - (3\times 4) = 14$.
4. $(2^2\times 5) + (-3)^2\times 2) = 38$.
:::



:::{.answer}
**Answer to Exercise \@ref(exr:AandBsimple2).**

1. $17$.
2. $5 + 2 + 0.2 = 7.2$.
3. $14$.
4. $(2^2\times 5) + ((-3)^2\times 2) + (2\times -3\times 0.2) = 36.8$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:SampleMean).**
1. $\text{E}(\overline{X}) = \text{E}([X_1 + X_2 + \cdots + X_n]/n) = [\text{E}(X_1) + \text{E}(X_2) + \cdots + \text{E}(+ X_n)]/n = [n \mu]/n = \mu$. 
2. $\text{var}(\overline{X}) = \text{var}([X_1 + X_2 + \cdots + X_n]/n) = [\text{var}(X_1) + \text{var}(X_2) + \cdots + \text{var}(X_n)]/n^2 = [n \sigma^2]/n^2 = \sigma^2/n$. 
:::


:::{.answer}
**Answer to Exercise \@ref(exr:Mixture).**

1. Since $X + Y + Z = 500$, once the values of $X$ and $Y$ are known, the value of $Z$ has one specific value (i.e., all three values are not free to vary).
2. See Fig. \@ref(fig:Mixture) (left panel).
3. See Fig. \@ref(fig:Mixture) (right panel).
4. Proceed:
   \begin{align*}
     1 
     &= \int_{200}^{300} \!\! \int_{100}^{400 - y} k\,dx\,dy + 
        \int_{100}^{200} \!\! \int_{300 - y}^{400 - y}     k\,dx\,dy \\
     &= 30,000,
  \end{align*}
  so that $k = 1/30,000$.
:::


```{r Mixture, echo=FALSE, out.width = '100%', fig.width=9, fig.align="center", fig.cap="The sample space for the mixture of nuts and dried fruit"}

par( mfrow = c(1, 2) )

plot( x = c(0, 430),
      y = c(0, 450),
      type = "n",
      asp = 1,
      main = "The weight of nuts plus dried fruit\nis between 300g and 400g",
      xlab = expression(italic(X)),
      ylab = expression(italic(Y)),
      las = 1)
abline(v = 0, 
       lty = 1)
abline(h = 0,
       lty = 1)

polygon( x = c(0, 0, 400, 300),
         y = c(300, 400, 0, 0),
         lwd = 3,
         col = "grey")
arrows(x0 = 200,
       y0 = 400,
       x1 = 100,
       y1 = 300,
       angle = 15,
       length = 0.25)
text(200, 400,
     pos = 3,
     labels = expression(italic(X)+italic(Y)==400))


arrows(x0 = 300,
       y0 = 200,
       x1 = 200,
       y1 = 100,
       angle = 15,
       length = 0.25)
text(300, 200,
     pos = 3,
     labels = expression(italic(X)+italic(Y)==300))

########################

plot( x = c(0, 430),
      y = c(0, 450),
      asp = 1,
      type = "n",
      axes = FALSE,
      main = "A minimum of 100g of nuts\nand a minimum of 100g of dried fruit",
      xlab = expression(italic(X)),
      ylab = expression(italic(Y)),
      las = 1)
axis(side = 1,
     at = c(100, 300, 400, 500),
     labels = c(expression(plain(min)(italic(X))==100), 300, 400, 500))
axis(side = 2,
     las = 1,
     at = seq(0, 500, by = 100),
     labels = c(0, expression(plain(min)*(italic(Y))==100), 200, 300, 400, 500))
box()


abline(v = 0, 
       lty = 1)
abline(h = 0,
       lty = 1)

polygon( x = c(0, 0, 400, 300),
         y = c(300, 400, 0, 0),
         lwd = 1,
         lty = 2,
         col = "white")


lines( x = c(100, 100),
       y = c(0, 200),
       lty = 2)
lines( x = c(0, 200),
       y = c(100, 100),
       lty = 2)


polygon( x = c(100, 100, 300, 200),
         y = c(200, 300, 100, 100),
         lwd = 3,
         col = "grey")



```




:::{.answer}
**Answer to Exercise \@ref(exr:PoissonGammaRainfall).**

For one month:

```{r}
set.seed(932649)

NumRainEvents <- rpois(1,
                       lambda = 0.78)
MonthlyRain <- 0

if ( NumRainEvents > 0) {
     EventAmounts <- rgamma(NumRainEvents,
                           shape = 0.5,
                           scale = 6 )
     MonthlyRain <- sum( EventAmounts )
}
```

For 1000 simulations:

```{r}
set.seed(932649)

MonthlyRain <- array(0,  
                     dim = 1000)

for (i in 1:1000){
 NumRainEvents <- rpois(1,
                       lambda = 0.78)
 MonthlyRain[i] <- 0

  if ( NumRainEvents > 0) {
       EventAmounts <- rgamma(NumRainEvents,
                             shape = 0.5,
                             scale = 6 )
       MonthlyRain[i] <- sum( EventAmounts )
  }
}

# Exact zeros:
sum(MonthlyRain == 0) / 1000
mean(MonthlyRain)
mean(MonthlyRain[MonthlyRain > 0])
```
:::


:::{.answer}
**Answer to Exercise \@ref(exr:JointPDF).**

1. Need integral to be one: $\displaystyle \int_0^1\!\!\!\int_0^1 kxy\, dx\, dy = 1$, so $k = 4$.
1. Here:
\[
   4 \int_0^{3/8}\!\!\!\int_0^{5/8} kxy\, dx\, dy = 225/4096\approx 0.05493.
\]
:::




:::{.answer}
**Answer to Exercise \@ref(exr:LinearCombinCovariance).**

1. $\text{E}[U] = \mu_x - \mu_Z$;  $\text{E}[V] = \mu_x - 2\mu_Y + \mu_Z$.
1. $\text{var}[U] = \sigma^2_x + \sigma^2_Z$;  $\text{E}[V] = \sigma^2_x + 4\sigma^2_Y + \sigma^2_Z$.
1. Care is needed!  
\begin{align*}
    \text{Cov}[U, V]
  &= \text{E}[UV] - \text{E}[U]\text{E}[V]\\
  &= \text{E}[X^2 - 2XY + XZ - XZ + 2YZ - Z^2] - \\
  &\qquad (\mu_X^2 + 2\mu_X\mu_Y + \mu_X\mu_Z - \mu_X\mu_Z - 2\mu_Y\mu_Z - \mu^2_z)\\
  &= (\text{E}[X^2] - \mu_X^2) - 2(\text{E}[XY] - \text{E}[X]\text{E}[Y]) + 2(\text{E}[YZ] - \mu_Y\mu_Z)  -\\
  &\qquad (\text{E}[Z^2] - \mu_Z^2)\\
  &= \sigma^2_X - \sigma^2_Z,
\end{align*}
since the two middle terms become $-2\text{Cov}[X, Y] + 2\text{Cov}[Y, Z]$, are both are zero (as given).
1. The covariance is zero if $\sigma^2_X = \sigma^2_Z$.
:::




:::{.answer}
**Answer to Exercise \@ref(exr:JointDiscrete11).**

1. First, $\Pr(Y = 2) = 3/11$.
   Note that for $Y = 2$, the probability function is non-zero only for $x = 0$ and $x = 1$.
   Then, the marginal distribution is
   
   \[
      p(X\mid Y = 2) =
      \begin{cases}
        2/3 & \text{for $x = 0$};\\
        1/3 & \text{for $x = 1$.}
      \end{cases}
    \]
    So $\text{E}(X | Y = 2) = 1/3$.
2. First, $\Pr(X\ge 1) = 5/11$, and the probability function is non-zero for $y = 1, 2, 3$.
   Then
   
   \[
     p(Y\mid x\ge 1) = 
     \begin{cases}
        1/5 & \text{for $y = 1$};\\
        1/5 & \text{for $y = 2$};\\
        3/5 & \text{for $y = 3$}.
     \end{cases}
   \]
   Then, $\text{E}(Y \mid X\ge 1) = 12/5$.
:::


:::{.answer}
**Answer to Exercise \@ref(exr:CorrContDist).**

1. We find $f_X(x) = 1$ for $0 < x < 1$ and $f_Y(y) = 1$ for $0 < y < 1$.
2. Independence if $f_X(x) \times f_Y(y) = f_{XY}(x, y)$, which occurs only when $\alpha = 0$.
3. We need some intermediate values: 

   * $\text{E}(X) = \text{E}(Y) = 1/2$;
   * $\text{var}(X) = \text{var}(Y) = 1/12$;
   * $\text{E}(XY) = (9 - \alpha)/36$.
   
   Then $\text{Cov}(X, Y) = -\alpha/36$ and so $\text{Cor}(X, Y) = -\alpha/3$.
4. $\Pr(X < Y) = \int_0^1\!\!\int_y^1 1 - \alpha(1 - 2x)(1 - 2y)\, dx\, dy = 1/2$.
:::



:::{.answer}
**Answer to Exercise \@ref(exr:FairCoinTossedTwice).**

1. Construct table (below) from listing all four outcomes.
1. We get
\[
  p_X(x) = 
  \begin{cases}
     1/4 & \text{for $x = 0$};\\
     1/2 & \text{for $x = 1$};\\
     1/4 & \text{for $x = 2$}.
  \end{cases}
\]
1. When given $Y = 1$, then the probability function is non-zero for $x = 1, 2$:

\[
  p_{X|Y = 1}(x \mid Y = 1) = 
  \begin{cases}
     1/2 & \text{for $x = 1$};\\
     1/2 & \text{for $x = 2$};
  \end{cases}
\] 
1. Not independent; for instance, when $Y = 0$, $\Pr(X) > 0$ for $x =   0, 1$, in constrast to when $Y = 1$.
:::

   .    | $X = 0$ | $X = 1$ | $X = 2$ |
--------| --------|---------|---------|
$Y = 0$ | $1/4$   | $1/4$   | $0$     |
$Y = 1$ | $0$     | $1/4$   | $1/4$   |
:::


:::{.answer}
**Answer to Exercise \@ref(exr:DiceMinMax).**
The joint probability function is shown in Table \@ref(tab:DiceMinMaxTab).
For example:

* A minimum of 2 and a maximum of 1 is impossible; this makes no sense (hence probability is zero).
* A minimum of 3 and a maximum of 4 can happen in two ways: A 4 on the first die and a 3 on the other, or a 3 on the first die and a 4 on the other.
* A minimum *and* a maximum of 2 can only happen one way: both dice show a 2.

Then, the marginal distribution for $B$ (the minimum) is  
\[
   f_B(b) =
   \begin{cases}
       11/36 & \text{for $b = 1$};\\
       9/36 & \text{for $b = 2$};\\
       7/36 & \text{for $b = 3$};\\
       5/36 & \text{for $b = 4$};\\
       3/36 & \text{for $b = 5$};\\
       1/36 & \text{for $b = 6$}
   \end{cases}
\]
which is easily confirmed as a valid pmf.


```{r DiceMinMaxTab, echo=FALSE}
DiceMinMax <- array( 0, 
                     dim = c(6, 6))

colnames(DiceMinMax) <- c("$\\text{min} = 1$",
                          "$\\text{min} = 2$",
                          "$\\text{min} = 3$",
                          "$\\text{min} = 4$",
                          "$\\text{min} = 5$",
                          "$\\text{min} = 6$")
rownames(DiceMinMax) <- c("$\\text{max} = 1$",
                          "$\\text{max} = 2$",
                          "$\\text{max} = 3$",
                          "$\\text{max} = 4$",
                          "$\\text{max} = 5$",
                          "$\\text{max} = 6$")
DiceMinMax[1, ] <- paste0( c(1, 0, 0, 0, 0, 0), "/36")
DiceMinMax[2, ] <- paste0( c(2, 1, 0, 0, 0, 0), "/36")
DiceMinMax[3, ] <- paste0( c(2, 2, 1, 0, 0, 0), "/36")
DiceMinMax[4, ] <- paste0( c(2, 2, 2, 1, 0, 0), "/36")
DiceMinMax[5, ] <- paste0( c(2, 2, 2, 2, 1, 0), "/36")
DiceMinMax[6, ] <- paste0( c(2, 2, 2, 2, 2, 1), "/36")


DiceMinMax.caption <- "The minimum and maximum from two rolls of a die"
if( knitr::is_latex_output() ) {
  knitr::kable(DiceMinMax,
               format = "latex",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               escape = FALSE,
               linesep = c("", "", "\\addlinespace"),
               caption = DiceMinMax.caption) %>%
    kable_styling(font_size = 10) %>%
    row_spec(0, bold = TRUE) %>%
    column_spec(1, bold = TRUE)
}
if( knitr::is_html_output() ) {
  knitr::kable(DiceMinMax,
               format = "html",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               caption = DiceMinMax.caption) %>%
    row_spec(0, bold = TRUE) 
}


```


:::



:::{.answer}
**Answer to Exercise \@ref(exr:GammaExp).**

For an exponential distribution, the mgf is $M_X(t) = (1 - \beta t)^{-1}$.
Now, the mgf is a sum is the product opf the mgfs (see Theorem \@ref(thm:MGFIndependent)), so the mgf of $W = Z_1 + Z_2 + \cdots + Z_n$ is

\[
   M_W(t) = \prod_{i = 1}^n (1 - \beta t)^{-1} =  (1 - \beta t)^{-n},
\]
which is the mgf of a gamma distribution with parameters $n$ and $\beta$, as to be shown. 
:::



:::{.answer}
**Answer to Exercise \@ref(exr:DiscreteJointTable).**


1. Adding:
\[
  p_X(x) = 
  \begin{cases}
    0.40 & \text{for $x = 0$};\\
    0.45 & \text{for $x = 1$};\\
    0.15 & \text{for $x = 3$}.
  \end{cases}
\]
2. $\Pr(X \ne Y) = 1 - \Pr(X = Y) = 1 - (0.20) = 0.80$.
3. $X < Y$ only includes these five $(x, y)$ elements of the sample space: 
   $\{ (0, 1), (0, 2), (0, 3); (1, 2), (1, 3)\}$.
   The sum of these probabilities is 0.65.  
   
   Then, **given** these five, only two of them sum to three (i.e., $(0, 3)$ and $(1, 2)$).
   So the probability of the **intersection** is $\Pr( \{0, 3\} ) + \Pr( \{1, 2\}) = 0.30$.  
   
   So the conditional probability is $0.30/0.65 = 0.4615385$, or about 46%.
4. No: For $X = 0$, the values of $Y$ with non-zero probability are $Y = 1, 2, 3$.
   However, for $X = 1$ (for example), the values of $Y$ with non-zero probability are $Y = 1, 2$.
:::




:::{.answer}
**Answer to Exercise \@ref(exr:DailyRainfallSim).**

```{r echo=FALSE}
set.seed(8584444)
```
```{r echo=TRUE}
annualRainfallList <- array( NA, dim = 1000)
for (i in 1:1000){
   rainAmounts <- array( 0, dim = 365) # Reset for each simulation

    wetDays <- rbinom(365, size = 1, prob = 0.32) # 1: Wet day
   locateWetDays <- which( wetDays == 1 )


   rainAmounts[locateWetDays] <- rgamma( n = length(locateWetDays),
                                         shape = 2,
                                         scale = 20)
   annualRainfallList[i] <- sum(rainAmounts)
}
# hist( annualRainfallList)
```

```{r echo=FALSE}
set.seed(8584444)
```
```{r echo=TRUE}
Days <- 1 : 365
prob <- (1 + cos( 2 * pi * Days/365) ) / 2.2

annualRainfallList2 <- array( NA, dim = 1000)
for (i in 1:1000){

  wetDays <- rbinom(365, size = 1, prob = prob) # 1: Wet day
  
  locateWetDays <- which( wetDays == 1 )
  
  rainAmounts2 <- array( 0, dim = 365)
  
  rainAmounts2[locateWetDays] <- rgamma( n = length(locateWetDays),
                                         shape = 2,
                                         scale = 20)
   annualRainfallList2[i] <- sum(rainAmounts2)
}
#hist( annualRainfallList2)
```

```{r echo=FALSE}
set.seed(8584444)
```
```{r echo=TRUE}
Days <- 1 : 365

probList <- array( dim = 365)
probList[1] <- 0.32

annualRainfallList3 <- array( NA, dim = 1000)

for (i in 1:1000){
  
  rainAmounts <- array( dim = 365 )

  for (day in 1:365) {
    if ( day == 1 ) {
      probList[1] <- 0.32
      wetDay <- rbinom(1, 
                       size = 1, 
                       prob = probList[1]) # 1: Wet day
      rainAmounts[1] <- rgamma( n = 1,
                                shape = 2,
                                scale = 20)

    } else {
    
      probList[i] <- ifelse( rainAmounts[day - 1] == 0,
                             0.15,
                             0.55)
      wetDay <- rbinom(1, 
                       size = 1, 
                       prob = probList[i]) # 1: Wet day

      if (wetDay) {
        rainAmounts[day] <- rgamma( n = 1,
                                    shape = 2,
                                    scale = 20)
      } else {
        rainAmounts[day] <- 0
      }
    }
  }
  annualRainfallList3[i] <- sum(rainAmounts)
    
}

#hist( annualRainfallList3)
```
:::




:::{.answer}
**Answer to Exercise \@ref(exr:JointTriangular).**

1. See Fig. \@ref(fig:TriRegion).
1. Need to integrate correctly; e.g., $\displaystyle \int_0^2 \!\!\!\int_0^{2 - x} x(y + 1)\,dy \, dx = 2$, so $c = 1/2$.
1. $P(Y < 1 \mid X > 1) = P(Y < 1 \cap X > 1)/\Pr(X > 1)$.
   First, $f_X(x) = (1/2) \int_0^{2 - x} x(y + 1)\,dy =  (1/4)(x^3 - 6x^2 + 8x)$ for $0 < x < 2$.
   So $\Pr(X > 1) = 7/16$.
   Also, 
   
   \[
      P(Y < 1 \cap X > 1)
      =  (1/2) \int_1^2 \!\!\!\int_0^{2 - x} x(y + 1)\,dy \, dx
      = 7/16.
   \]
   Then, $P(Y < 1 \mid X > 1) = 1$, which makes sense from the diagram (if $X > 1$, $Y$ *must* be less than 1).
1. $P(X < 1 \mid X > 0.25) = P(X < 1 \cap X > 0.25)/\Pr(X > 0.25)$.
   Using results from above, $\Pr(X > 0.25) = 2079/4096$ and $P(X < 1 \cap X > 0.25) = ??$.
1. First, $f_Y(y) = \frac{1}{2} \int_0^{2 - y} x(y + 1)\, dx = \frac{1}{4}(y + 1)(y - 2)^2$.
   Then, 
   \[
     \Pr(Y < 1) = \int_0^1 \frac{1}{4}(y + 1)(y - 2)^2\, dy = \frac{13}{16}.
   \]
:::

```{r TriRegion, echo=FALSE, fig.align="center", fig.cap="The region where $X$ and $Y$ have positive probability"}
plot( x = c(-0.5, 3),
      y = c(-0.5, 3),
      type = "n",
      las = 1,
      xlab = expression(italic(x)),
      ylab = expression(italic(y)))

polygon( x = c(0, 0, 2, 0),
         y = c(0, 2, 0, 0),
         col = "grey")
lines( x = c(0, 2),
       y = c(2, 0),
       lwd = 2)
abline(v = 0, 
       lwd = 2)
abline(h = 0,
       lwd = 2)
text(1.75, 1.75,
     pos = 3,
     expression( italic(y) == 2 - italic(x) ))
arrows( x0 = 1.75,
        y0 = 1.75,
        x1 = 1,
        y1 = 1,
        angle = 15,
        length = 0.15)
```





:::{.answer}
**Answer to Exercise \@ref(exr:JointQuad).**

1. Proceed:  
\begin{align*}
   1 
   &= k\int_0^1\!\!\!\int_0^{\sqrt{y}} (1 - x)y\, dx\, dy\\
   &= k\int_0^1\!\!\!\int_{x^2}^{1} (1 - x)y\, dy\, dx\\
   &= \frac{k}{2}\int_0^1 (1 - x) (1 - x^4) \, dx\\
   &= \frac{7k}{30},
\end{align*}
so that $k = 30/7\approx 4.285714$.
2. Being careful with the integration limits again (draw a diagram!):  
\begin{align*}
   \Pr(X > Y)
   &= \int_0^1 \!\int_y^{\sqrt{y}} f(x, y)\, dx\, dy\\
   &= \int_0^1 \!\int_x^{x^2} f(x, y)\, dy\, dx\\
   &= \frac{15}{7} \int_0^1 (x - 1) x^2 (x^2 - 1)\, dx\\
   &= 3/28\approx 0.1071429.
\end{align*}
3. First find the marginal distribution of $X$:  
\[
  f_X(x) = \int_{x^2}^1 f(x, y)\, dy = \frac{15}{7} (x - 1)(x^4 - 1),
\]
and so
\[
   \Pr(X > 0.5) =  \frac{15}{7} \int_{1/2}^1 (x - 1)(x^4 - 1)\, dx = \frac{183}{896}\approx 0.2042411.
\]
:::

