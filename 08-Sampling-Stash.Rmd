

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Self-assessment exercises}

The following exercises are designed to provide practice at problem-solving
based on the material in this module. Solutions are provided at the end of the module.
Additional exercises are available in the next section and in the textbook.

\begin{exercises}

\item A random sample of size 81 is taken from a population with
mean 128 and standard deviation 6.3. What is the probability
that the sample mean will \emph{not} fall between 126.6 and
129.4?
\begin{answer}
Let the rv be $X$ so that $\text{E}(X) = 128$ and $\text{Var}(X)=(6.3)^2$.
Then the distribution of the sample mean will be (by the Central
Limit Theorem) $\bar{X}\sim N(128,(6.3)^2/81)$. Then
\begin{align*}
   \Pr{126.6 < \bar{X} < 129.4}
   &=\Pr{\frac{126.6-128}{6.3/\sqrt{81}} < Z < \frac{129.4-128}{6.3/\sqrt{81}}} \\
   &=\Pr{-2 < Z < 2}\\
   &=0.9544
\end{align*}
 So the required answer is
\[
   \Pr{\bar{X}<126.6 \text{ or }\bar{X}>129.4} = 1 - 0.9544 = 0.0456.
\]
\end{answer}

\item Let $Y_1$, $Y_2$, $\dots$, $Y_n$ be $n$ independent random
variables, each with probability density function
\[
   f_Y(y) = \begin{cases}
               3y^2 & \text{for $0\le y \le 1$}\\
               0 & \text{otherwise}
            \end{cases}
\]
Determine the probability that the sample mean will be within one
standard deviation of the population mean, using the Central Limit
Theorem.
\begin{answer}
The mean of $Y$ is
\[
   \text{E}(Y) = \int_0^1 y(3y^2)\, dy = 3/4.
\]
Similarly, $\text{E}(Y^2) = 3/5$ so that $\text{Var}(Y) = 3/80$. Hence, by the
CLT, $\overline{Y}\sim N(3/4, 3/(80n) )$. Therefore
\[
   \Pr{ 3/4 - \sqrt{3/80} < \overline{Y} < 3/4 + \sqrt{3/80} }
   = \Pr{0.56 < \overline{Y} < 0.94}
\]
is required. So for a sample of size $n$,
\[
   \Pr{ \frac{0.56 - 0.75}{0.19/\sqrt{n}} < Z < \frac{0.56 - 0.75}{0.19/\sqrt{n}} }
   = \Pr{-\sqrt{n} < Z < \sqrt{n} }
\]
which approaches one as $n\to\infty$. For example, if $n=10$,\\
$\Pr{-\sqrt{10} < Z < \sqrt{10} } = 0.9984$.
\end{answer}

\item Suppose the weights of eggs in a dozen carton actually have
a weight that is normally distributed with mean $59$ and variance
$0.7$.
\begin{enumerate}
\item Find the probability that the sample mean weight will exceed
$59.5$ grams. \item Find the probability that a sample of twelve
eggs will produce a sample variance of greater than $1$.
\end{enumerate}

\begin{answer}
\begin{enumerate}
\item Let the weight be $E$, so that $E\sim N(59, 0.7)$. Then by
the CLT, the sample means have the distribution $\overline{E} \sim
N(59, 0.7/12)$. So
\[
   \Pr{\overline{E}>59.5} = \Pr{Z>\frac{59.5 - 59}{\sqrt{0.7/12}}}
   = \Pr{z>2.07}\approx 0.019
\]
\item We seek $\Pr{s^2>1}$. We know
that
\[
   \frac{(n-1)s^2}{\sigma^2}\sim \chi^2_{n-1}
\]
where $n=12$ and $\sigma^2=0.7$. So
\begin{align*}
   \Pr{s^2>1}
   &= \Pr{ \frac{11 s^2}{0.7} > \frac{11\times 1}{0.7} }\\
   &=\Pr{ \chi^2_{11} > 15.714}\\
   &\approx 0.152
\end{align*}


\end{enumerate}
\end{answer}

\item In a carton of a dozen eggs, the number that are broken has
a Poisson distribution with mean $0.2$. Find the probability that
the sample mean of the number of broken eggs per carton is more
than one.
\begin{answer}
Let the number broken be $B$, so $B \sim \text{Pois}(0.2)$. The
sample mean number broken will have the distribution
$\overline{B}\sim N(0.2, 0.2/\sqrt{12})$ approx. So
\[
   \Pr{B\ge 1} = \Pr{Z>\frac{1-0.2}{\sqrt{0.2\sqrt{12}}}} = \Pr{Z>6.196} = 0.
\]
In contrast, in any one carton, the probability of more than one
broken egg is
\[
   \Pr{B>1} = 1 - \Pr{B-0} = 1 - 0.8187 = 0.181
\]
using the Poisson distribution.

\end{answer}

\item

The random variable $M$ has the following probability density
function
\[
    f_M(m) = \begin{cases}
                   3m^2 & \text{for $0<m<1$}\\
                   0    & \text{otherwise}
              \end{cases}
\]
A random sample of size $9$ is taken from the distribution, and
the sample mean $\overline{M}$ is computed.

\begin{enumerate}
   \item
   Compute the mean of $M$.
   \item
   Compute the variance of $M$.
    \item
    State the approximate distribution of $\overline{M}$
    including the parameters of the distribution.
    \item
    Compute the probability that the sample mean will be within
    $0.1$ of the true mean.
\end{enumerate}

\begin{answer}
(a) $\text{E}(M)=3/4$ (b) $\text{Var}(M)=3/80$ (c) $\overline{M}\sim N(3/4, 1/240)$
approx\\
(d) $0.8788$
\end{answer}


\item\label{QN:R6.1}
(Computer exercise) Simulate a random samples $X_1,X_2,\dots,X_9$, of size 9 from
a $N(2,36)$ distribution.
Obtain the mean and variance of $\ds \sum X_i$ and $\overline{X}$.
Verify they are approximately as expected.

\begin{answer}
\Method: Generate 9 random samples of size 100 from a $N(2, 36)$ distribution
and put them in 9 columns of an array with 100 rows. We now consider each row
to be a random sample of size 9 (so we have 100 random samples of size 9).
Use the {\sf apply} function to get the row sums and means.
\begin{verbatim}
nsim<-100
nsamp<-9
sim.mat<-matrix(0,nrow=nsim,ncol=nsamp)
for ( i in 1:9){
sim.mat[,i]<-rnorm(mean=2,sd=6,n=100)
               }
row.totals<-apply(sim.mat,MARGIN=1,FUN=sum)
row.means<-apply(sim.mat,MARGIN=1,FUN=mean)
results<-array(0,dim=c(1,4))
results<-c(mean(row.totals),var(row.totals),mean(row.means),var(row.means))
\end{verbatim}
\end{answer}



\end{exercises}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Exercises}


\begin{exercises}

\item Consider the random variable $A$, defined as
\[
    A = \frac{Z}{\sqrt{W/\nu}},
\]
where $Z$ has a standard normal distribution independent of $W$
which has a $\chi^2$ distribution with $\nu$ degrees of freedom.
Also, consider the random variable $B$, defined as
\[
    B = \frac{W_1/\nu_1}{W_2/\nu_2},
\]
where $W_1$ and $W_2$ are independent $\chi^2$ variables with
$\nu_1$ and $\nu_2$ degrees of freedom respectively.

\begin{enumerate}
   \item
   Write down
   (do not derive)
   the distribution of the random variable $A$,
   including the parameters of the distribution.
   \item
   Write down
   (do not derive)
   the distribution of the random variable $B$,
   including the parameters of the distribution.
    \item
    Deduce that the distribution of $A^2$ is a special case
    of the distribution of $B$,
    and state the values of the parameters for which this is true.
\end{enumerate}


\item
A manufacturer makes metal tubes which must fit into metal sleeves.
The metal tubes have an average diameter of 1cm with a standard deviation of 0.005\,cm.
The sleeves have an average interior diameter of 1.01cm with a standard deviation of .004\,cm.
Both diameters are assumed to be normally distributed.
\begin{enumerate}
\item What is the probability that a randomly selected tube will fit into a
randomly selected sleeve?
\item What is the probability that tube will fit and that the difference in diameters
will be less than 0.015\,cm?
\item What is the probability that the average diameter of 10 randomly
selected tubes will be less than 1.005\,cm?
\end{enumerate}

\begin{answer}
(a) 0.94 (b) 0.7686 (This is a conditional probability!) (c) 0.9921
\end{answer}


\item
A manufacturing plant produces 4 tonnes of its product on a particular day
with a standard deviation of 0.2 tonnes per day. Find the probability that in
a 20 day period the plant will produce less than 78 tonnes of product if daily
productions can be assumed independent.

\begin{answer}
Let $Y=X_1+X_2+\cdots+X_{20}$ and use Theorem~\ref{TM:CLTgen}. Ans=.01255.
\end{answer}


\item (Computer exercise)
Let $Y$ be the change in depth of a river from one day to the next measured
(in cms) at a specific location. Assume $Y$ is uniformly distributed for
$y \in [-70,70]$.
\begin{enumerate}
\item  Find the probability that the mean change in depth
for a period of 30 days will be greater than 10\,cms.
\item Use simulation to estimate the probability in (a).
\end{enumerate}

\begin{answer}
(a) Use Theorem~\ref{TM:CLT} (b) Use Theorem~\ref{TM:CLTgen}
\end{answer}


\item
The number of deaths per year due to typhoid fever is assumed to have
a Poisson distribution with rate $\lambda=4.6$ per year.
\begin{enumerate}
\item If deaths from year to year can be assumed
to be independent what is the distribution over a 20 year period?
\item Find the probability that there will be more than 110 deaths due
to typoid in period of 20 years.
\end{enumerate}

\begin{answer}
(a) A sum of Poisson variates is also Poisson. (b) 0.0303
\end{answer}


\item (Computer exercise)
The probability that a cell is a lymphocyte is 0.2.
\begin{enumerate}
\item Write down an exact expression for the probability
that in a sample containing 150 cells that at least 40 are lymphocytes.
Evaluate this expression using \R.
\item Write down an approximate expression for this probability and evaluate it.
\end{enumerate}

\begin{answer}
(a) Use {\sf pbinom}. (b) Use an approximation to the binomial distribution. Ans = 0.0262
\end{answer}


\item (Computer exercise)
Suppose that the probability of a person aged 60--64 dying after receiving
influenza vaccine is 0.006. In a sample of 200 persons aged 60--64 years:
\begin{enumerate}
\item Write down an exact expression for the probability that more than 5
will die after vaccination for influenza. Evaluate this expression using \R.
\item Write down an approximate expression for this probability and evaluate it.
\item Simulate (a) using \R.
\item If 4 persons died in the sample of 200 what conclusion would you make about the
probability of dying after vaccination?
\end{enumerate}

\begin{answer}
(a) Use {\sf pbinom}. (b) Use an approximation to the binomial distribution.
Ans = 0.00143
(c) Use {\sf rbinom} to simulate 1000 outcomes. Tabulate the results.
\end{answer}

\item\label{QN:6.6}
(Computer exercise) Illustrate the Central Limit Theorem for the uniform
distribution on $[-1,1]$ by simulation and repeated sampling.

\begin{answer}
\Method: Generate a random sample of size 100 from a distribution which is
uniform on $[-1,1]$. Draw a density of the random sample and test it for
normality.\\
Generate a second random sample of size 100, sum the two and plot the density of the sum.
Test the sum for normality.\\
Continue the process, adding a third, fourth, .... sample to the sum. At each
step draw the density and test the sum for normality. Continue until it appears
you have achieved convergence to a normal distribution. (Normality should
be achieved reasonably quickly, stop if a satisfactory result has still not
been obtained after generating 12 samples.)\\
Draw a histogram of the initial sample and the final sum.\\[2mm]
To test for normality use the {\sf qqnorm} function
to get a normal probability plot. The graph should be an approximate straight
line.

\begin{verbatim}
samsz<-100
nruns<-5
par(mfrow=c(1,2),oma=c(4,4,8,4))    # sets up the plotting window
u1<-runif(n=samsz,min=-1,max=1)
hist(u1)
qqnorm(u1)
locator(1)  #  this means click the left button on the graph to proceed
u2<-u1
for ( i in 1:nruns){
u2<-u2+runif(n=samsz,min=-1,max=1)
hist(u2)
qqnorm(u2)
mtext(paste("Summation number ",i,sep=""),side=3,outer=T)
locator(1)      }
\end{verbatim}
\end{answer}


\item (Computer exercise)
Demonstrate the Central Limit Theorem using \R.
\begin{enumerate}
\item For the uniform distribution, where $-1 < x < 1$, (a symmetric distribution).
\item For the exponential distribution with parameter 1, (a skewed distribution).
\end{enumerate}

\begin{answer}
See Exercise~\ref{QN:6.6}.
\end{answer}

\item\label{QN:R6.2}
(Computer exercise) Suppose we again have random samples, $X_1,X_2,\dots,X_9$,
of size 9 from a $N(2,36)$
distribution. Estimate the mean and variance of
\[X_1+2X_2-X_3+3X_4-2X_5+X_6-4X_7+2X_8-X_9.\]
Verify it is approximately as expected.

\begin{answer}
Use the same simulations as in Exercise~\ref{QN:R6.1},
We get the weighted sum by matrix multiplication, eg

\begin{align*}
\overbrace{\begin{bmatrix}
Y_1\\Y_2\\Y_3\\ \vdots\\Y_{100}
\end{bmatrix}}^{\text{\hidewidth weighted sum\hidewidth}}=\,&
\overbrace{\begin{bmatrix}
X_{1,1}&X_{1,2}&X_{1,3}& X_{1,4} & X_{1,5} & X_{1,6} & X_{1,7} & X_{1,8}
& X_{1,9} \\
 X_{2,1}& X_{2,2}& X_{2,3} & X_{2,4} & X_{2,5} & X_{2,6} & X_{2,7} &
X_{2,8} & X_{2,9} \\
 X_{3,1}& X_{3,2}& X_{3,3} & X_{3,4} & X_{3,5} & X_{3,6} & X_{3,7} &
X_{3,8} & X_{3,9} \\
 \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots &
\vdots \\
 X_{100,1}&X_{100,2}&X_{100,3}&X_{100,4}&X_{100,5}&X_{100,6}&X_{100,7}&X_{100,8}&X_{100,9}
 \end{bmatrix}}^{\text{sim.mat}}\\
&\times
\overbrace{\begin{bmatrix}
W_1\\W_2\\W_3\\W_4\\W_5\\W_6\\W_7\\W_8 \\W_9
\end{bmatrix}}^{\text{weights}}
\end{align*}

\begin{verbatim}
weights<-c(1,2,-1,3,-2,1,-4,2,-1)
weighted.sum<-sim.mat %*% weights   # matrix multiplication
print(mean(weighted.sum))
print(var(weighted.sum))
\end{verbatim}
\end{answer}

\item
(Computer exercise) Generate 100 random samples, $X_1,X_2,X_3,X_4$,
of size 4 from a $N(2,6^2)$ distribution.
\begin{enumerate}
\item Determine the covariance of $(X_1+X_2+X_3+X_4)$ and $(6X_1+3X_2+3X_3+4X_4$).
\item Also determine the covariance of $(X_1+X_2-X_3-X_4)$ and $(X_1-X_2+X_3-X_4)$.
\item How do the estimated values compare to the theoretical values?
\end{enumerate}

\begin{answer}
We apply the same computing strategies as in Exercises~\ref{QN:R6.1}
and \ref{QN:R6.2} but for each simulation, we are generating a matrix of normal rv's.
\begin{verbatim}
nsim<-100
sampsz<-8
cov.mat<-matrix(0,nrow=nsim,ncol=2)  # ncol=2 to capture the 2
covariances
X<-matrix(0,nrow=8,ncol=4)           # the object to store each
simulation
for ( i in 1:nsim){
    for (j in 1:4) X[,j]<-rnorm(mean=2,sd=6,n=8)
#     matrix multiplication to make the weighted sums
Y1<-X %*% c(1,1,1,1)
Y2<-X %*% c(6,3,3,4)
Y3<-X %*% c(1,1,-1,-1)
Y4<-X %*% c(1,-1,1,-1)
R1<-cov(Y1,Y2)       #  this is a 2 X 2 covariance matrix
R2<-cov(Y3,Y4)
cov.mat[i,1]<-R1   # row i corresponds to simulation i
cov.mat[i,2]<-R2
}
print(apply(cov.mat,MARGIN=2,FUN=mean))
\end{verbatim}
\end{answer}

\item
(Computer exercise) Simulate Example~\ref{EG:6.4} and so estimate the
probability that a pile of 25 envelopes will not be counted as
such.

\begin{answer}
\begin{verbatim}
nsim<-1000
excl<-0
for ( i in 1:nsim){
sumwt<-sum(rnorm(mean=3,sd=0.6,n=25))
#   use the OR operator  - "||"
if (sumwt>=80 || sumwt<=70 ) excl<-excl+1   # too heavy or too light
   }
Pexcl<-excl/nsim
print(Pexcl)
\end{verbatim}
\end{answer}


\item
(Computer exercise) Simulate Example~\ref{EG:6.6} with \R.

\begin{answer}
\begin{verbatim}
nsim<-500
plungers<-rnorm(mean=2.1,sd=0.1,n=nsim)
cylinders<-rnorm(mean=2.3,sd=0.05,n=nsim)
oversize<-cylinders-plungers
Pnotfit<-sum(oversize<=0)/nsim
print(Pnotfit)
\end{verbatim}
There were 15 of the 500 plungers that did not fit, giving an estimate of
0.03  for the probability that a plunger would not fit.
\end{answer}


\item
(Computer exercise) Use simulation to estimate $\Pr{V>105}$ in
Example~\ref{EG:voltages}.

\begin{answer}
\begin{verbatim}
nsim<-1000
exceed<-numeric(0)
for ( i in 1:nsim){
sumVi<-sum(runif(n=20,min=0,max=10))
exceed<-c(exceed,sumVi>105)
  }
Pexc<-sum(exceed)/nsim
print(Pexc)
\end{verbatim}

My overall result: I used a sample size of $n=1000$ by repeating the above 10 times
and obtained 346 samples with a sum greater than 105. Hence
my estimate of $\Pr{V>105} = 0.346$.
\end{answer}

\item
(Computer exercise) Simulate the result of Example~\ref{EG:dieclt} with \R.

\begin{answer}
\begin{verbatim}
nsim<-1000
nthrows<-12
exceed52<-numeric(0)
for ( i in 1:nsim){
faces<-sample(1:6,replace=T,size=nthrows)
exceed52<-c(exceed52,sum(faces)>=52)  # a collection of 1's or 0's
          }
Pexc<-sum(exceed52)/nsim
print(Pexc)
\end{verbatim}
\end{answer}


\end{exercises}


\makeanswers

\endinput


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%unused qns
