# Random variables and their distributions {#DistributionRandomVariables}

::: {.objectivesBox .objectives data-latex="{iconmonstr-target-4-240.png}"}
Upon completion of this chapter, you should be able to:

* distinguish between discrete, continuous and mixed random variables.
* determine the probability function of random variables defined for a random process.
* determine the distribution function of a random variable from its probability function.
* apply probability functions and distribution functions to compute probabilities for defined events.
* plot the probability function and distribution function of a random variable.
:::


## Random variables {#RandomVariables}

Chapter\ \@ref(ChapterProbability) introduced the language and tools of probability to describe uncertainty.
The concept of the [*sample space*](#def:SampleSpace) was introduced, which describes the possible outcomes of a [*random process*](#def:RandomProcess).
Often, however, the individual elements of the sample space are not directly of interest, especially if the sample space is large or infinite.
Subsets of these sample space elements are usually of greater interest and more convenient to work with.

For example, the sample space for the observing the rolls of two dice (Example\ \@ref(exm:TwoDice)) contains\ $36$ elements.
We may be interested in the *sum* of the two rolls, rather than which elements in the sample space produce a given sum.
That is, we may be more interested in *whether* we roll a sum of\ $5$ than *how* that sum of\ $5$ was obtained, or *which* elements of the sample space give rise to a sum of\ $5$.
The various  elements of the sample space that are of interest can be collected together, and treated as a collective.

More generally, collecting elements of the sample space together is useful, and we can assign a real number to that collection.
This leads to the idea of a *random variable*.
*Random variable* may be abbreviated to 'rv' or 'RV'.


:::{.definition #RandomVariable name="Random variable"}
A *random variable*\index{Random variable} is a function that assigns a real number to each outcome\ $s$ in the sample space\ $S$.
A random variable\ $X$ maps $s\to\mathbb{R}$, and the value assigned to an outcome $s\in S$ is written\ $X(s)$.
:::


Many random variables take only integer values, such as the number of heads in three coin tosses; these are called *discrete* random variables. 
Many random variables take values in an interval, such as the height of a randomly chosen person; these are *continuous* random variables.
*Mixed* random variables are partially discrete and partially continuous. 
Mixed random variables combine both types of behaviour in a single variable.
In all cases, $X(s)$ is a real number, but the set of possible values of $X$ may be a finite set, a countable set (like the integers), or an interval in $\mathbb{R}$.


::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
*Random variables* are different from *variables* used in algebra. 
In algebra, a variable typically represents an unknown but fixed quantity. 
In contrast, a random variable represents a quantity whose value depends on the outcome of a random process.
:::


:::{.definition #DomainRange name="Domain and range space"}
The *domain*\index{Domain} of a random variable is the sample space\ $S$, and the *range*\index{Range} (or *range space*, or *value set*) is the set of real numbers taken by a function.

The *range space* for a random variable\ $X$ is often denoted\ $\mathcal{R}_X$, where $\mathcal{R}_X\in\mathbb{R}$.
The domain of\ $X$ is the set\ $S$, and the range space is the set $\{X(s)\mid s\in S\}$.
:::


Since $X$ is a function, each $s\in S$ is assigned to exactly one value $X(s)$; however, multiple values of $s\in S$ may be assigned to the same value of $X(s)$.
The variable is *random* since its value depends upon the outcome of the random process.


A capital letter (such as $X$ or $Y$) is usually used to denote the *description* of the random variable, while lower-case letters (such as $x$ or $y$) are used to represent the *values* that the random variable can take.
For example, consider rolling two dice and observing the sum of the two rolls. 
Writing $X = 3$ means:

* 'The random variable\ $X$' (e.g., the description 'the sum of the roll of two dice')...
* '... takes the value\ $3$ in some outcome of the random process'.


:::{.example #TossDieTwiceProduct name="Rolling a die twice"}
Consider rolling a fair die twice.
The sample space\ $S$ contains $36$\ elements shown in Table\ \@ref(tab:TwoDice):
$$
  S = \{ (1, 1), (1, 2), (1, 3), \dots (6, 6)\}.
$$
However, we may be interested in the random variable\ $X$, the *product* of the two numbers rolled.
Each element\ $s_i$ of\ $S$ can be assigned to exactly one real number (in this case, to exactly one *integer*):
\begin{align*}
  s_1    &= (1, 1) \mapsto X = 1;\\
  s_2    &= (1, 2) \mapsto X = 2;\\
  s_3    &= (1, 3) \mapsto X = 3;\\
  \vdots &\qquad   \vdots\\
  s_{36} &= (6, 6) \mapsto X = 36.
\end{align*}
Each element of the sample space is mapped to exactly one value of\ $X$.
However, multiple elements of the sample space can be mapped to the same value of\ $X$:
\begin{align*}
 (3, 4) &\mapsto X = 12; \quad\text{and}\\
 (6, 2) &\mapsto X = 12.
\end{align*}
Writing $X = 12$ means 'the product of the numbers on the two rolls is\ $12$'.
:::


Once a random variable has been defined, events\index{Events} can be defined in terms of the values of the random variable.
Random variables provide a convenient way to express events numerically; rather than listing specific *outcomes*, events can be described using inequalities or equations involving the random variable.



:::{.example #TossDieTwiceProductRange name="Rolling a die twice: range"}
In Example\ \@ref(exm:TossDieTwiceProduct), the range of the random variable\ $X$ is
$$
   \mathcal{R}_X = \{1,  2,  3,  4,  5,  6,  8,  9, 10, 12, 15, 16, 18, 20, 24, 25, 30, 36\}.
$$
The domain is the sample space, the set of all ordered pairs
$$
  S = \{ (1, 1), (1, 2), (1, 3), \dots (3, 2), (3, 3), (3, 4),\dots (6, 5), (6, 6)\}. 
$$
:::


:::{.example #TossDieTwiceProductEvents name="Rolling a die twice: events"}
The random variable\ $X$ in Example\ \@ref(exm:TossDieTwiceProduct) can be used to define different events.
For example, we could define Event\ $A_1$ as
$$
  A_1 = \{s \in S \mid  X(s) > 10\} = \{ 12, 15, 16, 18, 20, 24, 25, 30, 36\},
$$
usually written more succinctly as $X > 10$.
Other events can be defined also:
\begin{align*}
   A_2 &= \{\text{$4 \le X < 10$}\} = \{ 4,  5,  6, 8,  9 \};\\
   A_3 &= \{\text{$X < 0$ }\} = \varnothing;\\
   A_4 &= \{\text{$X$ is prime}\} = \{2, 3, 5 \};\\
   A_5 &= \{\text{$X$ is evenly divisible by\ $8$}\} = \{ 8, 16, 24\}.
\end{align*}
:::


:::{.example #TwoDiceRV name="Sum of two die rolls"}
Consider observing the rolls of two dice.
The sample space contains\ $36$ elements (Example\ \@ref(exm:TwoDice)), and can be denoted using the ordered pairs $(r_1, r_2)$, where $r_1$ and $r_2$ are the results of roll\ $1$ and\ $2$ respectively. 
The sample space is listed in Table\ \@ref(tab:TwoDice).
For example, we could define $s_1$ as the sample point $(1, 1)$.

The random variable\ $Y$ can be defined on this sample space as:
$$
   Y(s)  = \text{the sum of the two rolls in $s$} = r_1 + r_2.
$$
This definition assigns a real number to each outcome in the sample space:


**Sample space elements** | **Value of random variable $Y$**
--------------------------|:----------------------------:
(1, 1)                    |  2
(1, 2), (2, 1)            |  3
(1, 3), (2, 2), (3, 1)    |  4
$\vdots$                  | $\vdots$
(6, 6)                    | 12


For example, the elements of\ $S$ assigned to $Y = 4$ are
$$
   (1, 3), (2, 2), (3, 1).
$$
Notice that many elements of the sample space can be assigned to the same value of the random variable (which is typical for random variables).

The *domain* of\ $Y$ is the sample space\ $S$; the *range space* is
$$
   \mathcal{R}_Y = \{ Y(s) \mid s\in S\} = \{2, 3, \dots, 12\}.
$$
:::



:::{.example #TossCoinTillHead name="Tossing a coin till a head appears"}
Consider the random process 'tossing a coin until a Head is observed'.
The sample space is
$$
   \Omega = \{(H), (TH), (TTH), (TTTH), \dots \}.
$$
We could then define the random variable $N$ as 'the number of tosses until the first head is observed'.
Then each element of the sample space can be assigned to a real number:
\begin{align*}
   (H)\quad    &\text{is assigned to $N = 1$};\\
   (TH)\quad   &\text{is assigned to $N = 2$};\\
   (TTH)\quad  &\text{is assigned to $N = 3$};\\
   \vdots\quad &\qquad \vdots
\end{align*}
and so on.
Writing $N = 2$ means 'the number of tosses to observe the first head is two'.
:::


:::{.example #DrawTwoCards name="Drawing two cards"}
Consider drawing two cards from a standard, well-shuffled pack of cards, and observing the colour of the card (B: Black; R: Red).
The sample space\ $\Omega$ is:
$$
   \Omega = \{ (BB), (BR), (RR), (RB)\}.
$$
Many random variables could be defined on this sample space; for example:
\begin{align*}
   T&: \text{The number of black cards drawn};\\
   M&: \text{The number of red cards drawn on the first draw};\\
   D&: \text{The number of black cards drawn,}\\
    &\quad \text{minus the number of red cards drawn}.
\end{align*}
All of these assign a real number to each element of $\Omega$.
The random variable $D$, for instance, is defined as:


**Sample space elements** | **Value of $D$**
--------------------------|-----------------
$(BR)$ and $(RB)$         | $D = 0$
$(BB)$                    | $D = 2$
$(RR)$                    | $D = -2$


The domain is $\Omega$, and the range space is
$$
   \mathcal{R}_D = \{ D(s) \mid s\in \Omega\} = \{-2, 0, 2\}.
$$
:::



## Discrete, continuous and mixed random variables {#DiscreteContMixed}

As observed earlier, random variables can be discrete, continuous, or a mixture of both.


### Discrete random variables {#RVsDiscrete}

:::{.definition #DiscreteRV name="Discrete random variable"}
A **discrete random variable** contains a finite, or countably infinite, number of values within any given interval of a given domain.
:::


:::{.example}
In Example\ \@ref(exm:TossDieTwiceProduct), exactly\ $36$ values of the random variable\ $X$ are possible: $1, 2, \dots 36$.

In Example\ \@ref(exm:TwoDiceRV), exactly\ $11$ values of the random variable\ $Y$ are possible: $2, 3, \dots 12$.

In Example\ \@ref(exm:TossCoinTillHead), the random variable\ $N$ takes a *countably infinite* number of possible values: $1, 2, 3, \dots$

In Example\ \@ref(exm:DrawTwoCards), the random variable\ $D$ can take one of three possible values: $-2$, $0$ or $2$.
:::


The definition refers to the values of random variable, not to the [sample space](#def:SampleSpace) (i.e., the inputs to the function).


Examples of discrete random variables include:

* The number of children aged under\ $18$ living in a household.
* The number of errors per month.
* The number of incidents of lung cancer at a hospital.
* The number of cyclones per season.
* The number of wins by a football team.
* The number of kangaroos observed in a five-hectare transect.



### Continuous random variables {#RVsContinuous}

For a continuous sample space, the random variable is usually the *identity function* $Y(s) = s$.
For example, in Example\ \@ref(exm:CricketBallDefine) the sample space that describes how far a cricket ball can be thrown is already defined on the positive reals.
Hence, we can define the random variable as $T(s) = s$, where\ $s$ is the distance specified in the sample space.


:::{.definition #ContinuousRF name="Continuous random variable"}
A **continuous random variable** can take on any value within any given interval of a given domain (at least in theory).
:::


The value of a continuous random variable can never, in principle, be measured exactly, so in practice needs to be rounded.


:::{.example #ContinuousRVHeight name="Heights"}
Height $H$ is often recorded to the nearest centimetre (e.g., $179\cms$) for convenience and practicality. 
Better measuring instruments may be able to record height to one or more decimal places of a centimetre.
The range space is $\mathcal{R}_H = \{ H(s) \mid s \in (0, \infty)\}$, or $\mathcal{R}_H = \{ H(s) \mid s \in \mathbb{R}_{+}\}$.
:::


::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
Even though *your* height may not change, the notion of a *random variable* means that height varies from one realisation of the random process to another; that is, from one *person* to the next.
:::

Examples of continuous random variables include:

* The volume of waste water treated at a sewage plant per day.
* The weight of hearts in normal rats.
* The lengths of the wings of butterflies.
* The yield of barley from a large paddock.
* The amount of rainfall recorded each year.
* The time taken to perform a psychological test.
* The percentage cloud cover.


### Mixed random variables {#RVsMixed}

Some random variables are not completely discrete or continuous; these are called *mixed random variables*.
The most commonly-occuring mixed random variable is continuous for the positive real numbers, plus a discrete component at zero.


::: {.definition #MixedRF name="Mixed random variable"}
A **mixed random variable** has subsets where the random variable is discrete and subsets where the random variable is continuous.
:::


:::{.example #MixeVehicleWait name="Vehicle wait times"}
Consider the time spent by vehicles waiting at a set of traffic lights before proceeding through the intersection.

If the light is green on arrival, the wait time is exactly zero (i.e., discrete): the vehicle can drive straight through the intersection.
A wait time of zero seconds can be measured exactly.
However, if the light is red on arrival, the vehicle needs to  wait a continuous amount of time before it turns green.

The time spent waiting is a *mixed* random variable.
:::



Examples of mixed random variables include:

* The amount of rainfall that falls in a month (exactly zero, or a continuous amount).
* The weight of fruit produced per tree (exactly zero if no fruit is produced, or a continuous amount).
* The mass of fish-catch per trawl (exactly zero if no fish are caught, or a continuous amount).
* The lifetime of computer components (exactly zero if the component fails immediately, or a continuous time).


## Probability functions {#UnivariateProbabilityFunctions}

The previous section introduced *random variables*: real values assigned to outcomes in the sample space.
Often, many elements of the sample space were assigned to the same value of the random variable.
Therefore, *probabilities* can be assigned to various values of the random variable, to develop a *probability model* for the random variable.

A *model* describes theoretical patterns over infinite trials.
On any single roll of a die, a `r knitr::include_graphics("Dice/die4.png", dpi=2000)` may or may not occur, but theoretically (and for infinite rolls) we expect a `r knitr::include_graphics("Dice/die4.png", dpi=2000)` to appear\ $1/6$ of the time.
A *probability model* describes the probability that various values of the random variable might appear on any one realisation in theory.

This probability model is called the *probability function*.

::: {.example #TossingCoinOutcomes name="Tossing coin outcomes"}
Consider tossing a coin twice and observing the outcome of the two tosses. 
Since a random variable is a *real-valued function*, simply observing the outcome as $(H, T)$, for example, does not define a random variable.

We could define the random variable of interest, say\ $H$, as the *number* of heads on the two tosses of the coin.
The *sample space* for the experiment is
$$
   S = \{ (TT), (TH), (HT), (HH)\}.
$$
The connection between the sample space and\ $H$ is shown in the table below.
In this case, the range space of $H$ is $\mathcal{R}_H = \{0, 1, 2\}$.
The probability of observing each value of\ $H$ can be computed using classical probability:


*Element of $S$* | *Function $H(s)$*                     | *Value of $H$*   | *$\Pr(H = s_i)$*
:---------------:|:-------------------------------------:|:----------------:|:-----------------:
$s_1 = TT$       | $H(s_1)$: Number of heads in $s_1$    | 0                | $1/4$
$s_1 = TH$       | $H(s_2)$: Number of heads in $s_2$    | 1                | $1/4$
$s_1 = HT$       | $H(s_3)$: Number of heads in $s_3$    | 1                | $1/4$
$s_1 = HH$       | $H(s_4)$: Number of heads in $s_4$    | 2                | $1/4$

The *probability function* could be defined as
\begin{align*}
      \Pr(H = 0):&\quad 1/4\\
      \Pr(H = 1):&\quad 1/2\\
      \Pr(H = 2):&\quad 1/4\\
      \Pr(H = h):&\quad 0\quad \text{for all other values of $h$}.
\end{align*}
:::


Probability functions are written and interpreted differently, depending on whether the random variable is a discrete, continuous or mixed random variable.


### Discrete random variables: probability mass functions {#ProbabilityFunctionsDiscrete}

For a discrete random variable, the probability function indicates how probabilities are assigned to the values of the discrete random variable.
For a discrete random variable, the probability function is often called the *probability mass function* (or PMF).

::: {.definition #ProbabilityFunction name="Probability function"}
Let the range space of the discrete random variable\ $X$ be\ $\mathcal{R}_X$.
With each $x\in \mathcal{R}_X$, associate a number
$$
   p_X(x) = \Pr(X = x).
$$
The function $p_X(x)$ is called the *probability mass function* of\ $X$.
:::


The following properties of the probability function are implied by the definition and the rules of probability.

1. $p_X(t) \ge 0$ for all values of\ $t$; that is, probabilities are never negative.
2. $\displaystyle \sum_{t \in \mathcal{R}_X}  p_X(t) = 1$ where\ $\mathcal{R}_X$ is the range space of\ $X$; that is, the probability function covers the probability for all possible sample points in the sample space.
3. $p_X(t) = 0$ if\ $t \notin \mathcal{R}_X$.
4. For an event\ $A$ defined on a sample space\ $S$, the probability of event\ $A$ is
$$
      \Pr(A) = \sum_{t\in A} p_X(t).
$$


::: {.definition #ProbabilityDistribution name="Probability distribution"}
If $\mathcal{R}_X =\{ x_1, x_2, \dots \}$, 
the pair
$$
   \{ \big(x_i, p_X(x_i)\big); \quad i = 1, 2,\dots\}
$$
is called the *probability distribution* of the discrete random variable $X$.
:::


The probability distribution of a discrete random variable $X$ can be represented by: listing each outcome with its probability; giving a formula; using a table; or using a graph which displays the probabilities\ $p(x)$ corresponding to each $x\in \mathcal{R}_X$.

Sometimes the probability function is denoted\ $p(x)$ rather than\ $p_X(x)$.
Using the subscript avoids confusion in situations where many random variables are considered at once.
The subscript is used throughout this book.

The probability distribution of a random variable is a description of the range of the variable and the associated assignment of probabilities.


::: {.example #Independence name="Independence"}
Five balls numbered\ $1$, $2$, $3$, $4$ and\ $5$ are in an urn.
Two balls are selected at random.
Consider finding the probability distribution of the *larger* of the two numbers.

The sample space is:
$$
    S =\{ (1, 2), (1, 3), (1, 4), (1, 5), (2, 3), (2, 4), (2, 5), (3, 4), (3, 5), (4, 5)\},
$$
where all $10$\ elements are equally likely.
Then, let\ $X$ be the random variable 'the *larger* of the two numbers chosen', so that $\mathcal{R}_X = \{2, 3, 4, 5\}$.
Listing the probabilities:
\begin{alignat*}{3}
    \Pr(X = 2) &= \Pr\big((1, 2)\big)                                     &\quad &= 1/10;\\
    \Pr(X = 3) &= \Pr\big((1, 3) \text{ or } (2, 3)\big)                 &\quad &= 2/10;\\
    \Pr(X = 4) &= \Pr\big((1, 4) \text{ or } (2, 4) \text{ or } (3, 4)\big) &\quad &= 3/10;\\
    \Pr(X = 5) &= \Pr\big((1, 5) \text{ or } (2, 5) \text{ or } (3, 5)\text{ or } (4, 5)\big) &\quad &= 4/10;\\
    \Pr(\text{other values of } X) & \text{ }                             &\quad &= 0.
\end{alignat*}
This is the probability distribution of\ $X$, which could also be given as a formula:
$$
   \Pr(X = x) = 
   \begin{cases}
      (x - 1)/10 & \text{for $x = 2, 3, 4, 5$}\\
      0 & \text{elsewhere}.
  \end{cases}
$$
The probability function could also be given in a table (Table\ \@ref(tab:LargestDie)) or graph (Fig.\ \@ref(fig:ProbDist1)), where the probability is assumed to be zero for all values not shown.
:::

```{r LargestDie, echo=FALSE}
LargestDieTable <- array( dim = c(2, 4)) 


LargestDieTable[1, ] <- as.character(2:5)
LargestDieTable[2, ] <- ( (2:5) - 1 ) / 10

if( knitr::is_latex_output() ) {
  rownames(LargestDieTable) <- c("$x$",
                                 "$\\Pr(X = x)$")
  knitr::kable(LargestDieTable,
               format = "latex",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               escape = FALSE,
               caption = "A table showing the distribution of $X$, the largest number in two draws from an urn") %>%
    kable_styling(font_size = 10) %>%
    row_spec(0, bold = TRUE) 
}
if( knitr::is_html_output() ) {
  rownames(LargestDieTable) <- c("$x$",
                                 "Probability")
  knitr::kable(LargestDieTable,
               format = "html",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               caption = "A table showing the distribution of $X$, the largest number in two draws from an urn") %>%
    row_spec(1, bold = TRUE)
}



```


<!-- SHOW CODE AND PLOT -->
```{r child="PlotCode/LargerTwoNumbers.Rmd"}
```



 
::: {.example #TossingHeads name="Tossing heads"}
Suppose a fair coin is tossed twice, and the uppermost face is noted.
Then the *sample space* is
$$
   S = \{ (HH), (HT), (TH), (TT) \}.
$$
Let\ $H$ be the *number* of heads observed.
$H$\ is a (discrete) random variable, and the range of\ $H$ is $\mathcal{R}_H = \{0, 1, 2\}$, representing the values that\ $H$ can take.

The probability function maps each of these values to the associated probability.
Using techniques from Chap. \@ref(Probability), the probabilities are:
\begin{align*}
   \Pr(H = 0) &= \Pr(\text{no heads}) = 0.25;\\
   \Pr(H = 1) &= \Pr(\text{one head}) = 0.5;\\
   \Pr(H = 2) &= \Pr(\text{two heads}) = 0.25.
\end{align*}
As a function, the probability function is
$$
   p_H(h) = \Pr(H = h) 
          = \begin{cases}
               0.25 & \text{if $h = 0$};\\
               0.5 & \text{if $h = 1$};\\
               0.25 & \text{if $h = 2$};\\
               0 & \text{otherwise}.
              \end{cases}
$$
More succinctly,
$$
   p_H(h) = \Pr(H = h) 
          = \begin{cases}
                  (0.5)0.5^{|h - 1|} & \text{for $h = 0$, $1$ or $2$};\\
                  0 & \text{otherwise}.
              \end{cases}
$$
This information can also be presented as a table (Table\ \@ref(tab:TwoDieRV)) or graph (Fig.\ \@ref(fig:ProbDistributionCoin)).
Note that $\sum_{t \in \{0, 1, 2\}} p_H(t) = 1$ and $p_H(h)\ge0$ for all $h$, as required of a pf.
:::


```{r TwoDieRV, echo=FALSE}
TwoDieTable <- array( dim = c(2, 3)) 

rownames(TwoDieTable) <- c("$h$",
                           "$\\Pr(H = h)$")

TwoDieTable[1, ] <- as.character(0:2)
TwoDieTable[2, ] <- c(0.25, 0.50, 0.25)

if( knitr::is_latex_output() ) {
  knitr::kable(TwoDieTable,
               format = "latex",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               escape = FALSE,
               caption = "A table showing the distribution of $H$, the number of heads in two tosses of a coin") %>%
    kable_styling(font_size = 10) %>%
    row_spec(0, bold = TRUE) 
}
if( knitr::is_html_output() ) {
  knitr::kable(TwoDieTable,
               escape = TRUE,
               format = "html",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               caption = "A table showing the distribution of $H$, the number of heads in two tosses of a coin") %>%
    row_spec(1, bold = TRUE) 
}
```



```{r ProbDistributionCoin, echo=FALSE, fig.align="center", fig.width=4,fig.height=3.5,fig.cap="The probability function for\\ $H$, the number of heads on two tosses of a coin."}
plot( x = 0:2,
      y = c(0.25, 0.50, 0.25),
      ylim = c(0, 0.55),
      xlim = c(-0.25, 2.25), 
      type = "h",
      las = 1,
      lty = 3,
      col = "grey",
      main = expression(
        paste("The probability distribution of ", italic(H))
        ),
      xlab = expression(
        paste("Values of the rv ", italic(H) )
        ),
      ylab = expression(
        paste("Probability function ", italic(p)[italic(H)](italic(h)))
      )
)

points( x = 0:2,
        y = c(0.25, 0.5, 0.25),
        pch = 19)

```


### Continuous random variables: probability density functions {#ProbabilityFunctionsContinuous}

In the discrete case, probability can be distributed over distinct points (possibly a countably infinite number) where each point has non-zero mass.
However, in the continuous case, mass cannot be thought of as an attribute of a *point* but rather of a *region* surrounding a point.
The ideas from Sect.\ \@ref(AssignProbContinuous) are relevant here.


::: {.definition #ProbabilityDensityFunction name="Probability density function"}
The *probability density function* (PDF) of the continuous random variable\ $X$ is a function $f_X(\cdot)$ such that
$$
   f_X(x) = \Pr(a < X \le b) = \int_a^b f_X(x)\,dx
$$
for any interval $(a, b]$ (where $a < b$) on the real line.
:::


We are usually only concerned with $(a, b)\in \mathcal{R}_X$, but it makes sense to think of the PDF as defined for all\ $x$, insisting that $f_X(x) = 0$ for $x\notin \mathcal{R}_X$.
This definition states that *areas under the graph of the PDF represent probabilities* and leads to the following properties of the probability density function.

1. $f_X(x) \ge 0$ for all $-\infty < x < \infty$:
   the density function is never negative.
2. $\displaystyle \int_{-\infty}^\infty f_X(x)\,dx = 1$:
   The total probability is one.
3. For an event\ $A$ defined on a sample space\ $S$, the probability of event\ $A$ is
$$
      \Pr(A) = \int_{A} f_X(x)\, dx.
$$
4. Since exact values are not possible:
   \begin{align*}
          & \Pr(a < X \le b) = \Pr(a < X < b)\\
      {} =& \Pr(a \le X < b) = \Pr(a \le X \le b) = \int_a^b f_X(x)\,dx
    \end{align*}
<!-- 5. From the *Mean Value Theorem* in calculus, for small $\Delta x$: -->

<!--    \[  -->
<!--       \Pr(x < X < x + \Delta x) = \int ^{x + \Delta x}_x f(t)\, dt = \Delta xf(\xi ), \quad x < \xi < x + \Delta x. -->
<!--    \] -->
<!-- 6. For $\Delta x$ small, -->

<!--    \begin{equation} -->
<!--      \Pr(x < X < x +\Delta x)\simeq f(x)\Delta x. -->
<!--    \end{equation} -->

Properties\ 1 and\ 2 are sufficient to prove that a function is a PDF.
That is, to show that some function $g(x)$ is a PDF, showing that $g(x) \ge 0$ for all $-\infty < x < \infty$ and that $\int_{-\infty}^\infty g(x)\,dx = 1$ is sufficient.

Property\ 4 results from noting that if\ $X$ is a continuous random variable, $\Pr(X = a) = 0$ for any and every value\ $a$ for the same reason that a point has mass zero.


::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
The value of a PDF at some point\ $x$ does not represent a probability, but rather a *probability density*.
Hence, the PDF can have any non-negative value of arbitrary size at a specific value of\ $X$.
:::

This last statement is easy to show.
See Fig.\ \@ref(fig:ShowProbCont), which shows some probability density function $f(x)$.
The probability of\ $X$ occurring can be expressed as
$$
  \Pr(X = x^*)
  \approx \Pr\left(x^* - \frac{\Delta x}{2} < X < x^* + \frac{\Delta x}{2} \right)
$$
as $\Delta x \to 0$.
This is shown by the shaded area, which can be approximated by the dotted rectangle shown.
That is,
\begin{align*}
  \Pr(X = x^*)
  &\approx \Pr\left(x^* - \frac{\Delta x}{2} < X < x^* + \frac{\Delta x}{2} \right) \\
  &= \Delta x \times f(x).
\end{align*} 
Rearranging,
$$
  f(x) = \lim_{\Delta x \to 0} \frac{\Pr(X = x^*)}{\Delta x}.
$$
That is, the density function $f(x)$ is *not* the probability $\Pr(X = x^*)$.



```{r ShowProbCont, fig.align="center", fig.cap="Finding probabilities for a continuous random variable\\ $X$.", out.width='90%', fig.width=8, echo=FALSE}
xAt <- 6
deltax <- 4

xLo <- xAt - deltax/2
xHi <- xAt + deltax/2

x <- seq(1, 10,
         length = 100)
fx <- function(x) {
  dnorm(x, 
        mean = 5,
        sd = 5)
}

plot( fx(x) ~ x,
      type = "l",
      lwd = 3,
      axes = FALSE,
      ylim = c(0, 0.10),
      xlab = expression(Values~of~italic(X)),
      ylab = "Probability function")
axis(side = 1,
     at = c(xLo, xAt, xHi),
     labels = expression( italic(x)*"*" - Delta*italic(x)/2,
                          italic(x)*"*",
                          italic(x)*"*" + Delta*italic(x)/2))
box()

lines(x = c(xLo, xLo),
      y = c(0, fx(xLo)),
            lwd = 2,
            col = grey(0.3),
            lty = 2)
lines(x = c(xAt, xAt),
      y = c(0, fx(xAt)),
            lwd = 2,
            col = grey(0.3),
            lty = 2)
lines(x = c(xHi, xHi),
      y = c(0, fx(xLo)),
            lwd = 2,
            col = grey(0.3),
            lty = 2)
lines(x = c(xLo, xHi),
      y = c(fx(xAt), fx(xAt)),
            lwd = 2,
            col = grey(0.3),
            lty = 2)
xShade <- seq(xLo, xHi,
              length = 100)

polygon( x = c(min(xShade), xShade, max(xShade)),
         y = c(0, fx(xShade), 0),
         col = plotColour)
points(x = xAt,
      y = fx(xAt),
      cex = 1.5,
      pch = 19)
text(x = xAt,
     y = fx(xAt),
     pos = 3,
     labels = expression(italic(f)*(italic(x)*"*")) )
text(x = max(x),
     y = fx( max(x) ),
     pos = 3,
     labels = expression(italic(f)*(italic(x))) )


arrows(x0 = xLo,
       x1 = xHi,
       y0 = 0.02,
       y1 = 0.02,
       code = 3,
       angle = 15,
       length = 0.15)
text(x = xLo + 0.3 * (xHi - xLo), # Offset a bit
     y = 0.02,
     pos = 3,
     labels = expression(Delta*italic(x))) 

```


::: {.example #ProbabilityDensityFunction name="Probability density function"}
Consider the continuous random variable\ $W$ with the PDF
$$
   f_W(w) = 
   \begin{cases}
      2w & \text{for $0 < w < 1$};\\
      0  & \text{elsewhere}.
   \end{cases}
$$
The probability $\Pr(0 < W < 0.5)$ can be computed in two ways.
One is to use calculus:
$$
   \Pr(0 < W < 0.5) = w^2\Big|_0^{0.5} = 0.25.
$$
Alternately, the probability can be computed *geometrically* from the graph of the PDF (Fig.\ \@ref(fig:ContinuousPDF)).
The region corresponding to $\Pr(0 < W < 0.5)$ is triangular; integration simply finds the area of this triangle.
Thus, the area can be found using the area of a triangle directly: the length of the base of the triangle, times the height of the rectangle, divided by two:
$$
   0.5 \times 1 /2 = 0.25,
$$
and the answer is the same as before.

Note that $f_W(w)$ is greater than one for some values of\ $w$.
Since $f_W(w)$ does not represent probabilities at each point (as\ $W$ is continuous), this is not a problem.
However, $\int_{\mathbb{R}} f_W(w) \, dw = 1$ as required of a probability density.
:::



```{r ContinuousPDF, echo=FALSE, fig.align="center", fig.cap="The probability function for\\ $W$. The shaded area represents $0 < W < 0.5$.", fig.height=3.5, fig.width=5, out.width='55%'}
plot( x = c(-1, 2),
      y = c(0, 2),
      type = "n",
      las = 1,
      main = expression(
        paste("The probability distribution of ", italic(W))
        ),
      xlab = expression(
        paste("Values of the rv ", italic(W))
        ),
      ylab = expression(
        paste("The probability function ", italic(p)[italic(W)](italic(w)))
      )
)

polygon( x = c(0, 0.5, 0.5, 0),
         y = c(0, 1, 0, 0),
         col = plotColour1)
lines( x = c(-0.5, 0, 1),
       y = c(0, 0, 2),
       lwd = 2)
lines( x = c(-1, -0.5),
       y = c(0, 0),
       lwd = 2,
       lty = 3)
lines( x = c(1, 1.5),
       y = c(0, 0),
       lwd = 2)
lines( x = c(1.5, 2),
       y = c(0, 0),
       lwd = 2,
       lty = 3)
points(1, 2, 
       pch = 1)
points(1, 0, 
       pch = 19)
```






### Mixed random variables {#ProbabilityFunctionsMixed}

Some random variables are not entirely continuous nor entirely discrete, but have components of both.
These random variables are called *mixed random variables*.


::: {.example #MixedRandomVariable name="Mixed random variable"}
In a factory producing diodes, a proportion of the diodes\ $p$ fail immediately.
The distribution of the lifetime (in hundreds of days), say\ $Y$, of the diodes is given by a discrete component at $y = 0$ for which $\Pr(Y = 0) = p$, and a continuous part for $y > 0$ described by
$$
   f_Y(y) = (1 - p) \exp(-y) \quad \text{if $y > 0$.}
$$
Here, $f_Y(y)$ is not itself a PDF as it doesn't integrate to one; however the total probability is
$$
   p + \int_0^\infty (1 - p)\exp(-y) \, dy = p + (1 - p) = 1
$$
as required.

Consider a diode for which $p = 0.4$.
The probability distribution is displayed in Fig.\ \@ref(fig:Diode) where a solid dot is included to show the discrete part.
Representing the probability distribution in this mixed case is difficult, because of the need to combine a probability distribution and a PDF.
These difficulties are overcome by using the distribution function (Sect.\ \@ref(DistributionFunction)).
:::


```{r Diode, echo=FALSE, fig.align="center", fig.cap="The probability function for the diodes example.", fig.width=4.5, fig.height=4}
p <- 0.4
x <- seq(0, 4, 
         length = 100)
fy <- (1 - p) * exp( - x)
fy[1] <- 1 - p

Fy <- 0.4 + 0.6 * (1 - exp(-x ) )
F[1] <- p

plot(fy ~ x,
     lwd = 2,
     type = "l",
     xlim = c(-1, 4),
     xlab = expression(italic(Y)),
     ylab = expression(italic(f)[italic(y)](italic(y))),
     main = "Probability function",
     las = 1)
points( x = 0,
        y = 0.4,
        pch = 19)
points( x = 0,
        y = 0.6,
        pch = 1)

lines( x = c(-1, -0.5),
       y = c(0, 0),
       lwd = 2,
       lty = 2)
lines( x = c(-0.5, 0),
       y = c(0, 0),
       lwd = 2)
points( x = 0,
        y = 0,
        pch = 1)
```



## Distribution functions {#DistributionFunction}

Another way of describing random variables is using a *distribution function* (DF), also called a *cumulative distribution function* (CDF).
The DF gives the probability that a random variable\ $X$ is less than *or equal to* a given value of\ $x$.


::: {.definition #DistributionFunction name="Distribution function"}
For any random variable\ $X$ the *distribution function*, $F_X(x)$, is given by
$$
     F_X(x) = \Pr(X \leq x) \quad \text{for $x\in\mathbb{R}$}.
$$
:::


The distribution function applies to discrete, continuous or mixed random variables.
Importantly, the definition includes a less than *or equal to* sign; and the distribution function is defined for *all* real numbers.

If\ $X$ is a discrete random variable with range space\ $\mathcal{R}_X$, then the DF is
\begin{align*}
     F_X(x)
     &= \Pr(X \leq x)\\
     &= \sum_{x_i \leq x} \Pr(X = x_i)\text{ for }x_i\in \mathcal{R}_X,\text{ and }-\infty < x < \infty.
\end{align*}
If\ $X$ is a continuous random variable, the DF is
\begin{align*}
     F_(x)
     &= \Pr(X \leq x)\\
     &= \int^x_{-\infty} f(t)\,dt \text{ for } -\infty < x < \infty.
\end{align*}


::: {.example #TossingHeads2 name="Tossing heads"}
Consider the simple example in Example\ \@ref(exm:TossingHeads) where a coin is tossed once.
The probability function for $H$ is given in that example in numerous forms.
To determine the DF, first note that when $h < 0$, the accumulated probability is zero; hence, $F_H(h) = 0$ when $h < 0$.
At $h = 0$, the probability of $0.25$ is accumulated all at once, and no more probability is accumulated until $h = 1$.
Thus, $F_H(h) = 0.25$ for $0 \le h < 1$.
Continuing, the DF is
$$
   F_H(h) = \begin{cases}
               0 & \text{for $h < 0$};\\
               0.25 & \text{for $0\le h < 1$};\\
               0.75 & \text{for $1\le h < 2$};\\
               1 & \text{for $h\ge 2$}.
            \end{cases}
$$
The DF can be displayed graphically, being careful to clarify what happens at $H = 1$, $H = 2$ and $H = 3$ using open or filled circles (Fig.\ \@ref(fig:HeadsDF)).
:::



```{r HeadsDF, echo=FALSE, fig.cap="A graphical representation of the distribution function for the tossing-heads example. The filled circles contain the given point, while the empty circles omit the given point.", fig.align="center", fig.width=4,fig.height=3.5, out.width='50%'}
plot( x = c(-1, 4),
      y = c(0, 1.05),
      type = "n",
      las = 1,
      main = expression(
        paste("The distribution function of ", italic(H))
        ),
      xlab = expression(italic(H)),
      ylab = expression(
        paste("Distribution function ",italic(F)[italic(H)](italic(h)))
      )
)

abline(h = c(0, 1),
       col = "grey")


lines( x = c(-0.5, -1),
       y = c(0, 0),
       lty = 2,
       lwd = 2)
lines( x = c(-0.5, 0),
       y = c(0, 0),
       lwd = 2)
lines( x = c(0, 1),
       y = c(0.25, 0.25),
       lwd = 2)
lines( x = c(1, 2),
       y = c(0.75, 0.75),
       lwd = 2)
lines( x = c(2, 3),
       y = c(1, 1),
       lwd = 2)
lines( x = c(3, 4),
       y = c(1, 1),
       lwd = 2,
       lty = 2)


points(0, 0, 
       pch = 1)
points(0, 0.25, 
       pch = 19)

points(1, 0.25, 
       pch = 1)
points(1, 0.75, 
       pch = 19)

points(2, 0.75, 
       pch = 1)
points(2, 1, 
       pch = 19)

```




::: {.example #DistributionFunction name="Distribution function"}
Consider a continuous random variable\ $V$ with PDF
$$
   f_V(v) = \begin{cases}
               v/2 & \text{for $0 < v < 2$};\\
               0 & \text{otherwise.}
            \end{cases}
$$
The DF is zero whenever $v\le 0$.
For $0 < v < 2$,
$$
   F_V(v) = \int_0^v t/2\,dt = v^2/4.
$$
Whenever $v\ge 2$, the DF is one.
So the DF is
$$
   F_V(v) = \begin{cases}
               0 & \text{if $v\le 0$};\\
               v^2/4 & \text{if $0 < v < 2$};\\
               1 & \text{if $v\ge 2$.}
             \end{cases}
$$
A picture of the distribution function is shown in Fig.\ \@ref(fig:DFCont).
:::


```{r DFCont, echo=FALSE, fig.align="center", fig.cap="The probability function for\\ $V$.", fig.width=7, out.width='90%', fig.height=3.5}
p <- 0.4
x <- seq(0, 4, 
         length = 100)
fy <- (1 - p) * exp( - x)
fy[1] <- 1 - p

Fy <- 0.4 + 0.6 * (1 - exp(-x ) )
F[1] <- p

plot(fy ~ x,
     lwd = 2,
     type = "l",
     xlim = c(-1, 4),
     xlab = expression(italic(Y)),
     ylab = expression(italic(f)[italic(y)](italic(y))),
     main = "Probability function",
     las = 1)
points( x = 0,
        y = 0.4,
        pch = 19)
points( x = 0,
        y = 0.6,
        pch = 1)


# Indicate mass
arrows(x0 = -1,
       x1 = -0.075,
       y0 = 0.4,
       y1 = 0.4,
       col = "grey",
       length = 0.1,
       angle = 15)
text(x = -0.5,
     y = 0.4,
     label = expression(Pr(italic(Y)==0)),
     pos = 3)

lines( x = c(-1, -0.5),
       y = c(0, 0),
       lwd = 2,
       lty = 2)
lines( x = c(-0.5, 0),
       y = c(0, 0),
       lwd = 2)
points( x = 0,
        y = 0,
        pch = 1)
```


::: {.importantBox .important data-latex="{iconmonstr-warning-8-240.png}"}
For the integral, *do not write*
$$
   \int_0^v v/2\,dv.
$$
It makes no sense to have the *variable* of integration as a limit on the integral and also in the function to be integrated.
Either write the integral as given in the example, or write $\int_0^t v/2\,dv = t^2/4$ and then change the variable from\ $t$ to\ $v$.
:::




::: {.example #MixedRandomVariableDF name="Mixed random variable"}
Example\ \@ref(exm:MixedRandomVariable) discussed the mixed random variable\ $Y$, the lifetimes of diodes (in hundreds of days).
A proportion of the diodes\ $p = 0.4$ fail immediately.
For other diodes, the distribution function of\ $Y$ is described by
\begin{align*}
  F_Y(y) 
  &= \Pr(Y\le y)\\
  &= p + \int_0^y f_Y(t)\, dt \\
  &= p + (1 - p)  \int_0^y\exp(-t)\, dt \\
  &= p + (1 - p) [1 - \exp(-y)]\\
  &= 0.4 + 0.6 [1 - \exp(-y)]
\end{align*}
for $y > 0$.
The probability distribution is displayed in Fig.\ \@ref(fig:DiodeDF) where a solid dot is included to show the discrete part.

The complete distribution function is:
$$
   F_Y(y) = \begin{cases}
               0 & \text{if $y < 0$}\\
               0.4 & \text{if $y = 0$}\\
               0.4 + 0.6(1 - \exp(-y)) & \text{if $y > 0$}.
            \end{cases}
$$
Notice that the total probability is
$$
   0.4 + 0.6\int_0^\infty \exp(-y) \, dy = 1
$$
as required.
:::


```{r DiodeDF, echo=FALSE, fig.align="center", fig.cap="The distribution function for the diodes example.", fig.width=5, fig.height=4}
p <- 0.4
x <- seq(0, 4, 
         length = 100)
fy <- (1 - p) * exp( - x)
fy[1] <- 1 - p

Fy <- 0.4 + 0.6 * (1 - exp(-x ) )
F[1] <- p


plot(Fy ~ x,
     ylim = c(0, 1),
     xlim = c(-1, 4),
     lwd = 2,
     type = "l",
     xlab = expression(italic(Y)),
     ylab = expression(italic(F)[italic(y)](italic(y))),
     main = "Distribution function",
     las = 1)
points( x = 0,
        y = Fy[1],
        pch = 19)
points( x = 0,
        y = 0,
        pch = 1)
lines( x = c(-1, 0),
       y = c(0, 0),
       lwd = 2)
```




Properties of the DF are stated below.

1. $0\leq F_X(x)\leq 1$ because $F_X(x)$ is a probability.
2. $F_X(x)$ is a non-decreasing function of\ $x$.
   That is, if $x_1 < x_2$ then $F_X(x_1) \leq F_X(x_2)$.
3. $\displaystyle{\lim_{x\to \infty} F_X(x)} = 1$ and $\displaystyle{\lim_{x\to -\infty} F_X(x)} = 0$.
4. $\Pr(a < X \leq b) = F_X(b) - F_X(a)$.
5. If\ $X$ is discrete, then $F_X(x)$ is a step-function.
   If\ $X$ is continuous, then $F_X$ will be a continuous function for all\ $x$.



We have seen how to find $F_X(x)$ given $\Pr(X = x)$, or to find $F_X(x)$ given $f_X(x)$.
But can we proceed in the other direction too?
That is, given $F_X(x)$, how do we find $\Pr(X = x)$ for\ $X$ discrete, or $f_X(x)$ for\ $X$ continuous?

As seen from the graph of the distribution in Example\ \@ref(exm:TossingHeads2), the values of\ $x$ where a 'jump' in $F_X(x)$ occurs are the points in the range space, and the probability associated with a particular point in\ $\mathcal{R}_X$ is the 'height' of the jump there.
That is,
\begin{equation}
      p_X(x_j) = \Pr(X = x_j) = F_X(x_j) - F_X(x_{j - 1}).
   (\#eq:DFtoPDFdiscrete)
\end{equation}



:::{.example #DistributionFnReverseDiscrete name="Mass function from distribution function"}
Consider the DF for a discrete random variable\ $X$:
$$
   F_X(x) = 
   \begin{cases}
      0     & \text{for $x < 10$;}\\
      0.1   & \text{for $10 \le x < 11$;}\\
      0.4   & \text{for $11 \le x < 15$;}\\
      0.9   & \text{for $15 \le x < 17$;}\\
      1     & \text{for $x \ge 17$.}
   \end{cases}
$$
To find the PDF, use Eq.\ \@ref(eq:DFtoPDFdiscrete):
$$
   f_X(x) = 
   \begin{cases}
      0.1   & \text{for $x = 10$}\\
      0.3   & \text{for $x = 11$}\\
      0.5   & \text{for $x = 15$}\\
      0.1   & \text{for $x = 17$}\\
      0     & \text{elsewhere}\\
   \end{cases}.
$$
See Fig.\ \@ref(fig:DFtoPDFdiscrete).
:::

```{r DFtoPDFdiscrete, echo=FALSE, fig.align="center", fig.cap="Left: the distribution function of $X$. Right: the probability mass function of $X$.", fig.width=8, fig.height=4, out.width='100%'}
par(mfrow = c(1, 2))

xDF <-  c(8,  10,  11,  15, 17, 19)
yDF <- c(0, 0.1, 0.4, 0.9,  1,  1)

xPF <- c( 10,  11,  15,  17)
yPF <- c(0.1, 0.3, 0.5, 0.1)


###

plot(x = xDF, 
     y = yDF,
     xlab = expression(italic(X)),
     ylab = expression(Distribution~"function") ,
     main = expression(Distribution~"function"~of~italic(X)),
     las = 1,
     type = "n")
for (i in (1:(length(xDF) - 1) ) ) {
  lines( x = c(xDF[i], xDF[i + 1]),
         y = c(yDF[i], yDF[i]),
         lwd = 2)
  if (i > 1 ) {# Add 'include this point' points: solid dots
    points(x = xDF[i], 
           y = yDF[i],
           pch = 19)
  }
  if (i < (length(xDF) - 1) ) {# Add 'exclude this point' points: open diots
    points(x = xDF[i + 1],
           y = yDF[i],
           pch = 1)
  }
  
  # Arrows showing the change in the DF = PDF
  indent <- 0.03 # Amount by which arrows are shrunk from the points to make more visible
  if (i == 3 ){
    arrows( x0 = xDF[i],
            x1 = xDF[i],
            y0 = yDF[i] - indent,
            y1 = yDF[i - 1] + indent,
            code = 3, #arrow both ends
            angle = 15,
            col = "grey",
            length = 0.1)
    text(x = xDF[i],
         y = mean(yDF[(i-1): i]),
         label = "Change in DF is\n0.3 at X = 11",
         cex = 0.9,
         pos = 4)
  }
  if (i == 4 ){
    arrows( x0 = xDF[i],
            x1 = xDF[i],
            y0 = yDF[i] - indent,
            y1 = yDF[i - 1] + indent,
            code = 3, #arrow both ends
            angle = 15,
            col = "grey",
            length = 0.1)
    text(x = xDF[i],
         y = mean(yDF[(i-1): i]),
         label = "Change in DF\nis 0.5",
         cex = 0.9,
         pos = 4)
  }
}
grid()


###

plot(xPF, yPF,
     ylim = c(0, 0.55),
     xlab = expression(italic(X)),
     ylab = expression(Probability~"function"),
     main = expression(Probability~mass~"function"~of~italic(X)),
     las = 1,
     lty = 2,
     type = "h")
points(xPF, yPF,
       pch = 19)
```


When\ $X$ continuous, from the *Fundamental Theorem of Calculus*,
\begin{equation}
   f_X(x) = \frac{dF_X(x)}{dx} \quad \text{where the derivative exists.}
   (\#eq:DFtoPDFcontinuous)
\end{equation}


:::{.example #DistributionFnReverseContinuous name="Density function from distribution function"}
Consider the DF for a continuous random variable\ $X$:
$$
   F_X(x) = 
   \begin{cases}
      0        & \text{for $x < 0 $;}\\
      x(2 - x) & \text{for $0 \le x \le 1$;}\\
      1        & \text{for $x > 1$.}
   \end{cases}
$$
To find the PDF, use Eq.\ \@ref(eq:DFtoPDFcontinuous):
\begin{align*}
   f_X(x) &= 
   \begin{cases}
      \frac{d}{dx} 0        & \text{for $x < 0 $;}\\
      \frac{d}{dx} x(2 - x) & \text{for $0 \le x \le 1$;}\\
      \frac{d}{dx} 1        & \text{for $x > 1$}
   \end{cases} \\
   &=
      \begin{cases}
      0        & \text{for $x < 0 $;}\\
      2(1 - x) & \text{for $0 \le x \le 1$;}\\
      0        & \text{for $x > 1$}
   \end{cases}
\end{align*}
which is usually written as $f_X(x) = 2(1 - x)$ for $0 < x < 1$, and\ $0$ elsewhere.
:::


## Quantile functions {#QuantileFunction}

For a random variable\ $X$, the distribution function $F_X(x)$ computes the probability that $X < x$ for some given value of\ $x$.
The value of\ $F_X(x)$ is a probability, so is a value between\ $0$ and\ $1$.

The *quantile function* $Q_X(p)$ is the inverse of the distribution function; it takes a value between\ $0$ and\ $1$ (called\ $p$), and returns the *smallest* value\ $x$ such that $F_X(x) \ge p$ for given values of\ $p$.
More formally,
\begin{equation}
  Q_X(p) = \inf\{x \in \mathbb{R} \mid F_X(x) \ge p\}\quad\text{for $0 < p < 1$}
  (\#eq:QuantileFunction)
\end{equation}
where 'inf' is the 'infimum', the greatest lower bound of the set. 
In practice this refers to the leftmost value\ $x$ where the distribution function $F_X(x)$ reaches or exceeds a target probability\ $p$.

At the endpoints (i.e., at $p = 0$ and $p = 1$), some ambiguity exists.

Some authors set $Q_X(0) = \min\{x \mid F_X(x) > 0\}$, the smallest support point with a positive mass. 
Other authors define $Q_X(0) = \lim_{p\downarrow} Q_X(p)$, which may give $Q_X(0)\to -\infty$.

Similarly, some authors leave $Q_X(1)$ undefined, while others set $Q_X(1) = \sup\{x \mid F_X(x) < 1\}$, the largest support point (possibly $+\infty$).
Other authors define $Q_X(1) = \lim_{p\uparrow} Q_X(p)$, which again may be $+\infty$.

When\ $X$ is a *continuous* random variable and $F_X(x)$ is a strictly increasing function, the quantile function is the inverse of the distribution function, and we can write
$$
   Q_X(p) = F_X^{-1}(p).
$$


::: {.softwareBox .software data-latex="{iconmonstr-laptop-4-240.png}"}
For built-in distributions (see Chaps.\ \@ref(DiscreteDistributions) and\ \@ref(ContinuousDistributions)), **R** allows the values `p = 0` and `p = 1`.
If the distribution is *unbounded*, **R** returns $-\infty$ or $+\infty$ as appropriate.
If the distribution is *bounded*, **R** returns the actual minimum and maximum of the support.
:::


:::{.example #QuantileFnContinuous1 name="Quantile function: continuous rv"}
Consider the continuous random variable\ $X$ with the probability density function
$$
  f_X(x) 
  = 
  \begin{cases}
    x/2 & \text{for $0 \le x \le 2$}\\
    0   & \text{elsewhere}.
  \end{cases}
$$
The distribution function is
$$
  F_X(x) 
  = 
  \begin{cases}
    0     & \text{for $x < 0$}\\
    x^2/4 & \text{for $0 \le x \le 2$}\\
    1     & \text{for $x > 2$}.
  \end{cases}
$$
For $0 < p < 1$, the quantile function $Q_X(p)$ is given by solving $F_X(x) = p$ (i.e., solving $p = x^2 /4$), which gives $Q_X(p) = 2\sqrt{p}$.
This means the quantile function is
$$
  Q_X(p) 
  = 2\sqrt{p} \quad\text{for $0 < p < 1$.}\\
$$
See Fig.\ \@ref(fig:QuantileFnContinuous1).
:::


```{r QuantileFnContinuous1, echo=FALSE, fig.align="center", fig.cap="Left: the distribution function of $X$. Right: the quantile function for $X$.", fig.width=6.5, fig.height=3, out.width='100%'}
par(mfrow = c(1, 3))

x <- seq(-1, 3, 
         length = 5000)
p <- seq(0, 1, 
         length = 5000)
yPDF <- function(x){ ifelse( (x >= 0) & (x <= 2), 
                             x/2, 
                             0)}
yDF <- function(x){ ifelse(x < 0, 
                           0, 
                           ifelse(x > 2,
                                  1, 
                                  x^2 / 4 ) ) }
yQF <- function(p){ ifelse( (p > 0) & (p < 1), 
                           2 * sqrt(p),
                           NA) }
###
plot(x, 
     yPDF(x),
     las = 1,
     type = "l",
     lwd = 3,
     col = plotColour1,
     xlab = expression(italic(X)),
     ylab = expression(PDF~italic(f)[italic(X)](italic(x))),
     main = expression(PDF~of~italic(X)) )

### 
plot(x, 
     yDF(x),
     las = 1,
     type = "l",
     lwd = 3,
     col = plotColour1,
     xlab = expression(italic(X)),
     ylab = expression(Distribution~fn~italic(F)[italic(X)](italic(x))),
     main = expression(Distribution~"function"~of~italic(X)) )

# Show p = 0.75
xStar <- 1
qStar <- 0.25 
arrows(x0 = min(x),
       x1 = xStar,
       y0 = qStar,
       y1 = qStar,
       code = 1,
       angle = 15,
       length = 0.10)
text(x = xStar,
     y = qStar,
     pos = 4,
     cex = 0.9,
     label = expression(italic(F)[italic(x)](italic(x)) == 0.25) )

arrows(x0 = xStar,
       x1 = xStar,
       y0 = qStar,
       y1 = 0,
       code = 1,
       angle = 15,
       length = 0.10)
text(x = xStar,
     y = 0.1,
     pos = 4,
     cex = 0.9,
     label = expression(italic(x) == 1) )
###

plot(p, 
     yQF(p),
     las = 1,
     type = "l",
     lwd = 3,
     col = plotColour1,
     xlab = expression(italic(p)),
     ylab = expression(Quantile~fn~italic(Q)[italic(X)](italic(p))),
     main = expression(Quantile~"function"~of~italic(X)) )

# Show p = 0.8
xStar <- 1
qStar <- 0.25 
arrows(x0 = min(p),
       x1 = qStar,
       y0 = xStar,
       y1 = xStar,
       code = 1,
       angle = 15,
       length = 0.10)
text(x = 0.4,
     y = xStar,
     pos = 4,
     cex = 0.9,
     label = expression(italic(Q)[italic(x)](italic(p)) == 1) )

arrows(x0 = qStar,
       x1 = qStar,
       y0 = xStar,
       code = 1,
       y1 = 0,
       angle = 15,
       length = 0.10)
text(x = qStar,
     y = 0.25,
     pos = 4,
     cex = 0.9,
     label = expression( italic(p) == 0.25))
```


:::{.example #QuantileFnContinuous name="Quantile function: continuous rv"}
Consider the probability density function for a continuous random variable\ $X$ such that
$$
   f_X(x) = 
   \begin{cases}
      2\exp(-2x)   & \text{for $x > 0$}\\
      0            & \text{elsewhere}
   \end{cases}
$$
so that the distribution function is:
$$
   F_X(x) = 
   \begin{cases}
      0                    & \text{for $x < 0$}\\
      1 - \exp(-2x)        & \text{for $x \ge 0 $}.
   \end{cases}
$$
For $0 < p < 1$, the quantile function $Q(p)$ is found by solving $F_X(x) = p$; i.e., the solution to $p = 1 - \exp(-2x)$.
This yields
$$
   Q_X(p) =
   F_X^{-1}(p) = 
      -\frac{1}{2}\log(1 - p)
$$
for $0 \le p \le 1$.
For example, three quarters of the probability occurs before
$$
   Q(3/4) = -\frac{1}{2}\log\big(1 - (3/4)\big) = \frac{\log 4}{2} = 0.6931\dots
$$
In other words, $75$% of the probability occurs for $x = 0.6931...$.
See Fig.\ \@ref(fig:QuantileFnContinuous).
:::


```{r QuantileFnContinuous, echo=FALSE, fig.align="center", fig.cap="Left: the distribution function of $X$. Right: the quantile function for $X$.", fig.width=8, fig.height=4, out.width='100%'}
par(mfrow = c(1, 2))

x <- seq(-1, 5, 
         length = 5000)
p <- seq(0, 1, 
         length = 5000)
yDF <- function(x){ ifelse(x < 0, 0, 1 - exp(-2*x) ) }
yQF <- function(x){ ifelse(x < 0, 0, -0.5*(log(1 - x) ) ) }
###

plot(x, 
     yDF(x),
     las = 1,
     type = "l",
     lwd = 3,
     col = plotColour1,
     xlab = expression(italic(X)),
     ylab = expression(Distribution~fn~italic(F)[italic(X)](italic(x))),
     main = expression(Distribution~"function"~of~italic(X)) )

# Show p = 0.75
xStar <- log(4)/2
qStar <- 0.75 
arrows(x0 = min(x),
       x1 = xStar,
       y0 = qStar,
       y1 = qStar,
       angle = 15,
       length = 0.10)
text(x = xStar,
     y = qStar,
     pos = 4,
     cex = 0.9,
     label = expression(italic(F)[italic(x)](italic(x)) == 3/4) )

arrows(x0 = xStar,
       x1 = xStar,
       y0 = qStar,
       y1 = 0,
       angle = 15,
       length = 0.10)
text(x = xStar,
     y = 0.1,
     pos = 4,
     cex = 0.9,
     label = expression(italic(x) == 0.6931) )
###

plot(p, 
     yQF(p),
     las = 1,
     type = "l",
     lwd = 3,
     col = plotColour1,
     xlab = expression(italic(p)),
     ylab = expression(Quantile~fn~italic(Q)[italic(X)](italic(p))),
     main = expression(Quantile~"function"~of~italic(X)) )

# Show p = 0.75
xStar <- log(4)/2
qStar <- 0.75 
arrows(x0 = min(p),
       x1 = qStar,
       y0 = xStar,
       y1 = xStar,
       code = 1,
       angle = 15,
       length = 0.10)
text(x = 0.4,
     y = qStar,
     pos = 3,
     cex = 0.9,
     label = expression(italic(Q)[italic(x)](italic(p)) == 0.6931) )

arrows(x0 = qStar,
       x1 = qStar,
       y0 = xStar,
       code = 1,
       y1 = 0,
       angle = 15,
       length = 0.10)
text(x = qStar,
     y = 0.25,
     pos = 4,
     cex = 0.9,
     label = expression( italic(p) == 3/4))
```


When\ $X$ is a *discrete* random variable, and so the distribution function is discontinuous, great care is needed when applying Eq.\ \@ref(eq:QuantileFunction).


:::{.example #QuantileFnDiscrete name="Quantile function: discrete rv"}
Consider the discrete random variable in Example\ \@ref(exm:DistributionFnReverseDiscrete), for which
$$
   F_X(x) = 
   \begin{cases}
      0     & \text{for $x < 10$;}\\
      0.1   & \text{for $10 \le x < 11$;}\\
      0.4   & \text{for $11 \le x < 15$;}\\
      0.9   & \text{for $15 \le x < 17$;}\\
      1     & \text{for $x \ge 17$,}
   \end{cases}
$$
as shown in Fig.\ \@ref(fig:QuantileFnDiscrete) (left panel).

The quantile function is found by solving $F_X(x) \ge p$ for $0 < p \le 1$.
This gives:
$$
  Q_X(p) = 
  \begin{cases}
    10 & \text{for $0 < p \le 0.1$;}\\
    11 & \text{for $0.1 < p \le 0.4$;}\\
    15 & \text{for $0.4 < p \le 0.9$;}\\
    17 & \text{for $0.9 < p \le 1$.}
  \end{cases}
$$
as shown in Fig.\ \@ref(fig:QuantileFnDiscrete).
For example:

* $Q_X(0.02) = 10$.
* $Q_X(0.3) = 11$.
* $Q_X(0.4) = 11$, since $F_X(11) = 0.4$ and no value of\ $x$ has a value of $F_X(x)$ greater than or equal to\ $0.4$.
* $Q_X(1) = 17$.

:::



```{r QuantileFnDiscrete, echo=FALSE, fig.align="center", fig.cap="Left: the distribution function of $X$. Right: the quantile function of $X$.", fig.width=8, fig.height=4, out.width='100%'}
par(mfrow = c(1, 2))

xDF <-  c(6,  10,   11,  15, 17,  22)
yDF <-  c(0,  0.1, 0.4, 0.9,   1,  1)

xPF <- c( 10,  11,  15,  17)
yPF <- c(0.1, 0.3, 0.5, 0.1)


###

plot(x = xDF, 
     y = yDF,
     xlim = c(8, 20),
     xlab = expression(italic(p)),
     ylab = expression(Distribution~"function") ,
     main = expression(Distribution~"function"~of~italic(X)),
     las = 1,
     type = "n")
for (i in (1:(length(xDF) - 1) ) ) {
  lines( x = c(xDF[i], xDF[i + 1]),
         y = c(yDF[i], yDF[i]),
         col = plotColour1,
         lwd = 3)
  if (i > 1 ) {# Add 'include this point' points: solid dots
    points(x = xDF[i], 
           y = yDF[i],
           pch = 19)
  }
  if (i < (length(xDF) - 1) ) {# Add 'exclude this point' points: open diots
    points(x = xDF[i + 1],
           y = yDF[i],
           pch = 1)
  }
}
abline(v = xDF,
       col = "grey",
       lty = 2)
###

xQ <- c(0,  0.1, 0.4, 0.9,  1)
yQ <- c(10,  11,  15, 17,  17 )
n <- length(xQ)

plot(x = xQ, 
     y = yQ,
     xlab = expression(italic(X)),
     ylab = expression(Quantile~"function") ,
     main = expression(Quantile~"function"~of~italic(X)),
     las = 1,
     type = "n")

# The 'steps'
for (i in (1 : (n - 1))){
  lines(x = c(xQ[i], xQ[i + 1]),
        y = c(yQ[i], yQ[i]),
        col = plotColour1,
        lwd = 3)
}

# Draw points according to left-continuous convention
for (i in 1:(n-1)) {
  # Left endpoint of segment: open circle (excluded), except first point
  if (i == 1) {
    points(xQ[i], yQ[i], pch = 19)  # first point filled
  } else {
    points(xQ[i], yQ[i], pch = 1)   # open circle for interior left ends
  }
  
  # Right endpoint of segment: always filled (included)
  points(xQ[i+1], yQ[i], pch = 19)
}

# Guiding lines
abline(v = xQ,
       col = "grey",
       lty = 2)

```



## Generating random numbers {#RandomNumbers}

Many computers have facilities for generating pseudo-random numbers between\ $0$ and\ $1$, though random numbers from other distributions are often more useful in computer modelling and simulation (for example, Sects.\ \@ref(SimulationDiscrete) and\ \@ref(SimulationContinuous)).
For instance, generating heights of people at random would requires the heights to have an average value of (say) $180\cms$, with most heights between about $175\cms$ and $185\cms$, but a few smaller than $175\cms$ and a few larger than $185\cms$.

* Generate a random number between $(0, 1)$, say $p^*$.
* Use the quantile function to evaluate $Q(p^*)$; this becomes a random number from the distribution specified in quantile function.

In **R**, random numbers between\ $0$ and\ $1$ are found using the function `runif()`:

```{r echo=FALSE}
set.seed(847126)
```
```{r}
runif(10) # '10' here means to generate 10 random numbers between 0 and 1
```


::: {.example #RandomContinuous name="Random numbers from a continuous distribution"}
Suppose we want to generate random numbers from the distribution
$$
  f_X(x) = \exp(-2x)
$$
as in Example\ \@ref(exm:QuantileFnContinuous).
For the distribution, the quantile function is shown in Example\ \@ref(exm:QuantileFnContinuous).
So random numbers from the distribution can be generated using\ **R**:

```{r fig.show='hide'}
# Create an R function for the quantile function
quantileFn <- function(p){ -log(1 - p) / 2}

# Create 2000 random numbers between 0 and 1
rnos <- runif(2000)

# Random numbers from the specified distribution
rSpecified <- quantileFn(rnos)

# A histogram of these random numbers should have a shape like the density fn
hist(rSpecified)
```
The histogram (Fig.\ \@ref(fig:rRandomSpecified)) does indeed have a similar shape to the density function.

:::



```{r rRandomSpecified, echo=FALSE, fig.width=9, fig.height = 4, out.width='100%', fig.align="center", fig.cap="Left: a density function. Right: a histogram of random numbers from the distribution."}
par(mfrow = c(1, 2))
x <- seq(0, 4.5,
         length = 100)
fx <- function(x){ifelse(x < 0, 0, 2 * exp(-2 * x))}

plot( fx(x) ~ x,
      type ="l",
      lwd = 2,
      las = 1,
      xlim = c(0, 4.5),
      main = "The target distribution",
      xlab = expression(italic(X)),
      ylab = expression(Density~fn) )
###  truehist  is part of the MASS package,which must be loaded first, using: 
###  library(MASS)
truehist(rSpecified, 
               xlab = expression(italic(X)),
               ylab = expression(Number~of~values),
               main = "Random numbers",
               xlim = c(0, 4.5),
         breaks = seq(0, 5, by = 0.25),
               las = 1)
```


## Statistical computing {#RVsStatisticalComputing}

Many statistical distributions are generated from existing distributions, and many of these relationships are explored later.
These relationships can also be shown using computer simulation.

As an example, the chi-squared distribution\index{Chi-squared distribution} is related to the normal distribution,\index{Normal distribution} and is discussed later (Sect.\ \@ref(ChiSquareDistribution)).
If a random variable\ $Z$ has a standard normal distribution $Z\sim N(0, 1)$, then\ $Z^2$ has a chi-squared distribution (with one *degree of freedom*).
This can be shown using simulation (Fig.\ \@ref(fig:SimChiSq1Fig)).


```{r SimChiSq1, fig.show='hide'}
### A standard normal variate: 1000 random values 
Z <- rnorm(n = 1000,
           mean = 0, 
           sd = 1)

### Set up for two plots, side-by-side
par(mfrow = c(1, 2) )

### Plot two histograms: Z and Z^2
###  truehist  is part of the MASS package,which must be loaded first, using: 
###  library(MASS)
truehist(Z,
         las = 1,
         xlab = expression(italic(Z) ),
         ylab = "Density")
truehist(Z^2,
         las = 1,
         xlab = expression(sum(italic(Z^2)) ),
         ylab = "Density")

### Now plot the theoretical chi-squared distribution (with one df)
# Use these values of X:
x_Plot <- seq(0, 10,
              length = 100)
# Add lines to the histogram of chi-square random values
lines( dchisq(x_Plot, df = 1) ~ x_Plot,
       type = "l",
       lwd = 3)
# dchisq()  is the density function for a chi-squared distribution
```


```{r SimChiSq1Fig, fig.cap="Left: histogram of $1000$ simulated normal variates. Right: histogram of the squared normal variates. The solid lines on the right panel is the theoretical distribution of a chi-squared distribution with $1$\\ degree of freedom.",  out.width="100%", fig.align='centre', echo=FALSE, fig.width=10}
<<SimChiSq1>>
```


Furthermore, the sum of\ $k$ independent standard normal distributions is a chi-squared distribution with $k$\ degrees of freedom (Fig.\ \@ref(fig:SimChiSq5Fig)):


```{r SimChiSq5, fig.show='hide'}
set.seed(7701)

### Standard normal variate: in 100 rows of 5 columns each 
Z <- matrix( data = rnorm(n = 5000,
                          mean = 0, 
                          sd = 1),
             nrow = 1000,
             ncol = 5)

### Add the squared values, across rows (so each value is the
### sum of *five* standard normal variates)
Z_SumsSq <- rowSums(Z^2)

### Set up for two plots, side-by-side
par(mfrow = c(1, 2) )

### Plot two histograms: Z and Z^2
###  truehist  is part of the MASS package,which must be loaded first, using: 
###  library(MASS)
truehist(Z,
         las = 1,
         xlab = expression(italic(Z)),
         ylab = "Density")
truehist(Z_SumsSq,
         las = 1,
         ylim = c(0, 0.16),
         xlab = expression(sum(italic(Z^2))~over~five~values ),
         ylab = "Density")

### Now plot the theoretical chi-squared distribution (with *five* df)
# Use these values of X:
x_Plot <- seq(0, 20,
              length = 100)
lines( dchisq(x_Plot, df = 5) ~ x_Plot,
       type = "l",
       lwd = 3)
```



```{r SimChiSq5Fig, fig.cap="Left: histogram of $5000$ simulated normal variates. Right: histogram of the sum of five squared normal variates. The solid lines on the right panel is the theoretical distribution of a chi-squared distribution with $5$\\ degrees of freedom.",  out.width="100%", fig.align='centre', echo=FALSE, fig.width=10}
<<SimChiSq5>>
```




## Exercises {#RVExercises}

Selected answers appear in Sect.\ \@ref(AnswersChapRandomVariables).


:::{.exercise #SSpaceRV}
For the following random processes, determine the range space\ $\mathcal{R}_X$ and define the random variable of interest.
Determine whether the random variable is discrete, continuous or mixed.
Justify your answer.

1. The number of heads in two throws of a fair coin.
2. The number of throws of a fair coin until a head is observed.
3. The time taken to download a webpage.
4. The time it takes to walk to work.
:::


:::{.exercise #SSpaceRV2}
For the following random processes, determine the range space\ $\mathcal{R}_X$ and define the random variable of interest.
Determine whether the random variable is discrete, continuous or mixed.
Justify your answer.

1. The number of cars that pass through an intersection during a day.
2. The number of X-rays taken at a hospital per day.
3. The barometric pressure in a given city at $5$pm each afternoon.
4. The length of a phone call connection.
:::



:::{.exercise #DFdiscrete}
The random variable\ $X$ has the probability function
$$
   p_X(x) = \begin{cases}
               0.3 & \text{for $x = 10$};\\
               0.2 & \text{for $x = 15$};\\
               0.5 & \text{for $x = 20$};\\
               0 & \text{elsewhere}.
            \end{cases}
$$

1. Show that $p_X(x)$ is a valid probability distribution.
1. Plot the probability function of\ $X$.
1. Find and plot the distribution function for\ $X$.
1. Compute $\Pr(X > 13)$.
1. Compute $\Pr(X \le 10 \mid  X\le 15)$.
:::



:::{.exercise #DFdiscrete2}
The random variable\ $X$ has the probability mass function
$$
   p_X(x) = \begin{cases}
               2^{-x} & \text{for $x = 1, 2, 3, \dots$};\\
               0      & \text{elsewhere}.
            \end{cases}
$$

1. Show that $p_X(x)$ is a valid probability distribution.
1. Plot the probability function of\ $X$.
1. Find and plot the distribution function for\ $X$.
1. Compute $\Pr(X > 13)$.
1. Compute $\Pr(X \le 10 \mid  X\le 15)$.
:::


:::{.exercise #DFcontinuous}
Consider the continuous random variable\ $Z$ with probability function
$$
   f_Z(z) = \begin{cases}
               \alpha (3 - z) & \text{for $-1 < z < 2$};\\
               0 & \text{elsewhere}.
            \end{cases}
$$

1. Find the value of\ $\alpha$.
1. Plot the probability function of\ $Z$.
1. Find and plot the distribution function of\ $Z$.
1. Find $\Pr(Z < 0)$.
:::



:::{.exercise #DFcontinuous2}
Consider the continuous random variable\ $X$ with probability density function
$$
   f_X(x) = \begin{cases}
               3(4 - x^2)/16 & \text{for $0 < x < 2$};\\
               0 & \text{elsewhere}.
            \end{cases}
$$

1. Plot the probability function of\ $X$.
1. Find and plot the distribution function of\ $X$.
1. Find $\Pr(X < 1)$.
:::




:::{.exercise #DFmixed}
Consider the mixed random variable\ $Y$ with probability function
$$
   f_Y(y) = \begin{cases}
               p & \text{for $y = 0$};\\
               1 - y & \text{for $0 < y < 1$}.\\
               0 & \text{elsewhere}.
            \end{cases}
$$

1. Find the value of\ $p$.
1. Carefully plot the probability function of\ $Y$.
1. Find and carefully plot the distribution function of\ $Y$.
1. Find $\Pr(Y < 0.5)$.
:::



:::{.exercise #DFmixed2}
Consider the mixed random variable\ $X$ with probability function
$$
   f_X(x) = \begin{cases}
               c   & \text{for $x = 0$};\\
               x/2 & \text{for $0 < x < 1$};\\
               (1 - x)/4 & \text{for $1 < x < 3$};\\
               0 & \text{elsewhere}.
            \end{cases}
$$

1. Find the value of\ $c$.
1. Carefully plot the probability function of\ $X$.
1. Find and plot the distribution function of\ $X$.
1. Find $\Pr(X > 1)$.
:::



:::{.exercise #PMFtrickier}
Consider the random variable\ $Y$ with the probability mass function
$$
  f_Y(y)
  = 
  \begin{cases}
    y^\alpha - 2 & \text{for $y = 1, 2$}\\
    0            & \text{elsewhere.}
  \end{cases}
$$
Find the value(s) of $\alpha$ so that $f_Y(y)$ is a valid probability function.
:::


:::{.exercise #PMFtrickier2}
Consider the random variable\ $X$ with the probability mass function
$$
  f_X(x)
  = 
  \begin{cases}
    x + 1 & \text{for $x = b, b + 1, b + 2$}\\
    0     & \text{elsewhere.}
  \end{cases}
$$
Find the value(s) of $b$ so that $f_X(x)$ is a valid probability function.
:::



:::{.exercise #PDFtrickier}
Consider the random variable\ $T$ with the probability density function shown in Fig.\ \@ref(fig:TwoDensities) (left panel).
Find the value(s) of $a$ so that this represents a valid probability function.
:::




:::{.exercise #PDFtrickier2}
Consider the random variable\ $W$ with the probability density function shown in Fig.\ \@ref(fig:TwoDensities) (right panel).
Find the value(s) of $a$ so that this represents a valid probability function.
:::

```{r TwoDensities, echo=FALSE, fig.cap="Two probability density functions", out.width='100%', fig.width=9, fig.height = 4, fig.align="center"}
par(mfrow = c(1, 2))

plot( x = c(0, 3),
      y = c(0, 0.7),
      type = "n",
      axes = FALSE,
      main = "A probability function",
      xlab = expression(italic(Y)),
      ylab = "Density function")
axis(side = 1,
     at = c(0, 1, 2, 3) )
axis(side = 2,
     at = c(0, 2/3),
     las = 1,
     label = c(0, 
               expression(italic(a))) )

lines(x = c(0, 2),
      y = c(0, 2/3),
      col = plotColour1,
      lwd = 3)
lines(x = c(2, 3),
      y = c(2/3, 0),
      col = plotColour1,
      lwd = 3)

abline(h = 0,
       lty = 1,
       col = "grey")
abline(v = 2,
       lty = 2,
       col = "grey")
abline(h = 2/3,
       lty = 2,
       col = "grey")
box()

##############

theta <- seq(pi/2, pi,
             length = 100)
r <- 1

plot( x = c(-1, 1),
      y = c(0, 1.3),
      type = "n",
      asp = 1,
      axes = FALSE,
      main = "A probability function",
      xlab = expression(italic(T)),
      ylab = "Density function")
lines(x = r * cos(theta),
      y = r * sin(theta),
      col = plotColour1,
      lwd = 3)

axis(side = 1,
     at = c(-1, 0, 1, 2) )
axis(side = 2,
     at = c(0, 1.3),
     las = 1,
     label = c(0, 
               expression(italic(a) ) ) ) 

#lines(x = c(-1, 1),
#      y = c(0, 1/3),
#      lwd = 2)
lines(x = c(0, 1),
      y = c(1.3, 0),
      col = plotColour1,
      lwd = 3)

abline(v = 0,
       lty = 2,
       col = "grey")
abline(h = 0,
       lty = 1,
       col = "grey")
abline(h = 1.1,
       lty = 2,
       col = "grey")
points(x = 0,
       y = 1,
       col = plotColour1,
       lwd = 2,
       cex = 1.15,
       pch = 1) # Open circle
points(x = 0,
       y = 1.3,
       col = plotColour1,
       cex = 1.15,
       pch = 19) # Closed circle

arrows( x0 = -0.5,
       y0 = 0.5,
       x1 = r * cos(3 * pi / 4),
       y1 = r * sin(3 * pi / 4),
       angle = 15,
       length = 0.15)
text( x = -0.5,
      y = 0.5,
      pos = 1,
      labels = "Quarter\ncircle",
      cex = 0.9)
box()

```



:::{.exercise #DFdiscreteBackwards}
Consider the discrete random variable\ $W$ with DF
$$
   F_W(w) = \begin{cases}
               0   & \text{for $w < 10$};\\
               0.3 & \text{for $10 \le w < 20$};\\
               0.7 & \text{for $20 \le w < 30$};\\
               0.9 & \text{for $30 \le w < 40$};\\
               1 & \text{for $w \ge 40$}.
            \end{cases}
$$

1. Find and plot the PMF of\ $W$.
1. Compute $\Pr(W < 25)$ using the PMF, and using the DF.
:::


:::{.exercise #DFcontinuousBackwards}
Consider the continuous random variable\ $Y$ with DF
$$
   F_Y(y) = \begin{cases}
               0 & \text{for $y \le 0$};\\
               y(4 - y^2)/3 & \text{for $0 < y < 1$};\\
               1 & \text{for $y \ge 1$}.
            \end{cases}
$$

1. Find and plot the PDF of\ $Y$.
1. Compute $\Pr(Y < 0.5)$ using the PDF and using the DF.
:::



:::{.exercise #Chlorine}
A study of the service life of concrete in various conditions [@liu2012stochastic] used the following distribution for the chlorine threshold of concrete^[The density function quoted in the article has an error.]:
$$
   f(x; a, b, c) = 
   \begin{cases}
      \displaystyle \frac{2(x - a)}{(b - a)(c - a)} & \text{for $a\le x\le c$};\\[6pt]
      \displaystyle \frac{2(b - x)}{(b - a)(b - c)} & \text{for $c\le x\le b$};\\[3pt]
      0 & \text{otherwise},
   \end{cases}
$$
where\ $c$ is the mode, and\ $a$ and\ $b$ are the lower and upper limits. 

1. Show that the distribution is a valid PDF.
   (This may be easier geometrically than using integration.)
1. Previous studies, cited in the article, suggest the values $a = 0.6$ and $c = 5$, and that the distribution is symmetric.
   Write down the PDF for this case.
1. Determine the DF using the values above.
1. Plot the PDF and DF.
1. Determine $\Pr(X > 3)$.
1. Determine $\Pr(X > 3 \mid X > 1)$.
1. Explain the difference in *meaning* for the last two answers.
:::


:::{.exercise #TriangularHospital}
In a study modelling waiting times at a hospital [@khadem2008evaluating], patients are classified into one of three categories:

* Red: Critically ill or injured patients.
* Yellow: Moderately ill or
injured patients.
* Green: Minimally injured or
uninjured patients.

For 'Yellow' patients, the service time of doctors are modelled using a triangular distribution, with a minimum at $3.5\mins$, a maximum at $30.5\mins$ and a mode at $5\mins$.

1. Plot the PDF and DF.
1. If\ $S$ is the service time, compute $\Pr(S > 20 \mid S > 10)$.
:::


:::{.exercise #Exceedance}
In meteorological studies, rainfall is often graphed using rainfall *exceedance* charts [@dunn2001bootstrap]: the plotted function is $1 - F_X(x)$ (also called the *survivor function* in other contexts), where\ $X$ represents the rainfall.

1. Explain what is measured by $1 - F_X(x)$ in this context, and explain why it may be more useful than just $F_X(x)$ when studying rainfall.
1. The data in Table\ \@ref(tab:RainArray) shows the total monthly rainfall at Charleville, Queensland, from 1942 until 2022 for the months of June and December. 
   (Data supplied by the Bureau of Meteorology.)
   Plot $1 - F_X(x)$ for this rainfall data for each month on the same graph.
1. Suppose a producer requires at least $50\mms$ of rain in June to plant a crop.
   Find the probability of this occurring from the plot above.
1. Determine the median monthly rainfall in Charleville in June and December.
1. Decide if the mean or the median is an appropriate measure of central tendency, giving reasons for your answer.
1. Compare the probabilities of obtaining $30\mms$, $50\mms$, $100\mms$ and $150\mms$ of rain in the months of June and December.
1. Write a one-or two-paragraph explanation of how to use diagrams like that presented here.
   The explanation should be aimed at producers (that is, experts in farming, but not in statistics) and should be able to demonstrate the usefulness of such graphs in decision making.
  Your explanation should be clear and without jargon.
  Use diagrams if necessary.
:::


```{r RainArray, echo=FALSE}
RainArray <- array( dim = c(12, 2) )

Rain12 <- read.csv("Data/IDCJAC0001_044021/IDCJAC0001_044021_Data12.csv", 
                   na.strings = "null")
RainDec <- Rain12$Dec
RainJun <- Rain12$Jun

breaks <- c( 0, 0.01, 20,
             seq(40, 220, by = 20) )
outDec <- hist(RainDec,
               breaks = breaks,
               plot = FALSE)
outJun <- hist(RainJun, 
               breaks = breaks,
               plot = FALSE)

RainArray[, 1] <- outJun$counts
RainArray[, 2] <- outDec$counts
colnames(RainArray) <- c("June",
                         "December")
rownames(RainArray) <- c("Zero rainfall", 
           "$0 < R < 20$",
           "$20 \\le R < 40$",
           "$40 \\le R < 60$",
           "$60 \\le R < 80$",
           "$80 \\le R < 100$",
           "$100 \\le R < 120$",
           "$120 \\le R < 140$",
           "$140 \\le R < 160$",
           "$160 \\le R < 180$",
           "$180 \\le R < 200$",
           "$200 \\le R < 220$")


if( knitr::is_latex_output() ) {
  knitr::kable(RainArray,
               format = "latex",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               escape = FALSE,
               caption = "The monthly rainfall in Charleville, in mm, from 1942 to 2022: The number of months with the indicated rainfall") %>%
    kable_styling(font_size = 10) %>%
    row_spec(0, bold = TRUE) 
}
if( knitr::is_html_output() ) {
  rownames(RainArray) <- c("Zero rainfall", 
             "Over 0 to under 20",
             "20 to under 40",
             "40  to under  60",
             "60  to under  80",
             "80  to under  100",
             "100  to under  120",
             "120  to under  140",
             "140  to under  160",
             "160  to under  180",
             "180  to under  200",
             "200  to under  220")
knitr::kable(RainArray,
               escape = FALSE,
               format = "html",
               booktabs = TRUE,
               align = "r",
               longtable = FALSE,                
               caption = "The monthly rainfall in Charleville, in mm, from 1942 to 2022: The number of months with the indicated rainfall") %>%
    row_spec(0, bold = TRUE) 
}



```

:::{.exercise #YouFriendInLine}
Five people, including you and a friend, line up at random. 
The random variable\ $X$ denotes the number of people between yourself and your friend. 
Determine the probability function of\ $X$.
:::




:::{.exercise #Continuous1}
Let\ $Y$ be a continuous random variable with PDF
$$
   f_Y(y) = a(1 - y)^2,\quad \text{for $0\le y\le 1$}.
$$

1. Show that $a = 3$.
1. Find $\Pr\left(| Y - \frac{1}{2}| > \frac{1}{4} \right)$.
1. Use **R** to draw a graph of $f_Y(y)$ and show the area described above.
:::


:::{.exercise #ContTwoParts}
Suppose the random variable\ $Y$ has the PDF
$$
  f_Y()y) = 
  \begin{cases}
    \frac{2}{3}(y - 1) & \text{for $1 < y < 2$};\\
    \frac{2}{3} & \text{for $2 < y < 3$}.
  \end{cases}
$$

1. Plot the PDF.
2. Determine the DF.
3. Confirms that the DF is a valid DF.
:::



:::{.exercise #Quartic}
Quartic polynomials are sometimes used to model mortality (e.g., @fitzpatrick2018mortality).
Suppose the model
$$
   f_Y(y) = k y^2 (100 - y)^2\quad \text{for $0 \le y \le 100$}
$$
(for some value of\ $k$) is used for describing mortality where\ $Y$ denotes age at death in years.
Using this model, is a person more likely to die at age between\ $60$ and\ $70$, or live past\ $70$?
:::




:::{.exercise #PooledTest}
To detect disease in a population through a blood test, usually every individual is tested.
If the disease is uncommon, however, an alternative method is often more efficient.

In the alternative method (called a *pooled test*), blood from\ $n$ individuals is combined, and one test is conducted.
If the test returns a negative result, then none of the\ $n$ people have the disease; if the test returns a positive result, all\ $n$ individuals are then tested individually to identify which individual(s) have the disease.

Suppose a disease occurs in an unknown proportion of people\ $p$ of people.
Let\ $X$ be the number of tests to be performed for a group of\ $n$ individuals using the *pooled test* approach.

1. Determine the sample space for\ $X$.
1. Deduce the probability distribution of the random variable\ $X$.
:::



:::{.exercise #CardDistance}
In a deck of cards, consider an **Ace** as high, and all picture cards (i.e., **Jacks**, **Queens**, **Kings**, **Aces**) as worth ten points.
All other cards are worth their face value (i.e., an\ **8** is worth eight points.)

Deduce the probability distribution of the absolute difference between the value of two cards drawn at random from a well-shuffled deck of $52$ cards.
:::


:::{.exercise #BenfordsLaw}
The leading digits of natural data that span many orders of magnitude (e.g., lengths of rivers; populations of countries) often follow *Benford's law*.
Numbers are said to satisfy *Benford's law* if the *leading digit*, say\ $d$ (for $d\in \{1, \dots, 9\}$) has the probability mass function
$$
   p_D(d) = \log_{10}\left( \frac{d + 1}{d} \right).
$$

1. Plot the probability mass function of\ $D$.
1. Compute and plot the distribution function of\ $D$.
:::


<!-- arcsine distribution -->
:::{.exercise #Arcsine} 
Consider the random variable\ $X$ with PDF
$$
   f(x) =
   \begin{cases} 
      \displaystyle \frac{k}{\sqrt{x(1 - x)}} & \text{for $0 < x < 1$};\\[6pt]
      0                                       & \text{elsewhere},
   \end{cases}
$$
for some constant\ $k$.

1. Plot the density function.
1. Determine, and then plot, the distribution function.
1. Compute $\Pr(X > 0.25)$.
:::


:::{.exercise #DFExpInverse}
Consider the distribution function
$$
   F_X(x) = 
   \begin{cases}
        0          & \text{for $x < 0$};\\
        \exp(-1/x) & \text{$x \ge 0$}.
   \end{cases}
$$

1. Show that this is a valid DF.
1. Compute the PDF.
1. Plot the DF and PDF.
:::



:::{.exercise #Cards4}
Suppose a dealer deals four cards from a standard $52$-card pack.
Define\ $Y$ as the number of suits in the four cards.
Deduce the distribution of\ $Y$.
:::


:::{.exercise #Mixed}
Consider the random variable\ $T$ with the probability function
$$
  f_T(t) = 
  \begin{cases}
    a & \text{for $t = 0$}; \\
    \frac{2}{3} - (t - 1)^2 & \text{for $0 < t < 2$}.
  \end{cases}
$$

1. Determine the value of\ $a$.
2. Plot the probability function.
3. Determine the distribution function.
4. Plot the distribution function.
:::



:::{.exercise #TotalFour}
Consider rolling a fair, six-sided die.

1. Find the probability mass function for the number of rolls required to roll a total of *at least* four.
1. Find the probability mass function for the number of rolls required to roll a total of *exactly* four.
:::


:::{.exercise #SimTdist}
Consider a random variable\ $Z$ with a standard normal distribution $N(0, 1)$, and a random variable\ $V$ with a chi-squared distribution on\ $v$ degrees of freedom.

Simulate the distribution of
$$
  T = \frac{Z}{\sqrt{V/\nu}},
$$
then show this is a $t$-distribution with\ $\nu$ degrees of freedom.
*Hint*: use the **R** functions for the $t$-distribution (e.g., `dt()`) and the chi-squared distribution (e.g, `dchisq()`). 
:::


:::{.exercise #SimTriangular}
Consider two random variables\ $X$ and\ $Y$ that have *uniform distributions*,\index{Uniform distribution} with probability density functions
\begin{align*}
  f_X(x) = 1\quad\text{for $0< x < 1$; and}\\
  f_Y(y) = 1\quad\text{for $0< y < 1$}
\end{align*}

1. Using simulation, show that the distribution of $X + Y$ has a triangular distribution.
2. What is the mean and variance of the resulting distribution, based on the simulation?
3. Explain how your answers change if the distribution of \ $Y$ changes to
$$
  f_Y(y) = \frac{1}{2}\quad\text{for $-1 < y < 1$}.
$$
:::


:::{.exercise #SimTdist2}
Consider a random variable\ $Z$ with a standard normal distribution $N(0, 1)$, and a random variable\ $V_\nu$ with a chi-squared distribution on\ $\nu$ degrees of freedom.

Simulate the distribution of
$$
  T = \frac{Z}{\sqrt{V_9/9}},
$$
then show this is a $t$-distribution with\ $\nu = 9$ degrees of freedom.
*Hint*: use the **R** functions for the $t$-distribution (e.g., `dt()`) and the chi-squared distribution (e.g, `dchisq()`). 
:::





